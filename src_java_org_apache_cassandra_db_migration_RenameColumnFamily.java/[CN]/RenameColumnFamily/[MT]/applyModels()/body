{
  KSMetaData oldKsm=schema.getTableDefinition(tableName);
  schema.purge(oldKsm.cfMetaData().get(oldName));
  KSMetaData ksm=makeNewKeyspaceDefinition(schema.getTableDefinition(tableName));
  try {
    schema.load(ksm.cfMetaData().get(newName));
  }
 catch (  ConfigurationException ex) {
    throw new RuntimeException(ex);
  }
  schema.setTableDefinition(ksm,newVersion);
  if (!StorageService.instance.isClientMode()) {
    Table.open(ksm.name,schema).renameCf(cfId,newName);
  }
}
