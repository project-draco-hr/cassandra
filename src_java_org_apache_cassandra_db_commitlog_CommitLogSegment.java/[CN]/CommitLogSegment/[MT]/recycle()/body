{
  try {
    sync();
  }
 catch (  FSWriteError e) {
    logger.error("I/O error flushing {} {}",this,e.getMessage());
    throw e;
  }
  close();
  return new CommitLogSegment(getPath());
}
