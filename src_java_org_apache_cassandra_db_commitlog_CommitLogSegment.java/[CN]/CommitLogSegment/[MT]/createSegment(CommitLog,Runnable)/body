{
  return commitLog.configuration.useCompression() ? new CompressedSegment(commitLog,onClose) : new MemoryMappedSegment(commitLog);
}
