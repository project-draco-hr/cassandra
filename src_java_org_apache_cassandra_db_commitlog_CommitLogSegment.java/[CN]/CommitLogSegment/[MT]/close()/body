{
  discardUnusedTail();
  waitForModifications();
  lastSyncedOffset=buffer.capacity();
  internalClose();
}
