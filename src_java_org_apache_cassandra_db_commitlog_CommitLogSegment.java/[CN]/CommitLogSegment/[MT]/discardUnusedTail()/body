{
  if (discardedTailFrom > 0)   return;
  while (true) {
    int prev=allocatePosition.get();
    int next=buffer.capacity();
    if (allocatePosition.compareAndSet(prev,next)) {
      discardedTailFrom=prev;
      return;
    }
  }
}
