{
  final OpOrder.Group commandOrder=appendOrder.start();
  try {
    int position=allocate(size);
    if (position < 0) {
      commandOrder.close();
      return false;
    }
    alloc.buffer=(ByteBuffer)buffer.duplicate().position(position).limit(position + size);
    alloc.position=position;
    alloc.segment=this;
    alloc.appendOp=commandOrder;
    markDirty(mutation,position);
    return true;
  }
 catch (  Throwable t) {
    commandOrder.close();
    throw t;
  }
}
