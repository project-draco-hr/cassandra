{
  while (segment.lastSyncedOffset < position) {
    WaitQueue.Signal signal=segment.syncComplete.register(CommitLog.instance.metrics.waitingOnCommit.time());
    if (segment.lastSyncedOffset < position)     signal.awaitUninterruptibly();
 else     signal.cancel();
  }
}
