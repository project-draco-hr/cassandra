{
  TypeCodec<Object> codec=codecRegistry.codecFor(dataType);
  if (!codec.getJavaType().getRawType().isAssignableFrom(value.getClass()))   throw new InvalidTypeException("Invalid value for CQL type " + dataType.getName().toString());
  return codec.serialize(value,ProtocolVersion.fromInt(protocolVersion));
}
