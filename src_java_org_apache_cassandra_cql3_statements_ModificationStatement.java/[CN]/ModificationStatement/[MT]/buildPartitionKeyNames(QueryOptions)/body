{
  CompositesBuilder keyBuilder=new CompositesBuilder(cfm.getKeyValidatorAsCType());
  for (  ColumnDefinition def : cfm.partitionKeyColumns()) {
    Restriction r=checkNotNull(processedKeys.get(def.name),"Missing mandatory PRIMARY KEY part %s",def.name);
    r.appendTo(keyBuilder,options);
  }
  return Lists.transform(keyBuilder.build(),new Function<Composite,ByteBuffer>(){
    @Override public ByteBuffer apply(    Composite composite){
      ByteBuffer byteBuffer=composite.toByteBuffer();
      ThriftValidation.validateKey(cfm,byteBuffer);
      return byteBuffer;
    }
  }
);
}
