{
  MultiCBuilder keyBuilder=MultiCBuilder.create(cfm.getKeyValidatorAsClusteringComparator());
  for (  ColumnDefinition def : cfm.partitionKeyColumns()) {
    Restriction r=checkNotNull(processedKeys.get(def.name),"Missing mandatory PRIMARY KEY part %s",def.name);
    r.appendTo(keyBuilder,options);
  }
  NavigableSet<Clustering> clusterings=keyBuilder.build();
  List<ByteBuffer> keys=new ArrayList<ByteBuffer>(clusterings.size());
  for (  Clustering clustering : clusterings) {
    ByteBuffer key=CFMetaData.serializePartitionKey(clustering);
    ThriftValidation.validateKey(cfm,key);
    keys.add(key);
  }
  return keys;
}
