{
  List<ByteBuffer> keys=buildPartitionKeyNames(variables);
  Composite clusteringPrefix=createClusteringPrefix(variables);
  UpdateParameters params=makeUpdateParameters(keys,clusteringPrefix,variables,local,cl,now);
  Collection<IMutation> mutations=new ArrayList<IMutation>();
  for (  ByteBuffer key : keys) {
    ThriftValidation.validateKey(cfm,key);
    ColumnFamily cf=ArrayBackedSortedColumns.factory.create(cfm);
    addUpdateForKey(cf,key,clusteringPrefix,params);
    Mutation mut=new Mutation(cfm.ksName,key,cf);
    mutations.add(isCounter() ? new CounterMutation(mut,cl) : mut);
  }
  return mutations;
}
