{
  List<ByteBuffer> keys=buildPartitionKeyNames(variables);
  ColumnNameBuilder clusteringPrefix=createClusteringPrefixBuilder(variables);
  UpdateParameters params=makeUpdateParameters(keys,clusteringPrefix,variables,local,cl,now);
  Collection<IMutation> mutations=new ArrayList<IMutation>();
  for (  ByteBuffer key : keys) {
    ThriftValidation.validateKey(cfm,key);
    ColumnFamily cf=UnsortedColumns.factory.create(cfm);
    addUpdateForKey(cf,key,clusteringPrefix,params);
    RowMutation rm=new RowMutation(cfm.ksName,key,cf);
    mutations.add(isCounter() ? new CounterMutation(rm,cl) : rm);
  }
  return mutations;
}
