{
  KsDef ks;
  try {
    ks=client.describe_keyspace(WordCount.KEYSPACE);
  }
 catch (  NotFoundException e) {
    logger.info("set up keyspace " + WordCount.KEYSPACE);
    String query="CREATE KEYSPACE " + WordCount.KEYSPACE + " WITH replication = {'class': 'SimpleStrategy', 'replication_factor' : 1}";
    client.execute_cql3_query(ByteBufferUtil.bytes(query),Compression.NONE,ConsistencyLevel.ONE);
    int magnitude=client.describe_ring(WordCount.KEYSPACE).size();
    try {
      Thread.sleep(1000 * magnitude);
    }
 catch (    InterruptedException ie) {
      throw new RuntimeException(ie);
    }
  }
}
