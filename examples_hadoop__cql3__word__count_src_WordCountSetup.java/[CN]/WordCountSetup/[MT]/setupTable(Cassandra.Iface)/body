{
  String query="CREATE TABLE " + WordCount.KEYSPACE + "."+ WordCount.COLUMN_FAMILY+ " ( user_id text,"+ "   category_id text, "+ "   sub_category_id text,"+ "   title  text,"+ "   body  text,"+ "   PRIMARY KEY (user_id, category_id, sub_category_id) ) ";
  try {
    logger.info("set up table " + WordCount.COLUMN_FAMILY);
    client.execute_cql3_query(ByteBufferUtil.bytes(query),Compression.NONE,ConsistencyLevel.ONE);
  }
 catch (  InvalidRequestException e) {
    logger.error("failed to create table " + WordCount.KEYSPACE + "."+ WordCount.COLUMN_FAMILY,e);
  }
  query="CREATE INDEX title on " + WordCount.COLUMN_FAMILY + "(title)";
  try {
    logger.info("set up index on title column ");
    client.execute_cql3_query(ByteBufferUtil.bytes(query),Compression.NONE,ConsistencyLevel.ONE);
  }
 catch (  InvalidRequestException e) {
    logger.error("Failed to create index on title",e);
  }
  query="CREATE TABLE " + WordCount.KEYSPACE + "."+ WordCount.OUTPUT_COLUMN_FAMILY+ " ( row_id text,"+ "   word text, "+ "   count_num text,"+ "   PRIMARY KEY (row_id, word) ) ";
  try {
    logger.info("set up table " + WordCount.OUTPUT_COLUMN_FAMILY);
    client.execute_cql3_query(ByteBufferUtil.bytes(query),Compression.NONE,ConsistencyLevel.ONE);
  }
 catch (  InvalidRequestException e) {
    logger.error("failed to create table " + WordCount.KEYSPACE + "."+ WordCount.OUTPUT_COLUMN_FAMILY,e);
  }
}
