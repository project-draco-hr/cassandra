@staticmethod
def get_num_processes(cap):
    "\n        Pick a reasonable number of child processes. We need to leave at\n        least one core for the parent process.  This doesn't necessarily\n        need to be capped, but 4 is currently enough to keep\n        a single local Cassandra node busy so we use this for import, whilst\n        for export we use 16 since we can connect to multiple Cassandra nodes.\n        Eventually this parameter will become an option.\n        "
    try:
        return max(1, min(cap, (mp.cpu_count() - 1)))
    except NotImplementedError:
        return 1
