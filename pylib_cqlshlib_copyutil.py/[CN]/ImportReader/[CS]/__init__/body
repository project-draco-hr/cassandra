def __init__(self, task):
    self.shell = task.shell
    self.options = task.options
    self.printmsg = task.printmsg
    self.chunk_size = self.options.copy['chunksize']
    self.header = self.options.copy['header']
    self.max_rows = self.options.copy['maxrows']
    self.skip_rows = self.options.copy['skiprows']
    self.sources = self.get_source(task.fname)
    self.num_sources = 0
    self.current_source = None
    self.current_reader = None
    self.num_read = 0
