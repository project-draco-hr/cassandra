def run(self):
    try:
        try:
            table_meta = self.session.cluster.metadata.keyspaces[self.ks].tables[self.table]
            is_counter = ('counter' in [table_meta.columns[name].cql_type for name in self.valid_columns])
            if is_counter:
                self.run_counter(table_meta)
            else:
                self.run_normal(table_meta)
        except Exception as exc:
            if self.debug:
                traceback.print_exc(exc)
    finally:
        self.close()
