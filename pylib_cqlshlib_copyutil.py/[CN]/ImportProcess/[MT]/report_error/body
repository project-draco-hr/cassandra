def report_error(self, err, chunk, rows=None, attempts=1, final=True):
    if self.debug:
        traceback.print_exc(err)
    self.outmsg.send(ImportTaskError(err.__class__.__name__, err.message, rows, attempts, final))
    if final:
        self.update_chunk(rows, chunk)
