def get_replica(self, pk):
    '\n        Return the first replica or the host we are already connected to if there are no local\n        replicas that are up. We always use the first replica to match the replica chosen by the driver\n        TAR, see TokenAwarePolicy.make_query_plan().\n        '
    metadata = self.session.cluster.metadata
    replicas = filter((lambda r: (r.is_up and (r.datacenter == self.local_dc))), metadata.get_replicas(self.ks, pk))
    ret = (replicas[0].address if (len(replicas) > 0) else self.hostname)
    return ret
