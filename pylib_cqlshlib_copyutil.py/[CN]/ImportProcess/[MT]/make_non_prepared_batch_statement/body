def make_non_prepared_batch_statement(self, query, _, batch, replicas):
    if (len(batch['rows']) == 1):
        statement = SimpleStatement((query % (','.join(batch['rows'][0]),)), consistency_level=self.consistency_level)
    else:
        statement = BatchStatement(batch_type=BatchType.UNLOGGED, consistency_level=self.consistency_level)
        statement._statements_and_parameters = [(False, (query % (','.join(r),)), ()) for r in batch['rows']]
    statement.replicas = replicas
    statement.keyspace = self.ks
    return statement
