def receive(self):
    start_time = time.time()
    while ((time.time() - start_time) < 0.001):
        try:
            (batch, err) = self.inmsg.get(timeout=1e-05)
            if (err is None):
                self.succeeded += batch['imported']
                self.receive_meter.increment(batch['imported'])
            else:
                err = str(err)
                if self.import_errors.handle_error(err, batch):
                    self.retries.append(self.reset_batch(batch))
                else:
                    self.failed += len(batch['rows'])
        except Queue.Empty:
            pass
