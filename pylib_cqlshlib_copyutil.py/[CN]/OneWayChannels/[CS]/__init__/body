def __init__(self, num_channels):
    self.channels = [OneWayChannel() for _ in xrange(num_channels)]
    self._readers = [ch.reader for ch in self.channels]
    self._rlocks = [ch.rlock for ch in self.channels]
    self._rlocks_by_readers = dict([(ch.reader, ch.rlock) for ch in self.channels])
    self.num_channels = num_channels
    self.recv = (self.recv_select if IS_LINUX else self.recv_polling)
