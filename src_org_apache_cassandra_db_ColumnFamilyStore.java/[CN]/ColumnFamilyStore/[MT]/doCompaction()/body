{
  isCompacting_.set(true);
  List<String> files=new ArrayList<String>(ssTables_);
  try {
    int count=0;
    for (    List<String> fileList : getCompactionBuckets(files,50L * 1024L * 1024L)) {
      Collections.sort(fileList,new FileNameComparator(FileNameComparator.Ascending));
      if (fileList.size() >= threshHold_) {
        files.clear();
        count=0;
        for (        String file : fileList) {
          files.add(file);
          count++;
          if (count == threshHold_)           break;
        }
        try {
          if (count == threshHold_)           doFileCompaction(files,bufSize_);
        }
 catch (        Exception ex) {
          logger_.warn(LogUtil.throwableToString(ex));
        }
      }
    }
  }
  finally {
    isCompacting_.set(false);
  }
}
