{
  Map<List<String>,Long> buckets=new HashMap<List<String>,Long>();
  for (  String fname : files) {
    File f=new File(fname);
    long size=f.length();
    boolean bFound=false;
    for (    List<String> bucket : new ArrayList<List<String>>(buckets.keySet())) {
      long averageSize=buckets.get(bucket);
      if ((size > averageSize / 2 && size < 3 * averageSize / 2) || (size < min && averageSize < min)) {
        buckets.remove(bucket);
        averageSize=(averageSize + size) / 2;
        bucket.add(fname);
        buckets.put(bucket,averageSize);
        bFound=true;
        break;
      }
    }
    if (!bFound) {
      ArrayList<String> bucket=new ArrayList<String>();
      bucket.add(fname);
      buckets.put(bucket,size);
    }
  }
  return buckets.keySet();
}
