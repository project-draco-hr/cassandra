{
  boolean doCompaction=false;
  int ssTableSize=0;
  lock_.writeLock().lock();
  try {
    ssTables_.add(filename);
    SSTable.storeBloomFilter(filename,bf);
    ssTableSize=ssTables_.size();
  }
  finally {
    lock_.writeLock().unlock();
  }
  if (ssTableSize >= threshHold_ && !isCompacting_.get()) {
    doCompaction=true;
  }
  if (isCompacting_.get()) {
    if (ssTableSize % threshHold_ == 0) {
      doCompaction=true;
    }
  }
  if (doCompaction) {
    logger_.debug("Submitting for  compaction ...");
    MinorCompactionManager.instance().submit(ColumnFamilyStore.this);
    logger_.debug("Submitted for compaction ...");
  }
}
