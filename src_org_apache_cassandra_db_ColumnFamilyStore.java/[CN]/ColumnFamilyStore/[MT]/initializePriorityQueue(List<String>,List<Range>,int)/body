{
  PriorityQueue<FileStruct> pq=new PriorityQueue<FileStruct>();
  if (files.size() > 1 || (ranges != null && files.size() > 0)) {
    int bufferSize=Math.min((ColumnFamilyStore.compactionMemoryThreshold_ / files.size()),minBufferSize);
    FileStruct fs=null;
    for (    String file : files) {
      try {
        fs=new FileStruct(SequenceFile.bufferedReader(file,bufferSize));
        fs.advance();
        if (fs.isExhausted())         continue;
        pq.add(fs);
      }
 catch (      Exception ex) {
        ex.printStackTrace();
        try {
          if (fs != null) {
            fs.close();
          }
        }
 catch (        Exception e) {
          logger_.warn("Unable to close file :" + file);
        }
      }
    }
  }
  return pq;
}
