{
  File snapshotDir=new File(snapshotDirectory);
  if (!snapshotDir.exists())   snapshotDir.mkdir();
  lock_.writeLock().lock();
  List<String> files=new ArrayList<String>(ssTables_);
  try {
    for (    String file : files) {
      File f=new File(file);
      Path existingLink=f.toPath();
      File hardLinkFile=new File(snapshotDirectory + System.getProperty("file.separator") + f.getName());
      Path hardLink=hardLinkFile.toPath();
      hardLink.createLink(existingLink);
    }
  }
  finally {
    lock_.writeLock().unlock();
  }
}
