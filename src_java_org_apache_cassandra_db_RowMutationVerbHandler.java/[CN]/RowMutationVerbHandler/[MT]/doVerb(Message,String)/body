{
  try {
    RowMutation rm=RowMutation.fromBytes(message.getMessageBody(),message.getVersion());
    if (logger.isDebugEnabled())     logger.debug("Applying " + rm);
    byte[] forwardBytes=message.getHeader(RowMutation.FORWARD_HEADER);
    if (forwardBytes != null && message.getVersion() >= MessagingService.VERSION_11)     forwardToLocalNodes(message,forwardBytes);
    rm.apply();
    WriteResponse response=new WriteResponse(rm.getTable(),rm.key(),true);
    Message responseMessage=WriteResponse.makeWriteResponseMessage(message,response);
    if (logger.isDebugEnabled())     logger.debug(rm + " applied.  Sending response to " + id+ "@"+ message.getFrom());
    MessagingService.instance().sendReply(responseMessage,id,message.getFrom());
  }
 catch (  IOException e) {
    logger.error("Error in row mutation",e);
  }
}
