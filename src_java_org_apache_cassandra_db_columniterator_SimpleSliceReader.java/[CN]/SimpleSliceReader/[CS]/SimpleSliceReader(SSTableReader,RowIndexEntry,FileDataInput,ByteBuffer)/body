{
  logger.debug("Slicing {}",sstable);
  this.finishColumn=finishColumn;
  this.comparator=sstable.metadata.comparator;
  try {
    if (input == null) {
      this.file=sstable.getFileDataInput(indexEntry.position);
      this.needsClosing=true;
    }
 else {
      this.file=input;
      input.seek(indexEntry.position);
      this.needsClosing=false;
    }
    Descriptor.Version version=sstable.descriptor.version;
    ByteBufferUtil.skipShortLength(file);
    if (version.hasRowSizeAndColumnCount)     file.readLong();
    emptyColumnFamily=EmptyColumns.factory.create(sstable.metadata);
    emptyColumnFamily.delete(DeletionInfo.serializer().deserializeFromSSTable(file,sstable.descriptor.version));
    int columnCount=version.hasRowSizeAndColumnCount ? file.readInt() : Integer.MAX_VALUE;
    atomIterator=emptyColumnFamily.metadata().getOnDiskIterator(file,columnCount,sstable.descriptor.version);
  }
 catch (  IOException e) {
    sstable.markSuspect();
    throw new CorruptSSTableException(e,sstable.getFilename());
  }
}
