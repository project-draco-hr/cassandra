{
  JobConf conf=new JobConf(CassandraBulkLoader.class);
  if (args.length >= 4) {
    conf.setNumReduceTasks(new Integer(args[3]));
  }
  try {
    DistributedCache.addCacheFile(new URI("/cassandra/storage-conf.xml#storage-conf.xml"),conf);
  }
 catch (  URISyntaxException e) {
    throw new RuntimeException(e);
  }
  conf.setInputFormat(KeyValueTextInputFormat.class);
  conf.setJobName("CassandraBulkLoader_v2");
  conf.setMapperClass(Map.class);
  conf.setReducerClass(Reduce.class);
  conf.setOutputKeyClass(Text.class);
  conf.setOutputValueClass(Text.class);
  FileInputFormat.setInputPaths(conf,new Path(args[1]));
  FileOutputFormat.setOutputPath(conf,new Path(args[2]));
  try {
    JobClient.runJob(conf);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
