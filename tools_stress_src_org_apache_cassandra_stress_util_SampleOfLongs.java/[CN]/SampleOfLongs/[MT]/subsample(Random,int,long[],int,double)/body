{
  for (int i=0; i < maxSamples; i++) {
    int take=i + rnd.nextInt(count - i);
    long tmp=sample[i];
    sample[i]=sample[take];
    sample[take]=tmp;
  }
  p*=maxSamples / (double)sample.length;
  return p;
}
