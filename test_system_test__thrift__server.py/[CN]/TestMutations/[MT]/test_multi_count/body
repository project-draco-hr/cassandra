def test_multi_count(self):
    'Insert multiple keys and count them using the multiget interface'
    _set_keyspace('Keyspace1')
    num_keys = 10
    for i in range(1, (num_keys + 1)):
        key = ('key' + str(i))
        for j in range(1, (i + 1)):
            client.insert(key, ColumnParent('Standard1'), Column(('c' + str(j)), ('value' + str(j)), Clock(0)), ConsistencyLevel.ONE)
    keys = [('key' + str(i)) for i in range(1, (num_keys + 1))]
    p = SlicePredicate(slice_range=SliceRange('', '', False, 1000))
    counts = client.multiget_count('Keyspace1', keys, ColumnParent('Standard1'), p, ConsistencyLevel.ONE)
    for i in range(1, (num_keys + 1)):
        key = ('key' + str(i))
        assert (counts[key] == i)
