def test_bad_system_calls(self):

    def duplicate_index_names():
        _set_keyspace('Keyspace1')
        cd1 = ColumnDef('foo', 'BytesType', IndexType.KEYS, 'i')
        cd2 = ColumnDef('bar', 'BytesType', IndexType.KEYS, 'i')
        cf = CfDef('Keyspace1', 'BadCF', column_metadata=[cd1, cd2])
        client.system_add_column_family(cf)
    _expect_exception(duplicate_index_names, InvalidRequestException)
