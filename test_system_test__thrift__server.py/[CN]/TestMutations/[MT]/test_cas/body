def test_cas(self):
    _set_keyspace('Keyspace1')

    def cas(expected, updates):
        return client.cas('key1', 'Standard1', expected, updates, ConsistencyLevel.ONE)
    assert (not cas(_SIMPLE_COLUMNS, _SIMPLE_COLUMNS))
    assert cas(None, _SIMPLE_COLUMNS)
    result = [cosc.column for cosc in _big_slice('key1', ColumnParent('Standard1'))]
    assert (dict(((c.name, c.value) for c in result)) == dict(((c.name, c.value) for c in _SIMPLE_COLUMNS))), result
    assert (not cas(None, _SIMPLE_COLUMNS))
    assert (client.get('key1', ColumnPath('Standard1', column='c1'), ConsistencyLevel.SERIAL).column.value == 'value1')
