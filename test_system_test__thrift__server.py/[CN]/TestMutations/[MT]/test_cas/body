def test_cas(self):
    _set_keyspace('Keyspace1')

    def cas(expected, updates):
        return client.cas('key1', 'Standard1', expected, updates, ConsistencyLevel.ONE)
    cas_result = cas(_SIMPLE_COLUMNS, _SIMPLE_COLUMNS)
    assert (not cas_result.success)
    assert (len(cas_result.current_values) == 0), cas_result
    assert cas([], _SIMPLE_COLUMNS).success
    result = [cosc.column for cosc in _big_slice('key1', ColumnParent('Standard1'))]
    cas_result = cas([], _SIMPLE_COLUMNS)
    assert (not cas_result.success)
    assert (dict(((c.name, c.value) for c in cas_result.current_values)) == {_SIMPLE_COLUMNS[0].name: _SIMPLE_COLUMNS[0].value, }), cas_result
    assert (client.get('key1', ColumnPath('Standard1', column='c1'), ConsistencyLevel.SERIAL).column.value == 'value1')
