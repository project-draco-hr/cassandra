def test_count_around_page_size(self):

    def slice_predicate(count):
        return SlicePredicate(slice_range=SliceRange('', '', False, count))
    _set_keyspace('Keyspace1')
    key = 'key1'
    parent = ColumnParent('Standard1')
    cl = ConsistencyLevel.ONE
    for i in xrange(0, 3050):
        client.insert(key, parent, Column(str(i), '', 0), cl)
    assert (client.get_count(key, parent, slice_predicate(1024), cl) == 1024)
    assert (client.get_count(key, parent, slice_predicate(1025), cl) == 1025)
    assert (client.get_count(key, parent, slice_predicate(4000), cl) == 3050)
    assert (client.get_count(key, parent, slice_predicate(3050), cl) == 3050)
    assert (client.get_count(key, parent, slice_predicate(3051), cl) == 3050)
