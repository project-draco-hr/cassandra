def test_column_validators(self):
    ks = 'Keyspace1'
    _set_keyspace(ks)
    cd = ColumnDef('col', 'org.apache.cassandra.service.ExampleColumnValidator', None, None)
    cf = CfDef('Keyspace1', 'ValidatorColumnFamily', column_metadata=[cd])
    client.system_add_column_family(cf)
    dks = client.describe_keyspace(ks)
    assert ('ValidatorColumnFamily' in dks)
    cp = ColumnParent('ValidatorColumnFamily')
    col0 = Column('col', 'valuegood', Clock(0))
    col1 = Column('col', 'valuebad', Clock(0))
    client.insert('key0', cp, col0, ConsistencyLevel.ONE)
    e = _expect_exception((lambda : client.insert('key1', cp, col1, ConsistencyLevel.ONE)), InvalidRequestException)
    assert (e.why.find('failed validation') >= 0)
    assert (e.why.find('column.value.length is even') >= 0)
