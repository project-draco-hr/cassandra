def test_invalid_strategy_class(self):

    def add_invalid_keyspace():
        client.system_add_keyspace(KsDef('ValidKs', 'InvalidStrategyClass', {}, []))
    exc = _expect_exception(add_invalid_keyspace, InvalidRequestException)
    s = str(exc)
    assert (s.find('InvalidStrategyClass') > (-1)), s
    assert (s.find('Unable to find replication strategy') > (-1)), s

    def update_invalid_keyspace():
        client.system_add_keyspace(KsDef('ValidKsForUpdate', 'org.apache.cassandra.locator.SimpleStrategy', {'replication_factor': '1', }, []))
        client.system_update_keyspace(KsDef('ValidKsForUpdate', 'InvalidStrategyClass', {}, []))
    exc = _expect_exception(update_invalid_keyspace, InvalidRequestException)
    s = str(exc)
    assert (s.find('InvalidStrategyClass') > (-1)), s
    assert (s.find('Unable to find replication strategy') > (-1)), s
