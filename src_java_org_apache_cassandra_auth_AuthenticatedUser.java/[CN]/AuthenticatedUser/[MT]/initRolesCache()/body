{
  if (DatabaseDescriptor.getAuthenticator() instanceof AllowAllAuthenticator)   return null;
  int validityPeriod=DatabaseDescriptor.getRolesValidity();
  if (validityPeriod <= 0)   return null;
  return CacheBuilder.newBuilder().refreshAfterWrite(validityPeriod,TimeUnit.MILLISECONDS).build(new CacheLoader<RoleResource,Set<RoleResource>>(){
    public Set<RoleResource> load(    RoleResource primary){
      return loadRoles(primary);
    }
    public ListenableFuture<Set<RoleResource>> reload(    final RoleResource primary,    Set<RoleResource> oldValue){
      ListenableFutureTask<Set<RoleResource>> task=ListenableFutureTask.create(new Callable<Set<RoleResource>>(){
        public Set<RoleResource> call(){
          return loadRoles(primary);
        }
      }
);
      ScheduledExecutors.optionalTasks.execute(task);
      return task;
    }
  }
);
}
