{
  TestableTransaction txn;
  txn=newTest();
  Throwable t=new RuntimeException();
  txn.testing.prepareToCommit();
  Assert.assertEquals(t,txn.testing.commit(t));
  Assert.assertEquals(t,txn.testing.abort(t));
  Assert.assertTrue(t.getSuppressed()[0] instanceof IllegalStateException);
}
