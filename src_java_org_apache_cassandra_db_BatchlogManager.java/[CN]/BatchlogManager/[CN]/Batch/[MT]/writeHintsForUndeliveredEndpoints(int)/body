{
  try {
    List<Mutation> replayingMutations=replayingMutations();
    for (int i=startFrom; i < replayHandlers.size(); i++) {
      Mutation undeliveredMutation=replayingMutations.get(i);
      int ttl=calculateHintTTL(replayingMutations);
      ReplayWriteResponseHandler<Mutation> handler=replayHandlers.get(i);
      if (ttl > 0 && handler != null)       for (      InetAddress endpoint : handler.undelivered)       StorageProxy.writeHintForMutation(undeliveredMutation,writtenAt,ttl,endpoint);
    }
  }
 catch (  IOException e) {
    logger.error("Cannot schedule hints for undelivered batch",e);
  }
}
