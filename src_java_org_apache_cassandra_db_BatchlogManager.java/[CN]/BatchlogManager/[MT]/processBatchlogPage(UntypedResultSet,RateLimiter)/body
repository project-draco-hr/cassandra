{
  UUID id=null;
  for (  UntypedResultSet.Row row : page) {
    id=row.getUUID("id");
    long writtenAt=row.getLong("written_at");
    int version=row.has("version") ? row.getInt("version") : MessagingService.VERSION_12;
    long timeout=getBatchlogTimeout();
    if (System.currentTimeMillis() < writtenAt + timeout)     continue;
    replayBatch(id,row.getBytes("data"),writtenAt,version,rateLimiter);
  }
  return id;
}
