{
  DataInputStream in=new DataInputStream(ByteBufferUtil.inputStream(data));
  int size=in.readInt();
  List<RowMutation> mutations=new ArrayList<>(size);
  for (int i=0; i < size; i++) {
    RowMutation mutation=RowMutation.serializer.deserialize(in,version);
    for (    UUID cfId : mutation.getColumnFamilyIds())     if (writtenAt <= SystemKeyspace.getTruncatedAt(cfId))     mutation=mutation.without(cfId);
    if (!mutation.isEmpty())     mutations.add(mutation);
  }
  if (!mutations.isEmpty())   replayMutations(mutations,writtenAt,version,rateLimiter);
}
