{
  logger.debug("Replaying batch {}",id);
  UntypedResultSet result=process("SELECT written_at, data FROM %s.%s WHERE id = %s",Keyspace.SYSTEM_KS,SystemKeyspace.BATCHLOG_CF,id);
  if (result.isEmpty())   return;
  try {
    UntypedResultSet.Row batch=result.one();
    replaySerializedMutations(batch.getBytes("data"),batch.getLong("written_at"),rateLimiter);
  }
 catch (  IOException e) {
    logger.warn("Skipped batch replay of {} due to {}",id,e);
  }
  process("DELETE FROM %s.%s WHERE id = %s",Keyspace.SYSTEM_KS,SystemKeyspace.BATCHLOG_CF,id);
  totalBatchesReplayed.incrementAndGet();
}
