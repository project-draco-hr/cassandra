{
  logger.debug("Replaying batch {}",id);
  UntypedResultSet result=process("SELECT written_at, data FROM %s.%s WHERE id = %s",Table.SYSTEM_KS,SystemTable.BATCHLOG_CF,id);
  if (result.isEmpty())   return;
  try {
    replaySerializedMutations(result.one().getBytes("data"),result.one().getLong("written_at"),rateLimiter);
  }
 catch (  IOException e) {
    logger.warn("Skipped batch replay of {} due to {}",id,e);
  }
  process("DELETE FROM %s.%s WHERE id = %s",Table.SYSTEM_KS,SystemTable.BATCHLOG_CF,id);
  totalBatchesReplayed.incrementAndGet();
}
