{
  int remaining=buffer.remaining() - position;
  if (length > remaining)   throw new IOException(String.format("mmap segment underflow; remaining is %d but %d requested",remaining,length));
  if (length == 0)   return ByteBufferUtil.EMPTY_BYTE_BUFFER;
  ByteBuffer bytes=buffer.duplicate();
  bytes.position(buffer.position() + position).limit(buffer.position() + position + length);
  position+=length;
  ByteBuffer clone=ByteBuffer.allocate(bytes.remaining());
  clone.put(bytes);
  clone.flip();
  return clone;
}
