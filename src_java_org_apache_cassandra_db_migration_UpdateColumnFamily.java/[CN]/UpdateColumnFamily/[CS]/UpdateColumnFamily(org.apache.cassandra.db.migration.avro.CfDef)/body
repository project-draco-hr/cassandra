{
  super(UUIDGen.makeType1UUIDFromHost(FBUtilities.getLocalAddress()),DatabaseDescriptor.getDefsVersion());
  KSMetaData ksm=DatabaseDescriptor.getTableDefinition(cf_def.keyspace.toString());
  if (ksm == null)   throw new ConfigurationException("No such keyspace: " + cf_def.keyspace.toString());
  if (cf_def.column_metadata != null) {
    for (    ColumnDef entry : cf_def.column_metadata) {
      if (entry.index_name != null && !Migration.isLegalName((String)entry.index_name))       throw new ConfigurationException("Invalid index name: " + entry.index_name);
    }
  }
  CFMetaData oldCfm=DatabaseDescriptor.getCFMetaData(CFMetaData.getId(cf_def.keyspace.toString(),cf_def.name.toString()));
  this.metadata=CFMetaData.inflate(oldCfm.deflate());
  this.metadata.apply(cf_def);
  KSMetaData newKsMeta=KSMetaData.inflate(ksm.deflate());
  newKsMeta.cfMetaData().get(cf_def.name.toString()).apply(cf_def);
  rm=Migration.makeDefinitionMutation(newKsMeta,null,newVersion);
}
