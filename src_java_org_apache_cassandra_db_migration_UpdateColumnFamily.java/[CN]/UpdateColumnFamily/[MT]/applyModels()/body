{
  logger.debug("Updating " + schema.getCFMetaData(metadata.cfId) + " to "+ metadata);
  try {
    schema.getCFMetaData(metadata.cfId).apply(metadata.toAvro());
  }
 catch (  ConfigurationException ex) {
    throw new IOException(ex);
  }
  schema.setTableDefinition(null,newVersion);
  if (!StorageService.instance.isClientMode()) {
    Table table=Table.open(metadata.ksName,schema);
    ColumnFamilyStore oldCfs=table.getColumnFamilyStore(metadata.cfName);
    oldCfs.reload();
  }
}
