{
  out.writeByte(limits.kind().ordinal());
switch (limits.kind()) {
case CQL_LIMIT:
case CQL_PAGING_LIMIT:
    CQLLimits cqlLimits=(CQLLimits)limits;
  out.writeVInt(cqlLimits.rowLimit);
out.writeVInt(cqlLimits.perPartitionLimit);
out.writeBoolean(cqlLimits.isDistinct);
if (limits.kind() == Kind.CQL_PAGING_LIMIT) {
CQLPagingLimits pagingLimits=(CQLPagingLimits)cqlLimits;
ByteBufferUtil.writeWithVIntLength(pagingLimits.lastReturnedKey,out);
out.writeVInt(pagingLimits.lastReturnedKeyRemaining);
}
break;
case THRIFT_LIMIT:
case SUPER_COLUMN_COUNTING_LIMIT:
ThriftLimits thriftLimits=(ThriftLimits)limits;
out.writeVInt(thriftLimits.partitionLimit);
out.writeVInt(thriftLimits.cellPerPartitionLimit);
break;
}
}
