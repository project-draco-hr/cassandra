{
  final String sstablePrefix=getSSTablePrefix();
  return new FileFilter(){
    public boolean accept(    File file){
      if (file.isDirectory() || !file.getName().startsWith(sstablePrefix))       return false;
      Pair<Descriptor,Component> pair=SSTable.tryComponentFromFilename(file.getParentFile(),file.getName());
      if (pair == null)       return false;
      if (skipTemporary && pair.left.temporary)       return false;
      Set<Component> previous=components.get(pair.left);
      if (previous == null) {
        previous=new HashSet<Component>();
        components.put(pair.left,previous);
      }
      previous.add(pair.right);
      nbFiles++;
      return false;
    }
  }
;
}
