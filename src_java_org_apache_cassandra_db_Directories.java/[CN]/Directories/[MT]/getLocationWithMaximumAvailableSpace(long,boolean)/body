{
  long maxFreeDisk=0;
  File maxLocation=null;
  for (  File dir : sstableDirectories) {
    if (maxFreeDisk < dir.getUsableSpace()) {
      maxFreeDisk=dir.getUsableSpace();
      maxLocation=dir;
    }
  }
  logger.debug(String.format("expected data files size is %d; largest free partition (%s) has %d bytes free",estimatedSize,maxLocation,maxFreeDisk));
  maxFreeDisk=(long)(0.9 * maxFreeDisk);
  if (!ensureFreeSpace || estimatedSize < maxFreeDisk) {
    if (estimatedSize >= maxFreeDisk)     logger.warn(String.format("Data file location %s only has %d free, estimated size is %d",maxLocation,maxFreeDisk,estimatedSize));
    return maxLocation;
  }
  return null;
}
