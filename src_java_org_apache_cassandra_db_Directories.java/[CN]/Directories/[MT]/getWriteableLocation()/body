{
  List<DataDirectory> candidates=new ArrayList<>();
  for (  DataDirectory dataDir : dataFileLocations) {
    if (BlacklistedDirectories.isUnwritable(getLocationForDisk(dataDir)))     continue;
    candidates.add(dataDir);
  }
  if (candidates.isEmpty())   throw new IOError(new IOException("All configured data directories have been blacklisted as unwritable for erroring out"));
  Collections.sort(candidates);
  Collections.sort(candidates,new Comparator<DataDirectory>(){
    public int compare(    DataDirectory a,    DataDirectory b){
      return a.currentTasks.get() - b.currentTasks.get();
    }
  }
);
  return candidates.get(0);
}
