{
  List<DataDirectory> candidates=new ArrayList<DataDirectory>();
  for (  DataDirectory dataDir : dataFileLocations) {
    File sstableDir=getLocationForDisk(dataDir);
    if (BlacklistedDirectories.isUnwritable(sstableDir))     continue;
    if (dataDir.getEstimatedAvailableSpace() > estimatedSize && sstableDir.getUsableSpace() * 0.9 > estimatedSize)     candidates.add(dataDir);
  }
  Collections.sort(candidates);
  Collections.sort(candidates,new Comparator<DataDirectory>(){
    public int compare(    DataDirectory a,    DataDirectory b){
      return a.currentTasks.get() - b.currentTasks.get();
    }
  }
);
  return candidates.isEmpty() ? null : candidates.get(0);
}
