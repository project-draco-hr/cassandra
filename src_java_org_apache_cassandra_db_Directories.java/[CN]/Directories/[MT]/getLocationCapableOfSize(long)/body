{
  SortedSet<DataDirectory> directories=ImmutableSortedSet.copyOf(dataFileLocations);
  for (  DataDirectory directory : directories) {
    long spaceAvailable=directory.getEstimatedAvailableSpace();
    if (estimatedSize < spaceAvailable && directory.currentTasks.get() == 0)     return directory;
  }
  if (estimatedSize < directories.first().getEstimatedAvailableSpace())   return directories.first();
 else   return null;
}
