{
  logger.info("Upgrade from pre-1.1 version detected: migrating sstables to new directory layout");
  for (  File location : dataFileLocations) {
    if (!location.exists() || !location.isDirectory())     continue;
    for (    File ksDir : location.listFiles()) {
      if (!ksDir.isDirectory())       continue;
      for (      File file : ksDir.listFiles())       migrateFile(file,ksDir,null);
      migrateSnapshots(ksDir);
      migrateBackups(ksDir);
    }
  }
}
