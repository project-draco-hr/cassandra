{
  logger.info("Upgrade from pre-1.1 version detected: migrating sstables to new directory layout");
  for (  DataDirectory dir : dataFileLocations) {
    if (!dir.location.exists() || !dir.location.isDirectory())     continue;
    for (    File ksDir : dir.location.listFiles()) {
      if (!ksDir.isDirectory())       continue;
      for (      File file : ksDir.listFiles())       migrateFile(file,ksDir,null);
      migrateSnapshots(ksDir);
      migrateBackups(ksDir);
    }
  }
}
