{
  final Map<String,Pair<Long,Long>> snapshotSpaceMap=new HashMap<>();
  for (  File dir : dataPaths) {
    File snapshotDir=dir.getName().startsWith(SECONDARY_INDEX_NAME_SEPARATOR) ? new File(dir.getParent(),SNAPSHOT_SUBDIR) : new File(dir,SNAPSHOT_SUBDIR);
    if (snapshotDir.exists() && snapshotDir.isDirectory()) {
      final File[] snapshots=snapshotDir.listFiles();
      if (snapshots != null) {
        for (        final File snapshot : snapshots) {
          if (snapshot.isDirectory()) {
            final long sizeOnDisk=FileUtils.folderSize(snapshot);
            final long trueSize=getTrueAllocatedSizeIn(snapshot);
            Pair<Long,Long> spaceUsed=snapshotSpaceMap.get(snapshot.getName());
            if (spaceUsed == null)             spaceUsed=Pair.create(sizeOnDisk,trueSize);
 else             spaceUsed=Pair.create(spaceUsed.left + sizeOnDisk,spaceUsed.right + trueSize);
            snapshotSpaceMap.put(snapshot.getName(),spaceUsed);
          }
        }
      }
    }
  }
  return snapshotSpaceMap;
}
