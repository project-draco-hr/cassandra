{
  long maxFreeDisk=0;
  File maxLocation=null;
  for (  File dir : sstableDirectories) {
    if (BlacklistedDirectories.isUnwritable(dir))     continue;
    long usableSpace=dir.getUsableSpace();
    if (maxFreeDisk < usableSpace) {
      maxFreeDisk=usableSpace;
      maxLocation=dir;
    }
  }
  maxFreeDisk=(long)(0.9 * maxFreeDisk);
  logger.debug(String.format("expected data files size is %d; largest free partition (%s) has %d bytes free",estimatedSize,maxLocation,maxFreeDisk));
  return estimatedSize < maxFreeDisk ? maxLocation : null;
}
