{
  IEndpointSnitch oldSnitch=DatabaseDescriptor.getEndpointSnitch();
  IEndpointSnitch newSnitch;
  try {
    newSnitch=FBUtilities.construct(epSnitchClassName,"snitch");
  }
 catch (  ConfigurationException e) {
    throw new ClassNotFoundException(e.getMessage());
  }
  if (dynamic) {
    DatabaseDescriptor.setDynamicUpdateInterval(dynamicUpdateInterval);
    DatabaseDescriptor.setDynamicResetInterval(dynamicResetInterval);
    DatabaseDescriptor.setDynamicBadnessThreshold(dynamicBadnessThreshold);
    newSnitch=new DynamicEndpointSnitch(newSnitch);
  }
  DatabaseDescriptor.setEndpointSnitch(newSnitch);
  for (  String ks : Schema.instance.getKeyspaces()) {
    Keyspace.open(ks).getReplicationStrategy().snitch=newSnitch;
  }
  if (oldSnitch instanceof DynamicEndpointSnitch)   ((DynamicEndpointSnitch)oldSnitch).unregisterMBean();
  updateTopology();
}
