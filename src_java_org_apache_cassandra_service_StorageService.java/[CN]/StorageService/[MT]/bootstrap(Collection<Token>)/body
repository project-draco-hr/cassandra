{
  isBootstrapMode=true;
  SystemKeyspace.updateTokens(tokens);
  if (!DatabaseDescriptor.isReplacing()) {
    Gossiper.instance.addLocalApplicationState(ApplicationState.TOKENS,valueFactory.tokens(tokens));
    Gossiper.instance.addLocalApplicationState(ApplicationState.STATUS,valueFactory.bootstrapping(tokens));
    setMode(Mode.JOINING,"sleeping " + RING_DELAY + " ms for pending range setup",true);
    Uninterruptibles.sleepUninterruptibly(RING_DELAY,TimeUnit.MILLISECONDS);
  }
 else {
    tokenMetadata.updateNormalTokens(tokens,FBUtilities.getBroadcastAddress());
    SystemTable.removeEndpoint(DatabaseDescriptor.getReplaceAddress());
  }
  if (!Gossiper.instance.seenAnySeed())   throw new IllegalStateException("Unable to contact any seeds!");
  setMode(Mode.JOINING,"Starting to bootstrap...",true);
  new BootStrapper(FBUtilities.getBroadcastAddress(),tokens,tokenMetadata).bootstrap();
  logger.info("Bootstrap completed! for the tokens {}",tokens);
}
