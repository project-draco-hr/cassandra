{
  Token token=getPartitioner().getTokenFactory().fromString(moveValue);
  if (logger_.isDebugEnabled())   logger_.debug("Node " + endpoint + " state leaving, token "+ token);
  if (!tokenMetadata_.isMember(endpoint)) {
    logger_.info("Node " + endpoint + " state jump to leaving");
    tokenMetadata_.updateNormalToken(token,endpoint);
  }
 else   if (!tokenMetadata_.getToken(endpoint).equals(token)) {
    logger_.warn("Node " + endpoint + " 'leaving' token mismatch. Long network partition?");
    tokenMetadata_.updateNormalToken(token,endpoint);
  }
  tokenMetadata_.addLeavingEndpoint(endpoint);
  calculatePendingRanges();
}
