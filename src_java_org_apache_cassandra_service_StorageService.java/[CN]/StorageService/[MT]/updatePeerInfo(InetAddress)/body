{
  EndpointState epState=Gossiper.instance.getEndpointStateForEndpoint(endpoint);
  for (  Map.Entry<ApplicationState,VersionedValue> entry : epState.getApplicationStateMap().entrySet()) {
switch (entry.getKey()) {
case RELEASE_VERSION:
      SystemTable.updatePeerInfo(endpoint,"release_version",quote(entry.getValue().value));
    break;
case DC:
  SystemTable.updatePeerInfo(endpoint,"data_center",quote(entry.getValue().value));
break;
case RACK:
SystemTable.updatePeerInfo(endpoint,"rack",quote(entry.getValue().value));
break;
case RPC_ADDRESS:
SystemTable.updatePeerInfo(endpoint,"rpc_address",quote(entry.getValue().value));
break;
case SCHEMA:
SystemTable.updatePeerInfo(endpoint,"schema_version",entry.getValue().value);
break;
case HOST_ID:
SystemTable.updatePeerInfo(endpoint,"host_id",entry.getValue().value);
break;
}
}
}
