{
  if (Table.SYSTEM_TABLE.equals(tableName))   return;
  List<AntiEntropyService.RepairFuture> futures=new ArrayList<AntiEntropyService.RepairFuture>();
  for (  Range range : getLocalRanges(tableName)) {
    AntiEntropyService.RepairFuture future=forceTableRepair(range,tableName,columnFamilies);
    futures.add(future);
    try {
      future.session.differencingDone.await();
    }
 catch (    InterruptedException e) {
      logger_.error("Interrupted while waiting for the differencing of repair session " + future.session + " to be done. Repair may be imprecise.",e);
    }
  }
  boolean failedSession=false;
  for (  AntiEntropyService.RepairFuture future : futures) {
    try {
      future.get();
    }
 catch (    Exception e) {
      logger_.error("Repair session " + future.session.getName() + " failed.",e);
      failedSession=true;
    }
  }
  if (failedSession)   throw new IOException("Some repair session(s) failed (see log for details).");
}
