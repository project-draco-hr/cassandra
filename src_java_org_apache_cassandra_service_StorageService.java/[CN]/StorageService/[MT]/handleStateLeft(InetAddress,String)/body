{
  int index=moveValue.indexOf(Delimiter);
  assert(index != -1);
  String typeOfState=moveValue.substring(0,index);
  Token token=getPartitioner().getTokenFactory().fromString(moveValue.substring(index + 1));
  if (typeOfState.equals(LEFT_NORMALLY)) {
    if (logger_.isDebugEnabled())     logger_.debug("Node " + endpoint + " state left, token "+ token);
    if (tokenMetadata_.isMember(endpoint)) {
      if (!tokenMetadata_.getToken(endpoint).equals(token))       logger_.warn("Node " + endpoint + " 'left' token mismatch. Long network partition?");
      tokenMetadata_.removeEndpoint(endpoint);
      HintedHandOffManager.deleteHintsForEndPoint(endpoint);
    }
  }
 else {
    assert(typeOfState.equals(REMOVE_TOKEN));
    InetAddress endpointThatLeft=tokenMetadata_.getEndpoint(token);
    if (FBUtilities.getLocalAddress().equals(endpointThatLeft)) {
      logger_.info("Received removeToken gossip about myself. Is this node a replacement for a removed one?");
      return;
    }
    if (logger_.isDebugEnabled())     logger_.debug("Token " + token + " removed manually (endpoint was "+ ((endpointThatLeft == null) ? "unknown" : endpointThatLeft)+ ")");
    if (endpointThatLeft != null) {
      removeEndpointLocally(endpointThatLeft);
    }
  }
  tokenMetadata_.removeBootstrapToken(token);
  calculatePendingRanges();
}
