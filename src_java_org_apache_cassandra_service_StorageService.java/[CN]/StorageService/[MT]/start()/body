{
  storageMetadata_=SystemTable.initMetadata();
  tcpAddr_=new EndPoint(DatabaseDescriptor.getStoragePort());
  udpAddr_=new EndPoint(DatabaseDescriptor.getControlPort());
  MessagingService.getMessagingInstance().listen(tcpAddr_);
  MessagingService.getMessagingInstance().listenUDP(udpAddr_);
  SelectorManager.getSelectorManager().start();
  SelectorManager.getUdpSelectorManager().start();
  loadTimer_.schedule(new LoadDisseminator(),StorageService.threshold_,StorageService.threshold_);
  storageLoadBalancer_.start();
  Gossiper.instance().register(this);
  Gossiper.instance().start(udpAddr_,storageMetadata_.getGeneration());
  tokenMetadata_.update(storageMetadata_.getToken(),StorageService.tcpAddr_,isBootstrapMode);
  ApplicationState state=new ApplicationState(StorageService.getPartitioner().getTokenFactory().toString(storageMetadata_.getToken()));
  Gossiper.instance().addApplicationState(StorageService.nodeId_,state);
  if (isBootstrapMode) {
    logger_.info("Starting in bootstrap mode");
    doBootstrap(StorageService.getLocalStorageEndPoint());
    Gossiper.instance().addApplicationState(BOOTSTRAP_MODE,new ApplicationState(""));
  }
}
