{
  if (primaryRange && isLocal) {
    throw new IllegalArgumentException("You need to run primary range repair on all nodes in the cluster.");
  }
  final Collection<Range<Token>> ranges=primaryRange ? getLocalPrimaryRanges(keyspace) : getLocalRanges(keyspace);
  return forceRepairAsync(keyspace,isSequential ? RepairParallelism.SEQUENTIAL : RepairParallelism.PARALLEL,isLocal,ranges,columnFamilies);
}
