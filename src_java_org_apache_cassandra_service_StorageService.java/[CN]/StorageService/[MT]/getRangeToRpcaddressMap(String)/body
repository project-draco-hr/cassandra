{
  if (keyspace == null)   keyspace=DatabaseDescriptor.getNonSystemTables().get(0);
  Map<Range,List<String>> map=new HashMap<Range,List<String>>();
  for (  Map.Entry<Range,List<InetAddress>> entry : getRangeToAddressMap(keyspace).entrySet()) {
    List<String> rpcaddrs=new ArrayList<String>();
    for (    InetAddress endpoint : entry.getValue()) {
      if (endpoint.equals(FBUtilities.getLocalAddress()))       rpcaddrs.add(DatabaseDescriptor.getRpcAddress().toString());
 else       rpcaddrs.add(Gossiper.instance.getEndpointStateForEndpoint(endpoint).getApplicationState(ApplicationState.RPC_ADDRESS).value);
    }
    map.put(entry.getKey(),rpcaddrs);
  }
  return map;
}
