{
  if (Keyspace.SYSTEM_KS.equals(keyspace) || ranges.isEmpty())   return 0;
  final int cmd=nextRepairCommand.incrementAndGet();
  if (!FBUtilities.isUnix() && isSequential) {
    logger.warn("Snapshot-based repair is not yet supported on Windows.  Reverting to parallel repair.");
    isSequential=false;
  }
  new Thread(createRepairTask(cmd,keyspace,ranges,isSequential,isLocal,fullRepair,columnFamilies)).start();
  return cmd;
}
