{
  AbstractReplicationStrategy strategy=Table.open(keyspace).getReplicationStrategy();
  Collection<Range<Token>> primaryRanges=new HashSet<Range<Token>>();
  TokenMetadata metadata=tokenMetadata.cloneOnlyTokenMap();
  for (  Token token : metadata.sortedTokens()) {
    List<InetAddress> endpoints=strategy.calculateNaturalEndpoints(token,metadata);
    if (endpoints.size() > 0 && endpoints.get(0).equals(ep))     primaryRanges.add(new Range<Token>(metadata.getPredecessor(token),token));
  }
  return primaryRanges;
}
