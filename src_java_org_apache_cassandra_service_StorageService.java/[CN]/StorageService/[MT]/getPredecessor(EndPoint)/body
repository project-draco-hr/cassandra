{
  Token token=tokenMetadata_.getToken(ep);
  Map<Token,EndPoint> tokenToEndPointMap=tokenMetadata_.cloneTokenEndPointMap();
  List tokens=new ArrayList<Token>(tokenToEndPointMap.keySet());
  Collections.sort(tokens);
  int index=Collections.binarySearch(tokens,token);
  return (index == 0) ? tokenToEndPointMap.get(tokens.get(tokens.size() - 1)) : tokenToEndPointMap.get(tokens.get(--index));
}
