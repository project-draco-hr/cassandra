{
  if (parallelismDegree < 0 || parallelismDegree > RepairParallelism.values().length - 1) {
    throw new IllegalArgumentException("Invalid parallelism degree specified: " + parallelismDegree);
  }
  if (primaryRange && (dataCenters != null || hosts != null)) {
    throw new IllegalArgumentException("You need to run primary range repair on all nodes in the cluster.");
  }
  final Collection<Range<Token>> ranges=primaryRange ? getLocalPrimaryRanges(keyspace) : getLocalRanges(keyspace);
  return forceRepairAsync(keyspace,RepairParallelism.values()[parallelismDegree],dataCenters,hosts,ranges,columnFamilies);
}
