{
  InetAddress[] endpoints=getReadStorageEndPoints(key);
  for (  InetAddress endPoint : endpoints) {
    if (endPoint.equals(FBUtilities.getLocalAddress())) {
      return endPoint;
    }
  }
  int j=0;
  for (; j < endpoints.length; ++j) {
    if (StorageService.instance().isInSameDataCenter(endpoints[j]) && FailureDetector.instance().isAlive(endpoints[j])) {
      return endpoints[j];
    }
  }
  j=0;
  for (; j < endpoints.length; ++j) {
    if (FailureDetector.instance().isAlive(endpoints[j])) {
      if (logger_.isDebugEnabled())       logger_.debug("InetAddress " + endpoints[j] + " is alive so get data from it.");
      return endpoints[j];
    }
  }
  throw new UnavailableException();
}
