{
  List<InetAddress> endpoints=getNaturalEndpoints(key);
  for (  InetAddress endPoint : endpoints) {
    if (endPoint.equals(FBUtilities.getLocalAddress())) {
      return endPoint;
    }
  }
  int j=0;
  for (; j < endpoints.size(); ++j) {
    if (StorageService.instance().isInSameDataCenter(endpoints.get(j)) && FailureDetector.instance().isAlive(endpoints.get(j))) {
      return endpoints.get(j);
    }
  }
  j=0;
  for (; j < endpoints.size(); ++j) {
    if (FailureDetector.instance().isAlive(endpoints.get(j))) {
      if (logger_.isDebugEnabled())       logger_.debug("InetAddress " + endpoints.get(j) + " is alive so get data from it.");
      return endpoints.get(j);
    }
  }
  throw new UnavailableException();
}
