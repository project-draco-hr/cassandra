{
  EndPoint[] endpoints=getNStorageEndPoint(key);
  for (  EndPoint endPoint : endpoints) {
    if (endPoint.equals(StorageService.getLocalStorageEndPoint())) {
      return endPoint;
    }
  }
  int j=0;
  for (; j < endpoints.length; ++j) {
    if (StorageService.instance().isInSameDataCenter(endpoints[j]) && FailureDetector.instance().isAlive(endpoints[j])) {
      logger_.debug("EndPoint " + endpoints[j] + " is in the same data center as local storage endpoint.");
      return endpoints[j];
    }
  }
  j=0;
  for (; j < endpoints.length; ++j) {
    if (FailureDetector.instance().isAlive(endpoints[j])) {
      logger_.debug("EndPoint " + endpoints[j] + " is alive so get data from it.");
      return endpoints[j];
    }
  }
  return null;
}
