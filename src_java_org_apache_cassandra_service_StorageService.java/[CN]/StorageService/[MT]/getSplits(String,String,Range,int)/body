{
  List<Token> tokens=new ArrayList<Token>();
  tokens.add(range.left);
  List<DecoratedKey> keys=new ArrayList<DecoratedKey>();
  Table t=Table.open(table);
  ColumnFamilyStore cfs=t.getColumnFamilyStore(cfName);
  for (  DecoratedKey sample : cfs.allKeySamples()) {
    if (range.contains(sample.token))     keys.add(sample);
  }
  FBUtilities.sortSampledKeys(keys,range);
  int splits=keys.size() * SSTableReader.indexInterval() / keysPerSplit;
  if (keys.size() >= splits) {
    for (int i=1; i < splits; i++) {
      int index=i * (keys.size() / splits);
      tokens.add(keys.get(index).token);
    }
  }
  tokens.add(range.right);
  return tokens;
}
