{
  if (logger_.isDebugEnabled())   logger_.debug("Constructing range to endpoint map ...");
  Map<Range,List<EndPoint>> rangeToEndPointMap=new HashMap<Range,List<EndPoint>>();
  for (  Range range : ranges) {
    EndPoint[] endpoints=replicationStrategy_.getReadStorageEndPoints(range.right(),tokenToEndPointMap);
    rangeToEndPointMap.put(range,new ArrayList<EndPoint>(Arrays.asList(endpoints)));
  }
  if (logger_.isDebugEnabled())   logger_.debug("Done constructing range to endpoint map ...");
  return rangeToEndPointMap;
}
