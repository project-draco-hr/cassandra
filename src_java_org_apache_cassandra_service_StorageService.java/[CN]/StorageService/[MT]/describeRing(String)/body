{
  if (keyspace == null || !Schema.instance.getNonSystemTables().contains(keyspace))   throw new InvalidRequestException("There is no ring for the keyspace: " + keyspace);
  List<TokenRange> ranges=new ArrayList<TokenRange>();
  Token.TokenFactory tf=getPartitioner().getTokenFactory();
  for (  Map.Entry<Range,List<InetAddress>> entry : getRangeToAddressMap(keyspace).entrySet()) {
    Range range=entry.getKey();
    List<String> endpoints=new ArrayList<String>();
    List<String> rpc_endpoints=new ArrayList<String>();
    List<EndpointDetails> epDetails=new ArrayList<EndpointDetails>();
    for (    InetAddress endpoint : entry.getValue()) {
      EndpointDetails details=new EndpointDetails();
      details.host=endpoint.getHostAddress();
      details.datacenter=DatabaseDescriptor.getEndpointSnitch().getDatacenter(endpoint);
      details.rack=DatabaseDescriptor.getEndpointSnitch().getRack(endpoint);
      endpoints.add(details.host);
      rpc_endpoints.add(getRpcaddress(endpoint));
      epDetails.add(details);
    }
    TokenRange tr=new TokenRange(tf.toString(range.left),tf.toString(range.right),endpoints).setEndpoint_details(epDetails).setRpc_endpoints(rpc_endpoints);
    ranges.add(tr);
  }
  return ranges;
}
