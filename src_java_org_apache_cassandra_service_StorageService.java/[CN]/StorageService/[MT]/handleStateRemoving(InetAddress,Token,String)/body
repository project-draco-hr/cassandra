{
  InetAddress removeEndpoint=tokenMetadata_.getEndpoint(removeToken);
  if (removeEndpoint == null)   return;
  if (removeEndpoint.equals(FBUtilities.getLocalAddress())) {
    logger_.info("Received removeToken gossip about myself. Is this node a replacement for a removed one?");
    return;
  }
  if (VersionedValue.REMOVED_TOKEN.equals(state)) {
    Gossiper.instance.removeEndpoint(removeEndpoint);
    tokenMetadata_.removeEndpoint(removeEndpoint);
    HintedHandOffManager.deleteHintsForEndPoint(removeEndpoint);
    tokenMetadata_.removeBootstrapToken(removeToken);
  }
 else   if (VersionedValue.REMOVING_TOKEN.equals(state)) {
    if (logger_.isDebugEnabled())     logger_.debug("Token " + removeToken + " removed manually (endpoint was "+ removeEndpoint+ ")");
    tokenMetadata_.addLeavingEndpoint(removeEndpoint);
    calculatePendingRanges();
    restoreReplicaCount(removeEndpoint,endpoint);
  }
  if (!isClientMode) {
    logger_.info("Removing token " + removeToken + " for "+ removeEndpoint);
    SystemTable.removeToken(removeToken);
  }
}
