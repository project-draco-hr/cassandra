{
  Collection<Range> ranges=getRangesForEndPoint(endpoint);
  if (logger_.isDebugEnabled())   logger_.debug("Node " + endpoint + " ranges ["+ StringUtils.join(ranges,", ")+ "]");
  Map<Range,ArrayList<InetAddress>> currentReplicaEndpoints=new HashMap<Range,ArrayList<InetAddress>>();
  for (  Range range : ranges)   currentReplicaEndpoints.put(range,replicationStrategy_.getNaturalEndpoints(range.right(),tokenMetadata_));
  TokenMetadata temp=tokenMetadata_.cloneAfterAllLeft();
  temp.removeEndpoint(endpoint);
  Multimap<Range,InetAddress> changedRanges=HashMultimap.create();
  for (  Range range : ranges) {
    ArrayList<InetAddress> newReplicaEndpoints=replicationStrategy_.getNaturalEndpoints(range.right(),temp);
    newReplicaEndpoints.removeAll(currentReplicaEndpoints.get(range));
    if (logger_.isDebugEnabled())     logger_.debug("Range " + range + " will be responsibility of "+ StringUtils.join(newReplicaEndpoints,", "));
    changedRanges.putAll(range,newReplicaEndpoints);
  }
  return changedRanges;
}
