{
  Table table=getValidTable(tableName);
  Set<ColumnFamilyStore> valid=new HashSet<ColumnFamilyStore>();
  for (  String cfName : columnFamilies.length == 0 ? table.getColumnFamilies() : Arrays.asList(columnFamilies)) {
    ColumnFamilyStore cfStore=table.getColumnFamilyStore(cfName);
    if (cfStore == null) {
      logger_.warn(String.format("Invalid column family specified: %s. Proceeding with others.",cfName));
      continue;
    }
    valid.add(cfStore);
  }
  return valid;
}
