{
  if (keys.length > 0) {
    Token token=tokenMetadata_.getToken(StorageService.tcpAddr_);
    Map<Token,EndPoint> tokenToEndPointMap=tokenMetadata_.cloneTokenEndPointMap();
    Token[] tokens=tokenToEndPointMap.keySet().toArray(new Token[tokenToEndPointMap.keySet().size()]);
    Arrays.sort(tokens);
    int index=Arrays.binarySearch(tokens,token) * (keys.length / tokens.length);
    Token newToken=partitioner_.getInitialToken(keys[index]);
    updateToken(newToken);
  }
}
