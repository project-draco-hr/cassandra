{
  if (logger_.isDebugEnabled())   logger_.debug("Constructing range to endpoint map ...");
  Map<Range,List<InetAddress>> rangeToEndPointMap=new HashMap<Range,List<InetAddress>>();
  for (  Range range : ranges) {
    InetAddress[] endpoints=replicationStrategy_.getReadStorageEndPoints(range.right(),tokenToEndPointMap);
    rangeToEndPointMap.put(range,new ArrayList<InetAddress>(Arrays.asList(endpoints)));
  }
  if (logger_.isDebugEnabled())   logger_.debug("Done constructing range to endpoint map ...");
  return rangeToEndPointMap;
}
