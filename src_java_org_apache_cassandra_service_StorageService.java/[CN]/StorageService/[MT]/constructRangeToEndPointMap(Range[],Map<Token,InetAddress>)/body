{
  if (logger_.isDebugEnabled())   logger_.debug("Constructing range to endpoint map ...");
  Map<Range,List<InetAddress>> rangeToEndPointMap=new HashMap<Range,List<InetAddress>>();
  for (  Range range : ranges) {
    rangeToEndPointMap.put(range,replicationStrategy_.getNaturalEndpoints(range.right(),tokenToEndPointMap));
  }
  if (logger_.isDebugEnabled())   logger_.debug("Done constructing range to endpoint map ...");
  return rangeToEndPointMap;
}
