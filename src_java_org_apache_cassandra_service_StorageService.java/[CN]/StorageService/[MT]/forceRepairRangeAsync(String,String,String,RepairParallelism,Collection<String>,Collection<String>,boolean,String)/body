{
  if (!FBUtilities.isUnix() && parallelismDegree != RepairParallelism.PARALLEL) {
    logger.warn("Snapshot-based repair is not yet supported on Windows.  Reverting to parallel repair.");
    parallelismDegree=RepairParallelism.PARALLEL;
  }
  Collection<Range<Token>> repairingRange=createRepairRangeFrom(beginToken,endToken);
  RepairOption options=new RepairOption(parallelismDegree,false,!fullRepair,false,1,repairingRange);
  options.getDataCenters().addAll(dataCenters);
  if (hosts != null) {
    options.getHosts().addAll(hosts);
  }
  if (columnFamilies != null) {
    for (    String columnFamily : columnFamilies) {
      options.getColumnFamilies().add(columnFamily);
    }
  }
  logger.info("starting user-requested repair of range {} for keyspace {} and column families {}",repairingRange,keyspaceName,columnFamilies);
  return forceRepairAsync(keyspaceName,options);
}
