{
  List<InetAddress> endpoints=getNaturalEndpoints(table,key);
  DatabaseDescriptor.getEndPointSnitch().sortByProximity(FBUtilities.getLocalAddress(),endpoints);
  for (  InetAddress endpoint : endpoints) {
    if (FailureDetector.instance.isAlive(endpoint))     return endpoint;
  }
  throw new UnavailableException();
}
