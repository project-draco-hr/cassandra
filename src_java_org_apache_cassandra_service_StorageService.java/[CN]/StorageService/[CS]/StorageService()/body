{
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  try {
    mbs.registerMBean(this,new ObjectName("org.apache.cassandra.service:type=StorageService"));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  bootstrapSet=HashMultimap.create();
  endPointSnitch_=DatabaseDescriptor.getEndPointSnitch();
  MessagingService.instance.registerVerbHandlers(binaryVerbHandler_,new BinaryVerbHandler());
  MessagingService.instance.registerVerbHandlers(mutationVerbHandler_,new RowMutationVerbHandler());
  MessagingService.instance.registerVerbHandlers(readRepairVerbHandler_,new ReadRepairVerbHandler());
  MessagingService.instance.registerVerbHandlers(readVerbHandler_,new ReadVerbHandler());
  MessagingService.instance.registerVerbHandlers(rangeSliceVerbHandler_,new RangeSliceVerbHandler());
  MessagingService.instance.registerVerbHandlers(bootstrapTokenVerbHandler_,new BootStrapper.BootstrapTokenVerbHandler());
  MessagingService.instance.registerVerbHandlers(streamRequestVerbHandler_,new StreamRequestVerbHandler());
  MessagingService.instance.registerVerbHandlers(streamInitiateVerbHandler_,new Streaming.StreamInitiateVerbHandler());
  MessagingService.instance.registerVerbHandlers(streamInitiateDoneVerbHandler_,new Streaming.StreamInitiateDoneVerbHandler());
  MessagingService.instance.registerVerbHandlers(streamFinishedVerbHandler_,new Streaming.StreamFinishedVerbHandler());
  MessagingService.instance.registerVerbHandlers(responseVerbHandler_,new ResponseVerbHandler());
  MessagingService.instance.registerVerbHandlers(TREE_REQUEST_VERB,new TreeRequestVerbHandler());
  MessagingService.instance.registerVerbHandlers(TREE_RESPONSE_VERB,new AntiEntropyService.TreeResponseVerbHandler());
  MessagingService.instance.registerVerbHandlers(JOIN_VERB,new Gossiper.JoinVerbHandler());
  MessagingService.instance.registerVerbHandlers(GOSSIP_DIGEST_SYN_VERB,new Gossiper.GossipDigestSynVerbHandler());
  MessagingService.instance.registerVerbHandlers(GOSSIP_DIGEST_ACK_VERB,new Gossiper.GossipDigestAckVerbHandler());
  MessagingService.instance.registerVerbHandlers(GOSSIP_DIGEST_ACK2_VERB,new Gossiper.GossipDigestAck2VerbHandler());
  replicationStrategy_=getReplicationStrategy(tokenMetadata_);
}
