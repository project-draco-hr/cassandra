{
  store.setMinimumCompactionThreshold(2);
  store.setMaximumCompactionThreshold(4);
  while (true) {
    ArrayList<Future<Integer>> compactions=new ArrayList<Future<Integer>>();
    for (int i=0; i < 10; i++)     compactions.add(CompactionManager.instance.submitBackground(store));
    boolean progress=false;
    for (    Future<Integer> compaction : compactions)     if (compaction.get() > 0)     progress=true;
    if (!progress)     break;
  }
  if (store.getSSTables().size() > 1) {
    CompactionManager.instance.performMaximal(store);
  }
}
