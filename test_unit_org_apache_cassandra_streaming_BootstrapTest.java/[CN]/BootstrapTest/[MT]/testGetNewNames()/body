{
  PendingFile[] pendingFiles=new PendingFile[3];
  pendingFiles[0]=new PendingFile("/baz/foo/Standard1-500-Data.db",100,"Keyspace1");
  pendingFiles[1]=new PendingFile("/bar/foo/Standard1-500-Index.db",100,"Keyspace1");
  pendingFiles[2]=new PendingFile("/bad/foo/Standard1-500-Filter.db",100,"Keyspace1");
  StreamInitiateVerbHandler bivh=new StreamInitiateVerbHandler();
  Map<String,String> fileNames=bivh.getNewNames(pendingFiles);
  Map<String,String> paths=new HashMap<String,String>();
  for (  String ssName : fileNames.keySet())   paths.put(ssName,DatabaseDescriptor.getNextAvailableDataLocation());
  assertEquals(1,paths.size());
  String result=fileNames.get("Keyspace1-Standard1-500");
  assertEquals(true,result.contains("Standard1"));
  assertEquals(true,result.contains("Data.db"));
  assertEquals(1,fileNames.entrySet().size());
  assertTrue(new File(bivh.getNewFileNameFromOldContextAndNames(fileNames,paths,pendingFiles[0])).getName().matches("Standard1-tmp-\\d+-Data.db"));
  assertTrue(new File(bivh.getNewFileNameFromOldContextAndNames(fileNames,paths,pendingFiles[1])).getName().matches("Standard1-tmp-\\d+-Index.db"));
  assertTrue(new File(bivh.getNewFileNameFromOldContextAndNames(fileNames,paths,pendingFiles[2])).getName().matches("Standard1-tmp-\\d+-Filter.db"));
}
