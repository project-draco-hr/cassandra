{
  Table table=Table.open(TABLE1);
  ColumnFamilyStore cfs=table.getColumnFamilyStore("Super1");
  final int ROWS_PER_SSTABLE=10;
  final int SSTABLES=DatabaseDescriptor.getIndexInterval() * 3 / ROWS_PER_SSTABLE;
  cfs.disableAutoCompaction();
  long maxTimestampExpected=Long.MIN_VALUE;
  Set<DecoratedKey> inserted=new HashSet<DecoratedKey>();
  ByteBuffer superColumn=ByteBufferUtil.bytes("TestSuperColumn");
  for (int j=0; j < SSTABLES; j++) {
    for (int i=0; i < ROWS_PER_SSTABLE; i++) {
      DecoratedKey key=Util.dk(String.valueOf(i % 2));
      RowMutation rm=new RowMutation(TABLE1,key.key);
      long timestamp=j * ROWS_PER_SSTABLE + i;
      rm.add(new QueryPath("Super1",superColumn,ByteBufferUtil.bytes((long)(i / 2))),ByteBufferUtil.EMPTY_BYTE_BUFFER,timestamp);
      maxTimestampExpected=Math.max(timestamp,maxTimestampExpected);
      rm.apply();
      inserted.add(key);
    }
    cfs.forceBlockingFlush();
    CompactionsTest.assertMaxTimestamp(cfs,maxTimestampExpected);
    assertEquals(inserted.toString(),inserted.size(),Util.getRangeSlice(cfs,superColumn).size());
  }
  forceCompactions(cfs);
  assertEquals(inserted.size(),Util.getRangeSlice(cfs,superColumn).size());
  CompactionsTest.assertMaxTimestamp(cfs,maxTimestampExpected);
}
