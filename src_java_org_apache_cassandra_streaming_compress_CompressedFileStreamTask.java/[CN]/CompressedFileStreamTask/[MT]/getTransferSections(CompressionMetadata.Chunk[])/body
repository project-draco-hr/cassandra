{
  List<Pair<Long,Long>> transferSections=new ArrayList<Pair<Long,Long>>();
  Pair<Long,Long> lastSection=null;
  for (  CompressionMetadata.Chunk chunk : chunks) {
    if (lastSection != null) {
      if (chunk.offset == lastSection.right) {
        lastSection=new Pair<Long,Long>(lastSection.left,chunk.offset + chunk.length + 4);
      }
 else {
        transferSections.add(lastSection);
        lastSection=new Pair<Long,Long>(chunk.offset,chunk.offset + chunk.length + 4);
      }
    }
 else {
      lastSection=new Pair<Long,Long>(chunk.offset,chunk.offset + chunk.length + 4);
    }
  }
  if (lastSection != null)   transferSections.add(lastSection);
  return transferSections;
}
