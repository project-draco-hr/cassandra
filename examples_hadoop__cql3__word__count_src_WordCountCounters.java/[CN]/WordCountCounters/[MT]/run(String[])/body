{
  Job job=new Job(getConf(),"wordcountcounters");
  job.setJarByClass(WordCountCounters.class);
  job.setMapperClass(SumMapper.class);
  job.setCombinerClass(ReducerToFilesystem.class);
  job.setReducerClass(ReducerToFilesystem.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(LongWritable.class);
  FileOutputFormat.setOutputPath(job,new Path(OUTPUT_PATH_PREFIX));
  job.setInputFormatClass(CqlPagingInputFormat.class);
  ConfigHelper.setInputRpcPort(job.getConfiguration(),"9160");
  ConfigHelper.setInputInitialAddress(job.getConfiguration(),"localhost");
  ConfigHelper.setInputPartitioner(job.getConfiguration(),"Murmur3Partitioner");
  ConfigHelper.setInputColumnFamily(job.getConfiguration(),WordCount.KEYSPACE,WordCount.OUTPUT_COLUMN_FAMILY);
  CqlConfigHelper.setInputCQLPageRowSize(job.getConfiguration(),"3");
  job.waitForCompletion(true);
  return 0;
}
