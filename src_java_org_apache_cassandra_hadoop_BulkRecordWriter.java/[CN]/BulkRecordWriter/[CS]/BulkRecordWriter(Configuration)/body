{
  this.conf=conf;
  DatabaseDescriptor.setStreamThroughputOutboundMegabitsPerSec(Integer.valueOf(conf.get(STREAM_THROTTLE_MBITS,"0")));
  String keyspace=ConfigHelper.getOutputKeyspace(conf);
  File outputdir=new File(getOutputLocation() + File.separator + keyspace);
  outputdir.mkdirs();
  this.isSuper=Boolean.valueOf(conf.get(IS_SUPERCF));
  AbstractType subcomparator=null;
  if (isSuper)   subcomparator=BytesType.instance;
  this.writer=new SSTableSimpleUnsortedWriter(outputdir,keyspace,ConfigHelper.getOutputColumnFamily(conf),BytesType.instance,subcomparator,Integer.valueOf(conf.get(BUFFER_SIZE_IN_MB,"64")));
  this.loader=new SSTableLoader(outputdir,new ExternalClient(ConfigHelper.getInitialAddress(conf),ConfigHelper.getRpcPort(conf)),new NullOutputHandler());
}
