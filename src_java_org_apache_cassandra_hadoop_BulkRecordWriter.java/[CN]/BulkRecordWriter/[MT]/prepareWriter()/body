{
  if (outputDir == null) {
    String keyspace=ConfigHelper.getOutputKeyspace(conf);
    outputDir=new File(getOutputLocation() + File.separator + keyspace+ File.separator+ ConfigHelper.getOutputColumnFamily(conf));
    outputDir.mkdirs();
  }
  if (writer == null) {
    AbstractType<?> subcomparator=null;
    if (cfType == CFType.SUPER)     subcomparator=BytesType.instance;
    writer=new SSTableSimpleUnsortedWriter(outputDir,ConfigHelper.getOutputPartitioner(conf),ConfigHelper.getOutputKeyspace(conf),ConfigHelper.getOutputColumnFamily(conf),BytesType.instance,subcomparator,Integer.parseInt(conf.get(BUFFER_SIZE_IN_MB,"64")),ConfigHelper.getOutputCompressionParamaters(conf));
    this.loader=new SSTableLoader(outputDir,new ExternalClient(conf),new NullOutputHandler());
  }
}
