{
  Columns mergedColumns=existing.columns().mergeTo(update.columns());
  rowAllocator.allocateNewRow(update.clustering().size(),mergedColumns,update.isStatic());
  colUpdateTimeDelta=Math.min(colUpdateTimeDelta,Rows.merge(row.setTo(existing),update,mergedColumns,rowAllocator,nowInSec,indexer));
  MemtableRowData reconciled=rowAllocator.allocatedRowData();
  dataSize+=reconciled.dataSize() - existing.dataSize();
  heapSize+=reconciled.unsharedHeapSizeExcludingData() - existing.unsharedHeapSizeExcludingData();
  if (inserted == null)   inserted=new ArrayList<>();
  inserted.add(reconciled);
  discard(existing);
  return reconciled;
}
