{
  RateLimiter rl=rateLimit != 0 ? RateLimiter.create(rateLimit) : null;
  final Random rand=random != null ? random : ThreadLocalRandom.current();
  while (!stop) {
    if (rl != null)     rl.acquire();
    String ks="Keyspace1";
    ByteBuffer key=randomBytes(16,rand);
    Mutation mutation=new Mutation(ks,key);
    for (int ii=0; ii < numCells; ii++) {
      int sz=randomSize ? rand.nextInt(cellSize) : cellSize;
      ByteBuffer bytes=randomBytes(sz,rand);
      mutation.add("Standard1",Util.cellname("name" + ii),bytes,System.currentTimeMillis());
      hash=hash(hash,bytes);
      ++cells;
      dataSize+=sz;
    }
    rp=commitLog.add(mutation);
    counter.incrementAndGet();
  }
}
