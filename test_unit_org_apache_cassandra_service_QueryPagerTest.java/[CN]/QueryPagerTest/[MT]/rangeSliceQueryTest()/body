{
  QueryPager pager=QueryPagers.localPager(rangeSliceQuery(range("k1","k5"),100,"c1","c7"));
  List<Row> page;
  assertFalse(pager.isExhausted());
  page=pager.fetchPage(5);
  assertEquals(toString(page),1,page.size());
  assertRow(page.get(0),"k2","c1","c2","c3","c4","c5");
  assertFalse(pager.isExhausted());
  page=pager.fetchPage(4);
  assertEquals(toString(page),2,page.size());
  assertRow(page.get(0),"k2","c6","c7");
  assertRow(page.get(1),"k3","c1","c2");
  assertFalse(pager.isExhausted());
  page=pager.fetchPage(6);
  assertEquals(toString(page),2,page.size());
  assertRow(page.get(0),"k3","c3","c4","c5","c6","c7");
  assertRow(page.get(1),"k4","c1");
  assertFalse(pager.isExhausted());
  page=pager.fetchPage(5);
  assertEquals(toString(page),1,page.size());
  assertRow(page.get(0),"k4","c2","c3","c4","c5","c6");
  assertFalse(pager.isExhausted());
  page=pager.fetchPage(5);
  assertEquals(toString(page),2,page.size());
  assertRow(page.get(0),"k4","c7");
  assertRow(page.get(1),"k5","c1","c2","c3","c4");
  assertFalse(pager.isExhausted());
  page=pager.fetchPage(5);
  assertEquals(toString(page),1,page.size());
  assertRow(page.get(0),"k5","c5","c6","c7");
  assertTrue(pager.isExhausted());
}
