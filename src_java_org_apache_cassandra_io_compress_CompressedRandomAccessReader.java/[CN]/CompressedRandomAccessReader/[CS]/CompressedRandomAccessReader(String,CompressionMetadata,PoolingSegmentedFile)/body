{
  super(new File(dataFilePath),metadata.chunkLength(),metadata.compressor().useDirectOutputByteBuffers(),owner);
  this.metadata=metadata;
  checksum=new Adler32();
  if (!useMmap) {
    compressed=ByteBuffer.wrap(new byte[metadata.compressor().initialCompressedBufferLength(metadata.chunkLength())]);
    checksumBytes=ByteBuffer.wrap(new byte[4]);
  }
 else {
    try {
      createMappedSegments();
    }
 catch (    IOException e) {
      throw new IOError(e);
    }
  }
}
