{
  byte[] body=(byte[])message.getMessageBody()[0];
  ReadContext readCtx=tls_.get();
  if (readCtx == null) {
    readCtx=new ReadContext();
    tls_.set(readCtx);
  }
  readCtx.bufIn_.reset(body,body.length);
  try {
    ReadCommand readCommand=ReadCommand.serializer().deserialize(readCtx.bufIn_);
    Table table=Table.open(readCommand.table);
    Row row=null;
    long start=System.currentTimeMillis();
    row=readCommand.getRow(table);
    logger_.info("getRow()  TIME: " + (System.currentTimeMillis() - start) + " ms.");
    start=System.currentTimeMillis();
    ReadResponse readResponse=null;
    if (readCommand.isDigestQuery()) {
      readResponse=new ReadResponse(table.getTableName(),row.digest());
    }
 else {
      readResponse=new ReadResponse(table.getTableName(),row);
    }
    readResponse.setIsDigestQuery(readCommand.isDigestQuery());
    readCtx.bufOut_.reset();
    start=System.currentTimeMillis();
    ReadResponse.serializer().serialize(readResponse,readCtx.bufOut_);
    logger_.info("serialize  TIME: " + (System.currentTimeMillis() - start) + " ms.");
    byte[] bytes=new byte[readCtx.bufOut_.getLength()];
    start=System.currentTimeMillis();
    System.arraycopy(readCtx.bufOut_.getData(),0,bytes,0,bytes.length);
    logger_.info("copy  TIME: " + (System.currentTimeMillis() - start) + " ms.");
    Message response=message.getReply(StorageService.getLocalStorageEndPoint(),new Object[]{bytes});
    MessagingService.getMessagingInstance().sendOneWay(response,message.getFrom());
    logger_.info("ReadVerbHandler  TIME 2: " + (System.currentTimeMillis() - start) + " ms.");
    String repair=new String(message.getHeader(ReadCommand.DO_REPAIR));
    if (repair.equals(ReadCommand.DO_REPAIR))     doReadRepair(row,readCommand);
  }
 catch (  IOException ex) {
    logger_.info(LogUtil.throwableToString(ex));
  }
}
