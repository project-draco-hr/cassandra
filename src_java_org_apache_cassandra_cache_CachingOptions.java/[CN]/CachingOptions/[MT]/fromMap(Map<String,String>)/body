{
  validateCacheConfig(cacheConfig);
  if (!cacheConfig.containsKey("keys") && !cacheConfig.containsKey("rows_per_partition"))   return CachingOptions.NONE;
  if (!cacheConfig.containsKey("keys"))   return new CachingOptions(new KeyCache(KeyCache.Type.NONE),RowCache.fromString(cacheConfig.get("rows_per_partition")));
  if (!cacheConfig.containsKey("rows_per_partition"))   return CachingOptions.KEYS_ONLY;
  return new CachingOptions(KeyCache.fromString(cacheConfig.get("keys")),RowCache.fromString(cacheConfig.get("rows_per_partition")));
}
