{
  Iterator<Map.Entry<ByteBuffer,ByteBuffer>> conditionIter=elements.entrySet().iterator();
  while (iter.hasNext()) {
    if (!conditionIter.hasNext())     return operator.equals(Operator.GT) || operator.equals(Operator.GTE) || operator.equals(Operator.NEQ);
    Map.Entry<ByteBuffer,ByteBuffer> conditionEntry=conditionIter.next();
    Cell c=iter.next();
    int comparison=type.getKeysType().compare(c.name().collectionElement(),conditionEntry.getKey());
    if (comparison != 0)     return evaluateComparisonWithOperator(comparison,operator);
    comparison=type.getValuesType().compare(c.value(),conditionEntry.getValue());
    if (comparison != 0)     return evaluateComparisonWithOperator(comparison,operator);
  }
  if (conditionIter.hasNext())   return operator.equals(Operator.LT) || operator.equals(Operator.LTE) || operator.equals(Operator.NEQ);
  return operator == Operator.EQ || operator == Operator.LTE || operator == Operator.GTE;
}
