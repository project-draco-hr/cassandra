{
  client.init(keyspace);
  StreamPlan plan=new StreamPlan("Bulk Load");
  Collection<SSTableReader> sstables=openSSTables();
  if (sstables.isEmpty()) {
    return plan.execute();
  }
  Map<InetAddress,Collection<Range<Token>>> endpointToRanges=client.getEndpointToRangesMap();
  outputHandler.output(String.format("Streaming relevant part of %sto %s",names(sstables),endpointToRanges.keySet()));
  for (  Map.Entry<InetAddress,Collection<Range<Token>>> entry : endpointToRanges.entrySet()) {
    InetAddress remote=entry.getKey();
    if (toIgnore.contains(remote))     continue;
    Collection<Range<Token>> ranges=entry.getValue();
    SSTableReader.acquireReferences(sstables);
    plan.transferFiles(remote,ranges,sstables);
  }
  StreamResultFuture bulkResult=plan.execute();
  bulkResult.addEventListener(this);
  return bulkResult;
}
