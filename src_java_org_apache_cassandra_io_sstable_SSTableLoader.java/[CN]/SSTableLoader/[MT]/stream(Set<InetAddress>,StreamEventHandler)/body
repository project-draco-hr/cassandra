{
  client.init(keyspace);
  outputHandler.output("Established connection to initial hosts");
  StreamPlan plan=new StreamPlan("Bulk Load");
  Map<InetAddress,Collection<Range<Token>>> endpointToRanges=client.getEndpointToRangesMap();
  openSSTables(endpointToRanges);
  if (sstables.isEmpty()) {
    return plan.execute();
  }
  outputHandler.output(String.format("Streaming relevant part of %sto %s",names(sstables),endpointToRanges.keySet()));
  for (  Map.Entry<InetAddress,Collection<Range<Token>>> entry : endpointToRanges.entrySet()) {
    InetAddress remote=entry.getKey();
    if (toIgnore.contains(remote))     continue;
    Collection<StreamSession.SSTableStreamingSections> endpointDetails=streamingDetails.get(remote);
    for (    StreamSession.SSTableStreamingSections details : endpointDetails)     details.sstable.acquireReference();
    plan.transferFiles(remote,streamingDetails.get(remote));
  }
  plan.listeners(this,listeners);
  return plan.execute();
}
