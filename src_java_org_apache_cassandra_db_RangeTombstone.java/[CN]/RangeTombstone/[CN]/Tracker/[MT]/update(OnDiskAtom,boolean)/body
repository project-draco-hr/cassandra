{
  ListIterator<RangeTombstone> iterator=openedTombstones.listIterator();
  while (iterator.hasNext()) {
    RangeTombstone t=iterator.next();
    if (comparator.compare(atom.name(),t.max) > 0) {
      iterator.remove();
    }
 else {
      iterator.previous();
      break;
    }
  }
  if (atom instanceof RangeTombstone) {
    RangeTombstone toAdd=(RangeTombstone)atom;
    while (iterator.hasNext()) {
      RangeTombstone existing=iterator.next();
      int cmp=comparator.compare(toAdd.max,existing.max);
      if (cmp > 0) {
        if (!existing.data.supersedes(toAdd.data)) {
          iterator.remove();
          if (comparator.compare(toAdd.min,existing.min) == 0)           unwrittenTombstones.remove(existing);
        }
      }
 else {
        if (!toAdd.data.supersedes(existing.data))         return false;
        if (cmp == 0) {
          iterator.remove();
          if (comparator.compare(toAdd.min,existing.min) == 0)           unwrittenTombstones.remove(existing);
        }
 else {
          iterator.previous();
        }
        break;
      }
    }
    if (isExpired)     iterator.add(new ExpiredRangeTombstone(toAdd));
 else {
      iterator.add(toAdd);
      unwrittenTombstones.add(toAdd);
    }
    return false;
  }
  return true;
}
