{
  Keyspace keyspace=Keyspace.open("Keyspace2");
  Mutation rm;
  rm=new Mutation("Keyspace2",ByteBufferUtil.bytes("k100"));
  rm.add("Indexed1",cellname("birthdate"),ByteBufferUtil.bytes(100L),1,1000);
  rm.apply();
  IndexExpression expr=new IndexExpression(ByteBufferUtil.bytes("birthdate"),IndexExpression.Operator.EQ,ByteBufferUtil.bytes(100L));
  List<IndexExpression> clause=Arrays.asList(expr);
  IDiskAtomFilter filter=new IdentityQueryFilter();
  Range<RowPosition> range=Util.range("","");
  List<Row> rows=keyspace.getColumnFamilyStore("Indexed1").search(range,clause,filter,100);
  assertEquals(1,rows.size());
  TimeUnit.SECONDS.sleep(1);
  rm=new Mutation("Keyspace2",ByteBufferUtil.bytes("k100"));
  rm.add("Indexed1",cellname("birthdate"),ByteBufferUtil.bytes(100L),1,1000);
  rm.apply();
  rows=keyspace.getColumnFamilyStore("Indexed1").search(range,clause,filter,100);
  assertEquals(1,rows.size());
  rm=new Mutation("Keyspace2",ByteBufferUtil.bytes("k101"));
  rm.add("Indexed1",cellname("birthdate"),ByteBufferUtil.bytes(101L),1,1000);
  rm.apply();
  expr=new IndexExpression(ByteBufferUtil.bytes("birthdate"),IndexExpression.Operator.EQ,ByteBufferUtil.bytes(101L));
  clause=Arrays.asList(expr);
  rows=keyspace.getColumnFamilyStore("Indexed1").search(range,clause,filter,100);
  assertEquals(1,rows.size());
  TimeUnit.SECONDS.sleep(1);
  rm=new Mutation("Keyspace2",ByteBufferUtil.bytes("k101"));
  rm.add("Indexed1",cellname("birthdate"),ByteBufferUtil.bytes(102L),1,1000);
  rm.apply();
  rows=keyspace.getColumnFamilyStore("Indexed1").search(range,clause,filter,100);
  assertEquals(0,rows.size());
  expr=new IndexExpression(ByteBufferUtil.bytes("birthdate"),IndexExpression.Operator.EQ,ByteBufferUtil.bytes(102L));
  clause=Arrays.asList(expr);
  rows=keyspace.getColumnFamilyStore("Indexed1").search(range,clause,filter,100);
  assertEquals(1,rows.size());
}
