{
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  final ColumnFamilyStore store=keyspace.getColumnFamilyStore(CF_STANDARD2);
  Mutation rm;
  rm=new Mutation(KEYSPACE1,ByteBufferUtil.bytes("key1"));
  rm.delete(CF_STANDARD2,System.currentTimeMillis());
  rm.apply();
  Runnable r=new WrappedRunnable(){
    public void runMayThrow() throws IOException {
      QueryFilter sliceFilter=QueryFilter.getSliceFilter(Util.dk("key1"),CF_STANDARD2,Composites.EMPTY,Composites.EMPTY,false,1,System.currentTimeMillis());
      ColumnFamily cf=store.getColumnFamily(sliceFilter);
      assertTrue(cf.isMarkedForDelete());
      assertFalse(cf.hasColumns());
      QueryFilter namesFilter=Util.namesQueryFilter(store,Util.dk("key1"),"a");
      cf=store.getColumnFamily(namesFilter);
      assertTrue(cf.isMarkedForDelete());
      assertFalse(cf.hasColumns());
    }
  }
;
  KeyspaceTest.reTest(store,r);
}
