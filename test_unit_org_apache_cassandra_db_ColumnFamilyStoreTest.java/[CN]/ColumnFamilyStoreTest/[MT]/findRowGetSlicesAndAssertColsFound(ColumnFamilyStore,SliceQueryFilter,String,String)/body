{
  List<Row> rows=cfs.getRangeSlice(new Bounds<RowPosition>(rp(rowKey),rp(rowKey)),null,filter,Integer.MAX_VALUE,System.currentTimeMillis(),false,false);
  assertSame("unexpected number of rows ",1,rows.size());
  Row row=rows.get(0);
  Collection<Cell> cols=!filter.isReversed() ? row.cf.getSortedColumns() : row.cf.getReverseSortedColumns();
  String[] returnedColsNames=Iterables.toArray(Iterables.transform(cols,new Function<Cell,String>(){
    public String apply(    Cell arg0){
      return Util.string(arg0.name().toByteBuffer());
    }
  }
),String.class);
  assertTrue("Columns did not match. Expected: " + Arrays.toString(colNames) + " but got:"+ Arrays.toString(returnedColsNames),Arrays.equals(colNames,returnedColsNames));
  int i=0;
  for (  Cell col : cols) {
    assertEquals(colNames[i++],Util.string(col.name().toByteBuffer()));
  }
}
