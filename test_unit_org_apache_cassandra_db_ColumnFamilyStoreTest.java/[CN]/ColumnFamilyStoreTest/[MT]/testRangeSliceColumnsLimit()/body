{
  String tableName="Keyspace1";
  String cfName="Standard1";
  Table table=Table.open(tableName);
  ColumnFamilyStore cfs=table.getColumnFamilyStore(cfName);
  cfs.clearUnsafe();
  Column[] cols=new Column[5];
  for (int i=0; i < 5; i++)   cols[i]=column("c" + i,"value",1);
  putColsStandard(cfs,Util.dk("a"),cols[0],cols[1],cols[2],cols[3],cols[4]);
  putColsStandard(cfs,Util.dk("b"),cols[0],cols[1]);
  putColsStandard(cfs,Util.dk("c"),cols[0],cols[1],cols[2],cols[3]);
  cfs.forceBlockingFlush();
  SlicePredicate sp=new SlicePredicate();
  sp.setSlice_range(new SliceRange());
  sp.getSlice_range().setCount(1);
  sp.getSlice_range().setStart(ArrayUtils.EMPTY_BYTE_ARRAY);
  sp.getSlice_range().setFinish(ArrayUtils.EMPTY_BYTE_ARRAY);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),3,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),3);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),5,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),5);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),8,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),8);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),10,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),10);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),100,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),11);
  sp=new SlicePredicate();
  sp.setColumn_names(Arrays.asList(ByteBufferUtil.bytes("c0"),ByteBufferUtil.bytes("c1"),ByteBufferUtil.bytes("c2")));
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),1,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),3);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),4,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),5);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),5,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),5);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),6,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),8);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),100,ThriftValidation.asIFilter(sp,cfs.metadata,null),null,true,false),8);
}
