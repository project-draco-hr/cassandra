{
  String keyspaceName=KEYSPACE1;
  String cfName=CF_STANDARD1;
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  cfs.clearUnsafe();
  Cell[] cols=new Cell[5];
  for (int i=0; i < 5; i++)   cols[i]=column("c" + i,"value",1);
  putColsStandard(cfs,Util.dk("a"),cols[0],cols[1],cols[2],cols[3],cols[4]);
  putColsStandard(cfs,Util.dk("b"),cols[0],cols[1]);
  putColsStandard(cfs,Util.dk("c"),cols[0],cols[1],cols[2],cols[3]);
  cfs.forceBlockingFlush();
  SlicePredicate sp=new SlicePredicate();
  sp.setSlice_range(new SliceRange());
  sp.getSlice_range().setCount(1);
  sp.getSlice_range().setStart(ArrayUtils.EMPTY_BYTE_ARRAY);
  sp.getSlice_range().setFinish(ArrayUtils.EMPTY_BYTE_ARRAY);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),3,System.currentTimeMillis(),true,false),3);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),5,System.currentTimeMillis(),true,false),5);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),8,System.currentTimeMillis(),true,false),8);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),10,System.currentTimeMillis(),true,false),10);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),100,System.currentTimeMillis(),true,false),11);
  sp=new SlicePredicate();
  sp.setColumn_names(Arrays.asList(ByteBufferUtil.bytes("c0"),ByteBufferUtil.bytes("c1"),ByteBufferUtil.bytes("c2")));
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),1,System.currentTimeMillis(),true,false),3);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),4,System.currentTimeMillis(),true,false),5);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),5,System.currentTimeMillis(),true,false),5);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),6,System.currentTimeMillis(),true,false),8);
  assertTotalColCount(cfs.getRangeSlice(Util.range("",""),null,ThriftValidation.asIFilter(sp,cfs.metadata,null),100,System.currentTimeMillis(),true,false),8);
}
