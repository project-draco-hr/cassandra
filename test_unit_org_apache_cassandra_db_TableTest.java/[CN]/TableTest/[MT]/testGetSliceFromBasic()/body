{
  final Table table=Table.open("Keyspace1");
  final ColumnFamilyStore cfStore=table.getColumnFamilyStore("Standard1");
  final String ROW="row1";
  RowMutation rm=new RowMutation("Keyspace1",ROW);
  ColumnFamily cf=ColumnFamily.create("Keyspace1","Standard1");
  cf.addColumn(column("col1","val1",1L));
  cf.addColumn(column("col3","val3",1L));
  cf.addColumn(column("col4","val4",1L));
  cf.addColumn(column("col5","val5",1L));
  cf.addColumn(column("col7","val7",1L));
  cf.addColumn(column("col9","val9",1L));
  rm.add(cf);
  rm.apply();
  rm=new RowMutation("Keyspace1",ROW);
  rm.delete(new QueryPath("Standard1",null,"col4".getBytes()),2L);
  rm.apply();
  Runner verify=new Runner(){
    public void run() throws Exception {
      ColumnFamily cf;
      cf=cfStore.getColumnFamily(ROW,new QueryPath("Standard1"),"col5".getBytes(),ArrayUtils.EMPTY_BYTE_ARRAY,false,2);
      assertColumns(cf,"col5","col7");
      cf=cfStore.getColumnFamily(ROW,new QueryPath("Standard1"),"col4".getBytes(),ArrayUtils.EMPTY_BYTE_ARRAY,false,2);
      assertColumns(cf,"col4","col5","col7");
      assertColumns(ColumnFamilyStore.removeDeleted(cf,Integer.MAX_VALUE),"col5","col7");
      cf=cfStore.getColumnFamily(ROW,new QueryPath("Standard1"),"col5".getBytes(),ArrayUtils.EMPTY_BYTE_ARRAY,true,2);
      assertColumns(cf,"col3","col4","col5");
      cf=cfStore.getColumnFamily(ROW,new QueryPath("Standard1"),"col6".getBytes(),ArrayUtils.EMPTY_BYTE_ARRAY,true,2);
      assertColumns(cf,"col3","col4","col5");
      cf=cfStore.getColumnFamily(ROW,new QueryPath("Standard1"),ArrayUtils.EMPTY_BYTE_ARRAY,ArrayUtils.EMPTY_BYTE_ARRAY,true,2);
      assertColumns(cf,"col7","col9");
      cf=cfStore.getColumnFamily(ROW,new QueryPath("Standard1"),"col95".getBytes(),ArrayUtils.EMPTY_BYTE_ARRAY,false,2);
      assertColumns(cf);
      cf=cfStore.getColumnFamily(ROW,new QueryPath("Standard1"),"col0".getBytes(),ArrayUtils.EMPTY_BYTE_ARRAY,true,2);
      assertColumns(cf);
    }
  }
;
  reTest(table.getColumnFamilyStore("Standard1"),verify);
}
