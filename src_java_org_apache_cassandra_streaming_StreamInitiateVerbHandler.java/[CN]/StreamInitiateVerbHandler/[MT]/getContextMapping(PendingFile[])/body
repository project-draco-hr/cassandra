{
  LinkedHashMap<PendingFile,PendingFile> mapping=new LinkedHashMap<PendingFile,PendingFile>();
  Map<Descriptor,Descriptor> sstables=new HashMap<Descriptor,Descriptor>();
  for (  PendingFile remote : remoteFiles) {
    Descriptor remotedesc=remote.getDescriptor();
    Descriptor localdesc=sstables.get(remotedesc);
    if (localdesc == null) {
      Table table=Table.open(remotedesc.ksname);
      ColumnFamilyStore cfStore=table.getColumnFamilyStore(remotedesc.cfname);
      localdesc=Descriptor.fromFilename(cfStore.getFlushPath());
      sstables.put(remotedesc,localdesc);
    }
    mapping.put(remote,new PendingFile(localdesc,remote.getComponent(),remote.getExpectedBytes()));
  }
  return mapping;
}
