{
  Map<String,String> fileNames=new HashMap<String,String>();
  Set<String> distinctEntries=new HashSet<String>();
  for (  StreamContextManager.StreamContext streamContext : streamContexts) {
    String[] pieces=FBUtilities.strip(new File(streamContext.getTargetFile()).getName(),"-");
    distinctEntries.add(streamContext.getTable() + "-" + pieces[0]+ "-"+ pieces[1]);
  }
  for (  String distinctEntry : distinctEntries) {
    String tableName;
    String[] pieces=FBUtilities.strip(distinctEntry,"-");
    tableName=pieces[0];
    Table table=Table.open(tableName);
    ColumnFamilyStore cfStore=table.getColumnFamilyStore(pieces[1]);
    if (logger.isDebugEnabled())     logger.debug("Generating file name for " + distinctEntry + " ...");
    fileNames.put(distinctEntry,cfStore.getTempSSTableFileName());
  }
  return fileNames;
}
