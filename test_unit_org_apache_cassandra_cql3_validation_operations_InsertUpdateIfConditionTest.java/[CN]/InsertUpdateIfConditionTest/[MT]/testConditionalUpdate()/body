{
  createTable(" CREATE TABLE %s (k int PRIMARY KEY, v1 int, v2 text, v3 int)");
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF v1 = 4"),row(false));
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF EXISTS"),row(false));
  assertRows(execute("INSERT INTO %s (k, v1, v2) VALUES (0, 2, 'foo') IF NOT EXISTS"),row(true));
  assertRows(execute("INSERT INTO %s (k, v1, v2) VALUES (0, 5, 'bar') IF NOT EXISTS"),row(false,0,2,"foo",null));
  assertRows(execute("SELECT * FROM %s"),row(0,2,"foo",null));
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF v1 = 4"),row(false,2));
  assertRows(execute("SELECT * FROM %s"),row(0,2,"foo",null));
  assertRows(execute("UPDATE %s SET v2 = 'bar', v1 = 3 WHERE k = 0 IF v1 = 2"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar', v1 = 3 WHERE k = 0 IF EXISTS"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,3,"bar",null));
  assertRows(execute("UPDATE %s SET v1 = 5, v2 = 'foobar' WHERE k = 0 IF v1 = 3 AND v2 = 'foo'"),row(false,3,"bar"));
  assertRows(execute("SELECT * FROM %s"),row(0,3,"bar",null));
  assertRows(execute("UPDATE %s SET v1 = 5, v2 = 'foobar' WHERE k = 0 IF v1 = 3 AND v2 = 'bar'"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,5,"foobar",null));
  assertRows(execute("DELETE v2 FROM %s WHERE k = 0 IF v1 = 3"),row(false,5));
  assertRows(execute("SELECT * FROM %s"),row(0,5,"foobar",null));
  assertRows(execute("DELETE v2 FROM %s WHERE k = 0 IF v1 = null"),row(false,5));
  assertRows(execute("SELECT * FROM %s"),row(0,5,"foobar",null));
  assertRows(execute("DELETE v2 FROM %s WHERE k = 0 IF v1 = 5"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,5,null,null));
  assertRows(execute("DELETE v1 FROM %s WHERE k = 0 IF v3 = 4"),row(false,null));
  assertRows(execute("DELETE v1 FROM %s WHERE k = 0 IF v3 = null"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,null,null,null));
  assertRows(execute("DELETE FROM %s WHERE k = 0 IF v1 = null"),row(true));
  assertEmpty(execute("SELECT * FROM %s"));
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF EXISTS"),row(false));
  assertEmpty(execute("SELECT * FROM %s WHERE k = 0"));
  assertRows(execute("DELETE FROM %s WHERE k = 0 IF v1 IN (null)"),row(true));
  createTable(" CREATE TABLE %s (k int, c int, v1 text, PRIMARY KEY(k, c))");
  assertInvalidMessage("IN on the clustering key columns is not supported with conditional updates","UPDATE %s SET v1 = 'A' WHERE k = 0 AND c IN (1, 2) IF EXISTS");
}
