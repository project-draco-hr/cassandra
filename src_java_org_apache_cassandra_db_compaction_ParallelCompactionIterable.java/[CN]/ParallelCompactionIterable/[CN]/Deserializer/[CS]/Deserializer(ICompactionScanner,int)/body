{
  this.scanner=ssts;
  Runnable runnable=new WrappedRunnable(){
    protected void runMayThrow() throws Exception {
      SimpleCondition condition=null;
      while (true) {
        if (condition != null) {
          condition.await();
          condition=null;
        }
        if (!scanner.hasNext()) {
          queue.put(finished);
          break;
        }
        SSTableIdentityIterator iter=(SSTableIdentityIterator)scanner.next();
        if (iter.dataSize > maxInMemorySize) {
          logger.debug("parallel lazy deserialize from {}",iter.getPath());
          condition=new SimpleCondition();
          queue.put(new RowContainer(new NotifyingSSTableIdentityIterator(iter,condition)));
        }
 else {
          logger.debug("parallel eager deserialize from {}",iter.getPath());
          queue.put(new RowContainer(new Row(iter.getKey(),iter.getColumnFamilyWithColumns(ArrayBackedSortedColumns.factory))));
        }
      }
    }
  }
;
  new Thread(runnable,"Deserialize " + scanner.getBackingFiles()).start();
}
