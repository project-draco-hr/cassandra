{
  final ColumnFamily returnCF=ColumnFamily.create(controller.cfs.metadata,ArrayBackedSortedColumns.factory());
  List<CloseableIterator<IColumn>> data=new ArrayList<CloseableIterator<IColumn>>(rows.size());
  for (  Row row : rows) {
    returnCF.delete(row.cf);
    data.add(FBUtilities.closeableIterator(row.cf.iterator()));
  }
  PrecompactedRow.merge(returnCF,data,controller.cfs.indexManager.updaterFor(rows.get(0).key,false));
  return PrecompactedRow.removeDeletedAndOldShards(rows.get(0).key,controller,returnCF);
}
