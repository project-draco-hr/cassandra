{
  this.cfm=cfm;
  this.hasCompositeKey=cfm.getKeyValidator() instanceof CompositeType;
  for (int i=0; i < cfm.partitionKeyColumns().size(); ++i) {
    ColumnIdentifier id=new ColumnIdentifier(cfm.partitionKeyColumns().get(i).name,definitionType);
    this.partitionKeys.put(id,new Name(cfm.ksName,cfm.cfName,id,Name.Kind.KEY_ALIAS,i,cfm.getKeyValidator().getComponents().get(i)));
  }
  this.isComposite=cfm.comparator instanceof CompositeType;
  this.hasCollections=cfm.comparator.getComponents().get(cfm.comparator.componentsCount() - 1) instanceof ColumnToCollectionType;
  this.isCompact=cfm.clusteringKeyColumns().size() == cfm.comparator.componentsCount();
  for (int i=0; i < cfm.clusteringKeyColumns().size(); ++i) {
    ColumnIdentifier id=new ColumnIdentifier(cfm.clusteringKeyColumns().get(i).name,definitionType);
    this.clusteringColumns.put(id,new Name(cfm.ksName,cfm.cfName,id,Name.Kind.COLUMN_ALIAS,i,cfm.comparator.getComponents().get(i)));
  }
  if (isCompact) {
    this.compactValue=createValue(cfm);
  }
 else {
    this.compactValue=null;
    for (    ColumnDefinition def : cfm.regularColumns()) {
      ColumnIdentifier id=new ColumnIdentifier(def.name,cfm.getColumnDefinitionComparator(def));
      this.regularColumns.put(id,new Name(cfm.ksName,cfm.cfName,id,Name.Kind.COLUMN_METADATA,def.getValidator()));
    }
    for (    ColumnDefinition def : cfm.staticColumns()) {
      ColumnIdentifier id=new ColumnIdentifier(def.name,cfm.getColumnDefinitionComparator(def));
      this.staticColumns.put(id,new Name(cfm.ksName,cfm.cfName,id,Name.Kind.STATIC,def.getValidator()));
    }
  }
}
