{
  if (last == null && !source.hasNext())   return endOfData();
  boolean keyChanged=false;
  while (!keyChanged) {
    if (last != null)     reduce(last);
    if (!source.hasNext()) {
      last=null;
      break;
    }
    T current=source.next();
    if (last != null && !getKey(current).equals(getKey(last)))     keyChanged=true;
    last=current;
  }
  return getReduced();
}
