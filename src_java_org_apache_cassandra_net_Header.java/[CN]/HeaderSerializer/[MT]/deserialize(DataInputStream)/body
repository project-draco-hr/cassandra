{
  String id=dis.readUTF();
  InetAddress from=CompactEndpointSerializationHelper.deserialize(dis);
  int typeOrdinal=dis.readInt();
  int verbOrdinal=dis.readInt();
  int size=dis.readInt();
  Map<String,byte[]> details=new Hashtable<String,byte[]>(size);
  for (int i=0; i < size; ++i) {
    String key=dis.readUTF();
    int length=dis.readInt();
    byte[] bytes=new byte[length];
    dis.readFully(bytes);
    details.put(key,bytes);
  }
  return new Header(id,from,Stage.values()[typeOrdinal],StorageService.VERBS[verbOrdinal],details);
}
