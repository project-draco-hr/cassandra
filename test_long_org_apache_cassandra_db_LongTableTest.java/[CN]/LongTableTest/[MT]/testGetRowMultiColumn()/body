{
  final Table table=Table.open("Keyspace1");
  final ColumnFamilyStore cfStore=table.getColumnFamilyStore("Standard1");
  for (int i=1; i < 5000; i+=100) {
    RowMutation rm=new RowMutation("Keyspace1",Util.dk("key" + i).key);
    ColumnFamily cf=ColumnFamily.create("Keyspace1","Standard1");
    for (int j=0; j < i; j++)     cf.addColumn(column("c" + j,"v" + j,1L));
    rm.add(cf);
    rm.applyUnsafe();
  }
  Runnable verify=new WrappedRunnable(){
    public void runMayThrow() throws Exception {
      ColumnFamily cf;
      for (int i=1; i < 5000; i+=100) {
        for (int j=0; j < i; j++) {
          cf=cfStore.getColumnFamily(QueryFilter.getNamesFilter(Util.dk("key" + i),new QueryPath("Standard1"),ByteBufferUtil.bytes("c" + j)));
          TableTest.assertColumns(cf,"c" + j);
        }
      }
    }
  }
;
  TableTest.reTest(table.getColumnFamilyStore("Standard1"),verify);
}
