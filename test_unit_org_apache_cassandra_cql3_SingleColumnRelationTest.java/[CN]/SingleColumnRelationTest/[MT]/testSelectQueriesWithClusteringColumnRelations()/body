{
  assertRows(execute("select * from %s where a in (?, ?)","first","second"),row("first",1,5,1),row("first",2,6,2),row("first",3,7,3),row("second",4,8,4));
  assertRows(execute("select * from %s where a = ? and b = ? and c in (?, ?)","first",2,6,7),row("first",2,6,2));
  assertRows(execute("select * from %s where a = ? and b in (?, ?) and c in (?, ?)","first",2,3,6,7),row("first",2,6,2),row("first",3,7,3));
  assertRows(execute("select * from %s where a = ? and b in (?, ?) and c in (?, ?)","first",3,2,7,6),row("first",2,6,2),row("first",3,7,3));
  assertRows(execute("select * from %s where a = ? and c in (?, ?) and b in (?, ?)","first",7,6,3,2),row("first",2,6,2),row("first",3,7,3));
  assertRows(execute("select c, d from %s where a = ? and c in (?, ?) and b in (?, ?)","first",7,6,3,2),row(6,2),row(7,3));
  assertRows(execute("select c, d from %s where a = ? and c in (?, ?) and b in (?, ?, ?)","first",7,6,3,2,3),row(6,2),row(7,3));
  assertRows(execute("select * from %s where a = ? and b in (?, ?) and c = ?","first",3,2,7),row("first",3,7,3));
  assertRows(execute("select * from %s where a = ? and b in ? and c in ?","first",Arrays.asList(3,2),Arrays.asList(7,6)),row("first",2,6,2),row("first",3,7,3));
  assertInvalidMessage("Invalid null value for IN restriction","select * from %s where a = ? and b in ? and c in ?","first",null,Arrays.asList(7,6));
  assertRows(execute("select * from %s where a = ? and c >= ? and b in (?, ?)","first",6,3,2),row("first",2,6,2),row("first",3,7,3));
  assertRows(execute("select * from %s where a = ? and c > ? and b in (?, ?)","first",6,3,2),row("first",3,7,3));
  assertRows(execute("select * from %s where a = ? and c <= ? and b in (?, ?)","first",6,3,2),row("first",2,6,2));
  assertRows(execute("select * from %s where a = ? and c < ? and b in (?, ?)","first",7,3,2),row("first",2,6,2));
  assertRows(execute("select * from %s where a = ? and c >= ? and c <= ? and b in (?, ?)","first",6,7,3,2),row("first",2,6,2),row("first",3,7,3));
  assertRows(execute("select * from %s where a = ? and c > ? and c <= ? and b in (?, ?)","first",6,7,3,2),row("first",3,7,3));
  assertEmpty(execute("select * from %s where a = ? and c > ? and c < ? and b in (?, ?)","first",6,7,3,2));
  assertInvalidMessage("Column \"c\" cannot be restricted by both an equality and an inequality relation","select * from %s where a = ? and c > ? and c = ? and b in (?, ?)","first",6,7,3,2);
  assertInvalidMessage("c cannot be restricted by more than one relation if it includes an Equal","select * from %s where a = ? and c = ? and c > ?  and b in (?, ?)","first",6,7,3,2);
  assertRows(execute("select * from %s where a = ? and c in (?, ?) and b in (?, ?) order by b DESC","first",7,6,3,2),row("first",3,7,3),row("first",2,6,2));
  assertInvalidMessage("More than one restriction was found for the start bound on b","select * from %s where a = ? and b > ? and b > ?","first",6,3,2);
  assertInvalidMessage("More than one restriction was found for the end bound on b","select * from %s where a = ? and b < ? and b <= ?","first",6,3,2);
}
