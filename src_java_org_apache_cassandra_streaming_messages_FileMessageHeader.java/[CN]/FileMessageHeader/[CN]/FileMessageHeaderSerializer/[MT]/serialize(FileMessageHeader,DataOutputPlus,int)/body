{
  UUIDSerializer.serializer.serialize(header.cfId,out,version);
  out.writeInt(header.sequenceNumber);
  out.writeUTF(header.version);
  if (version < StreamMessage.VERSION_22 && header.format != SSTableFormat.Type.LEGACY && header.format != SSTableFormat.Type.BIG)   throw new UnsupportedOperationException("Can't stream non-legacy sstables to nodes < 2.2");
  if (version >= StreamMessage.VERSION_22)   out.writeUTF(header.format.name);
  out.writeLong(header.estimatedKeys);
  out.writeInt(header.sections.size());
  for (  Pair<Long,Long> section : header.sections) {
    out.writeLong(section.left);
    out.writeLong(section.right);
  }
  CompressionInfo.serializer.serialize(header.compressionInfo,out,version);
  out.writeLong(header.repairedAt);
  out.writeInt(header.sstableLevel);
}
