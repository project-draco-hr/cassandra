{
  logger_.debug("Started  hinted handoff " + columnFamilyStore_.columnFamily_);
  Table table=Table.open(DatabaseDescriptor.getTables().get(0));
  ColumnFamily hintedColumnFamily=null;
  boolean success=false;
  boolean allsuccess=true;
  try {
    hintedColumnFamily=table.get(key_,Table.hints_);
    if (hintedColumnFamily == null) {
      columnFamilyStore_.forceFlush(false);
      return;
    }
    Collection<IColumn> keys=hintedColumnFamily.getAllColumns();
    if (keys != null) {
      for (      IColumn key : keys) {
        Collection<IColumn> endpoints=key.getSubColumns();
        allsuccess=true;
        if (endpoints != null) {
          for (          IColumn endpoint : endpoints) {
            success=sendMessage(endpoint.name(),key.name());
            if (success) {
              deleteEndPoint(endpoint.name(),key.name());
            }
 else {
              allsuccess=false;
            }
          }
        }
        if (endpoints == null || allsuccess) {
          deleteKey(key.name());
        }
      }
    }
    columnFamilyStore_.forceFlush(false);
    columnFamilyStore_.forceCompaction(null,null,0,null);
  }
 catch (  Exception ex) {
    logger_.warn(ex.getMessage());
  }
  logger_.debug("Finished hinted handoff ..." + columnFamilyStore_.columnFamily_);
}
