{
  SocketChannel channel=SocketChannel.open();
  channel.socket().bind(new InetSocketAddress(FBUtilities.getLocalAddress(),0));
  int attempts=0;
  while (true) {
    try {
      channel.connect(new InetSocketAddress(to,DatabaseDescriptor.getStoragePort()));
      return channel;
    }
 catch (    IOException e) {
      if (++attempts >= MAX_CONNECT_ATTEMPTS)       throw e;
      long waitms=DatabaseDescriptor.getRpcTimeout() * (long)Math.pow(2,attempts);
      logger.warn("Failed attempt " + attempts + " to connect to "+ to+ " to stream "+ file+ ". Retrying in "+ waitms+ " ms. ("+ e+ ")");
      try {
        Thread.sleep(waitms);
      }
 catch (      InterruptedException wtf) {
        throw new RuntimeException(wtf);
      }
    }
  }
}
