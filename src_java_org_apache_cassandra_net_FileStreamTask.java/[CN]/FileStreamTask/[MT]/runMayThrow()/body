{
  SocketChannel channel=SocketChannel.open();
  channel.socket().bind(new InetSocketAddress(FBUtilities.getLocalAddress(),0));
  channel.connect(new InetSocketAddress(to,DatabaseDescriptor.getStoragePort()));
  try {
    stream(channel);
  }
  finally {
    try {
      channel.close();
    }
 catch (    IOException e) {
      if (logger.isDebugEnabled())       logger.debug("error closing socket",e);
    }
  }
  if (logger.isDebugEnabled())   logger.debug("Done streaming " + file);
}
