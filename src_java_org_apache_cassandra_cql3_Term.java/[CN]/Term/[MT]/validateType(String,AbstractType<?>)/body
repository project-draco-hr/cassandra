{
  if (skipTypeValidation)   return;
  Set<Type> supported=validator.supportedCQL3Constants();
  if (supported == null)   return;
  if (!supported.contains(type)) {
    if (type == Type.STRING && validator instanceof BytesType) {
      if (!stringAsBlobWarningLogged) {
        stringAsBlobWarningLogged=true;
        logger.warn("Inputing CLQ3 blobs as strings (like %s = '%s') is now deprecated and will be removed in a future version. " + "You should convert client code to use a blob constant (%s = %s) instead (see http://cassandra.apache.org/doc/cql3/CQL.html changelog section for more info).",identifier,text,identifier,"0x" + text);
      }
      return;
    }
    throw new InvalidRequestException(String.format("Invalid %s constant for %s of type %s",type,identifier,validator.asCQL3Type()));
  }
}
