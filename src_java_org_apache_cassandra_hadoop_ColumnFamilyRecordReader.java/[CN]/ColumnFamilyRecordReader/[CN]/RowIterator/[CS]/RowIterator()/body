{
  try {
    partitioner=FBUtilities.newPartitioner(client.describe_partitioner());
    Map<String,String> info=client.describe_keyspace(keyspace).get(cfName);
    comparator=FBUtilities.getComparator(info.get("CompareWith"));
    subComparator=info.get("CompareSubcolumnsWith") == null ? null : FBUtilities.getComparator(info.get("CompareSubcolumnsWith"));
  }
 catch (  ConfigurationException e) {
    throw new RuntimeException("unable to load sub/comparator",e);
  }
catch (  TException e) {
    throw new RuntimeException("error communicating via Thrift",e);
  }
catch (  NotFoundException e) {
    throw new RuntimeException("server reports no such keyspace " + keyspace,e);
  }
}
