{
  int targetSlices=Math.min(sstableDetails.size(),connectionsPerHost);
  int step=Math.round((float)sstableDetails.size() / (float)targetSlices);
  int index=0;
  List<List<StreamSession.SSTableStreamingSections>> result=new ArrayList<>();
  List<StreamSession.SSTableStreamingSections> slice=null;
  for (  StreamSession.SSTableStreamingSections streamSession : sstableDetails) {
    if (index % step == 0) {
      slice=new ArrayList<>();
      result.add(slice);
    }
    slice.add(streamSession);
    ++index;
  }
  return result;
}
