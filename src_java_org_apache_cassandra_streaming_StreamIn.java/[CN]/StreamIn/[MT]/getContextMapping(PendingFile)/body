{
  Descriptor remotedesc=remote.desc;
  if (!remotedesc.isStreamCompatible())   throw new UnsupportedOperationException(String.format("SSTable %s is not compatible with current version %s",remote.getFilename(),Descriptor.Version.CURRENT));
  Table table=Table.open(remotedesc.ksname);
  ColumnFamilyStore cfStore=table.getColumnFamilyStore(remotedesc.cfname);
  Directories.DataDirectory localDir=cfStore.directories.getLocationCapableOfSize(remote.size);
  if (localDir == null)   throw new RuntimeException("Insufficient disk space to store " + remote.size + " bytes");
  Descriptor localdesc=Descriptor.fromFilename(cfStore.getTempSSTablePath(cfStore.directories.getLocationForDisk(localDir)));
  return new PendingFile(localdesc,remote);
}
