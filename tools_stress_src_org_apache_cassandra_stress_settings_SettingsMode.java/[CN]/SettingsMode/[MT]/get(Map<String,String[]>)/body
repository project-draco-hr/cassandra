{
  String[] params=clArgs.remove("-mode");
  if (params == null) {
    ThriftOptions opts=new ThriftOptions();
    opts.smart.accept("smart");
    return new SettingsMode(opts);
  }
  GroupedOptions options=GroupedOptions.select(params,new ThriftOptions(),new Cql3NativeOptions(),new Cql3ThriftOptions(),new Cql3SimpleNativeOptions(),new Cql2ThriftOptions());
  if (options == null) {
    printHelp();
    System.out.println("Invalid -mode options provided, see output for valid options");
    System.exit(1);
  }
  return new SettingsMode(options);
}
