{
  if (Keyspace.open(cfm.ksName).hasColumnFamilyStore(cfm.cfId)) {
    ColumnFamilyStore cfs=Keyspace.open(cfm.ksName).getColumnFamilyStore(cfm.cfId);
    return create(cfs,descriptor,keyCount,repairedAt,sstableLevel,header);
  }
  LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.WRITE,descriptor.directory);
  MetadataCollector collector=new MetadataCollector(cfm.comparator).sstableLevel(sstableLevel);
  SSTableMultiWriter writer=SimpleSSTableMultiWriter.create(descriptor,keyCount,repairedAt,cfm,collector,header,txn);
  return new SSTableTxnWriter(txn,writer);
}
