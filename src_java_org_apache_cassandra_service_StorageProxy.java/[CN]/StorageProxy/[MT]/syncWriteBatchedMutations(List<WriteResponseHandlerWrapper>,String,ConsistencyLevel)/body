{
  for (  WriteResponseHandlerWrapper wrapper : wrappers) {
    try {
      Iterable<InetAddress> endpoints=Iterables.concat(wrapper.handler.naturalEndpoints,wrapper.handler.pendingEndpoints);
      sendToHintedEndpoints(wrapper.mutation,endpoints,wrapper.handler,localDataCenter,consistencyLevel);
    }
 catch (    IOException e) {
      throw new RuntimeException("Error writing key " + ByteBufferUtil.bytesToHex(wrapper.mutation.key()),e);
    }
catch (    OverloadedException e) {
      throw new WriteTimeoutException(consistencyLevel,-1,0,true);
    }
  }
  for (  WriteResponseHandlerWrapper wrapper : wrappers) {
    try {
      wrapper.handler.get();
    }
 catch (    WriteTimeoutException e) {
      if (logger.isDebugEnabled())       logger.debug("Write timeout {} for {}",e,wrapper.mutation.toString(true));
      throw new WriteTimeoutException(e.consistency,-1,e.blockFor,true);
    }
  }
}
