{
  List<Row> rows=new ArrayList<Row>();
  List<Future<Object>> localFutures=null;
  List<IAsyncResult> remoteResults=null;
  for (  ReadCommand command : commands) {
    InetAddress endPoint=StorageService.instance.findSuitableEndpoint(command.table,command.key);
    if (endPoint.equals(FBUtilities.getLocalAddress())) {
      if (logger.isDebugEnabled())       logger.debug("weakread reading " + command + " locally");
      if (localFutures == null)       localFutures=new ArrayList<Future<Object>>();
      Callable<Object> callable=new weakReadLocalCallable(command);
      localFutures.add(StageManager.getStage(StageManager.READ_STAGE).submit(callable));
    }
 else {
      if (remoteResults == null)       remoteResults=new ArrayList<IAsyncResult>();
      Message message=command.makeReadMessage();
      if (logger.isDebugEnabled())       logger.debug("weakread reading " + command + " from "+ message.getMessageId()+ "@"+ endPoint);
      if (randomlyReadRepair(command))       message.setHeader(ReadCommand.DO_REPAIR,ReadCommand.DO_REPAIR.getBytes());
      remoteResults.add(MessagingService.instance.sendRR(message,endPoint));
    }
  }
  if (localFutures != null) {
    for (    Future<Object> future : localFutures) {
      Row row;
      try {
        row=(Row)future.get();
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
      rows.add(row);
    }
  }
  if (remoteResults != null) {
    for (    IAsyncResult iar : remoteResults) {
      byte[] body;
      body=iar.get(DatabaseDescriptor.getRpcTimeout(),TimeUnit.MILLISECONDS);
      ByteArrayInputStream bufIn=new ByteArrayInputStream(body);
      ReadResponse response=ReadResponse.serializer().deserialize(new DataInputStream(bufIn));
      if (response.row() != null)       rows.add(response.row());
    }
  }
  return rows;
}
