{
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(command.metadata().cfId);
  SecondaryIndexSearcher searcher=cfs.indexManager.getBestIndexSearcherFor(command);
  float maxExpectedResults=searcher == null ? command.limits().estimateTotalResults(cfs) : searcher.highestSelectivityIndex(command.rowFilter()).estimateResultRows();
  return (maxExpectedResults / DatabaseDescriptor.getNumTokens()) / keyspace.getReplicationStrategy().getReplicationFactor();
}
