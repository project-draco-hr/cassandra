{
  String table=mutation.getTable();
  AbstractReplicationStrategy rs=Table.open(table).getReplicationStrategy();
  Pair<? extends Iterable<InetAddress>,? extends Iterable<InetAddress>> p=getWriteEndpoints(table,mutation.key());
  Iterable<InetAddress> writeEndpoints=p.left;
  Iterable<InetAddress> pendingEndpoints=p.right;
  Multimap<InetAddress,InetAddress> hintedEndpoints=rs.getHintedEndpoints(writeEndpoints);
  IWriteResponseHandler responseHandler=rs.getWriteResponseHandler(writeEndpoints,hintedEndpoints,pendingEndpoints,consistency_level);
  responseHandler.assureSufficientLiveNodes();
  performer.apply(mutation,hintedEndpoints,responseHandler,localDataCenter,consistency_level);
  return responseHandler;
}
