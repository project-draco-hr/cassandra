{
  TokenMetadata.Topology topology=StorageService.instance.getTokenMetadata().cloneOnlyTokenMap().getTopology();
  Collection<InetAddress> localMembers=topology.getDatacenterEndpoints().get(localDataCenter);
  if (localMembers.size() == 1)   return localMembers;
  localMembers.remove(FBUtilities.getBroadcastAddress());
  List<InetAddress> candidates=new ArrayList<InetAddress>(localMembers.size());
  for (  InetAddress member : localMembers) {
    if (FailureDetector.instance.isAlive(member))     candidates.add(member);
  }
  if (candidates.isEmpty()) {
    if (consistencyLevel == ConsistencyLevel.ANY)     return Collections.singleton(FBUtilities.getBroadcastAddress());
    throw new UnavailableException(ConsistencyLevel.ONE,1,0);
  }
  if (candidates.size() > 2) {
    IEndpointSnitch snitch=DatabaseDescriptor.getEndpointSnitch();
    snitch.sortByProximity(FBUtilities.getBroadcastAddress(),candidates);
    candidates=candidates.subList(0,2);
  }
  return candidates;
}
