{
switch (consistency_level) {
case ONE:
case ANY:
    return 1;
case QUORUM:
  return (expandedTargets / 2) + 1;
case DCQUORUM:
case DCQUORUMSYNC:
return expandedTargets;
case ALL:
return expandedTargets;
default :
throw new UnsupportedOperationException("invalid consistency level " + consistency_level);
}
}
