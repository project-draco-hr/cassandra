{
  logger.debug("Starting a blocking truncate operation on keyspace {}, CF ",keyspace,cfname);
  if (isAnyHostDown()) {
    logger.info("Cannot perform truncate, some hosts are down");
    throw new UnavailableException();
  }
  Set<InetAddress> allEndpoints=Gossiper.instance.getLiveMembers();
  int blockFor=allEndpoints.size();
  allEndpoints.remove(FBUtilities.getLocalAddress());
  final TruncateResponseHandler responseHandler=new TruncateResponseHandler(blockFor,keyspace);
  logger.debug("Starting to send truncate messages to hosts {}",allEndpoints);
  truncateLocal(keyspace,cfname,responseHandler);
  truncateRemotes(keyspace,cfname,allEndpoints,responseHandler);
  logger.debug("Sent all truncate messages, now waiting for {} responses",blockFor);
  responseHandler.get();
  logger.debug("truncate done");
}
