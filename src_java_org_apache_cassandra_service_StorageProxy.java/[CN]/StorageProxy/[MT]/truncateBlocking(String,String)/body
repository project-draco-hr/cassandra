{
  logger.debug("Starting a blocking truncate operation on keyspace {}, CF ",keyspace,cfname);
  if (isAnyHostDown()) {
    logger.info("Cannot perform truncate, some hosts are down");
    throw new UnavailableException();
  }
  Set<InetAddress> allEndpoints=Gossiper.instance.getLiveMembers();
  int blockFor=allEndpoints.size();
  final TruncateResponseHandler responseHandler=new TruncateResponseHandler(blockFor);
  logger.debug("Starting to send truncate messages to hosts {}",allEndpoints);
  Truncation truncation=new Truncation(keyspace,cfname);
  Message message=truncation.makeTruncationMessage();
  MessagingService.instance.sendRR(message,allEndpoints,responseHandler);
  logger.debug("Sent all truncate messages, now waiting for {} responses",blockFor);
  responseHandler.get();
  logger.debug("truncate done");
}
