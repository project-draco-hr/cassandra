{
  List<InetAddress> endpoints=StorageService.instance.getLiveNaturalEndpoints(table,key);
  DatabaseDescriptor.getEndpointSnitch().sortByProximity(FBUtilities.getLocalAddress(),endpoints);
  if (endpoints.isEmpty())   throw new UnavailableException();
  return endpoints.get(0);
}
