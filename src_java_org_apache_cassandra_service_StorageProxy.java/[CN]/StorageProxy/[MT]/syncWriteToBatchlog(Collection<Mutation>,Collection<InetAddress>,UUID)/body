{
  AbstractWriteResponseHandler handler=new WriteResponseHandler(endpoints,Collections.<InetAddress>emptyList(),ConsistencyLevel.ONE,Keyspace.open(Keyspace.SYSTEM_KS),null,WriteType.BATCH_LOG);
  MessageOut<Mutation> message=BatchlogManager.getBatchlogMutationFor(mutations,uuid,MessagingService.current_version).createMessage();
  for (  InetAddress target : endpoints) {
    int targetVersion=MessagingService.instance().getVersion(target);
    if (target.equals(FBUtilities.getBroadcastAddress()) && OPTIMIZE_LOCAL_REQUESTS) {
      insertLocal(message.payload,handler);
    }
 else     if (targetVersion == MessagingService.current_version) {
      MessagingService.instance().sendRR(message,target,handler,false);
    }
 else {
      MessagingService.instance().sendRR(BatchlogManager.getBatchlogMutationFor(mutations,uuid,targetVersion).createMessage(),target,handler,false);
    }
  }
  handler.get();
}
