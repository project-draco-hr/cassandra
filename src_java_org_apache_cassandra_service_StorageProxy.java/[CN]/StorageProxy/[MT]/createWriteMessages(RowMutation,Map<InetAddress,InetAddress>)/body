{
  Map<InetAddress,Message> messageMap=new HashMap<InetAddress,Message>();
  Message message=rm.makeRowMutationMessage();
  for (  Map.Entry<InetAddress,InetAddress> entry : endpointMap.entrySet()) {
    InetAddress target=entry.getKey();
    InetAddress hintedTarget=entry.getValue();
    if (target.equals(hintedTarget)) {
      messageMap.put(target,message);
    }
 else {
      Message hintedMessage=rm.makeRowMutationMessage();
      hintedMessage.addHeader(RowMutation.HINT,hintedTarget.getAddress());
      if (logger.isDebugEnabled())       logger.debug("Sending the hint of " + hintedTarget + " to "+ target);
      messageMap.put(hintedTarget,hintedMessage);
    }
  }
  return messageMap;
}
