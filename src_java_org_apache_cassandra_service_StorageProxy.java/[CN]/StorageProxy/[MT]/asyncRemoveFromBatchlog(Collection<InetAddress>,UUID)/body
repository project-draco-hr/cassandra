{
  AbstractWriteResponseHandler<IMutation> handler=new WriteResponseHandler<>(endpoints,Collections.<InetAddress>emptyList(),ConsistencyLevel.ANY,Keyspace.open(SystemKeyspace.NAME),null,WriteType.SIMPLE);
  Mutation mutation=new Mutation(PartitionUpdate.fullPartitionDelete(SystemKeyspace.Batches,UUIDType.instance.decompose(uuid),FBUtilities.timestampMicros(),FBUtilities.nowInSeconds()));
  MessageOut<Mutation> message=mutation.createMessage(MessagingService.Verb.BATCHLOG_MUTATION);
  for (  InetAddress target : endpoints) {
    int targetVersion=MessagingService.instance().getVersion(target);
    if (canDoLocalRequest(target)) {
      insertLocal(Stage.BATCHLOG_MUTATION,message.payload,handler);
    }
 else     if (targetVersion < MessagingService.VERSION_30) {
      MessagingService.instance().sendRR(mutation.createMessage(MessagingService.Verb.MUTATION),target,handler,false);
    }
 else {
      MessagingService.instance().sendRR(message,target,handler,false);
    }
  }
}
