{
  if (DatabaseDescriptor.hintedHandoffEnabled()) {
    if (DatabaseDescriptor.shouldHintByDC()) {
      final String dc=DatabaseDescriptor.getEndpointSnitch().getDatacenter(ep);
      if (!DatabaseDescriptor.hintedHandoffEnabled(dc)) {
        return false;
      }
    }
    boolean hintWindowExpired=Gossiper.instance.getEndpointDowntime(ep) > DatabaseDescriptor.getMaxHintWindow();
    if (hintWindowExpired) {
      HintedHandOffManager.instance.metrics.incrPastWindow(ep);
      Tracing.trace("Not hinting {} which has been down {}ms",ep,Gossiper.instance.getEndpointDowntime(ep));
    }
    return !hintWindowExpired;
  }
 else {
    return false;
  }
}
