{
  int bootstrapTargets=hintedTargets - naturalTargets;
  int blockFor;
  if (consistency_level == ConsistencyLevel.ONE) {
    blockFor=1 + bootstrapTargets;
  }
 else   if (consistency_level == ConsistencyLevel.QUORUM) {
    blockFor=(naturalTargets / 2) + 1 + bootstrapTargets;
  }
 else   if (consistency_level == ConsistencyLevel.DCQUORUM || consistency_level == ConsistencyLevel.DCQUORUMSYNC) {
    blockFor=naturalTargets;
  }
 else   if (consistency_level == ConsistencyLevel.ALL) {
    blockFor=naturalTargets + bootstrapTargets;
  }
 else {
    throw new UnsupportedOperationException("invalid consistency level " + consistency_level);
  }
  return blockFor;
}
