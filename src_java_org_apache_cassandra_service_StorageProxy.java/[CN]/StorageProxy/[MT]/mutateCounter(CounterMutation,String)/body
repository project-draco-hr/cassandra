{
  InetAddress endpoint=findSuitableEndpoint(cm.getTable(),cm.key());
  if (endpoint.equals(FBUtilities.getLocalAddress())) {
    return applyCounterMutationOnCoordinator(cm,localDataCenter);
  }
 else {
    String table=cm.getTable();
    AbstractReplicationStrategy rs=Table.open(table).getReplicationStrategy();
    Pair<? extends Iterable<InetAddress>,? extends Iterable<InetAddress>> p=getWriteEndpoints(table,cm.key());
    Iterable<InetAddress> writeEndpoints=p.left;
    Iterable<InetAddress> pendingEndpoints=p.right;
    Multimap<InetAddress,InetAddress> hintedEndpoints=rs.getHintedEndpoints(writeEndpoints);
    rs.getWriteResponseHandler(writeEndpoints,hintedEndpoints,pendingEndpoints,cm.consistency()).assureSufficientLiveNodes();
    IWriteResponseHandler responseHandler=WriteResponseHandler.create(endpoint);
    Message message=cm.makeMutationMessage(Gossiper.instance.getVersion(endpoint));
    if (logger.isDebugEnabled())     logger.debug("forwarding counter update of key " + ByteBufferUtil.bytesToHex(cm.key()) + " to "+ endpoint);
    MessagingService.instance().sendRR(message,endpoint,responseHandler);
    return responseHandler;
  }
}
