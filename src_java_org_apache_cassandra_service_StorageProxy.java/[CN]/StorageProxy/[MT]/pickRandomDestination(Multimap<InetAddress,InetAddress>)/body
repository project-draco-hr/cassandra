{
  Set<InetAddress> destinationSet=endpoints.keySet();
  if (destinationSet.contains(FBUtilities.getLocalAddress())) {
    return FBUtilities.getLocalAddress();
  }
 else {
    InetAddress[] destinations=destinationSet.toArray(new InetAddress[0]);
    return destinations[random.nextInt(destinations.length)];
  }
}
