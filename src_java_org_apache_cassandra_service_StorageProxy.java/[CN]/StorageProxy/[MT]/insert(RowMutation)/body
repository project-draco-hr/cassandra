{
  long startTime=System.currentTimeMillis();
  try {
    Map<EndPoint,EndPoint> endpointMap=StorageService.instance().getNStorageEndPointMap(rm.key());
    Map<EndPoint,Message> messageMap=createWriteMessages(rm,endpointMap);
    logger.debug("insert writing to [" + StringUtils.join(messageMap.keySet(),", ") + "]");
    for (    Map.Entry<EndPoint,Message> entry : messageMap.entrySet()) {
      MessagingService.getMessagingInstance().sendOneWay(entry.getValue(),entry.getKey());
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    if (writeOperations++ == Integer.MAX_VALUE) {
      writeOperations=1;
      writeLatency=0;
    }
    writeLatency+=System.currentTimeMillis() - startTime;
  }
}
