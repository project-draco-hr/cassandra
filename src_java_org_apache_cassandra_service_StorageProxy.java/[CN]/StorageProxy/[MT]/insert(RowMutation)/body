{
  long startTime=System.currentTimeMillis();
  try {
    InetAddress[] naturalEndpoints=StorageService.instance().getReadStorageEndPoints(rm.key());
    Map<InetAddress,InetAddress> endpointMap=StorageService.instance().getHintedStorageEndpointMap(rm.key(),naturalEndpoints);
    Map<InetAddress,Message> messageMap=createWriteMessages(rm,endpointMap);
    for (    Map.Entry<InetAddress,Message> entry : messageMap.entrySet()) {
      Message message=entry.getValue();
      InetAddress endpoint=entry.getKey();
      if (logger.isDebugEnabled())       logger.debug("insert writing key " + rm.key() + " to "+ message.getMessageId()+ "@"+ endpoint);
      MessagingService.instance().sendOneWay(message,endpoint);
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("error inserting key " + rm.key(),e);
  }
 finally {
    writeStats.add(System.currentTimeMillis() - startTime);
  }
}
