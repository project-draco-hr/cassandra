{
  long startTime=System.currentTimeMillis();
  try {
    Map<EndPoint,EndPoint> endpointMap=StorageService.instance().getNStorageEndPointMap(rm.key());
    Map<EndPoint,Message> messageMap=createWriteMessages(rm,endpointMap);
    logger.debug("insert writing key " + rm.key() + " to ["+ StringUtils.join(messageMap.keySet(),", ")+ "]");
    for (    Map.Entry<EndPoint,Message> entry : messageMap.entrySet()) {
      MessagingService.getMessagingInstance().sendOneWay(entry.getValue(),entry.getKey());
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    writeStats.add(System.currentTimeMillis() - startTime);
  }
}
