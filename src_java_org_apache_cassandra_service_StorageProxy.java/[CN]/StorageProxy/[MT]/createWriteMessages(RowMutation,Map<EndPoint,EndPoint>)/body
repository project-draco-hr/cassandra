{
  Map<EndPoint,Message> messageMap=new HashMap<EndPoint,Message>();
  Message message=rm.makeRowMutationMessage();
  for (  Map.Entry<EndPoint,EndPoint> entry : endpointMap.entrySet()) {
    EndPoint target=entry.getKey();
    EndPoint hint=entry.getValue();
    if (!target.equals(hint)) {
      Message hintedMessage=rm.makeRowMutationMessage();
      hintedMessage.addHeader(RowMutation.HINT,EndPoint.toBytes(hint));
      if (logger.isDebugEnabled())       logger.debug("Sending the hint of " + hint.getHost() + " to "+ target.getHost());
      messageMap.put(target,hintedMessage);
    }
 else {
      messageMap.put(target,message);
    }
  }
  return messageMap;
}
