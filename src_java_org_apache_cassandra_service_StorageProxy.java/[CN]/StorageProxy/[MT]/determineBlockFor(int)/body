{
  int blockFor;
  if (consistency_level == ConsistencyLevel.ONE) {
    blockFor=1;
  }
 else   if (consistency_level == ConsistencyLevel.QUORUM) {
    blockFor=(DatabaseDescriptor.getReplicationFactor() / 2) + 1;
  }
 else   if (consistency_level == ConsistencyLevel.ALL) {
    blockFor=DatabaseDescriptor.getReplicationFactor();
  }
 else {
    throw new UnsupportedOperationException("invalid consistency level " + consistency_level);
  }
  return blockFor;
}
