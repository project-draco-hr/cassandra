{
  try {
    ParsedStatement.Prepared prepared=prepareInternal(query);
    if (!(prepared.statement instanceof SelectStatement))     throw new IllegalArgumentException("Only SELECTs can be paged");
    SelectStatement select=(SelectStatement)prepared.statement;
    QueryPager pager=QueryPagers.localPager(select.getPageableCommand(makeInternalOptions(prepared,values)));
    return UntypedResultSet.create(select,pager,pageSize);
  }
 catch (  RequestValidationException e) {
    throw new RuntimeException("Error validating query" + e);
  }
}
