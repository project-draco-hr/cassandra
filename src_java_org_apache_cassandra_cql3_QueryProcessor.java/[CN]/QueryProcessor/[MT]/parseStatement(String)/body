{
  try {
    ErrorCollector errorCollector=new ErrorCollector(queryStr);
    CharStream stream=new ANTLRStringStream(queryStr);
    CqlLexer lexer=new CqlLexer(stream);
    lexer.addErrorListener(errorCollector);
    TokenStream tokenStream=new CommonTokenStream(lexer);
    CqlParser parser=new CqlParser(tokenStream);
    parser.addErrorListener(errorCollector);
    ParsedStatement statement=parser.query();
    errorCollector.throwFirstSyntaxError();
    return statement;
  }
 catch (  RuntimeException re) {
    throw new SyntaxException(String.format("Failed parsing statement: [%s] reason: %s %s",queryStr,re.getClass().getSimpleName(),re.getMessage()));
  }
catch (  RecognitionException e) {
    throw new SyntaxException("Invalid or malformed CQL query string: " + e.getMessage());
  }
}
