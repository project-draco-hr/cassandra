{
  Object[] node=currentNode();
  int r=0;
  if (!isLeaf(node)) {
    int i=currentIndex();
    if (node == endNode && i == endIndex)     return -1;
    r=1;
    successor();
    node=currentNode();
  }
  if (node == endNode) {
    if (currentIndex() == endIndex)     return r > 0 ? r : -1;
    r+=endIndex - currentIndex();
    setIndex(endIndex);
    return r;
  }
  int keyEnd=getLeafKeyEnd(node);
  r+=keyEnd - currentIndex();
  setIndex(keyEnd);
  successor();
  return r;
}
