{
  buffer.reset();
  boolean isFirst=true;
  if (start != null) {
    while (deserializer.hasNext() && deserializer.compareNextTo(start) <= 0 && !stopReadingDisk()) {
      isFirst=false;
      if (deserializer.nextIsRow())       deserializer.skipNext();
 else       updateOpenMarker((RangeTombstoneMarker)deserializer.readNext());
    }
  }
  if (openMarker != null) {
    RangeTombstone.Bound markerStart=start == null ? RangeTombstone.Bound.BOTTOM : RangeTombstone.Bound.fromSliceBound(start);
    buffer.add(new RangeTombstoneBoundMarker(markerStart,openMarker));
  }
  while (deserializer.hasNext() && (end == null || deserializer.compareNextTo(end) <= 0) && !stopReadingDisk()) {
    Unfiltered unfiltered=deserializer.readNext();
    if (!isFirst || includeFirst)     buffer.add(unfiltered);
    isFirst=false;
    if (unfiltered.isRangeTombstoneMarker())     updateOpenMarker((RangeTombstoneMarker)unfiltered);
  }
  if (openMarker != null) {
    RangeTombstone.Bound markerEnd=end == null ? RangeTombstone.Bound.TOP : RangeTombstone.Bound.fromSliceBound(end);
    buffer.add(new RangeTombstoneBoundMarker(markerEnd,getAndClearOpenMarker()));
  }
  buffer.build();
}
