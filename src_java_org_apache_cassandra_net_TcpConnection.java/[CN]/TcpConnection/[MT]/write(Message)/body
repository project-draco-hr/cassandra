{
  byte[] data=serializer_.serialize(message);
  if (data.length > 0) {
    boolean listening=(message.getFrom().equals(EndPoint.randomLocalEndPoint_)) ? false : true;
    ByteBuffer buffer=MessagingService.packIt(data,false,false,listening);
synchronized (this) {
      if (!pendingWrites_.isEmpty() || !socketChannel_.isConnected()) {
        pendingWrites_.add(buffer);
        return;
      }
      logger_.debug("Sending packets of size " + data.length);
      socketChannel_.write(buffer);
      if (buffer.remaining() > 0) {
        pendingWrites_.add(buffer);
        key_.interestOps(key_.interestOps() | SelectionKey.OP_WRITE);
      }
    }
  }
}
