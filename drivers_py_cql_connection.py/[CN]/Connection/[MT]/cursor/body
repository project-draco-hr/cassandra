def cursor(self):
    from cql import ProgrammingError
    if (not self.open_socket):
        raise ProgrammingError('Connection has been closed.')
    return Cursor(self)
