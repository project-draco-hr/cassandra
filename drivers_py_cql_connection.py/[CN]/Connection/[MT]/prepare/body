def prepare(self, query, *args):
    prepared_query = prepare(query, *args)
    match = Connection._cfamily_re.match(prepared_query)
    if match:
        self._cur_column_family = match.group(1)
        return prepared_query
    match = Connection._keyspace_re.match(prepared_query)
    if match:
        self._cur_keyspace = match.group(1)
        return prepared_query
    match = Connection._ddl_re.match(prepared_query)
    if match:
        if isinstance(self.decoder, SchemaDecoder):
            self.decoder.schema = self.__get_schema()
    return prepared_query
