{
  CellName name=column.name();
  while (true) {
    Column oldColumn=map.putIfAbsent(name,column);
    if (oldColumn == null) {
      indexer.insert(column);
      return column.dataSize();
    }
    Column reconciledColumn=column.reconcile(oldColumn,allocator);
    if (map.replace(name,oldColumn,reconciledColumn)) {
      if (reconciledColumn == column)       indexer.update(oldColumn,reconciledColumn);
 else       indexer.update(column,reconciledColumn);
      return reconciledColumn.dataSize() - oldColumn.dataSize();
    }
  }
}
