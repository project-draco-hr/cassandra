{
  ByteBuffer name=column.name();
  while (true) {
    Column oldColumn=map.putIfAbsent(name,column);
    if (oldColumn == null) {
      indexer.insert(column);
      return Pair.create(column.dataSize(),Long.MAX_VALUE);
    }
    Column reconciledColumn=column.reconcile(oldColumn,allocator);
    if (map.replace(name,oldColumn,reconciledColumn)) {
      indexer.update(oldColumn,reconciledColumn);
      return Pair.create(reconciledColumn.dataSize() - oldColumn.dataSize(),enableColUpdateTimeDelta ? Math.abs(oldColumn.timestamp - column.timestamp) : Long.MAX_VALUE);
    }
  }
}
