{
  Iterator<Column> iter=map.values().iterator();
  Iterator<Column> toRetain=columns.iterator();
  Column current=iter.hasNext() ? iter.next() : null;
  Column retain=toRetain.hasNext() ? toRetain.next() : null;
  Comparator<? super ByteBuffer> comparator=map.comparator();
  while (current != null && retain != null) {
    int c=comparator.compare(current.name(),retain.name());
    if (c == 0) {
      current=iter.hasNext() ? iter.next() : null;
      retain=toRetain.hasNext() ? toRetain.next() : null;
    }
 else     if (c < 0) {
      iter.remove();
      current=iter.hasNext() ? iter.next() : null;
    }
 else {
      retain=toRetain.hasNext() ? toRetain.next() : null;
    }
  }
  while (current != null) {
    iter.remove();
    current=iter.hasNext() ? iter.next() : null;
  }
}
