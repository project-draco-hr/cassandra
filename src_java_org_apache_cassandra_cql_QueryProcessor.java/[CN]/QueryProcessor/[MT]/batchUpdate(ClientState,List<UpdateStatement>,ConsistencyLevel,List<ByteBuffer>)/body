{
  String globalKeyspace=clientState.getKeyspace();
  List<IMutation> rowMutations=new ArrayList<IMutation>(updateStatements.size());
  List<String> cfamsSeen=new ArrayList<String>(updateStatements.size());
  for (  UpdateStatement update : updateStatements) {
    String keyspace=update.keyspace == null ? globalKeyspace : update.keyspace;
    if (!(cfamsSeen.contains(update.getColumnFamily()))) {
      clientState.hasColumnFamilyAccess(keyspace,update.getColumnFamily(),Permission.WRITE);
      cfamsSeen.add(update.getColumnFamily());
    }
    rowMutations.addAll(update.prepareRowMutations(keyspace,clientState,variables));
  }
  for (  IMutation mutation : rowMutations) {
    validateKey(mutation.key());
  }
  StorageProxy.mutate(rowMutations,consistency);
}
