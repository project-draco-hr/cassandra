{
  String keyspace=clientState.getKeyspace();
  List<RowMutation> rowMutations=new ArrayList<RowMutation>();
  List<String> cfamsSeen=new ArrayList<String>();
  for (  UpdateStatement update : updateStatements) {
    if (!(cfamsSeen.contains(update.getColumnFamily()))) {
      clientState.hasColumnFamilyAccess(update.getColumnFamily(),Permission.WRITE);
      cfamsSeen.add(update.getColumnFamily());
    }
    rowMutations.addAll(update.prepareRowMutations(keyspace,clientState));
  }
  try {
    StorageProxy.mutate(rowMutations,consistency);
  }
 catch (  org.apache.cassandra.thrift.UnavailableException e) {
    throw new UnavailableException();
  }
catch (  TimeoutException e) {
    throw new TimedOutException();
  }
}
