{
  String keyspace=clientState.getKeyspace();
  List<RowMutation> rowMutations=new ArrayList<RowMutation>();
  List<String> cfamsSeen=new ArrayList<String>();
  for (  UpdateStatement update : updateStatements) {
    if (!(cfamsSeen.contains(update.getColumnFamily()))) {
      clientState.hasColumnFamilyAccess(update.getColumnFamily(),Permission.WRITE);
      cfamsSeen.add(update.getColumnFamily());
    }
    ByteBuffer key=update.getKey().getByteBuffer();
    validateKey(key);
    validateColumnFamily(keyspace,update.getColumnFamily());
    RowMutation rm=new RowMutation(keyspace,key);
    for (    Map.Entry<Term,Term> column : update.getColumns().entrySet()) {
      validateColumn(keyspace,update.getColumnFamily(),column.getKey().getByteBuffer(),column.getValue().getByteBuffer());
      rm.add(new QueryPath(update.getColumnFamily(),null,column.getKey().getByteBuffer()),column.getValue().getByteBuffer(),System.currentTimeMillis());
    }
    rowMutations.add(rm);
  }
  try {
    StorageProxy.mutate(rowMutations,consistency);
  }
 catch (  org.apache.cassandra.thrift.UnavailableException e) {
    throw new UnavailableException();
  }
catch (  TimeoutException e) {
    throw new TimedOutException();
  }
}
