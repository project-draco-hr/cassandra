{
  Map<String,String> options=new HashMap<>(cfm.compactionStrategyOptions);
  Map<String,String> optionsWithThresholds=new HashMap<>(options);
  options.putIfAbsent(CFPropDefs.KW_MINCOMPACTIONTHRESHOLD,Integer.toString(cfm.getMinCompactionThreshold()));
  options.putIfAbsent(CFPropDefs.KW_MAXCOMPACTIONTHRESHOLD,Integer.toString(cfm.getMaxCompactionThreshold()));
  try {
    Map<String,String> unrecognizedOptions=(Map<String,String>)cfm.compactionStrategyClass.getMethod("validateOptions",Map.class).invoke(null,optionsWithThresholds);
    if (unrecognizedOptions.isEmpty())     options=optionsWithThresholds;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  options.put("class",cfm.compactionStrategyClass.getName());
  return options;
}
