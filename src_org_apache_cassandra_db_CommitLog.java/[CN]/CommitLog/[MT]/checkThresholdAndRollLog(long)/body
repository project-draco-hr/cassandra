{
  try {
    if (fileSize >= DatabaseDescriptor.getLogFileSizeThreshold() || forcedRollOver_) {
      if (logWriter_.getFileSize() >= DatabaseDescriptor.getLogFileSizeThreshold() || forcedRollOver_) {
        setNextFileName();
        String oldLogFile=logWriter_.getFileName();
        logWriter_.close();
        logWriter_=CommitLog.createWriter(logFile_);
        clHeaders_.put(oldLogFile,new CommitLogHeader(clHeader_));
        clHeader_.zeroPositions();
        writeCommitLogHeader(clHeader_.toByteArray(),false);
      }
    }
  }
 catch (  IOException e) {
    logger_.info(LogUtil.throwableToString(e));
  }
 finally {
    forcedRollOver_=false;
  }
}
