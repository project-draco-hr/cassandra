{
  if (ranges.size() == 0) {
    if (logger_.isDebugEnabled())     logger_.debug("No ranges to give scram ...");
    return;
  }
  for (  Range range : ranges) {
    StringBuilder sb=new StringBuilder("");
    sb.append(range.toString());
    sb.append(" ");
    if (logger_.isDebugEnabled())     logger_.debug("Beginning transfer process to " + target + " for ranges "+ sb.toString());
  }
  List<String> tables=DatabaseDescriptor.getTables();
  for (  String tName : tables) {
    Table table=Table.open(tName);
    if (logger_.isDebugEnabled())     logger_.debug("Flushing memtables ...");
    table.flush(false);
    if (logger_.isDebugEnabled())     logger_.debug("Forcing compaction ...");
    List<String> fileList=new ArrayList<String>();
    table.forceCompaction(ranges,target,fileList);
    doHandoff(target,fileList,tName);
  }
}
