{
  if (DatabaseDescriptor.getAuthenticator() instanceof AllowAllAuthenticator)   return;
  setupAuthKeyspace();
  setupTable(USERS_CF,USERS_CF_SCHEMA);
  DatabaseDescriptor.getAuthenticator().setup();
  DatabaseDescriptor.getAuthorizer().setup();
  MigrationManager.instance.register(new AuthMigrationListener());
  ScheduledExecutors.nonPeriodicTasks.schedule(new Runnable(){
    public void run(){
      setupDefaultSuperuser();
    }
  }
,SUPERUSER_SETUP_DELAY,TimeUnit.MILLISECONDS);
  try {
    String query=String.format("SELECT * FROM %s.%s WHERE name = ?",AUTH_KS,USERS_CF);
    selectUserStatement=(SelectStatement)QueryProcessor.parseStatement(query).prepare().statement;
  }
 catch (  RequestValidationException e) {
    throw new AssertionError(e);
  }
}
