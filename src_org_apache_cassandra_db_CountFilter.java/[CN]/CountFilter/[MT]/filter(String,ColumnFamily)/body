{
  String[] values=RowMutation.getColumnAndColumnFamily(cfNameParam);
  if (columnFamily == null)   return columnFamily;
  String cfName=columnFamily.name();
  ColumnFamily filteredCf=new ColumnFamily(cfName);
  if (countLimit_ <= 0) {
    isDone_=true;
    return filteredCf;
  }
  if (values.length == 1) {
    Collection<IColumn> columns=columnFamily.getAllColumns();
    for (    IColumn column : columns) {
      filteredCf.addColumn(column);
      countLimit_--;
      if (countLimit_ <= 0) {
        isDone_=true;
        return filteredCf;
      }
    }
  }
 else   if (values.length == 2 && DatabaseDescriptor.getColumnType(cfName).equals("Super")) {
    Collection<IColumn> columns=columnFamily.getAllColumns();
    for (    IColumn column : columns) {
      SuperColumn superColumn=(SuperColumn)column;
      SuperColumn filteredSuperColumn=new SuperColumn(superColumn.name());
      filteredCf.addColumn(filteredSuperColumn);
      Collection<IColumn> subColumns=superColumn.getSubColumns();
      for (      IColumn subColumn : subColumns) {
        filteredSuperColumn.addColumn(subColumn.name(),subColumn);
        countLimit_--;
        if (countLimit_ <= 0) {
          isDone_=true;
          return filteredCf;
        }
      }
    }
  }
 else {
    throw new UnsupportedOperationException();
  }
  return filteredCf;
}
