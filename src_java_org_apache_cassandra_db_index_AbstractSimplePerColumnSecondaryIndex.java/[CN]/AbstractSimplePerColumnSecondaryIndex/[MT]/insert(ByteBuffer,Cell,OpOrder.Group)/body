{
  DecoratedKey valueKey=getIndexKeyFor(getIndexedValue(rowKey,cell));
  ColumnFamily cfi=ArrayBackedSortedColumns.factory.create(indexCfs.metadata,false,1);
  CellName name=makeIndexColumnName(rowKey,cell);
  if (cell instanceof ExpiringCell) {
    ExpiringCell ec=(ExpiringCell)cell;
    cfi.addColumn(new BufferExpiringCell(name,ByteBufferUtil.EMPTY_BYTE_BUFFER,ec.timestamp(),ec.getTimeToLive(),ec.getLocalDeletionTime()));
  }
 else {
    cfi.addColumn(new BufferCell(name,ByteBufferUtil.EMPTY_BYTE_BUFFER,cell.timestamp()));
  }
  if (logger.isTraceEnabled())   logger.trace("applying index row {} in {}",indexCfs.metadata.getKeyValidator().getString(valueKey.getKey()),cfi);
  indexCfs.apply(valueKey,cfi,SecondaryIndexManager.nullUpdater,opGroup,null);
}
