{
  DecoratedKey valueKey=getIndexKeyFor(getIndexedValue(rowKey,cell));
  ColumnFamily cfi=ArrayBackedSortedColumns.factory.create(indexCfs.metadata);
  CellName name=makeIndexColumnName(rowKey,cell);
  if (cell instanceof ExpiringCell) {
    ExpiringCell ec=(ExpiringCell)cell;
    cfi.addColumn(new ExpiringCell(name,ByteBufferUtil.EMPTY_BYTE_BUFFER,ec.timestamp(),ec.getTimeToLive(),ec.getLocalDeletionTime()));
  }
 else {
    cfi.addColumn(new Cell(name,ByteBufferUtil.EMPTY_BYTE_BUFFER,cell.timestamp()));
  }
  if (logger.isDebugEnabled())   logger.debug("applying index row {} in {}",indexCfs.metadata.getKeyValidator().getString(valueKey.key),cfi);
  indexCfs.apply(valueKey,cfi,SecondaryIndexManager.nullUpdater);
}
