{
  Multimap<Integer,SSTableReader> byLevel=ArrayListMultimap.create();
  for (  SSTableReader sstable : sstables) {
    if (manifest.hasRepairedData() && !sstable.isRepaired())     byLevel.get(0).add(sstable);
 else     byLevel.get(sstable.getSSTableLevel()).add(sstable);
  }
  List<ICompactionScanner> scanners=new ArrayList<ICompactionScanner>(sstables.size());
  for (  Integer level : byLevel.keySet()) {
    if (level <= 0) {
      for (      SSTableReader sstable : byLevel.get(level))       scanners.add(sstable.getScanner(range,CompactionManager.instance.getRateLimiter()));
    }
 else {
      List<SSTableReader> intersecting=LeveledScanner.intersecting(byLevel.get(level),range);
      if (!intersecting.isEmpty())       scanners.add(new LeveledScanner(intersecting,range));
    }
  }
  return scanners;
}
