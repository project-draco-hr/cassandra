{
  if (currentScanner == null)   return endOfData();
  while (true) {
    if (currentScanner.hasNext())     return currentScanner.next();
    positionOffset+=currentScanner.getLengthInBytes();
    currentScanner.close();
    if (!sstableIterator.hasNext()) {
      currentScanner=null;
      return endOfData();
    }
    currentScanner=sstableIterator.next().getScanner(ranges,CompactionManager.instance.getRateLimiter());
  }
}
