{
  String snapshotDirectory=DatabaseDescriptor.getSnapshotDirectory();
  File snapshotDir=new File(snapshotDirectory);
  if (!snapshotDir.exists())   snapshotDir.mkdir();
  String currentSnapshotDir=null;
  if (clientSuppliedName != null && !clientSuppliedName.equals(""))   currentSnapshotDir=snapshotDirectory + System.getProperty("file.separator") + System.currentTimeMillis()+ "-"+ clientSuppliedName;
 else   currentSnapshotDir=snapshotDirectory + System.getProperty("file.separator") + System.currentTimeMillis();
  CommitLog.open(table_).snapshot(currentSnapshotDir);
  CommitLog.open(table_).setForcedRollOver();
  Set<String> columnFamilies=tableMetadata_.getColumnFamilies();
  for (  String columnFamily : columnFamilies) {
    ColumnFamilyStore cfStore=columnFamilyStores_.get(columnFamily);
    if (cfStore != null)     cfStore.snapshot(currentSnapshotDir);
  }
}
