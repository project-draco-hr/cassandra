{
  Change change=CBUtil.readEnumValue(Change.class,cb);
  if (version >= 3) {
    Target target=CBUtil.readEnumValue(Target.class,cb);
    String keyspace=CBUtil.readString(cb);
    String tableOrType=target == Target.KEYSPACE ? null : CBUtil.readString(cb);
    return new SchemaChange(change,target,keyspace,tableOrType);
  }
 else {
    String keyspace=CBUtil.readString(cb);
    String table=CBUtil.readString(cb);
    return new SchemaChange(change,table.isEmpty() ? Target.KEYSPACE : Target.TABLE,keyspace,table.isEmpty() ? null : table);
  }
}
