{
  Term v=value.prepare(receiver);
  if (!(receiver.type instanceof CollectionType)) {
    if (!(receiver.type instanceof CounterColumnType))     throw new InvalidRequestException(String.format("Invalid operation (%s) for non counter column %s",toString(receiver),receiver));
    return new Constants.Substracter(receiver.kind == ColumnDefinition.Kind.COMPACT_VALUE ? null : receiver.name,v);
  }
switch (((CollectionType)receiver.type).kind) {
case LIST:
    return new Lists.Discarder(receiver.name,v);
case SET:
  return new Sets.Discarder(receiver.name,v);
case MAP:
throw new InvalidRequestException(String.format("Invalid operation (%s) for map column %s",toString(receiver),receiver));
}
throw new AssertionError();
}
