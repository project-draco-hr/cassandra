{
  SinglePartitionReadCommand command=SinglePartitionReadCommand.create(isForThrift,metadata,nowInSec,columnFilter,RowFilter.NONE,limits,key,filter);
  final SinglePartitionPager pager=new SinglePartitionPager(command,null);
  int count=0;
  while (!pager.isExhausted()) {
    try (CountingPartitionIterator iter=new CountingPartitionIterator(pager.fetchPage(pageSize,consistencyLevel,state),limits,nowInSec)){
      PartitionIterators.consume(iter);
      count+=iter.counter().counted();
    }
   }
  return count;
}
