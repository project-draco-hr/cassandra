{
  long size=0;
  long warnThreshold=DatabaseDescriptor.getBatchSizeWarnThreshold();
  long failThreshold=DatabaseDescriptor.getBatchSizeFailThreshold();
  for (  ColumnFamily cf : cfs)   size+=cf.dataSize();
  if (size > warnThreshold) {
    Set<String> ksCfPairs=new HashSet<>();
    for (    ColumnFamily cf : cfs)     ksCfPairs.add(cf.metadata().ksName + "." + cf.metadata().cfName);
    String format="Batch of prepared statements for {} is of size {}, exceeding specified threshold of {} by {}.{}";
    if (size > failThreshold) {
      Tracing.trace(format,new Object[]{ksCfPairs,size,failThreshold,size - failThreshold," (see batch_size_fail_threshold_in_kb)"});
      logger.error(format,ksCfPairs,size,failThreshold,size - failThreshold," (see batch_size_fail_threshold_in_kb)");
      throw new InvalidRequestException(String.format("Batch too large"));
    }
 else     if (logger.isWarnEnabled()) {
      logger.warn(format,ksCfPairs,size,warnThreshold,size - warnThreshold,"");
    }
  }
}
