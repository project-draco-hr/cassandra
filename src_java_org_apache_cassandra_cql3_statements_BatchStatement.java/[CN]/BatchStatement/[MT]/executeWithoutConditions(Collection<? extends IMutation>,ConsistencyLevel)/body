{
  Iterable<ColumnFamily> cfs=Iterables.concat(Iterables.transform(mutations,new Function<IMutation,Collection<ColumnFamily>>(){
    public Collection<ColumnFamily> apply(    IMutation im){
      return im.getColumnFamilies();
    }
  }
));
  verifyBatchSize(cfs);
  boolean mutateAtomic=(type == Type.LOGGED && mutations.size() > 1);
  StorageProxy.mutateWithTriggers(mutations,cl,mutateAtomic);
}
