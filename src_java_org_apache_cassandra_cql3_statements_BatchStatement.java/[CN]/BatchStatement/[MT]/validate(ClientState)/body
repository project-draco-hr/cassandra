{
  if (getTimeToLive() != 0)   throw new InvalidRequestException("Global TTL on the BATCH statement is not supported.");
  ConsistencyLevel cLevel=null;
  for (  ModificationStatement statement : statements) {
    if (statement.isSetConsistencyLevel())     throw new InvalidRequestException("Consistency level must be set on the BATCH, not individual statements");
    if (isSetTimestamp() && statement.isSetTimestamp())     throw new InvalidRequestException("Timestamp must be set either on BATCH or individual statements");
    if (statement.getTimeToLive() < 0)     throw new InvalidRequestException("A TTL must be greater or equal to 0");
    if (isSetConsistencyLevel()) {
      getConsistencyLevel().validateForWrite(statement.keyspace());
    }
 else {
      ConsistencyLevel stmtCL=statement.getConsistencyLevel();
      if (cLevel != null && cLevel != stmtCL)       throw new InvalidRequestException("The tables involved in the BATCH have different default write consistency, you must explicitely set the BATCH consitency level with USING CONSISTENCY");
      cLevel=stmtCL;
    }
  }
}
