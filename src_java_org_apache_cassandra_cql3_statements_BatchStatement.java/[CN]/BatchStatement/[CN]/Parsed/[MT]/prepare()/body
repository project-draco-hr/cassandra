{
  VariableSpecifications boundNames=getBoundVariables();
  List<ModificationStatement> statements=new ArrayList<>(parsedStatements.size());
  boolean hasConditions=false;
  for (  ModificationStatement.Parsed parsed : parsedStatements) {
    ModificationStatement stmt=parsed.prepare(boundNames);
    if (stmt.hasConditions())     hasConditions=true;
    statements.add(stmt);
  }
  Attributes prepAttrs=attrs.prepare("[batch]","[batch]");
  prepAttrs.collectMarkerSpecification(boundNames);
  BatchStatement batchStatement=new BatchStatement(boundNames.size(),type,statements,prepAttrs,hasConditions);
  batchStatement.validate();
  return new ParsedStatement.Prepared(batchStatement,boundNames);
}
