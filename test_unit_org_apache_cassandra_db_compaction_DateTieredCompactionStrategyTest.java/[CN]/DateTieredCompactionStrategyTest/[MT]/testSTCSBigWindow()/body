{
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ByteBuffer bigValue=ByteBuffer.wrap(new byte[10000]);
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=40;
  long timestamp=System.currentTimeMillis();
  for (int r=0; r < numSSTables / 2; r++) {
    for (int i=0; i < 10; i++) {
      DecoratedKey key=Util.dk(String.valueOf(r));
      Mutation rm=new Mutation(KEYSPACE1,key.getKey());
      rm.add(CF_STANDARD1,Util.cellname("column"),bigValue,timestamp);
      rm.apply();
    }
    cfs.forceBlockingFlush();
  }
  for (int r=0; r < numSSTables / 2; r++) {
    DecoratedKey key=Util.dk(String.valueOf(r));
    Mutation rm=new Mutation(KEYSPACE1,key.getKey());
    rm.add(CF_STANDARD1,Util.cellname("column"),value,timestamp);
    rm.apply();
    cfs.forceBlockingFlush();
  }
  Map<String,String> options=new HashMap<>();
  options.put(SizeTieredCompactionStrategyOptions.MIN_SSTABLE_SIZE_KEY,"1");
  DateTieredCompactionStrategy dtcs=new DateTieredCompactionStrategy(cfs,options);
  for (  SSTableReader sstable : cfs.getSSTables())   dtcs.addSSTable(sstable);
  assertEquals(20,dtcs.getNextBackgroundTask(0).sstables.size());
}
