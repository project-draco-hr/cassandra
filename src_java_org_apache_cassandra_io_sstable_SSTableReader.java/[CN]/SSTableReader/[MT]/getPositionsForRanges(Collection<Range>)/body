{
  List<Pair<Long,Long>> positions=new ArrayList<Pair<Long,Long>>();
  for (  AbstractBounds range : AbstractBounds.normalize(ranges)) {
    long left=getPosition(new DecoratedKey(range.left,null),Operator.GT);
    if (left == -1)     continue;
    long right=getPosition(new DecoratedKey(range.right,null),Operator.GT);
    if (right == -1 || Range.isWrapAround(range.left,range.right))     right=length();
    if (left == right)     continue;
    positions.add(new Pair(Long.valueOf(left),Long.valueOf(right)));
  }
  return positions;
}
