{
  File summariesFile=new File(descriptor.filenameFor(Component.SUMMARY));
  if (summariesFile.exists())   FileUtils.deleteWithConfirm(summariesFile);
  DataOutputStreamAndChannel oStream=null;
  try {
    oStream=new DataOutputStreamAndChannel(new FileOutputStream(summariesFile));
    IndexSummary.serializer.serialize(summary,oStream,descriptor.version.hasSamplingLevel);
    ByteBufferUtil.writeWithLength(first.getKey(),oStream);
    ByteBufferUtil.writeWithLength(last.getKey(),oStream);
    ibuilder.serializeBounds(oStream);
    dbuilder.serializeBounds(oStream);
  }
 catch (  IOException e) {
    logger.debug("Cannot save SSTable Summary: ",e);
    if (summariesFile.exists())     FileUtils.deleteWithConfirm(summariesFile);
  }
 finally {
    FileUtils.closeQuietly(oStream);
  }
}
