{
  SegmentedFile.Builder ibuilder=SegmentedFile.getBuilder();
  SegmentedFile.Builder dbuilder=SegmentedFile.getBuilder();
  indexSummary=new IndexSummary();
  BufferedRandomAccessFile input=new BufferedRandomAccessFile(indexFilename(),"r");
  try {
    long indexSize=input.length();
    if (recreatebloom)     bf=BloomFilter.getFilter((int)(input.length() / 32),15);
    while (true) {
      long indexPosition=input.getFilePointer();
      if (indexPosition == indexSize)       break;
      DecoratedKey decoratedKey=decodeKey(partitioner,desc,FBUtilities.readShortByteArray(input));
      if (recreatebloom)       bf.add(decoratedKey.key);
      long dataPosition=input.readLong();
      indexSummary.maybeAddEntry(decoratedKey,indexPosition);
      ibuilder.addPotentialBoundary(indexPosition);
      dbuilder.addPotentialBoundary(dataPosition);
    }
    indexSummary.complete();
  }
  finally {
    input.close();
  }
  indexSummary.complete();
  ifile=ibuilder.complete(indexFilename());
  dfile=dbuilder.complete(getFilename());
}
