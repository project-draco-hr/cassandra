{
  SegmentedFile.Builder ibuilder=SegmentedFile.getBuilder(DatabaseDescriptor.getIndexAccessMode());
  SegmentedFile.Builder dbuilder=compression ? SegmentedFile.getCompressedBuilder() : SegmentedFile.getBuilder(DatabaseDescriptor.getDiskAccessMode());
  boolean summaryLoaded=loadSummary(this,ibuilder,dbuilder,metadata);
  if (recreateBloomFilter || !summaryLoaded)   buildSummary(recreateBloomFilter,ibuilder,dbuilder,summaryLoaded);
  if (components.contains(Component.PRIMARY_INDEX))   ifile=ibuilder.complete(descriptor.filenameFor(Component.PRIMARY_INDEX));
  dfile=dbuilder.complete(descriptor.filenameFor(Component.DATA));
  if (saveSummaryIfCreated && (recreateBloomFilter || !summaryLoaded))   saveSummary(this,ibuilder,dbuilder);
}
