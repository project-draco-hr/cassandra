{
  List<Pair<Long,Long>> positions=new ArrayList<Pair<Long,Long>>();
  for (  AbstractBounds<Token> range : AbstractBounds.normalize(ranges)) {
    AbstractBounds<RowPosition> keyRange=range.toRowBounds();
    long left=getPosition(keyRange.left,Operator.GT);
    if (left == -1)     continue;
    long right=getPosition(keyRange.right,Operator.GT);
    if (right == -1 || Range.isWrapAround(range.left,range.right))     right=uncompressedLength();
    if (left == right)     continue;
    positions.add(new Pair(Long.valueOf(left),Long.valueOf(right)));
  }
  return positions;
}
