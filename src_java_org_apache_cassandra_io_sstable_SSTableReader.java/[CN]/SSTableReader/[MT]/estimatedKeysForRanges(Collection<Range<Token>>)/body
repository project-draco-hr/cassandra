{
  long sampleKeyCount=0;
  List<Pair<Integer,Integer>> sampleIndexes=getSampleIndexesForRanges(indexSummary.getKeys(),ranges);
  for (  Pair<Integer,Integer> sampleIndexRange : sampleIndexes)   sampleKeyCount+=(sampleIndexRange.right - sampleIndexRange.left + 1);
  return Math.max(1,sampleKeyCount * DatabaseDescriptor.getIndexInterval());
}
