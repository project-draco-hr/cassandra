{
  CFMetaData metadata;
  if (descriptor.cfname.contains(".")) {
    int i=descriptor.cfname.indexOf(".");
    String parentName=descriptor.cfname.substring(0,i);
    CFMetaData parent=Schema.instance.getCFMetaData(descriptor.ksname,parentName);
    ColumnDefinition def=parent.getColumnDefinitionForIndex(descriptor.cfname.substring(i + 1));
    metadata=CFMetaData.newIndexMetadata(parent,def,KeysIndex.indexComparator());
  }
 else {
    metadata=Schema.instance.getCFMetaData(descriptor.ksname,descriptor.cfname);
  }
  return open(descriptor,metadata);
}
