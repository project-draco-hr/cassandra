{
  SegmentedFile.Builder ibuilder=new BufferedSegmentedFile.Builder();
  SegmentedFile.Builder dbuilder=compression ? SegmentedFile.getCompressedBuilder() : new BufferedSegmentedFile.Builder();
  IndexSummaryBuilder summaryBuilder=new IndexSummaryBuilder(1);
  RandomAccessReader in=RandomAccessReader.open(new File(descriptor.filenameFor(Component.PRIMARY_INDEX)),true);
  try {
    ByteBuffer key=ByteBufferUtil.readWithShortLength(in);
    first=decodeKey(partitioner,descriptor,key);
    summaryBuilder.maybeAddEntry(first,0);
    indexSummary=summaryBuilder.build(partitioner);
  }
  finally {
    FileUtils.closeQuietly(in);
  }
  last=null;
  ifile=ibuilder.complete(descriptor.filenameFor(Component.PRIMARY_INDEX));
  dfile=dbuilder.complete(descriptor.filenameFor(Component.DATA));
}
