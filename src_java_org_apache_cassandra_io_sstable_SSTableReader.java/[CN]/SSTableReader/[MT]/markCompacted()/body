{
  if (logger.isDebugEnabled())   logger.debug("Marking " + getFilename() + " compacted");
  if (isCompacted.getAndSet(true))   return false;
  try {
    if (!new File(descriptor.filenameFor(Component.COMPACTED_MARKER)).createNewFile())     throw new IOException("Compaction marker already exists");
  }
 catch (  IOException e) {
    throw new IOError(e);
  }
  return true;
}
