{
  List<Pair<Integer,Integer>> positions=new ArrayList<Pair<Integer,Integer>>();
  for (  Range<Token> range : Range.normalize(ranges)) {
    RowPosition leftPosition=range.left.maxKeyBound();
    RowPosition rightPosition=range.right.maxKeyBound();
    int left=summary.binarySearch(leftPosition);
    if (left < 0)     left=(left + 1) * -1;
 else     left=left + 1;
    if (left == summary.size())     continue;
    int right=Range.isWrapAround(range.left,range.right) ? summary.size() - 1 : summary.binarySearch(rightPosition);
    if (right < 0) {
      right=(right + 1) * -1;
      if (right == 0)       continue;
      right--;
    }
    if (left > right)     continue;
    positions.add(Pair.create(Integer.valueOf(left),Integer.valueOf(right)));
  }
  return positions;
}
