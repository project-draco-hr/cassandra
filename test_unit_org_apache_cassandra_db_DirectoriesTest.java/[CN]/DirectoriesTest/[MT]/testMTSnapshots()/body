{
  for (  final String cf : CFS) {
    final Directories directories=Directories.create(KS,cf);
    Assert.assertEquals(cfDir(cf),directories.getDirectoryForNewSSTables());
    final String n=Long.toString(System.nanoTime());
    Callable<File> directoryGetter=new Callable<File>(){
      public File call() throws Exception {
        Descriptor desc=new Descriptor(cfDir(cf),KS,cf,1,false);
        return directories.getSnapshotDirectory(desc,n);
      }
    }
;
    List<Future<File>> invoked=Executors.newFixedThreadPool(2).invokeAll(Arrays.asList(directoryGetter,directoryGetter));
    for (    Future<File> fut : invoked) {
      Assert.assertTrue(fut.get().exists());
    }
  }
}
