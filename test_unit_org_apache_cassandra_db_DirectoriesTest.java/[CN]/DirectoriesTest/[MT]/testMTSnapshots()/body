{
  for (  final CFMetaData cfm : CFM) {
    final Directories directories=new Directories(cfm);
    assertEquals(cfDir(cfm),directories.getDirectoryForNewSSTables());
    final String n=Long.toString(System.nanoTime());
    Callable<File> directoryGetter=new Callable<File>(){
      public File call() throws Exception {
        Descriptor desc=new Descriptor(cfDir(cfm),KS,cfm.cfName,1,SSTableFormat.Type.BIG);
        return Directories.getSnapshotDirectory(desc,n);
      }
    }
;
    List<Future<File>> invoked=Executors.newFixedThreadPool(2).invokeAll(Arrays.asList(directoryGetter,directoryGetter));
    for (    Future<File> fut : invoked) {
      assertTrue(fut.get().exists());
    }
  }
}
