{
  setLocation(location,job);
  TableInfo cfInfo=getCfInfo(loadSignature);
  ResourceSchema schema=new ResourceSchema();
  Map<ByteBuffer,AbstractType> validators=getValidatorMap(cfInfo);
  List<ResourceFieldSchema> allSchemaFields=new ArrayList<ResourceFieldSchema>();
  for (  ColumnInfo cdef : cfInfo.getColumns()) {
    ResourceFieldSchema valSchema=new ResourceFieldSchema();
    AbstractType<?> validator=validators.get(ByteBufferUtil.bytes(cdef.getName()));
    valSchema.setName(cdef.getName());
    valSchema.setType(StorageHelper.getPigType(validator));
    allSchemaFields.add(valSchema);
  }
  schema.setFields(allSchemaFields.toArray(new ResourceFieldSchema[allSchemaFields.size()]));
  return schema;
}
