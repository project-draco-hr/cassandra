{
  String query="SELECT column_name, component_index, type FROM system.schema_columns WHERE keyspace_name='" + keyspace + "' and columnfamily_name='"+ cfName+ "'";
  List<Row> rows=session.execute(query).all();
  if (CollectionUtils.isEmpty(rows)) {
    throw new RuntimeException("No table metadata found for " + keyspace + "."+ cfName);
  }
  int numberOfPartitionKeys=0;
  for (  Row row : rows)   if (row.getString(2).equals("partition_key"))   numberOfPartitionKeys++;
  String[] partitionKeyArray=new String[numberOfPartitionKeys];
  for (  Row row : rows) {
    String type=row.getString(2);
    String column=row.getString(0);
    if (type.equals("partition_key")) {
      int componentIndex=row.isNull(1) ? 0 : row.getInt(1);
      partitionKeyArray[componentIndex]=column;
    }
 else     if (type.equals("clustering_key")) {
      clusteringKeys.add(column);
    }
  }
  partitionKeys.addAll(Arrays.asList(partitionKeyArray));
}
