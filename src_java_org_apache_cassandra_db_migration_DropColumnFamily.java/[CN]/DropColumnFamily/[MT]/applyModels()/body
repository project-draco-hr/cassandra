{
  KSMetaData existing=DatabaseDescriptor.getTableDefinition(tableName);
  CFMetaData cfm=existing.cfMetaData().get(cfName);
  KSMetaData ksm=makeNewKeyspaceDefinition(existing);
  CFMetaData.purge(cfm);
  DatabaseDescriptor.setTableDefinition(ksm,newVersion);
  if (!clientMode) {
    Table.open(ksm.name).dropCf(cfm.cfId);
    SystemTable.markForRemoval(cfm);
    CommitLog.instance().forceNewSegment();
    Migration.cleanupDeadFiles(blockOnFileDeletion);
  }
}
