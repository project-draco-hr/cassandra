{
  ColumnFamilyStore cfs=Keyspace.open(KS).getColumnFamilyStore(CF);
  cfs.truncateBlocking();
  CacheService.instance.invalidateCounterCache();
  ColumnFamily cells=ArrayBackedSortedColumns.factory.create(cfs.metadata);
  cells.addColumn(new BufferCounterUpdateCell(cellname(1),1L,FBUtilities.timestampMicros()));
  cells.addColumn(new BufferCounterUpdateCell(cellname(2),2L,FBUtilities.timestampMicros()));
  new CounterMutation(new Mutation(KS,bytes(1),cells),ConsistencyLevel.ONE).apply();
  new CounterMutation(new Mutation(KS,bytes(2),cells),ConsistencyLevel.ONE).apply();
  CacheService.instance.counterCache.submitWrite(Integer.MAX_VALUE).get();
  CacheService.instance.invalidateCounterCache();
  assertEquals(0,CacheService.instance.counterCache.size());
  Keyspace ks=Schema.instance.removeKeyspaceInstance(KS);
  try {
    CacheService.instance.counterCache.loadSaved();
    assertEquals(0,CacheService.instance.counterCache.size());
  }
  finally {
    Schema.instance.storeKeyspaceInstance(ks);
  }
}
