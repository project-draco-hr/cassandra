{
  Map<String,AtomicInteger> dcEndpoints=new HashMap<String,AtomicInteger>();
  for (  String dc : strategy.getDatacenters())   dcEndpoints.put(dc,new AtomicInteger());
  for (  InetAddress destination : Iterables.concat(naturalEndpoints,pendingEndpoints)) {
    if (FailureDetector.instance.isAlive(destination)) {
      String destinationDC=snitch.getDatacenter(destination);
      dcEndpoints.get(destinationDC).incrementAndGet();
    }
  }
  for (  String dc : strategy.getDatacenters()) {
    if (dcEndpoints.get(dc).get() < responses.get(dc).get())     throw new UnavailableException(consistencyLevel,responses.get(dc).get(),dcEndpoints.get(dc).get());
  }
}
