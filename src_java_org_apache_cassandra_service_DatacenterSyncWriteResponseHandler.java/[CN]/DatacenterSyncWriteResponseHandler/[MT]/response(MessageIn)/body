{
  String dataCenter=message == null ? localdc : snitch.getDatacenter(message.from);
  responses.get(dataCenter).getAndDecrement();
  for (  AtomicInteger i : responses.values()) {
    if (i.get() > 0)     return;
  }
  condition.signal();
}
