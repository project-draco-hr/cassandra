{
  String dataCenter=message == null ? localdc : snitch.getDatacenter(message.getFrom());
  responses.get(dataCenter).getAndDecrement();
  for (  AtomicInteger i : responses.values()) {
    if (0 < i.get())     return;
  }
  condition.signal();
}
