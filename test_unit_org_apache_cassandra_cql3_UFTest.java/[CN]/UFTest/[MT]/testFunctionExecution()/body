{
  createTable("CREATE TABLE %s (v text PRIMARY KEY)");
  execute("INSERT INTO %s(v) VALUES (?)","aaa");
  execute("CREATE FUNCTION repeat (v text, n int) RETURNS text LANGUAGE java AS 'StringBuilder sb = new StringBuilder();\n" + "        for (int i = 0; i < n.intValue(); i++)\n" + "            sb.append(v);\n"+ "        return sb.toString();'");
  assertRows(execute("SELECT v FROM %s WHERE v=repeat(?, ?)","a",3),row("aaa"));
  assertEmpty(execute("SELECT v FROM %s WHERE v=repeat(?, ?)","a",2));
}
