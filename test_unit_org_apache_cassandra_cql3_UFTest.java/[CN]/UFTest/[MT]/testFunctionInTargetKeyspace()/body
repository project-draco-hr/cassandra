{
  createTable("CREATE TABLE %s (key int primary key, val double)");
  execute("CREATE TABLE " + KS_FOO + ".second_tab (key int primary key, val double)");
  String functionBody="\n" + "  return val;\n";
  String cql="CREATE OR REPLACE FUNCTION " + KS_FOO + ".jfitks(val double) RETURNS double LANGUAGE JAVA\n"+ "AS '"+ functionBody+ "';";
  execute(cql);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  assertInvalid("SELECT key, val, " + KEYSPACE + ".jfitks(val) FROM %s");
  execute("INSERT INTO " + KS_FOO + ".second_tab (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO " + KS_FOO + ".second_tab (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO " + KS_FOO + ".second_tab (key, val) VALUES (?, ?)",3,3d);
  assertRows(execute("SELECT key, val, jfitks(val) FROM " + KS_FOO + ".second_tab"),row(1,1d,1d),row(2,2d,2d),row(3,3d,3d));
}
