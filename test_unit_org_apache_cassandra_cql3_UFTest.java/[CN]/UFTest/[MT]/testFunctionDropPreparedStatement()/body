{
  createTable("CREATE TABLE %s (key int PRIMARY KEY, d double)");
  String fSin=createFunction(KEYSPACE_PER_TEST,"double","CREATE FUNCTION %s ( input double ) " + "RETURNS double " + "LANGUAGE java "+ "AS 'return Double.valueOf(Math.sin(input.doubleValue()));'");
  FunctionName fSinName=parseFunctionName(fSin);
  Assert.assertEquals(1,Functions.find(parseFunctionName(fSin)).size());
  ResultMessage.Prepared prepared=QueryProcessor.prepare(String.format("SELECT key, %s(d) FROM %s.%s",fSin,KEYSPACE,currentTable()),ClientState.forInternalCalls(),false);
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(prepared.statementId));
  execute("DROP FUNCTION " + fSin + "(double);");
  Assert.assertNull(QueryProcessor.instance.getPrepared(prepared.statementId));
  execute("CREATE FUNCTION " + fSin + " ( input double ) "+ "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf(Math.sin(input.doubleValue()));'");
  Assert.assertEquals(1,Functions.find(fSinName).size());
  prepared=QueryProcessor.prepare(String.format("SELECT key, %s(d) FROM %s.%s",fSin,KEYSPACE,currentTable()),ClientState.forInternalCalls(),false);
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(prepared.statementId));
  dropPerTestKeyspace();
  Assert.assertNull(QueryProcessor.instance.getPrepared(prepared.statementId));
}
