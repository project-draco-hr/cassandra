{
  createTable("CREATE TABLE %s (k text PRIMARY KEY, v int)");
  execute("INSERT INTO %s(k, v) VALUES (?, ?)","f2",1);
  execute("CREATE FUNCTION " + KEYSPACE + ".overloaded(v varchar) RETURNS text LANGUAGE java AS 'return \"f1\";'");
  execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".overloaded(i int) RETURNS text LANGUAGE java AS 'return \"f2\";'");
  execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".overloaded(v1 text, v2 text) RETURNS text LANGUAGE java AS 'return \"f3\";'");
  execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".overloaded(v ascii) RETURNS text LANGUAGE java AS 'return \"f1\";'");
  assertInvalid("CREATE FUNCTION " + KEYSPACE + ".overloaded(v varchar) RETURNS text LANGUAGE java AS 'return \"f1\";'");
  assertRows(execute("SELECT " + KEYSPACE + ".overloaded(k), "+ KEYSPACE+ ".overloaded(v), "+ KEYSPACE+ ".overloaded(k, k) FROM %s"),row("f1","f2","f3"));
  forcePreparedValues();
  assertInvalid("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded(?)","foo");
  stopForcingPreparedValues();
  assertEmpty(execute("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((text)?)","foo"));
  assertRows(execute("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((int)?)",3),row(1));
  assertEmpty(execute("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((ascii)?)","foo"));
  assertEmpty(execute("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((varchar)?)","foo"));
  assertInvalid("DROP FUNCTION " + KEYSPACE + ".overloaded(boolean)");
  assertInvalid("DROP FUNCTION " + KEYSPACE + ".overloaded(bigint)");
  assertInvalid("DROP FUNCTION " + KEYSPACE + ".overloaded");
  execute("DROP FUNCTION " + KEYSPACE + ".overloaded(varchar)");
  assertInvalid("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((text)?)","foo");
  execute("DROP FUNCTION " + KEYSPACE + ".overloaded(text, text)");
  assertInvalid("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((text)?,(text)?)","foo","bar");
  execute("DROP FUNCTION " + KEYSPACE + ".overloaded(ascii)");
  assertInvalid("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((ascii)?)","foo");
  assertRows(execute("SELECT v FROM %s WHERE k = " + KEYSPACE + ".overloaded((int)?)",3),row(1));
  execute("DROP FUNCTION " + KEYSPACE + ".overloaded");
}
