{
  createTable("CREATE TABLE %s (key int primary key, val double)");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS boolean LANGUAGE javascript\n" + "AS 'true;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,true));
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS boolean LANGUAGE javascript\n" + "AS 'false;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,false));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS int LANGUAGE javascript\n" + "AS '100;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,100));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS int LANGUAGE javascript\n" + "AS '100.;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,100));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS double LANGUAGE javascript\n" + "AS '100;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,100d));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS double LANGUAGE javascript\n" + "AS '100.;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,100d));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS bigint LANGUAGE javascript\n" + "AS '100;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,100L));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS bigint LANGUAGE javascript\n" + "AS '100.;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,100L));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS varint LANGUAGE javascript\n" + "AS '100;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,BigInteger.valueOf(100L)));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS varint LANGUAGE javascript\n" + "AS '100.;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,BigInteger.valueOf(100L)));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS decimal LANGUAGE javascript\n" + "AS '100;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,BigDecimal.valueOf(100d)));
  execute("DROP FUNCTION js(double)");
  execute("CREATE OR REPLACE FUNCTION js(val double) RETURNS decimal LANGUAGE javascript\n" + "AS '100.;';");
  assertRows(execute("SELECT key, val, js(val) FROM %s"),row(1,1d,BigDecimal.valueOf(100d)));
  execute("DROP FUNCTION js(double)");
}
