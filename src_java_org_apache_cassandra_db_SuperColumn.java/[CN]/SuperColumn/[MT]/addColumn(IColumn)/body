{
  if (!(column instanceof Column))   throw new UnsupportedOperationException("A super column can only contain simple columns.");
  try {
    getComparator().validate(column.name());
  }
 catch (  Exception e) {
    throw new MarshalException("Invalid column name in supercolumn for " + getComparator().getClass().getName());
  }
  IColumn oldColumn=columns_.get(column.name());
  if (oldColumn == null) {
    columns_.put(column.name(),column);
    size_.addAndGet(column.size());
  }
 else {
    if (((Column)oldColumn).comparePriority((Column)column) <= 0) {
      columns_.put(column.name(),column);
      int delta=(-1) * oldColumn.size();
      size_.addAndGet(delta);
      size_.addAndGet(column.size());
    }
  }
}
