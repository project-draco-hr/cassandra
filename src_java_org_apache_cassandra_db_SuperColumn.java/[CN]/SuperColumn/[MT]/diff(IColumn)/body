{
  IClock _markedForDeleteAt=markedForDeleteAt.get();
  IColumn columnDiff=new SuperColumn(columnNew.name(),((SuperColumn)columnNew).getComparator(),_markedForDeleteAt.type(),reconciler);
  ClockRelationship rel=columnNew.getMarkedForDeleteAt().compare(_markedForDeleteAt);
  if (ClockRelationship.GREATER_THAN == rel) {
    ((SuperColumn)columnDiff).markForDeleteAt(columnNew.getLocalDeletionTime(),columnNew.getMarkedForDeleteAt());
  }
  for (  IColumn subColumn : columnNew.getSubColumns()) {
    IColumn columnInternal=columns_.get(subColumn.name());
    if (columnInternal == null) {
      columnDiff.addColumn(subColumn);
    }
 else {
      IColumn subColumnDiff=columnInternal.diff(subColumn);
      if (subColumnDiff != null) {
        columnDiff.addColumn(subColumnDiff);
      }
    }
  }
  if (!columnDiff.getSubColumns().isEmpty() || columnNew.isMarkedForDelete())   return columnDiff;
 else   return null;
}
