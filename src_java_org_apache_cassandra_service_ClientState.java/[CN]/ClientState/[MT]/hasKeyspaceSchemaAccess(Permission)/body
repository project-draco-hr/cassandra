{
  validateLogin();
  if (keyspace != null && keyspace.equalsIgnoreCase(Table.SYSTEM_TABLE) && perm == Permission.WRITE)   throw new InvalidRequestException("system keyspace is not user-modifiable");
  resourceClear();
  Set<Permission> perms=DatabaseDescriptor.getAuthority().authorize(user,resource);
  hasAccess(user,perms,perm,resource);
}
