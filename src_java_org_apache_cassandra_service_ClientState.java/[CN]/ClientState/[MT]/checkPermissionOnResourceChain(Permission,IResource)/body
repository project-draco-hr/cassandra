{
  for (  IResource r : Resources.chain(resource))   if (authorize(r).contains(perm))   return;
  throw new UnauthorizedException(String.format("User %s has no %s permission on %s or any of its parents",user.getName(),perm,resource));
}
