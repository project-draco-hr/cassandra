{
  if (!((perm == Permission.ALTER) || (perm == Permission.DROP) || (perm == Permission.CREATE)))   return;
  if (SystemKeyspace.NAME.equalsIgnoreCase(keyspace))   throw new UnauthorizedException(keyspace + " keyspace is not user-modifiable.");
  Set<String> allowAlter=Sets.newHashSet(Auth.AUTH_KS,TraceKeyspace.NAME);
  if (allowAlter.contains(keyspace.toLowerCase()) && !(resource.isKeyspaceLevel() && (perm == Permission.ALTER)))   throw new UnauthorizedException(String.format("Cannot %s %s",perm,resource));
}
