{
  validateKeyspace(keyspace);
  if (isInternal)   return;
  validateLogin();
  preventSystemKSSchemaModification(keyspace,resource,perm);
  if (perm.equals(Permission.SELECT) && READABLE_SYSTEM_RESOURCES.contains(resource))   return;
  if (PROTECTED_AUTH_RESOURCES.contains(resource))   if (perm.equals(Permission.CREATE) || perm.equals(Permission.ALTER) || perm.equals(Permission.DROP))   throw new UnauthorizedException(String.format("%s schema is protected",resource));
  ensureHasPermission(perm,resource);
}
