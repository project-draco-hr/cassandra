{
  byte[] nodeId=node.getAddress();
  int idCount=context.length / stepLength;
  for (int stepOffset=0; stepOffset < idCount; ++stepOffset) {
    int offset=stepOffset * stepLength;
    int cmp=FBUtilities.compareByteSubArrays(nodeId,0,context,offset,idLength);
    if (cmp == 0) {
      long clock=FBUtilities.byteArrayToLong(context,offset + idLength);
      long count=FBUtilities.byteArrayToLong(context,offset + idLength + clockLength);
      writeElementAtStepOffset(context,stepOffset,nodeId,clock + 1L,count + delta);
      return context;
    }
    if (cmp < 0) {
      return insertElementAtStepOffset(context,stepOffset,nodeId,1L,delta);
    }
  }
  return insertElementAtStepOffset(context,idCount,nodeId,1L,delta);
}
