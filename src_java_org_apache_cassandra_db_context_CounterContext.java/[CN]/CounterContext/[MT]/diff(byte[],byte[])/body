{
  left=sortElementsById(left);
  right=sortElementsById(right);
  ContextRelationship relationship=ContextRelationship.EQUAL;
  int leftIndex=0;
  int rightIndex=0;
  while (leftIndex < left.length && rightIndex < right.length) {
    int compareId=FBUtilities.compareByteSubArrays(left,leftIndex,right,rightIndex,idLength);
    if (compareId == 0) {
      long leftClock=FBUtilities.byteArrayToLong(left,leftIndex + idLength);
      long rightClock=FBUtilities.byteArrayToLong(right,rightIndex + idLength);
      leftIndex+=stepLength;
      rightIndex+=stepLength;
      if (leftClock == rightClock) {
        continue;
      }
 else       if (leftClock > rightClock) {
        if (relationship == ContextRelationship.EQUAL) {
          relationship=ContextRelationship.GREATER_THAN;
        }
 else         if (relationship == ContextRelationship.GREATER_THAN) {
          continue;
        }
 else {
          return ContextRelationship.DISJOINT;
        }
      }
 else {
        if (relationship == ContextRelationship.EQUAL) {
          relationship=ContextRelationship.LESS_THAN;
        }
 else         if (relationship == ContextRelationship.GREATER_THAN) {
          return ContextRelationship.DISJOINT;
        }
 else {
          continue;
        }
      }
    }
 else     if (compareId > 0) {
      rightIndex+=stepLength;
      if (relationship == ContextRelationship.EQUAL) {
        relationship=ContextRelationship.LESS_THAN;
      }
 else       if (relationship == ContextRelationship.GREATER_THAN) {
        return ContextRelationship.DISJOINT;
      }
 else {
        continue;
      }
    }
 else {
      leftIndex+=stepLength;
      if (relationship == ContextRelationship.EQUAL) {
        relationship=ContextRelationship.GREATER_THAN;
      }
 else       if (relationship == ContextRelationship.GREATER_THAN) {
        continue;
      }
 else {
        return ContextRelationship.DISJOINT;
      }
    }
  }
  if (leftIndex < left.length) {
    if (relationship == ContextRelationship.EQUAL) {
      return ContextRelationship.GREATER_THAN;
    }
 else     if (relationship == ContextRelationship.LESS_THAN) {
      return ContextRelationship.DISJOINT;
    }
  }
 else   if (rightIndex < right.length) {
    if (relationship == ContextRelationship.EQUAL) {
      return ContextRelationship.LESS_THAN;
    }
 else     if (relationship == ContextRelationship.GREATER_THAN) {
      return ContextRelationship.DISJOINT;
    }
  }
  return relationship;
}
