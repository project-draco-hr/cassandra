{
  setNextFileName();
  logWriter_=CommitLog.createWriter(logFile_);
  writeCommitLogHeader();
  if (DatabaseDescriptor.getCommitLogSync() == DatabaseDescriptor.CommitLogSync.periodic) {
    final Runnable syncer=new WrappedRunnable(){
      public void runMayThrow() throws IOException {
        sync();
      }
    }
;
    new Thread(new Runnable(){
      public void run(){
        while (true) {
          executor.submit(syncer);
          try {
            Thread.sleep(DatabaseDescriptor.getCommitLogSyncPeriod());
          }
 catch (          InterruptedException e) {
            throw new AssertionError(e);
          }
        }
      }
    }
,"PERIODIC-COMMIT-LOG-SYNCER").start();
  }
}
