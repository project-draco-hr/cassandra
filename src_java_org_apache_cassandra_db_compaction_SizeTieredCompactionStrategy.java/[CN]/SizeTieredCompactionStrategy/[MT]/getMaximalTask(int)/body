{
  Iterable<SSTableReader> allSSTables=cfs.markAllCompacting();
  if (allSSTables == null)   return null;
  Set<SSTableReader> sstables=Sets.newHashSet(allSSTables);
  Set<SSTableReader> repaired=new HashSet<>();
  Set<SSTableReader> unrepaired=new HashSet<>();
  for (  SSTableReader sstable : sstables) {
    if (sstable.isRepaired())     repaired.add(sstable);
 else     unrepaired.add(sstable);
  }
  return Arrays.<AbstractCompactionTask>asList(new CompactionTask(cfs,repaired,gcBefore),new CompactionTask(cfs,unrepaired,gcBefore));
}
