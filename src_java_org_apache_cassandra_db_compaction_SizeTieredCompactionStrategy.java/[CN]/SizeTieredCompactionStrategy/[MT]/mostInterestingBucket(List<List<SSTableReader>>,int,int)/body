{
  List<List<SSTableReader>> prunedBuckets=new ArrayList<List<SSTableReader>>();
  for (  List<SSTableReader> bucket : buckets) {
    if (bucket.size() < minThreshold)     continue;
    Collections.sort(bucket,generationComparator);
    List<SSTableReader> prunedBucket=bucket.subList(0,Math.min(bucket.size(),maxThreshold));
    prunedBuckets.add(prunedBucket);
  }
  if (prunedBuckets.isEmpty())   return Collections.emptyList();
  return Collections.min(prunedBuckets,avgBucketSizeComparator);
}
