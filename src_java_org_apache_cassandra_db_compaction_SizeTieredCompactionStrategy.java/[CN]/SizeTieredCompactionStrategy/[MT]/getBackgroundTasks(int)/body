{
  if (cfs.isCompactionDisabled()) {
    logger.debug("Compaction is currently disabled.");
    return Collections.<AbstractCompactionTask>emptyList();
  }
  List<AbstractCompactionTask> tasks=new LinkedList<AbstractCompactionTask>();
  List<List<SSTableReader>> buckets=getBuckets(createSSTableAndLengthPairs(cfs.getSSTables()),minSSTableSize);
  for (  List<SSTableReader> bucket : buckets) {
    if (bucket.size() < cfs.getMinimumCompactionThreshold())     continue;
    Collections.sort(bucket);
    tasks.add(new CompactionTask(cfs,bucket.subList(0,Math.min(bucket.size(),cfs.getMaximumCompactionThreshold())),gcBefore));
  }
  updateEstimatedCompactionsByTasks(tasks);
  return tasks;
}
