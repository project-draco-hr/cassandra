{
  validateTable(tablename);
  if (cfName.isEmpty())   throw new InvalidRequestException("non-empty columnfamily is required");
  CFMetaData metadata=DatabaseDescriptor.getCFMetaData(tablename,cfName);
  if (metadata == null)   throw new InvalidRequestException("unconfigured columnfamily " + cfName);
  if (isCommutativeOp) {
    if (!metadata.getDefaultValidator().isCommutative())     throw new InvalidRequestException("invalid operation for non commutative columnfamily " + cfName);
  }
 else {
    if (metadata.getDefaultValidator().isCommutative())     throw new InvalidRequestException("invalid operation for commutative columnfamily " + cfName);
  }
  return metadata;
}
