{
  SliceRange sr=sp.slice_range;
  IDiskAtomFilter filter;
  if (sr == null) {
    AbstractType<?> comparator=metadata.isSuper() ? ((CompositeType)metadata.comparator).types.get(superColumn == null ? 0 : 1) : metadata.comparator;
    SortedSet<ByteBuffer> ss=new TreeSet<ByteBuffer>(comparator);
    ss.addAll(sp.column_names);
    filter=new NamesQueryFilter(ss);
  }
 else {
    filter=new SliceQueryFilter(sr.start,sr.finish,sr.reversed,sr.count);
  }
  if (metadata.isSuper())   filter=SuperColumns.fromSCFilter((CompositeType)metadata.comparator,superColumn,filter);
  return filter;
}
