{
  validateTtl(column);
  if (!column.isSetValue())   throw new org.apache.cassandra.exceptions.InvalidRequestException("Column value is required");
  if (!column.isSetTimestamp())   throw new org.apache.cassandra.exceptions.InvalidRequestException("Column timestamp is required");
  CellName cn=scName == null ? metadata.comparator.cellFromByteBuffer(column.name) : metadata.comparator.makeCellName(scName,column.name);
  try {
    AbstractType<?> validator=metadata.getValueValidator(cn);
    if (validator != null)     validator.validate(column.value);
  }
 catch (  MarshalException me) {
    if (logger.isDebugEnabled())     logger.debug("rejecting invalid value {}",ByteBufferUtil.bytesToHex(summarize(column.value)));
    throw new org.apache.cassandra.exceptions.InvalidRequestException(String.format("(%s) [%s][%s][%s] failed validation",me.getMessage(),metadata.ksName,metadata.cfName,(SuperColumns.getComparatorFor(metadata,scName != null)).getString(column.name)));
  }
  SecondaryIndex failedIndex=Keyspace.open(metadata.ksName).getColumnFamilyStore(metadata.cfName).indexManager.validate(key,asDBColumn(cn,column));
  if (failedIndex != null)   throw new org.apache.cassandra.exceptions.InvalidRequestException(String.format("Can't index column value of size %d for index %s in CF %s of KS %s",column.value.remaining(),failedIndex.getIndexName(),metadata.cfName,metadata.ksName));
}
