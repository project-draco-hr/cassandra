{
  if (ks_def.name.length() > 32)   throw new ConfigurationException(String.format("Keyspace names shouldn't be more than 32 character long (got \"%s\")",ks_def.name));
  Map<String,String> options=KSMetaData.forwardsCompatibleOptions(ks_def);
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  IEndpointSnitch eps=DatabaseDescriptor.getEndpointSnitch();
  Class<? extends AbstractReplicationStrategy> cls=AbstractReplicationStrategy.getClass(ks_def.strategy_class);
  if (cls.equals(LocalStrategy.class))   throw new ConfigurationException("Unable to use given strategy class: LocalStrategy is reserved for internal use.");
  AbstractReplicationStrategy.createReplicationStrategy(ks_def.name,cls,tmd,eps,options);
}
