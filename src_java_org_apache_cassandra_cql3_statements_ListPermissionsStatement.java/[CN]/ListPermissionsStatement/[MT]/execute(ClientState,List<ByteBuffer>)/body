{
  List<PermissionDetails> details=new ArrayList<PermissionDetails>();
  if (resource != null && recursive) {
    for (    IResource r : Resources.chain(resource))     details.addAll(state.listPermissions(permissions,r,username));
  }
 else {
    details.addAll(state.listPermissions(permissions,resource,username));
  }
  Collections.sort(details);
  return resultMessage(details);
}
