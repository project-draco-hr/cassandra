{
  List<Integer> versions=new ArrayList<Integer>();
  versions.add(epState.getHeartBeatState().getHeartBeatVersion());
  Map<String,ApplicationState> appStateMap=epState.getApplicationStateMap();
  for (  ApplicationState value : appStateMap.values()) {
    int stateVersion=value.version;
    versions.add(stateVersion);
  }
  Collections.sort(versions);
  int maxVersion=versions.get(versions.size() - 1);
  versions.clear();
  return maxVersion;
}
