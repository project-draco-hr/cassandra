{
  List<Integer> versions=new ArrayList<Integer>();
  versions.add(epState.getHeartBeatState().getHeartBeatVersion());
  Map<String,ApplicationState> appStateMap=epState.getApplicationStateMap();
  Set<String> keys=appStateMap.keySet();
  for (  String key : keys) {
    int stateVersion=appStateMap.get(key).getStateVersion();
    versions.add(stateVersion);
  }
  Collections.sort(versions);
  int maxVersion=versions.get(versions.size() - 1);
  versions.clear();
  return maxVersion;
}
