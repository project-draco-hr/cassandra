{
  if (MessagingService.instance().getVersion(addr) < MessagingService.VERSION_20) {
    realMarkAlive(addr,localState);
    return;
  }
  if (localState.hasPendingEcho()) {
    logger.debug("{} has already a pending echo, skipping it",localState);
    return;
  }
  localState.markDead();
  MessageOut<EchoMessage> echoMessage=new MessageOut<EchoMessage>(MessagingService.Verb.ECHO,new EchoMessage(),EchoMessage.serializer);
  logger.trace("Sending a EchoMessage to {}",addr);
  IAsyncCallback echoHandler=new IAsyncCallback(){
    public boolean isLatencyForSnitch(){
      return false;
    }
    public void response(    MessageIn msg){
      localState.markPendingEcho(false);
      realMarkAlive(addr,localState);
    }
  }
;
  localState.markPendingEcho(true);
  MessagingService.instance().sendRR(echoMessage,addr,echoHandler);
}
