{
  HeartBeatState localHbState=localState.getHeartBeatState();
  HeartBeatState remoteHbState=remoteState.getHeartBeatState();
  if (remoteHbState.getGeneration() > localHbState.getGeneration()) {
    localState.setHeartBeatState(remoteHbState);
  }
  if (localHbState.getGeneration() == remoteHbState.getGeneration()) {
    if (remoteHbState.getHeartBeatVersion() > localHbState.getHeartBeatVersion()) {
      int oldVersion=localHbState.getHeartBeatVersion();
      localState.setHeartBeatState(remoteHbState);
      if (logger_.isTraceEnabled())       logger_.trace("Updating heartbeat state version to " + localState.getHeartBeatState().getHeartBeatVersion() + " from "+ oldVersion+ " for "+ addr+ " ...");
    }
  }
}
