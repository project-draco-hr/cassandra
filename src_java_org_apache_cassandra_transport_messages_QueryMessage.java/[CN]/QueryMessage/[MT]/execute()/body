{
  try {
    return QueryProcessor.process(query,connection.clientState());
  }
 catch (  Exception e) {
    if (!((e instanceof UnavailableException) || (e instanceof InvalidRequestException) || (e instanceof TimedOutException))) {
      logger.error("Unexpected error during query",e);
    }
    return ErrorMessage.fromException(e);
  }
}
