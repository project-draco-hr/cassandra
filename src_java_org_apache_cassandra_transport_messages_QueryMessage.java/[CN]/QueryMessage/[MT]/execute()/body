{
  try {
    return QueryProcessor.process(query,((ServerConnection)connection).clientState());
  }
 catch (  Exception e) {
    if (!((e instanceof RequestValidationException) || (e instanceof RequestExecutionException)))     logger.error("Unexpected error during query",e);
    return ErrorMessage.fromException(e);
  }
}
