{
  lock.writeLock().lock();
  try {
    if (bootstrapState) {
      bootstrapNodes.put(token,endpoint);
      this.remove(endpoint);
    }
 else {
      bootstrapNodes.remove(token);
      Token oldToken=endPointToTokenMap.get(endpoint);
      if (oldToken != null)       tokenToEndPointMap.remove(oldToken);
      tokenToEndPointMap.put(token,endpoint);
      endPointToTokenMap.put(endpoint,token);
    }
  }
  finally {
    lock.writeLock().unlock();
  }
}
