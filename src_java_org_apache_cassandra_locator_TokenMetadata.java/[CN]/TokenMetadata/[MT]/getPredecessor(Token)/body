{
  List<Token> tokens=sortedTokens();
  int index=Collections.binarySearch(tokens,token);
  if (index < 0)   index=-index - 1;
  return index == 0 ? tokens.get(tokens.size() - 1) : tokens.get(index - 1);
}
