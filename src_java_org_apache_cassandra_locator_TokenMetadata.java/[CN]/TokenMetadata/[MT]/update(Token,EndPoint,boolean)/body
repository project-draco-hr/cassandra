{
  lock_.writeLock().lock();
  try {
    if (bootstrapState) {
      bootstrapNodes.put(token,endpoint);
      this.remove(endpoint);
    }
 else {
      bootstrapNodes.remove(token);
      Token oldToken=endPointToTokenMap_.get(endpoint);
      if (oldToken != null)       tokenToEndPointMap_.remove(oldToken);
      tokenToEndPointMap_.put(token,endpoint);
      endPointToTokenMap_.put(endpoint,token);
    }
  }
  finally {
    lock_.writeLock().unlock();
  }
}
