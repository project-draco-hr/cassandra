{
  List<Token> tokens=sortedTokens();
  int index=Collections.binarySearch(tokens,token);
  if (index < 0)   return (Token)tokens.get(-index - 1);
  return (index == (tokens.size() - 1)) ? tokens.get(0) : tokens.get(index + 1);
}
