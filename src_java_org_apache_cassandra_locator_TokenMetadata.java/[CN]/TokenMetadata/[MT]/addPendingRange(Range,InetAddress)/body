{
  InetAddress oldEndpoint=pendingRanges.get(range);
  if (oldEndpoint != null && !oldEndpoint.equals(endpoint))   throw new RuntimeException("pending range collision between " + oldEndpoint + " and "+ endpoint);
  pendingRanges.put(range,endpoint);
}
