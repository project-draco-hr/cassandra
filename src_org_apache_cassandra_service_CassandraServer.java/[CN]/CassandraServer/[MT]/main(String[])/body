{
  int port=DatabaseDescriptor.getThriftPort();
  Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler(){
    public void uncaughtException(    Thread t,    Throwable e){
      logger_.error("Fatal exception in thread " + t,e);
    }
  }
);
  try {
    CassandraServer peerStorageServer=new CassandraServer();
    peerStorageServer.start();
    Cassandra.Processor processor=new Cassandra.Processor(peerStorageServer);
    TServerSocket tServerSocket=new TServerSocket(port);
    TProtocolFactory tProtocolFactory=new TBinaryProtocol.Factory();
    Options options=new Options();
    options.minWorkerThreads=64;
    TThreadPoolServer serverEngine=new TThreadPoolServer(processor,tServerSocket,tProtocolFactory);
    serverEngine.serve();
  }
 catch (  Exception x) {
    System.err.println("UNCAUGHT EXCEPTION IN main()");
    x.printStackTrace();
    System.exit(1);
  }
}
