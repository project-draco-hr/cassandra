{
  if (columnFamily == null) {
    return null;
  }
  String[] values=RowMutation.getColumnAndColumnFamily(cf);
  ColumnFamily filteredCf=columnFamily.cloneMeShallow();
  if (values.length == 1) {
    Collection<IColumn> columns=columnFamily.getAllColumns();
    for (    IColumn column : columns) {
      if (names_.contains(column.name())) {
        filteredCf.addColumn(column);
      }
    }
  }
 else   if (values.length == 2 && columnFamily.isSuper()) {
    Collection<IColumn> columns=columnFamily.getAllColumns();
    for (    IColumn column : columns) {
      SuperColumn superColumn=(SuperColumn)column;
      SuperColumn filteredSuperColumn=new SuperColumn(superColumn.name());
      filteredCf.addColumn(filteredSuperColumn);
      Collection<IColumn> subColumns=superColumn.getSubColumns();
      for (      IColumn subColumn : subColumns) {
        if (names_.contains(subColumn.name())) {
          filteredSuperColumn.addColumn(subColumn);
        }
      }
    }
  }
 else {
    throw new UnsupportedOperationException();
  }
  return filteredCf;
}
