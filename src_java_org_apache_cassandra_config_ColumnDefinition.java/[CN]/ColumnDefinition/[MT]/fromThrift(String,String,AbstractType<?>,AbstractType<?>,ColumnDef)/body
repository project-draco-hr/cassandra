{
  Integer componentIndex=thriftSubcomparator != null ? 1 : null;
  AbstractType<?> comparator=thriftSubcomparator == null ? thriftComparator : thriftSubcomparator;
  try {
    comparator.validate(thriftColumnDef.name);
  }
 catch (  MarshalException e) {
    throw new ConfigurationException(String.format("Column name %s is not valid for comparator %s",ByteBufferUtil.bytesToHex(thriftColumnDef.name),comparator));
  }
  return new ColumnDefinition(ksName,cfName,new ColumnIdentifier(ByteBufferUtil.clone(thriftColumnDef.name),comparator),TypeParser.parse(thriftColumnDef.validation_class),thriftColumnDef.index_type == null ? null : IndexType.valueOf(thriftColumnDef.index_type.name()),thriftColumnDef.index_options,thriftColumnDef.index_name,componentIndex,Kind.REGULAR);
}
