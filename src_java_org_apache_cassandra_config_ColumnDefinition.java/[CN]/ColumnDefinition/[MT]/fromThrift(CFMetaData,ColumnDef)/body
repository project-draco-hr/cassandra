{
  Integer componentIndex=cfm.isSuper() ? 1 : null;
  AbstractType<?> comparator=cfm.getComponentComparator(componentIndex,Kind.REGULAR);
  try {
    comparator.validate(thriftColumnDef.name);
  }
 catch (  MarshalException e) {
    throw new ConfigurationException(String.format("Column name %s is not valid for comparator %s",ByteBufferUtil.bytesToHex(thriftColumnDef.name),comparator));
  }
  ColumnDefinition cd=new ColumnDefinition(cfm,ByteBufferUtil.clone(thriftColumnDef.name),TypeParser.parse(thriftColumnDef.validation_class),componentIndex,Kind.REGULAR);
  cd.setIndex(thriftColumnDef.index_name,thriftColumnDef.index_type == null ? null : IndexType.valueOf(thriftColumnDef.index_type.name()),thriftColumnDef.index_options);
  return cd;
}
