{
  if (row.cf == null)   return Collections.emptyList();
  List<ColumnDefinition> cds=new ArrayList<ColumnDefinition>();
  for (  UntypedResultSet.Row result : QueryProcessor.resultify("SELECT * FROM system.schema_columns",row)) {
    try {
      IndexType index_type=null;
      Map<String,String> index_options=null;
      String index_name=null;
      if (result.has("index_type"))       index_type=IndexType.valueOf(result.getString("index_type"));
      if (result.has("index_options"))       index_options=FBUtilities.fromJsonMap(result.getString("index_options"));
      if (result.has("index_name"))       index_name=result.getString("index_name");
      cds.add(new ColumnDefinition(comparator.fromString(result.getString("column")),TypeParser.parse(result.getString("validator")),index_type,index_options,index_name));
    }
 catch (    ConfigurationException e) {
      throw new RuntimeException(e);
    }
  }
  return cds;
}
