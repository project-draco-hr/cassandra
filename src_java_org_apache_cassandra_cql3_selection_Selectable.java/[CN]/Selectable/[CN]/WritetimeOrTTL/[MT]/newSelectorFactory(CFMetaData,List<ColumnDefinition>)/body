{
  ColumnDefinition def=cfm.getColumnDefinition(id);
  if (def == null)   throw new InvalidRequestException(String.format("Undefined name %s in selection clause",id));
  if (def.isPrimaryKeyColumn())   throw new InvalidRequestException(String.format("Cannot use selection function %s on PRIMARY KEY part %s",isWritetime ? "writeTime" : "ttl",def.name));
  if (def.type.isCollection())   throw new InvalidRequestException(String.format("Cannot use selection function %s on collections",isWritetime ? "writeTime" : "ttl"));
  return WritetimeOrTTLSelector.newFactory(def.name.toString(),addAndGetIndex(def,defs),isWritetime);
}
