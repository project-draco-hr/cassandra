{
  Selector.Factory factory=selected.newSelectorFactory(cfm,defs);
  AbstractType<?> type=factory.newInstance().getType();
  if (!(type instanceof UserType))   throw new InvalidRequestException(String.format("Invalid field selection: %s of type %s is not a user type",selected,type.asCQL3Type()));
  UserType ut=(UserType)type;
  for (int i=0; i < ut.size(); i++) {
    if (!ut.fieldName(i).equals(field.bytes))     continue;
    return FieldSelector.newFactory(ut,i,factory);
  }
  throw new InvalidRequestException(String.format("%s of type %s has no field %s",selected,type.asCQL3Type(),field));
}
