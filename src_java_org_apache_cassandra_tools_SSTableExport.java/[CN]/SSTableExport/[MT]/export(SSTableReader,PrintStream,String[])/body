{
  SSTableScanner scanner=reader.getDirectScanner(INPUT_FILE_BUFFER_SIZE);
  Set<String> excludeSet=new HashSet<String>();
  if (excludes != null)   excludeSet=new HashSet<String>(Arrays.asList(excludes));
  outs.println("{");
  while (scanner.hasNext()) {
    SSTableIdentityIterator row=(SSTableIdentityIterator)scanner.next();
    if (excludeSet.contains(bytesToHex(row.getKey().key)))     continue;
    try {
      serializeRow(outs,row);
      outs.print("  ");
      if (scanner.hasNext())       outs.println(",");
 else       outs.println();
    }
 catch (    IOException ioexcep) {
      System.err.println("WARNING: Corrupt row " + bytesToHex(row.getKey().key) + " (skipping).");
      continue;
    }
catch (    OutOfMemoryError oom) {
      System.err.println("ERROR: Out of memory deserializing row " + bytesToHex(row.getKey().key));
      continue;
    }
  }
  outs.println("}");
  outs.flush();
}
