{
  SSTableScanner scanner=reader.getScanner(INPUT_FILE_BUFFER_SIZE);
  Set<String> excludeSet=new HashSet<String>(Arrays.asList(excludes));
  outs.println("{");
  while (scanner.hasNext()) {
    IteratingRow row=scanner.next();
    if (excludeSet.contains(row.getKey().key))     continue;
    try {
      String jsonOut=serializeRow(row);
      outs.print("  " + jsonOut);
      if (scanner.hasNext())       outs.println(",");
 else       outs.println();
    }
 catch (    IOException ioexcep) {
      System.err.println("WARNING: Corrupt row " + row.getKey().key + " (skipping).");
      continue;
    }
catch (    OutOfMemoryError oom) {
      System.err.println("ERROR: Out of memory deserializing row " + row.getKey().key);
      continue;
    }
  }
  outs.println("}");
  outs.flush();
}
