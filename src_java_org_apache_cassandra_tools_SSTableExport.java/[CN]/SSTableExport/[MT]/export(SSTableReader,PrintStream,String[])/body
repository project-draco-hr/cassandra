{
  Set<String> excludeSet=new HashSet<String>();
  if (excludes != null)   excludeSet=new HashSet<String>(Arrays.asList(excludes));
  SSTableIdentityIterator row;
  SSTableScanner scanner=reader.getScanner();
  try {
    outs.println("[");
    int i=0;
    while (scanner.hasNext()) {
      row=(SSTableIdentityIterator)scanner.next();
      String currentKey=bytesToHex(row.getKey().key);
      if (excludeSet.contains(currentKey))       continue;
 else       if (i != 0)       outs.println(",");
      serializeRow(row,row.getKey(),outs);
      checkStream(outs);
      i++;
    }
    outs.println("\n]");
    outs.flush();
  }
  finally {
    scanner.close();
  }
}
