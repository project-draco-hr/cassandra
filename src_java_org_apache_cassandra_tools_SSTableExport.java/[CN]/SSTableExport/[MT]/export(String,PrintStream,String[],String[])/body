{
  SSTableReader reader=SSTableReader.open(Descriptor.fromFilename(ssTableFile));
  SSTableScanner scanner=reader.getDirectScanner(BufferedRandomAccessFile.DEFAULT_BUFFER_SIZE);
  IPartitioner<?> partitioner=StorageService.getPartitioner();
  for (  String toExclude : excludes) {
    toExport.remove(toExclude);
  }
  outs.println("{");
  int i=0;
  DecoratedKey lastKey=null;
  for (  String key : toExport) {
    if (excludeSet.contains(key))     continue;
    DecoratedKey<?> dk=partitioner.decorateKey(hexToBytes(key));
    if (lastKey != null && lastKey.compareTo(dk) > 0)     throw new IOException("Key out of order! " + lastKey + " > "+ dk);
    lastKey=dk;
    lastKey=decoratedKey;
    scanner.seekTo(decoratedKey);
    if (!scanner.hasNext())     continue;
    serializeRow(reader,(SSTableIdentityIterator)scanner.next(),decoratedKey,outs);
    if (i != 0)     outs.println(",");
    i++;
  }
  outs.println("\n}");
  outs.flush();
  scanner.close();
}
