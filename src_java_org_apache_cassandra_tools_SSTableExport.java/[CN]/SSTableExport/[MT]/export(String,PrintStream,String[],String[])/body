{
  SSTableReader reader=SSTableReader.open(Descriptor.fromFilename(ssTableFile));
  SSTableScanner scanner=reader.getScanner(INPUT_FILE_BUFFER_SIZE);
  IPartitioner<?> partitioner=DatabaseDescriptor.getPartitioner();
  Set<String> excludeSet=new HashSet();
  int i=0;
  if (excludes != null)   excludeSet=new HashSet<String>(Arrays.asList(excludes));
  outs.println("{");
  for (  String key : keys) {
    if (excludeSet.contains(key))     continue;
    DecoratedKey<?> dk=partitioner.decorateKey(hexToBytes(key));
    scanner.seekTo(dk);
    i++;
    if (scanner.hasNext()) {
      SSTableIdentityIterator row=(SSTableIdentityIterator)scanner.next();
      try {
        String jsonOut=serializeRow(row);
        if (i != 1)         outs.println(",");
        outs.print("  " + jsonOut);
      }
 catch (      IOException ioexc) {
        System.err.println("WARNING: Corrupt row " + key + " (skipping).");
        continue;
      }
catch (      OutOfMemoryError oom) {
        System.err.println("ERROR: Out of memory deserializing row " + key);
        continue;
      }
    }
  }
  outs.println("\n}");
  outs.flush();
}
