{
  CheaterFutureTask firstTask=queue.poll(100,TimeUnit.MILLISECONDS);
  if (firstTask == null)   return false;
  if (!(firstTask.getRawCallable() instanceof CommitLog.LogRecordAdder)) {
    firstTask.run();
    return true;
  }
  incompleteTasks.clear();
  taskValues.clear();
  long end=System.nanoTime() + (long)(1000000 * DatabaseDescriptor.getCommitLogSyncBatchWindow());
  incompleteTasks.add(firstTask);
  taskValues.add(firstTask.getRawCallable().call());
  while (!queue.isEmpty() && queue.peek().getRawCallable() instanceof CommitLog.LogRecordAdder && System.nanoTime() < end) {
    CheaterFutureTask task=queue.remove();
    incompleteTasks.add(task);
    taskValues.add(task.getRawCallable().call());
  }
  CommitLog.instance.sync();
  for (int i=0; i < incompleteTasks.size(); i++) {
    incompleteTasks.get(i).set(taskValues.get(i));
  }
  return true;
}
