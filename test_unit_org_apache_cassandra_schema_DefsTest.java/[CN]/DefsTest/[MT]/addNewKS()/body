{
  CFMetaData cfm=addTestTable("newkeyspace1","newstandard1","A new cf for a new ks");
  KSMetaData newKs=KSMetaData.testMetadata(cfm.ksName,SimpleStrategy.class,KSMetaData.optsWithRF(5),cfm);
  MigrationManager.announceNewKeyspace(newKs);
  assertNotNull(Schema.instance.getKSMetaData(cfm.ksName));
  assertEquals(Schema.instance.getKSMetaData(cfm.ksName),newKs);
  QueryProcessor.executeInternal("INSERT INTO newkeyspace1.newstandard1 (key, col, val) VALUES (?, ?, ?)","key0","col0","val0");
  ColumnFamilyStore store=Keyspace.open(cfm.ksName).getColumnFamilyStore(cfm.cfName);
  assertNotNull(store);
  store.forceBlockingFlush();
  UntypedResultSet rows=QueryProcessor.executeInternal("SELECT * FROM newkeyspace1.newstandard1");
  assertRows(rows,row("key0","col0","val0"));
}
