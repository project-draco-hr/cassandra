{
  SchemaKeyspace.makeCreateKeyspaceMutation(Schema.instance.getKSMetaData(KEYSPACE6),FBUtilities.timestampMicros()).applyUnsafe();
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE6).getColumnFamilyStore(TABLE1i);
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, c1, birthdate, notbirthdate) VALUES (?, ?, ?, ?)",KEYSPACE6,TABLE1i),"key0","col0",1L,1L);
  cfs.forceBlockingFlush();
  ColumnFamilyStore indexedCfs=cfs.indexManager.getIndexForColumn(cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("birthdate"))).getIndexCfs();
  Descriptor desc=indexedCfs.getSSTables().iterator().next().descriptor;
  CFMetaData meta=cfs.metadata.copy();
  ColumnDefinition cdOld=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("birthdate"));
  ColumnDefinition cdNew=ColumnDefinition.regularDef(meta,cdOld.name.bytes,cdOld.type,null);
  meta.addOrReplaceColumnDefinition(cdNew);
  MigrationManager.announceColumnFamilyUpdate(meta,false);
  assertTrue(cfs.indexManager.getIndexes().isEmpty());
  SSTableDeletingTask.waitForDeletions();
  assertFalse(new File(desc.filenameFor(Component.DATA)).exists());
}
