{
  if (comparator instanceof CompositeType) {
    CompositeType ct=(CompositeType)comparator;
    if (maxSeen.isEmpty())     return Arrays.asList(ct.split(candidate));
    int typeCount=getTypeCount(ct);
    List<ByteBuffer> components=Arrays.asList(ct.split(candidate));
    List<ByteBuffer> biggest=maxSeen.size() > components.size() ? maxSeen : components;
    int minSize=Math.min(typeCount,Math.min(components.size(),maxSeen.size()));
    int maxSize=Math.min(typeCount,biggest.size());
    List<ByteBuffer> retList=new ArrayList<ByteBuffer>(maxSize);
    for (int i=0; i < minSize; i++)     retList.add(ColumnNameHelper.max(maxSeen.get(i),components.get(i),ct.types.get(i)));
    for (int i=minSize; i < maxSize; i++)     retList.add(biggest.get(i));
    return retList;
  }
 else {
    if (maxSeen.size() == 0)     return Collections.singletonList(candidate);
    return Collections.singletonList(ColumnNameHelper.max(maxSeen.get(0),candidate,comparator));
  }
}
