{
  Table table=Table.open("Keyspace1");
  ColumnFamilyStore store=table.getColumnFamilyStore(columnFamilyName);
  for (int j=0; j < insertsPerTable; j++) {
    String key=String.valueOf(j);
    RowMutation rm=new RowMutation("Keyspace1",key);
    rm.add(new QueryPath(columnFamilyName,null,"0".getBytes()),new byte[0],j);
    rm.apply();
  }
  store.forceBlockingFlush();
  List<String> fileList=new ArrayList<String>();
  List<Range> ranges=new ArrayList<Range>();
  Range r=new Range(new StringToken("0"),new StringToken("zzzzzz"));
  ranges.add(r);
  boolean result=store.doAntiCompaction(ranges,new EndPoint("127.0.0.1",9150),fileList);
  assertEquals(true,result);
  assertEquals(true,fileList.size() >= 3);
}
