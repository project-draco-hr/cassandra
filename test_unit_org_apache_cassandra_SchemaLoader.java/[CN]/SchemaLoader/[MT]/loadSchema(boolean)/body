{
  cleanupAndLeaveDirs();
  CommitLog.instance.allocator.enableReserveSegmentCreation();
  Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler(){
    public void uncaughtException(    Thread t,    Throwable e){
      logger.error("Fatal exception in thread " + t,e);
    }
  }
);
  startGossiper();
  try {
    for (    KSMetaData ksm : schemaDefinition(withOldCfIds))     MigrationManager.announceNewKeyspace(ksm);
  }
 catch (  ConfigurationException e) {
    throw new RuntimeException(e);
  }
}
