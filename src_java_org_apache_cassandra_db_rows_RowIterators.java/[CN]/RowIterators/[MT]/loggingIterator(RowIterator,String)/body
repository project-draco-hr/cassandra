{
  CFMetaData metadata=iterator.metadata();
  logger.info("[{}] Logging iterator on {}.{}, partition key={}, reversed={}",new Object[]{id,metadata.ksName,metadata.cfName,metadata.getKeyValidator().getString(iterator.partitionKey().getKey()),iterator.isReverseOrder()});
  return new WrappingRowIterator(iterator){
    @Override public Row staticRow(){
      Row row=super.staticRow();
      if (!row.isEmpty())       logger.info("[{}] {}",id,row.toString(metadata()));
      return row;
    }
    @Override public Row next(){
      Row next=super.next();
      logger.info("[{}] {}",id,next.toString(metadata()));
      return next;
    }
  }
;
}
