{
  Directories.DataDirectory localDir=cfs.directories.getWriteableLocation(totalSize);
  if (localDir == null)   throw new IOException("Insufficient disk space to store " + totalSize + " bytes");
  desc=Descriptor.fromFilename(cfs.getSSTablePath(cfs.directories.getLocationForDisk(localDir),format));
  return SSTableWriter.create(desc,estimatedKeys,repairedAt,sstableLevel,header.toHeader(cfs.metadata),session.getTransaction(cfId));
}
