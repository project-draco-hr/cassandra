{
  Directories.DataDirectory localDir=cfs.getDirectories().getWriteableLocation(totalSize);
  if (localDir == null)   throw new IOException("Insufficient disk space to store " + totalSize + " bytes");
  desc=Descriptor.fromFilename(cfs.getSSTablePath(cfs.getDirectories().getLocationForDisk(localDir),format));
  return cfs.createSSTableMultiWriter(desc,estimatedKeys,repairedAt,sstableLevel,header.toHeader(cfs.metadata),session.getTransaction(cfId));
}
