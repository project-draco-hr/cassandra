{
  Map<ColumnIdentifier,Integer> orderingIndexes=new HashMap<>();
  for (  ColumnIdentifier.Raw raw : parameters.orderings.keySet()) {
    ColumnIdentifier column=raw.prepare(cfm);
    final ColumnDefinition def=cfm.getColumnDefinition(column);
    if (def == null)     handleUnrecognizedOrderingColumn(column);
    int index=selection.getResultSetIndex(def);
    if (index < 0)     index=selection.addColumnForOrdering(def);
    orderingIndexes.put(def.name,index);
  }
  return orderingIndexes;
}
