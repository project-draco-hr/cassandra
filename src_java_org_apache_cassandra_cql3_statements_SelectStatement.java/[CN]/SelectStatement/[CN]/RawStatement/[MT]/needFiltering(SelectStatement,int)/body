{
  boolean needFiltering=stmt.restrictedColumns.size() > 1 || (stmt.restrictedColumns.isEmpty() && !stmt.columnFilterIsIdentity()) || (!stmt.restrictedColumns.isEmpty() && stmt.isRestrictedByMultipleContains(Iterables.getOnlyElement(stmt.restrictedColumns.keySet())));
  if (!needFiltering && !hasLoggedMissingAllowFilteringWarning && (stmt.restrictedColumns.size() + numberOfRestrictionsEvaluatedWithSlices) > 1) {
    hasLoggedMissingAllowFilteringWarning=true;
    String msg="Some secondary index queries with restrictions on non-indexed clustering columns " + "were executed without ALLOW FILTERING. In Cassandra 3.0, these queries will require " + "ALLOW FILTERING (see CASSANDRA-8418 for details).";
    logger.warn(msg);
  }
  return needFiltering;
}
