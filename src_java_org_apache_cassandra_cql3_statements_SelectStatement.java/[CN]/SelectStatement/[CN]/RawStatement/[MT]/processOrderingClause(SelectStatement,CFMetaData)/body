{
  verifyOrderingIsAllowed(stmt);
  if (stmt.keyIsInRelation) {
    stmt.orderingIndexes=new HashMap<>();
    for (    ColumnIdentifier column : stmt.parameters.orderings.keySet()) {
      final ColumnDefinition def=cfm.getColumnDefinition(column);
      if (def == null)       handleUnrecognizedOrderingColumn(column);
      int index=indexOf(def,stmt.selection);
      if (index < 0)       index=stmt.selection.addColumnForOrdering(def);
      stmt.orderingIndexes.put(def.name,index);
    }
  }
  stmt.isReversed=isReversed(stmt,cfm);
}
