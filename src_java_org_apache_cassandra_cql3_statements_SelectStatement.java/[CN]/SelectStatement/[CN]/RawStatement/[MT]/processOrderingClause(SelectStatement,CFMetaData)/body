{
  verifyOrderingIsAllowed(stmt);
  if (stmt.keyIsInRelation) {
    stmt.orderingIndexes=new HashMap<>();
    for (    ColumnIdentifier.Raw rawColumn : stmt.parameters.orderings.keySet()) {
      ColumnIdentifier column=rawColumn.prepare(cfm);
      final ColumnDefinition def=cfm.getColumnDefinition(column);
      if (def == null)       handleUnrecognizedOrderingColumn(column);
      int index=stmt.selection.getResultSetIndex(def);
      if (index < 0)       index=stmt.selection.addColumnForOrdering(def);
      stmt.orderingIndexes.put(def.name,index);
    }
  }
  stmt.isReversed=isReversed(stmt,cfm);
}
