{
  if (!parameters.allowFiltering && (restrictions.isKeyRange() || restrictions.usesSecondaryIndexing())) {
    checkFalse(restrictions.needFiltering(),"Cannot execute this query as it might involve data filtering and " + "thus may have unpredictable performance. If you want to execute " + "this query despite the performance unpredictability, use ALLOW FILTERING");
  }
  if (restrictions.isNonCompositeSliceWithExclusiveBounds() && restrictions.isKeyRange() && limit != null) {
    SingleColumnRelation rel=findInclusiveClusteringRelationForCompact(restrictions.cfm);
    throw invalidRequest("The query requests a restriction of rows with a strict bound (%s) over a range of partitions. " + "This is not supported by the underlying storage engine for COMPACT tables if a LIMIT is provided. " + "Please either make the condition non strict (%s) or remove the user LIMIT",rel,rel.withNonStrictOperator());
  }
}
