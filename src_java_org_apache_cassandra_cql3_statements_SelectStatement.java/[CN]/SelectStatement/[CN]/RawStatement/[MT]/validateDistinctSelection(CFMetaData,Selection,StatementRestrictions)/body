{
  checkFalse(restrictions.hasClusteringColumnsRestriction() || restrictions.hasNonPrimaryKeyRestrictions(),"SELECT DISTINCT with WHERE clause only supports restriction by partition key.");
  Collection<ColumnDefinition> requestedColumns=selection.getColumns();
  for (  ColumnDefinition def : requestedColumns)   checkFalse(!def.isPartitionKey() && !def.isStatic(),"SELECT DISTINCT queries must only request partition key columns and/or static columns (not %s)",def.name);
  if (!restrictions.isKeyRange())   return;
  for (  ColumnDefinition def : cfm.partitionKeyColumns())   checkTrue(requestedColumns.contains(def),"SELECT DISTINCT queries must request all the partition key columns (missing %s)",def.name);
}
