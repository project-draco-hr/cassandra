{
  QueryPath queryPath=new QueryPath(columnFamily());
  Collection<ByteBuffer> keys=getKeys(variables);
  if (keys.isEmpty())   return null;
  List<ReadCommand> commands=new ArrayList<ReadCommand>(keys.size());
  if (isColumnRange()) {
    for (    ByteBuffer key : keys) {
      QueryProcessor.validateKey(key);
      SliceQueryFilter filter=(SliceQueryFilter)makeFilter(variables);
      if (filter == null)       return null;
      commands.add(new SliceFromReadCommand(keyspace(),key,queryPath,filter));
    }
  }
 else {
    IDiskAtomFilter filter=makeFilter(variables);
    if (filter == null)     return null;
    for (    ByteBuffer key : keys) {
      QueryProcessor.validateKey(key);
      commands.add(new SliceByNamesReadCommand(keyspace(),key,queryPath,(NamesQueryFilter)filter));
    }
  }
  return commands;
}
