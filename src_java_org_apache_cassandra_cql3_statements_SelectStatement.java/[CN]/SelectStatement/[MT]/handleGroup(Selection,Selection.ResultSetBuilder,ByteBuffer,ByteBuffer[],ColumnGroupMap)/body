{
  result.newRow();
  for (  CFDefinition.Name name : selection.getColumnsList()) {
switch (name.kind) {
case KEY_ALIAS:
      result.add(keyComponents[name.position]);
    break;
case COLUMN_ALIAS:
  result.add(columns.getKeyComponent(name.position));
break;
case VALUE_ALIAS:
throw new AssertionError();
case COLUMN_METADATA:
if (name.type.isCollection()) {
List<Pair<ByteBuffer,Column>> collection=columns.getCollection(name.name.key);
ByteBuffer value=collection == null ? null : ((CollectionType)name.type).serialize(collection);
result.add(value);
}
 else {
result.add(columns.getSimple(name.name.key));
}
break;
}
}
}
