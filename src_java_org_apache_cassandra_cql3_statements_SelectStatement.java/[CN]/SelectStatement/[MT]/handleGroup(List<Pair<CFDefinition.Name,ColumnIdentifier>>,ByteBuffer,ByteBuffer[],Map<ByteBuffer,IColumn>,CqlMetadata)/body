{
  List<Column> thriftColumns=new ArrayList<Column>();
  for (  Pair<CFDefinition.Name,ColumnIdentifier> p : selection) {
    CFDefinition.Name name=p.left;
    ByteBuffer nameAsRequested=p.right.key;
    addToSchema(schema,p);
    Column col=new Column(nameAsRequested);
switch (name.kind) {
case KEY_ALIAS:
      col.setValue(key).setTimestamp(-1L);
    break;
case COLUMN_ALIAS:
  col.setValue(components[name.position]);
col.setTimestamp(-1L);
break;
case VALUE_ALIAS:
throw new AssertionError();
case COLUMN_METADATA:
IColumn c=columns.get(name.name.key);
if (c != null && !c.isMarkedForDelete()) col.setValue(value(c)).setTimestamp(c.timestamp());
break;
}
thriftColumns.add(col);
}
return new CqlRow(key,thriftColumns);
}
