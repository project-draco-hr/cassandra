{
  int cqlRowLimit=DataLimits.NO_LIMIT;
  if (!selection.isAggregate() && !needsPostQueryOrdering())   cqlRowLimit=userLimit;
  if (parameters.isDistinct)   return cqlRowLimit == DataLimits.NO_LIMIT ? DataLimits.DISTINCT_NONE : DataLimits.distinctLimits(cqlRowLimit);
  return cqlRowLimit == DataLimits.NO_LIMIT ? DataLimits.NONE : DataLimits.cqlLimits(cqlRowLimit);
}
