{
  Collection<ColumnDefinition> requestedColumns=selection.getColumns();
  for (  ColumnDefinition def : requestedColumns)   if (def.kind != ColumnDefinition.Kind.PARTITION_KEY && def.kind != ColumnDefinition.Kind.STATIC)   throw new InvalidRequestException(String.format("SELECT DISTINCT queries must only request partition key columns and/or static columns (not %s)",def.name));
  if (!isKeyRange)   return;
  for (  ColumnDefinition def : cfm.partitionKeyColumns())   if (!requestedColumns.contains(def))   throw new InvalidRequestException(String.format("SELECT DISTINCT queries must request all the partition key columns (missing %s)",def.name));
}
