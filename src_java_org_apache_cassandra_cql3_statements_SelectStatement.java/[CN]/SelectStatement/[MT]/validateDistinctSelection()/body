{
  Collection<CFDefinition.Name> requestedColumns=selection.getColumns();
  for (  CFDefinition.Name name : requestedColumns)   if (name.kind != CFDefinition.Name.Kind.KEY_ALIAS && name.kind != CFDefinition.Name.Kind.STATIC)   throw new InvalidRequestException(String.format("SELECT DISTINCT queries must only request partition key columns and/or static columns (not %s)",name));
  if (!isKeyRange)   return;
  for (  CFDefinition.Name name : cfDef.partitionKeys())   if (!requestedColumns.contains(name))   throw new InvalidRequestException(String.format("SELECT DISTINCT queries must request all the partition key columns (missing %s)",name));
}
