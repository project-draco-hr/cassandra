{
  List<List<ByteBuffer>> splitInValues=restriction.splitValues(variables);
  TreeSet<ByteBuffer> inValues=new TreeSet<>(isReversed ? cfDef.cfm.comparator.reverseComparator : cfDef.cfm.comparator);
  Iterator<CFDefinition.Name> iter=names.iterator();
  for (  List<ByteBuffer> components : splitInValues) {
    ColumnNameBuilder nameBuilder=builder.copy();
    for (    ByteBuffer component : components)     nameBuilder.add(component);
    Bound b=isReversed == isReversedType(iter.next()) ? bound : Bound.reverse(bound);
    inValues.add((bound == Bound.END && nameBuilder.remainingCount() > 0) ? nameBuilder.buildAsEndOfRange() : nameBuilder.build());
  }
  return new ArrayList<>(inValues);
}
