{
  if (isColumnRange()) {
    int multiplier=cfDef.isCompact ? 1 : (cfDef.metadata.size() + 1);
    int toGroup=cfDef.isCompact ? -1 : cfDef.columns.size();
    ColumnSlice slice=new ColumnSlice(getRequestedBound(Bound.START,variables),getRequestedBound(Bound.END,variables));
    if (slice.isAlwaysEmpty(cfDef.cfm.comparator,isReversed))     return null;
    SliceQueryFilter filter=new SliceQueryFilter(new ColumnSlice[]{slice},isReversed,getLimit(),toGroup,multiplier);
    return filter;
  }
 else {
    SortedSet<ByteBuffer> columnNames=getRequestedColumns(variables);
    QueryProcessor.validateColumnNames(columnNames);
    return new NamesQueryFilter(columnNames,true);
  }
}
