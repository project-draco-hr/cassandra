{
  if (isColumnRange()) {
    int toGroup=cfDef.isCompact ? -1 : cfDef.columns.size();
    ColumnSlice slice=new ColumnSlice(getRequestedBound(Bound.START,variables),getRequestedBound(Bound.END,variables));
    SliceQueryFilter filter=new SliceQueryFilter(new ColumnSlice[]{slice},isReversed,getLimit(),toGroup);
    QueryProcessor.validateSliceFilter(cfDef.cfm,filter);
    return filter;
  }
 else {
    SortedSet<ByteBuffer> columnNames=getRequestedColumns(variables);
    QueryProcessor.validateColumnNames(columnNames);
    return new NamesQueryFilter(columnNames,true);
  }
}
