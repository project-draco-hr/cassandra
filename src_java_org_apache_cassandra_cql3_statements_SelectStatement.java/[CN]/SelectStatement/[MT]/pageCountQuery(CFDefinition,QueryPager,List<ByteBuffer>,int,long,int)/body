{
  int count=0;
  while (!pager.isExhausted()) {
    int maxLimit=pager.maxRemaining();
    logger.debug("New maxLimit for paged count query is {}",maxLimit);
    ResultSet rset=process(cfDef,pager.fetchPage(pageSize),variables,maxLimit,now);
    count+=rset.rows.size();
  }
  ResultSet result=ResultSet.makeCountResult(keyspace(),columnFamily(),Math.min(count,limit),parameters.countAlias);
  return new ResultMessage.Rows(result);
}
