{
  int cqlRowLimit=DataLimits.NO_LIMIT;
  int cqlPerPartitionLimit=DataLimits.NO_LIMIT;
  if (!selection.isAggregate()) {
    if (!needsPostQueryOrdering())     cqlRowLimit=userLimit;
    cqlPerPartitionLimit=perPartitionLimit;
  }
  if (parameters.isDistinct)   return cqlRowLimit == DataLimits.NO_LIMIT ? DataLimits.DISTINCT_NONE : DataLimits.distinctLimits(cqlRowLimit);
  return DataLimits.cqlLimits(cqlRowLimit,cqlPerPartitionLimit);
}
