{
  result.newRow();
  for (  CFDefinition.Name name : selection.getColumnsList()) {
switch (name.kind) {
case KEY_ALIAS:
      result.add(keyComponents[name.position]);
    break;
case COLUMN_ALIAS:
  result.add(columns.getKeyComponent(name.position));
break;
case VALUE_ALIAS:
throw new AssertionError();
case COLUMN_METADATA:
if (name.type.isCollection()) {
result.add(getCollectionValue(name,columns));
}
 else {
result.add(columns.getSimple(name.name.key));
}
break;
case STATIC:
result.add(staticValues.get(name));
break;
}
}
}
