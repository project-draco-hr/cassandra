def test_parse_create_index(self):
    parsed = parse_cqlsh_statements('CREATE INDEX idx ON ks.tab (i);')
    self.assertSequenceEqual(tokens_with_types(parsed), (('CREATE', 'reserved_identifier'), ('INDEX', 'reserved_identifier'), ('idx', 'identifier'), ('ON', 'reserved_identifier'), ('ks', 'identifier'), ('.', 'op'), ('tab', 'identifier'), ('(', 'op'), ('i', 'identifier'), (')', 'op'), (';', 'endtoken')))
    parsed = parse_cqlsh_statements('CREATE INDEX idx ON ks.tab (i) IF NOT EXISTS;')
    self.assertSequenceEqual(tokens_with_types(parsed), (('CREATE', 'reserved_identifier'), ('INDEX', 'reserved_identifier'), ('idx', 'identifier'), ('ON', 'reserved_identifier'), ('ks', 'identifier'), ('.', 'op'), ('tab', 'identifier'), ('(', 'op'), ('i', 'identifier'), (')', 'op'), ('IF', 'reserved_identifier'), ('NOT', 'reserved_identifier'), ('EXISTS', 'identifier'), (';', 'endtoken')))
    parsed = parse_cqlsh_statements('CREATE INDEX idx ON tab (KEYS(i));')
    self.assertSequenceEqual(tokens_with_types(parsed), (('CREATE', 'reserved_identifier'), ('INDEX', 'reserved_identifier'), ('idx', 'identifier'), ('ON', 'reserved_identifier'), ('tab', 'identifier'), ('(', 'op'), ('KEYS', 'identifier'), ('(', 'op'), ('i', 'identifier'), (')', 'op'), (')', 'op'), (';', 'endtoken')))
    parsed = parse_cqlsh_statements('CREATE INDEX idx ON ks.tab FULL(i);')
    self.assertSequenceEqual(tokens_with_types(parsed), [('CREATE', 'reserved_identifier'), ('INDEX', 'reserved_identifier'), ('idx', 'identifier'), ('ON', 'reserved_identifier'), ('ks', 'identifier'), ('.', 'op'), ('tab', 'identifier'), ('FULL', 'reserved_identifier'), ('(', 'op'), ('i', 'identifier'), (')', 'op'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements('CREATE CUSTOM INDEX idx ON ks.tab (i);')
    self.assertSequenceEqual(tokens_with_types(parsed), [('CREATE', 'reserved_identifier'), ('CUSTOM', 'identifier'), ('INDEX', 'reserved_identifier'), ('idx', 'identifier'), ('ON', 'reserved_identifier'), ('ks', 'identifier'), ('.', 'op'), ('tab', 'identifier'), ('(', 'op'), ('i', 'identifier'), (')', 'op'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("CREATE INDEX idx ON ks.tab (i) USING 'org.custom.index.MyIndexClass';")
    self.assertSequenceEqual(tokens_with_types(parsed), [('CREATE', 'reserved_identifier'), ('INDEX', 'reserved_identifier'), ('idx', 'identifier'), ('ON', 'reserved_identifier'), ('ks', 'identifier'), ('.', 'op'), ('tab', 'identifier'), ('(', 'op'), ('i', 'identifier'), (')', 'op'), ('USING', 'reserved_identifier'), ("'org.custom.index.MyIndexClass'", 'quotedStringLiteral'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("CREATE INDEX idx ON ks.tab (i) WITH OPTIONS = {'storage': '/mnt/ssd/indexes/'};")
    self.assertSequenceEqual(tokens_with_types(parsed), [('CREATE', 'reserved_identifier'), ('INDEX', 'reserved_identifier'), ('idx', 'identifier'), ('ON', 'reserved_identifier'), ('ks', 'identifier'), ('.', 'op'), ('tab', 'identifier'), ('(', 'op'), ('i', 'identifier'), (')', 'op'), ('WITH', 'reserved_identifier'), ('OPTIONS', 'identifier'), ('=', 'op'), ('{', 'brackets'), ("'storage'", 'quotedStringLiteral'), (':', 'colon'), ("'/mnt/ssd/indexes/'", 'quotedStringLiteral'), ('}', 'brackets'), (';', 'endtoken')])
