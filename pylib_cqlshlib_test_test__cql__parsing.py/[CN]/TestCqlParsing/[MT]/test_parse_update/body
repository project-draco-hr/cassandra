def test_parse_update(self):
    parsed = parse_cqlsh_statements("UPDATE tab SET x = 15 WHERE y = 'eggs';")
    self.assertSequenceEqual(tokens_with_types(parsed), [('UPDATE', 'reserved_identifier'), ('tab', 'identifier'), ('SET', 'reserved_identifier'), ('x', 'identifier'), ('=', 'op'), ('15', 'wholenumber'), ('WHERE', 'reserved_identifier'), ('y', 'identifier'), ('=', 'op'), ("'eggs'", 'quotedStringLiteral'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("UPDATE tab USING TTL 432000 SET x = 15 WHERE y = 'eggs';")
    self.assertSequenceEqual(tokens_with_types(parsed), [('UPDATE', 'reserved_identifier'), ('tab', 'identifier'), ('USING', 'reserved_identifier'), ('TTL', 'identifier'), ('432000', 'wholenumber'), ('SET', 'reserved_identifier'), ('x', 'identifier'), ('=', 'op'), ('15', 'wholenumber'), ('WHERE', 'reserved_identifier'), ('y', 'identifier'), ('=', 'op'), ("'eggs'", 'quotedStringLiteral'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("UPDATE tab SET x = 15, y = 'sausage' WHERE y = 'eggs';")
    self.assertSequenceEqual(tokens_with_types(parsed), [('UPDATE', 'reserved_identifier'), ('tab', 'identifier'), ('SET', 'reserved_identifier'), ('x', 'identifier'), ('=', 'op'), ('15', 'wholenumber'), (',', 'op'), ('y', 'identifier'), ('=', 'op'), ("'sausage'", 'quotedStringLiteral'), ('WHERE', 'reserved_identifier'), ('y', 'identifier'), ('=', 'op'), ("'eggs'", 'quotedStringLiteral'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("UPDATE tab SET x = 15 WHERE y IN ('eggs', 'sausage', 'spam');")
    self.assertSequenceEqual(tokens_with_types(parsed), [('UPDATE', 'reserved_identifier'), ('tab', 'identifier'), ('SET', 'reserved_identifier'), ('x', 'identifier'), ('=', 'op'), ('15', 'wholenumber'), ('WHERE', 'reserved_identifier'), ('y', 'identifier'), ('IN', 'reserved_identifier'), ('(', 'op'), ("'eggs'", 'quotedStringLiteral'), (',', 'op'), ("'sausage'", 'quotedStringLiteral'), (',', 'op'), ("'spam'", 'quotedStringLiteral'), (')', 'op'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("UPDATE tab SET x = 15 WHERE y = 'spam' IF z = 'sausage';")
    self.assertSequenceEqual(tokens_with_types(parsed), [('UPDATE', 'reserved_identifier'), ('tab', 'identifier'), ('SET', 'reserved_identifier'), ('x', 'identifier'), ('=', 'op'), ('15', 'wholenumber'), ('WHERE', 'reserved_identifier'), ('y', 'identifier'), ('=', 'op'), ("'spam'", 'quotedStringLiteral'), ('IF', 'reserved_identifier'), ('z', 'identifier'), ('=', 'op'), ("'sausage'", 'quotedStringLiteral'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("UPDATE tab SET x = 15 WHERE y = 'spam' IF z = 'sausage' AND w = 'spam';")
    self.assertSequenceEqual(tokens_with_types(parsed), [('UPDATE', 'reserved_identifier'), ('tab', 'identifier'), ('SET', 'reserved_identifier'), ('x', 'identifier'), ('=', 'op'), ('15', 'wholenumber'), ('WHERE', 'reserved_identifier'), ('y', 'identifier'), ('=', 'op'), ("'spam'", 'quotedStringLiteral'), ('IF', 'reserved_identifier'), ('z', 'identifier'), ('=', 'op'), ("'sausage'", 'quotedStringLiteral'), ('AND', 'reserved_identifier'), ('w', 'identifier'), ('=', 'op'), ("'spam'", 'quotedStringLiteral'), (';', 'endtoken')])
    parsed = parse_cqlsh_statements("UPDATE tab SET x = 15 WHERE y = 'spam' IF EXISTS")
    self.assertSequenceEqual(tokens_with_types(parsed), [('UPDATE', 'reserved_identifier'), ('tab', 'identifier'), ('SET', 'reserved_identifier'), ('x', 'identifier'), ('=', 'op'), ('15', 'wholenumber'), ('WHERE', 'reserved_identifier'), ('y', 'identifier'), ('=', 'op'), ("'spam'", 'quotedStringLiteral'), ('IF', 'reserved_identifier'), ('EXISTS', 'identifier')])
