{
  String key=String.format(MapFormatString,keyspace,columnFamily,specifier.name(),FBUtilities.bytesToHex(column == null ? new byte[]{} : column));
  AbstractType comparator=comparators.get(key);
  if (comparator == null) {
    if (def == null)     def=cfDefs.get(String.format("%s.%s",keyspace,columnFamily));
    if (def == null)     return null;
    try {
switch (specifier) {
case KeyValidator:
        comparator=FBUtilities.getComparator(def.getKey_validation_class());
      break;
case ColumnSpecific:
case Validator:
    comparator=FBUtilities.getComparator(def.getDefault_validation_class());
  break;
case Comparator:
default :
comparator=FBUtilities.getComparator(def.getComparator_type());
break;
}
comparators.put(key,comparator);
}
 catch (ConfigurationException ex) {
throw new RuntimeException(ex);
}
}
return comparator;
}
