{
  CFMetaData md=metadata.get(String.format("%s.%s",keyspace,columnFamily));
  try {
    if (ByteBufferUtil.string(name).equalsIgnoreCase(ByteBufferUtil.string(md.getKeyName())))     return md.getKeyValidator();
  }
 catch (  CharacterCodingException e) {
  }
  ColumnDefinition cd=md.getColumnDefinition(name);
  return cd == null ? md.getDefaultValidator() : cd.getValidator();
}
