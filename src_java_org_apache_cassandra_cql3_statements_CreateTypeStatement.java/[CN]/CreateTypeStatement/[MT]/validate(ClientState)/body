{
  KSMetaData ksm=Schema.instance.getKSMetaData(name.getKeyspace());
  if (ksm == null)   throw new InvalidRequestException(String.format("Cannot add type in unknown keyspace %s",name.getKeyspace()));
  if (ksm.userTypes.getType(name.getUserTypeName()) != null && !ifNotExists)   throw new InvalidRequestException(String.format("A user type of name %s already exists.",name));
}
