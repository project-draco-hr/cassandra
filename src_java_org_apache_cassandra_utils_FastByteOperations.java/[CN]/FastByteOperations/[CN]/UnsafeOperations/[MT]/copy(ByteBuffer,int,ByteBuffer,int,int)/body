{
  if (srcBuf.hasArray() && trgBuf.hasArray()) {
    System.arraycopy(srcBuf.array(),srcBuf.arrayOffset() + srcPosition,trgBuf.array(),trgBuf.arrayOffset() + trgPosition,length);
    return;
  }
  Object src, trg;
  long srcOffset, trgOffset;
  if (srcBuf.isDirect()) {
    srcOffset=srcPosition + theUnsafe.getLong(srcBuf,DIRECT_BUFFER_ADDRESS_OFFSET);
    src=null;
  }
 else {
    src=srcBuf.array();
    srcOffset=BYTE_ARRAY_BASE_OFFSET + srcBuf.arrayOffset() + srcPosition;
  }
  if (trgBuf.isDirect()) {
    trgOffset=trgPosition + theUnsafe.getLong(trgBuf,DIRECT_BUFFER_ADDRESS_OFFSET);
    trg=null;
  }
 else {
    trg=trgBuf.array();
    trgOffset=BYTE_ARRAY_BASE_OFFSET + trgBuf.arrayOffset() + trgPosition;
  }
  copy(src,srcOffset,trg,trgOffset,length);
}
