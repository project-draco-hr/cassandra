{
  if (validator.kind != CollectionType.Kind.SET)   throw new InvalidRequestException("Set operations are only supported on Set typed columns, but " + validator + " given.");
switch (kind) {
case SET:
    cf.addAtom(params.makeTombstoneForOverwrite(builder.copy().build(),builder.copy().buildAsEndOfRange()));
case ADD:
  doAdd(cf,builder,validator,params);
break;
case DISCARD:
doDiscard(cf,builder,validator,params);
break;
default :
throw new AssertionError("Unsupported Set operation: " + kind);
}
}
