{
  boolean allAreBuilt=true;
  for (  ColumnDefinition cdef : columnDefs) {
    if (!SystemKeyspace.isIndexBuilt(baseCfs.keyspace.getName(),getNameForSystemKeyspace(cdef.name.bytes))) {
      allAreBuilt=false;
      break;
    }
  }
  if (allAreBuilt) {
    queryable=true;
    return null;
  }
  if (baseCfs.isEmpty()) {
    setIndexBuilt();
    return null;
  }
  Runnable runnable=new Runnable(){
    public void run(){
      baseCfs.forceBlockingFlush();
      buildIndexBlocking();
    }
  }
;
  FutureTask<?> f=new FutureTask<Object>(runnable,null);
  new Thread(f,"Creating index: " + getIndexName()).start();
  return f;
}
