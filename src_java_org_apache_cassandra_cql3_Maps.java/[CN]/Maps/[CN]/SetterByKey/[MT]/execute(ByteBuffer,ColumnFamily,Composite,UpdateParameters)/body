{
  ByteBuffer key=k.bindAndGet(params.options);
  ByteBuffer value=t.bindAndGet(params.options);
  if (key == null)   throw new InvalidRequestException("Invalid null map key");
  CellName cellName=cf.getComparator().create(prefix,column,key);
  if (value == null) {
    cf.addColumn(params.makeTombstone(cellName));
  }
 else {
    if (value.remaining() > FBUtilities.MAX_UNSIGNED_SHORT)     throw new InvalidRequestException(String.format("Map value is too long. Map values are limited to %d bytes but %d bytes value provided",FBUtilities.MAX_UNSIGNED_SHORT,value.remaining()));
    cf.addColumn(params.makeColumn(cellName,value));
  }
}
