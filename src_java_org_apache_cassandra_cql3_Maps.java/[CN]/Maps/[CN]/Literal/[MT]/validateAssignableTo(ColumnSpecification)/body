{
  if (!(receiver.type instanceof MapType))   throw new InvalidRequestException(String.format("Invalid map literal for %s of type %s",receiver,receiver.type.asCQL3Type()));
  ColumnSpecification keySpec=Maps.keySpecOf(receiver);
  ColumnSpecification valueSpec=Maps.valueSpecOf(receiver);
  for (  Pair<Term.Raw,Term.Raw> entry : entries) {
    if (!entry.left.isAssignableTo(keySpec))     throw new InvalidRequestException(String.format("Invalid map literal for %s: key %s is not of type %s",receiver,entry.left,keySpec.type.asCQL3Type()));
    if (!entry.right.isAssignableTo(valueSpec))     throw new InvalidRequestException(String.format("Invalid map literal for %s: value %s is not of type %s",receiver,entry.right,valueSpec.type.asCQL3Type()));
  }
}
