{
  ByteBuffer name=column.name();
  IColumn oldColumn;
  while ((oldColumn=columns.putIfAbsent(name,column)) != null) {
    if (oldColumn.isInPageCache() || column.isInPageCache()) {
      oldColumn.setIsInPageCache(true);
      column.setIsInPageCache(true);
    }
    if (oldColumn instanceof SuperColumn) {
      ((SuperColumn)oldColumn).putColumn(column);
      break;
    }
 else {
      IColumn reconciledColumn=column.reconcile(oldColumn);
      if (columns.replace(name,oldColumn,reconciledColumn))       break;
    }
  }
}
