{
  ColumnFamily cfDiff=new ColumnFamily(cfComposite.type,cfComposite.clockType,getComparator(),getSubComparator(),cfComposite.id());
  ClockRelationship rel=cfComposite.getMarkedForDeleteAt().compare(getMarkedForDeleteAt());
  if (ClockRelationship.GREATER_THAN == rel) {
    cfDiff.delete(cfComposite.getLocalDeletionTime(),cfComposite.getMarkedForDeleteAt());
  }
  Map<byte[],IColumn> columns=cfComposite.getColumnsMap();
  Set<byte[]> cNames=columns.keySet();
  for (  byte[] cName : cNames) {
    IColumn columnInternal=this.columns.get(cName);
    IColumn columnExternal=columns.get(cName);
    if (columnInternal == null) {
      cfDiff.addColumn(columnExternal);
    }
 else {
      IColumn columnDiff=columnInternal.diff(columnExternal);
      if (columnDiff != null) {
        cfDiff.addColumn(columnDiff);
      }
    }
  }
  if (!cfDiff.getColumnsMap().isEmpty() || cfDiff.isMarkedForDelete())   return cfDiff;
  return null;
}
