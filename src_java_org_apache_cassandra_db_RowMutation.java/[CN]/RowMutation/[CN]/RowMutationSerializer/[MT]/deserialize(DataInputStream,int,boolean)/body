{
  String table=dis.readUTF();
  ByteBuffer key=ByteBufferUtil.readWithShortLength(dis);
  Map<Integer,ColumnFamily> modifications=new HashMap<Integer,ColumnFamily>();
  int size=dis.readInt();
  for (int i=0; i < size; ++i) {
    Integer cfid=Integer.valueOf(dis.readInt());
    ColumnFamily cf=ColumnFamily.serializer().deserialize(dis,true,fromRemote,ThreadSafeSortedColumns.FACTORY);
    modifications.put(cfid,cf);
  }
  return new RowMutation(table,key,modifications);
}
