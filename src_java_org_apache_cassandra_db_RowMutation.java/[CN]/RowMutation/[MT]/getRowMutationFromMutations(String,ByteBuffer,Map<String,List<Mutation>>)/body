{
  RowMutation rm=new RowMutation(keyspace,key);
  for (  Map.Entry<String,List<Mutation>> entry : cfmap.entrySet()) {
    String cfName=entry.getKey();
    for (    Mutation mutation : entry.getValue()) {
      if (mutation.deletion != null) {
        deleteColumnOrSuperColumnToRowMutation(rm,cfName,mutation.deletion);
      }
      if (mutation.column_or_supercolumn != null) {
        addColumnOrSuperColumnToRowMutation(rm,cfName,mutation.column_or_supercolumn);
      }
      if (mutation.counter != null) {
        addCounterToRowMutation(rm,cfName,mutation.counter);
      }
    }
  }
  return rm;
}
