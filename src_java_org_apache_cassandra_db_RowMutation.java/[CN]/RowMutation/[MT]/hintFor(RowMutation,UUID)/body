{
  RowMutation rm=new RowMutation(Table.SYSTEM_KS,UUIDType.instance.decompose(targetId));
  UUID hintId=UUIDGen.getTimeUUID();
  int ttl=Integer.MAX_VALUE;
  for (  ColumnFamily cf : mutation.getColumnFamilies())   ttl=Math.min(ttl,cf.metadata().getGcGraceSeconds());
  ByteBuffer name=HintedHandOffManager.comparator.decompose(hintId,MessagingService.current_version);
  ByteBuffer value=ByteBuffer.wrap(mutation.getSerializedBuffer(MessagingService.current_version));
  rm.add(SystemTable.HINTS_CF,name,value,System.currentTimeMillis(),ttl);
  return rm;
}
