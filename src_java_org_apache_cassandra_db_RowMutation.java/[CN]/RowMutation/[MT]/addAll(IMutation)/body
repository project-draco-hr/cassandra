{
  if (!(m instanceof RowMutation))   throw new IllegalArgumentException();
  RowMutation rm=(RowMutation)m;
  if (!table.equals(rm.table) || !key.equals(rm.key))   throw new IllegalArgumentException();
  for (  Map.Entry<Integer,ColumnFamily> entry : rm.modifications.entrySet()) {
    ColumnFamily cf=modifications.put(entry.getKey(),entry.getValue());
    if (cf != null)     entry.getValue().resolve(cf);
  }
}
