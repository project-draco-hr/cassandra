{
  KSMetaData ksm=DatabaseDescriptor.getTableDefinition(name);
  Table table=Table.clear(ksm.name);
  if (table == null)   throw new IOException("Table is not active. " + ksm.name);
  for (  CFMetaData cfm : ksm.cfMetaData().values()) {
    CFMetaData.purge(cfm);
    table.dropCf(cfm.cfName);
    SystemTable.markForRemoval(cfm);
  }
  DatabaseDescriptor.clearTableDefinition(ksm,newVersion);
  CommitLog.instance().forceNewSegment();
  Migration.cleanupDeadFiles(blockOnFileDeletion);
  HintedHandOffManager.renameHints(name,null);
}
