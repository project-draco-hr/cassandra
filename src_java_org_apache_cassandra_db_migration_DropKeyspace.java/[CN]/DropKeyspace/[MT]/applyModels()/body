{
  KSMetaData ksm=DatabaseDescriptor.getTableDefinition(name);
  Table table=Table.clear(ksm.name);
  if (table == null)   throw new IOException("Table is not active. " + ksm.name);
  for (  CFMetaData cfm : ksm.cfMetaData().values()) {
    CFMetaData.purge(cfm);
    if (!clientMode) {
      table.dropCf(cfm.cfId);
    }
  }
  DatabaseDescriptor.clearTableDefinition(ksm,newVersion);
  if (!clientMode) {
    HintedHandOffManager.renameHints(name,null);
  }
}
