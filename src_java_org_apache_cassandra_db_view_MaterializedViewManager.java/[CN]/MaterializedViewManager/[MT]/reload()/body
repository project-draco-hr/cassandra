{
  Map<String,MaterializedViewDefinition> newViewsByName=new HashMap<>();
  for (  MaterializedViewDefinition definition : baseCfs.metadata.getMaterializedViews()) {
    newViewsByName.put(definition.viewName,definition);
  }
  for (  String viewName : viewsByName.keySet()) {
    if (!newViewsByName.containsKey(viewName))     removeMaterializedView(viewName);
  }
  for (  Map.Entry<String,MaterializedViewDefinition> entry : newViewsByName.entrySet()) {
    if (!viewsByName.containsKey(entry.getKey()))     addMaterializedView(entry.getValue());
  }
  for (  MaterializedView view : allViews()) {
    view.build();
    view.updateDefinition(newViewsByName.get(view.name));
  }
}
