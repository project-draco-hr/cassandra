{
  Collector collector=new Collector(columnNameComparator);
  collector.replayPosition(ReplayPosition.getReplayPosition(sstables));
  collector.sstableLevel(level);
  for (  SSTableReader sstable : sstables) {
    collector.addAncestor(sstable.descriptor.generation);
    for (    Integer i : sstable.getAncestors()) {
      if (new File(sstable.descriptor.withGeneration(i).filenameFor(Component.DATA)).exists())       collector.addAncestor(i);
    }
  }
  return collector;
}
