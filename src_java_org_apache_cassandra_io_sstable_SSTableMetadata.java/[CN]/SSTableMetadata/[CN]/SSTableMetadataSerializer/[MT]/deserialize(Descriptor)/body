{
  File statsFile=new File(descriptor.filenameFor(SSTable.COMPONENT_STATS));
  if (!statsFile.exists()) {
    logger.debug("No sstable stats for {}",descriptor);
    return new SSTableMetadata();
  }
  DataInputStream dis=null;
  try {
    logger.debug("Load metadata for {}",descriptor);
    dis=new DataInputStream(new BufferedInputStream(new FileInputStream(statsFile)));
    if (!descriptor.usesHistogramAndReplayPositionStatsFile)     return deserialize(dis);
    EstimatedHistogram rowSizes=EstimatedHistogram.serializer.deserialize(dis);
    EstimatedHistogram columnCounts=EstimatedHistogram.serializer.deserialize(dis);
    ReplayPosition replayPosition=descriptor.hasReplayPosition() ? ReplayPosition.serializer.deserialize(dis) : ReplayPosition.NONE;
    return new SSTableMetadata(rowSizes,columnCounts,replayPosition);
  }
  finally {
    FileUtils.closeQuietly(dis);
  }
}
