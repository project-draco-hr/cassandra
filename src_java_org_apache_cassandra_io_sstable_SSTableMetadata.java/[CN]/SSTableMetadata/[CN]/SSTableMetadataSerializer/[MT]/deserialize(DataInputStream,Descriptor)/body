{
  EstimatedHistogram rowSizes=EstimatedHistogram.serializer.deserialize(dis);
  EstimatedHistogram columnCounts=EstimatedHistogram.serializer.deserialize(dis);
  ReplayPosition replayPosition=desc.metadataIncludesReplayPosition ? ReplayPosition.serializer.deserialize(dis) : ReplayPosition.NONE;
  long maxTimestamp=desc.tracksMaxTimestamp ? dis.readLong() : Long.MIN_VALUE;
  double compressionRatio=desc.hasCompressionRatio ? dis.readDouble() : Double.MIN_VALUE;
  String partitioner=desc.hasPartitioner ? dis.readUTF() : DatabaseDescriptor.getPartitioner().getClass().getCanonicalName();
  return new SSTableMetadata(rowSizes,columnCounts,replayPosition,maxTimestamp,compressionRatio,partitioner);
}
