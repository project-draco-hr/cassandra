{
  while (!getDirectories().hasAvailableDiskSpace(estimatedSSTables,expectedWriteSize)) {
    if (!reduceScopeForLimitedSpace())     throw new RuntimeException(String.format("Not enough space for compaction, estimated sstables = %d, expected write size = %d",estimatedSSTables,expectedWriteSize));
  }
}
