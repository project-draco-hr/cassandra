{
  try {
    NIODataInputStream in=new NIODataInputStream(bytes,true);
    return Pair.create(ReplayPosition.serializer.deserialize(in),in.available() > 0 ? in.readLong() : Long.MIN_VALUE);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
