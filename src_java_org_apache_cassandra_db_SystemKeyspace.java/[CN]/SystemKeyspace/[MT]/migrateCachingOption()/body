{
  for (  UntypedResultSet.Row row : executeOnceInternal(String.format("SELECT * FROM system.%s",SCHEMA_COLUMNFAMILIES_TABLE))) {
    if (!row.has("caching"))     continue;
    if (!CachingOptions.isLegacy(row.getString("caching")))     continue;
    try {
      CachingOptions caching=CachingOptions.fromString(row.getString("caching"));
      CFMetaData table=CFMetaData.fromSchema(row);
      logger.info("Migrating caching option {} to {} for {}.{}",row.getString("caching"),caching.toString(),table.ksName,table.cfName);
      String query=String.format("SELECT writetime(type) FROM system.%s WHERE keyspace_name = ? AND columnfamily_name = ?",SCHEMA_COLUMNFAMILIES_TABLE);
      long timestamp=executeOnceInternal(query,table.ksName,table.cfName).one().getLong("writetime(type)");
      table.toSchema(timestamp).apply();
    }
 catch (    ConfigurationException e) {
    }
  }
}
