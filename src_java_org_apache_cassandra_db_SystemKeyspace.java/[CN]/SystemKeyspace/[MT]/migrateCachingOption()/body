{
  for (  UntypedResultSet.Row row : processInternal(String.format("SELECT * FROM system.%s",SCHEMA_COLUMNFAMILIES_CF))) {
    if (!row.has("caching"))     continue;
    if (!CachingOptions.isLegacy(row.getString("caching")))     continue;
    try {
      CachingOptions caching=CachingOptions.fromString(row.getString("caching"));
      CFMetaData table=CFMetaData.fromSchema(row);
      logger.info("Migrating caching option {} to {} for {}.{}",row.getString("caching"),caching.toString(),table.ksName,table.cfName);
      String query=String.format("SELECT writetime(type) " + "FROM system.%s " + "WHERE keyspace_name = '%s' AND columnfamily_name = '%s'",SCHEMA_COLUMNFAMILIES_CF,table.ksName,table.cfName);
      long timestamp=processInternal(query).one().getLong("writetime(type)");
      table.toSchema(timestamp).apply();
    }
 catch (    ConfigurationException e) {
    }
  }
}
