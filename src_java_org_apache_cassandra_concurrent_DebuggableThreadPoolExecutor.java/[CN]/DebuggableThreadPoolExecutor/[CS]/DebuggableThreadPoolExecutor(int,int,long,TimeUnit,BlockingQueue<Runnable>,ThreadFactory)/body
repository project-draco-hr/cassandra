{
  super(corePoolSize,maximumPoolSize,keepAliveTime,unit,workQueue,threadFactory);
  if (maximumPoolSize > 1) {
    this.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
  }
 else {
    this.setRejectedExecutionHandler(new RejectedExecutionHandler(){
      public void rejectedExecution(      Runnable task,      ThreadPoolExecutor executor){
        BlockingQueue<Runnable> queue=executor.getQueue();
        while (true) {
          if (executor.isShutdown())           throw new RejectedExecutionException("ThreadPoolExecutor has shut down");
          try {
            if (queue.offer(task,1000,TimeUnit.MILLISECONDS))             break;
          }
 catch (          InterruptedException e) {
            throw new AssertionError(e);
          }
        }
      }
    }
);
  }
}
