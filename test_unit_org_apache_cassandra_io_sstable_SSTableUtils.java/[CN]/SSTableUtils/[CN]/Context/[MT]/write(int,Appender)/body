{
  File datafile=(dest == null) ? tempSSTableFile(ksname,cfname,generation) : new File(dest.filenameFor(Component.DATA));
  SSTableWriter writer=SSTableWriter.create(Descriptor.fromFilename(datafile.getAbsolutePath()),expectedSize,ActiveRepairService.UNREPAIRED_SSTABLE,0);
  while (appender.append(writer)) {
  }
  SSTableReader reader=writer.closeAndOpenReader();
  if (cleanup)   for (  Component component : reader.components)   new File(reader.descriptor.filenameFor(component)).deleteOnExit();
  return reader;
}
