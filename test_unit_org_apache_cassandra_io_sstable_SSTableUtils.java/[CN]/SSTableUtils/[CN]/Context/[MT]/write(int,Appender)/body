{
  File datafile=(dest == null) ? tempSSTableFile(ksname,cfname,generation) : new File(dest.filenameFor(Component.DATA));
  SSTableWriter writer=new SSTableWriter(datafile.getAbsolutePath(),expectedSize);
  long start=System.currentTimeMillis();
  while (appender.append(writer)) {
  }
  SSTableReader reader=writer.closeAndOpenReader();
  if (cleanup)   for (  Component component : reader.components)   new File(reader.descriptor.filenameFor(component)).deleteOnExit();
  return reader;
}
