{
  File tempdir=File.createTempFile(keyspaceName,cfname);
  if (!tempdir.delete() || !tempdir.mkdir())   throw new IOException("Temporary directory creation failed.");
  tempdir.deleteOnExit();
  File keyspaceDir=new File(tempdir,keyspaceName);
  keyspaceDir.mkdir();
  keyspaceDir.deleteOnExit();
  File datafile=new File(new Descriptor(keyspaceDir,keyspaceName,cfname,generation,Descriptor.Type.FINAL).filenameFor("Data.db"));
  if (!datafile.createNewFile())   throw new IOException("unable to create file " + datafile);
  datafile.deleteOnExit();
  return datafile;
}
