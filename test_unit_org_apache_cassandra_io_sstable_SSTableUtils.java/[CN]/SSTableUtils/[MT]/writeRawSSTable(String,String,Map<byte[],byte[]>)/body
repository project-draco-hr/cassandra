{
  File datafile=tempSSTableFile(tablename,cfname);
  SSTableWriter writer=new SSTableWriter(datafile.getAbsolutePath(),entries.size());
  SortedMap<DecoratedKey,byte[]> sortedEntries=new TreeMap<DecoratedKey,byte[]>();
  for (  Map.Entry<byte[],byte[]> entry : entries.entrySet())   sortedEntries.put(writer.partitioner.decorateKey(entry.getKey()),entry.getValue());
  for (  Map.Entry<DecoratedKey,byte[]> entry : sortedEntries.entrySet())   writer.append(entry.getKey(),entry.getValue());
  new File(writer.desc.filenameFor(Component.PRIMARY_INDEX)).deleteOnExit();
  new File(writer.desc.filenameFor(Component.FILTER)).deleteOnExit();
  return writer.closeAndOpenReader();
}
