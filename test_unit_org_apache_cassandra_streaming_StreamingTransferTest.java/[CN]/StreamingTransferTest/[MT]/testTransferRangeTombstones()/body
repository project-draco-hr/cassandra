{
  String ks=KEYSPACE1;
  String cfname="StandardInteger1";
  Keyspace keyspace=Keyspace.open(ks);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  String key="key0";
  Mutation rm=new Mutation(ks,ByteBufferUtil.bytes(key));
  rm.add(cfname,cellname(1),ByteBuffer.wrap(new byte[DatabaseDescriptor.getColumnIndexSize() - 64]),2);
  rm.add(cfname,cellname(6),ByteBuffer.wrap(new byte[DatabaseDescriptor.getColumnIndexSize()]),2);
  ColumnFamily cf=rm.addOrGet(cfname);
  cf.delete(new DeletionInfo(cellname(2),cellname(3),cf.getComparator(),1,(int)(System.currentTimeMillis() / 1000)));
  cf.delete(new DeletionInfo(cellname(5),cellname(7),cf.getComparator(),1,(int)(System.currentTimeMillis() / 1000)));
  cf.delete(new DeletionInfo(cellname(8),cellname(10),cf.getComparator(),1,(int)(System.currentTimeMillis() / 1000)));
  rm.applyUnsafe();
  key="key1";
  rm=new Mutation(ks,ByteBufferUtil.bytes(key));
  rm.add(cfname,cellname(1),ByteBuffer.wrap(new byte[DatabaseDescriptor.getColumnIndexSize() - 64]),2);
  cf=rm.addOrGet(cfname);
  cf.delete(new DeletionInfo(cellname(2),cellname(3),cf.getComparator(),1,(int)(System.currentTimeMillis() / 1000)));
  rm.applyUnsafe();
  cfs.forceBlockingFlush();
  int cellCount=countCells(cfs);
  SSTableReader sstable=cfs.getSSTables().iterator().next();
  cfs.clearUnsafe();
  transferSSTables(sstable);
  assertEquals(1,cfs.getSSTables().size());
  assertEquals(cellCount,countCells(cfs));
  List<Row> rows=Util.getRangeSlice(cfs);
  assertEquals(2,rows.size());
}
