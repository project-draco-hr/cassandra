{
  if (logger.isDebugEnabled())   logger.debug(String.format("Binding avro service to %s:%s",listenAddr,listenPort));
  CassandraServer cassandraServer=new CassandraServer();
  SpecificResponder responder=new SpecificResponder(Cassandra.class,cassandraServer);
  logger.info("Listening for avro clients...");
  server=new org.mortbay.jetty.Server(listenPort);
  server.setThreadPool(new CleaningThreadPool(cassandraServer.clientState,DatabaseDescriptor.getRpcMinThreads(),DatabaseDescriptor.getRpcMaxThreads()));
  try {
    ResponderServlet servlet=new ResponderServlet(responder);
    new Context(server,"/").addServlet(new ServletHolder(servlet),"/*");
    server.start();
  }
 catch (  Exception e) {
    throw new RuntimeException("Could not start Avro server.",e);
  }
}
