{
  super(file,parameters.chunkLength(),skipIOCache);
  this.compressor=parameters.sstableCompressor;
  compressed=new ICompressor.WrappedArray(new byte[compressor.initialCompressedBufferLength(buffer.length)]);
  metadataWriter=CompressionMetadata.Writer.open(offsetsPath);
  metadataWriter.writeHeader(parameters);
  this.sstableMetadataCollector=sstableMetadataCollector;
  crcMetadata=new DataIntegrityMetadata.ChecksumWriter(out);
}
