{
  super(file,parameters.chunkLength(),parameters.sstableCompressor.useDirectOutputByteBuffers());
  this.compressor=parameters.sstableCompressor;
  compressed=compressor.useDirectOutputByteBuffers() ? new ICompressor.WrappedByteBuffer(ByteBuffer.allocateDirect(compressor.initialCompressedBufferLength(buffer.capacity()))) : new ICompressor.WrappedByteBuffer(ByteBuffer.allocate(compressor.initialCompressedBufferLength(buffer.capacity())));
  metadataWriter=CompressionMetadata.Writer.open(parameters,offsetsPath);
  this.sstableMetadataCollector=sstableMetadataCollector;
  crcMetadata=new DataIntegrityMetadata.ChecksumWriter(new DataOutputStream(Channels.newOutputStream(channel)));
}
