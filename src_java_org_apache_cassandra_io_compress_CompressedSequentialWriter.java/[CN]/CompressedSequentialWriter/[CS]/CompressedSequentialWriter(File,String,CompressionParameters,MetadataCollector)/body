{
  super(file,parameters.chunkLength(),parameters.sstableCompressor.preferredBufferType());
  this.compressor=parameters.sstableCompressor;
  compressed=compressor.preferredBufferType().allocate(compressor.initialCompressedBufferLength(buffer.capacity()));
  metadataWriter=CompressionMetadata.Writer.open(parameters,offsetsPath);
  this.sstableMetadataCollector=sstableMetadataCollector;
  crcMetadata=new DataIntegrityMetadata.ChecksumWriter(new DataOutputStream(Channels.newOutputStream(channel)));
}
