{
  super(file,parameters.chunkLength());
  this.compressor=parameters.sstableCompressor;
  compressed=new ICompressor.WrappedArray(new byte[compressor.initialCompressedBufferLength(buffer.length)]);
  metadataWriter=CompressionMetadata.Writer.open(parameters,offsetsPath);
  this.sstableMetadataCollector=sstableMetadataCollector;
  crcMetadata=new DataIntegrityMetadata.ChecksumWriter(out);
}
