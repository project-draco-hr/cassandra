{
  seekToChunkStart();
  int compressedLength=Snappy.rawCompress(buffer,0,validBufferBytes,compressed,0);
  metadataWriter.writeLong(chunkOffset);
  chunkCount++;
  out.write(compressed,0,compressedLength);
  chunkOffset+=compressedLength;
}
