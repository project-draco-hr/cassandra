{
  final int SAMPLES_CAP=10000, BYTES_CAP=(int)Math.min(10000000,ifile.length());
  int keys=0;
  while (ifile.getFilePointer() < BYTES_CAP && keys < SAMPLES_CAP) {
    FBUtilities.skipShortByteArray(ifile);
    ifile.skipBytes(8);
    keys++;
  }
  long estimatedRows=ifile.length() / (ifile.getFilePointer() / keys);
  ifile.seek(0);
  return estimatedRows;
}
