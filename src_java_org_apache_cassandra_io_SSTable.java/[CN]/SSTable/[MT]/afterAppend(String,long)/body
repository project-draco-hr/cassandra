{
  bf.add(decoratedKey);
  lastWrittenKey_=decoratedKey;
  long indexPosition=indexRAF_.getFilePointer();
  indexRAF_.writeUTF(decoratedKey);
  indexRAF_.writeLong(position);
  logger_.trace("wrote " + decoratedKey + " at "+ position);
  if (keysWritten++ % indexInterval_ != 0)   return;
  if (indexPositions_ == null) {
    indexPositions_=new ArrayList<KeyPosition>();
  }
  indexPositions_.add(new KeyPosition(decoratedKey,indexPosition,partitioner_));
  logger_.trace("wrote index of " + decoratedKey + " at "+ indexPosition);
}
