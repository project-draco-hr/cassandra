{
  lastWrittenKey_=decoratedKey;
  long indexPosition=indexRAF_.getFilePointer();
  indexRAF_.writeUTF(decoratedKey);
  indexRAF_.writeLong(position);
  logger_.trace("wrote " + decoratedKey + " at "+ position);
  if (keysWritten++ % indexInterval_ != 0)   return;
  List<KeyPosition> indexEntries=SSTable.indexMetadataMap_.get(dataFile_);
  if (indexEntries == null) {
    indexEntries=new ArrayList<KeyPosition>();
    SSTable.indexMetadataMap_.put(dataFile_,indexEntries);
  }
  indexEntries.add(new KeyPosition(decoratedKey,indexPosition,partitioner_));
  logger_.trace("wrote index of " + decoratedKey + " at "+ indexPosition);
}
