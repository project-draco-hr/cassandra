{
  ++indexKeysWritten_;
  lastWrittenKey_=decoratedKey;
  blockIndex_.put(decoratedKey,new SSTableIndex.BlockMetadata(position,size));
  if (indexKeysWritten_ == indexInterval_) {
    blockIndexes_.add(blockIndex_);
    blockIndex_=new TreeMap<String,SSTableIndex.BlockMetadata>(partitioner_.getReverseDecoratedKeyComparator());
    indexKeysWritten_=0;
  }
}
