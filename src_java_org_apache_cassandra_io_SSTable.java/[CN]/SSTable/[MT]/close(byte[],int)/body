{
  if (dataWriter_ != null) {
    long bloomFilterPosition=dataWriter_.getCurrentPosition();
    dataWriter_.close(footer,size);
    dataWriter_.writeDirect(BasicUtilities.longToByteArray(version_));
    long blockPosition=dataWriter_.getCurrentPosition() - firstBlockPosition_;
    dataWriter_.writeDirect(BasicUtilities.longToByteArray(blockPosition));
    long bloomFilterRelativePosition=dataWriter_.getCurrentPosition() - bloomFilterPosition;
    dataWriter_.writeDirect(BasicUtilities.longToByteArray(bloomFilterRelativePosition));
    dataWriter_.close();
  }
}
