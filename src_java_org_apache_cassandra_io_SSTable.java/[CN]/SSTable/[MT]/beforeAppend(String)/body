{
  if (decoratedKey == null) {
    throw new IOException("Keys must not be null.");
  }
  Comparator<String> c=partitioner_.getDecoratedKeyComparator();
  if (lastWrittenKey_ != null && c.compare(lastWrittenKey_,decoratedKey) > 0) {
    logger_.info("Last written key : " + lastWrittenKey_);
    logger_.info("Current key : " + decoratedKey);
    logger_.info("Writing into file " + dataFile_);
    throw new IOException("Keys must be written in ascending order.");
  }
  return (lastWrittenKey_ == null) ? SSTable.positionAfterFirstBlockIndex_ : dataWriter_.getCurrentPosition();
}
