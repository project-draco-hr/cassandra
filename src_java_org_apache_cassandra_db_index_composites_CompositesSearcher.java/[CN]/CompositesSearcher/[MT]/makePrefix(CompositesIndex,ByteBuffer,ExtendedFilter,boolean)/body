{
  if (key.remaining() == 0)   return ByteBufferUtil.EMPTY_BYTE_BUFFER;
  ColumnNameBuilder builder;
  if (filter.originalFilter() instanceof SliceQueryFilter) {
    SliceQueryFilter originalFilter=(SliceQueryFilter)filter.originalFilter();
    builder=index.makeIndexColumnNameBuilder(key,isStart ? originalFilter.start() : originalFilter.finish());
  }
 else {
    builder=index.getIndexComparator().builder().add(key);
  }
  return isStart ? builder.build() : builder.buildAsEndOfRange();
}
