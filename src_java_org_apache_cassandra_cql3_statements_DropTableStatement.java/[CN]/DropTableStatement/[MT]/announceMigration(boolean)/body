{
  try {
    CFMetaData cfm=Schema.instance.getCFMetaData(keyspace(),columnFamily());
    if (cfm != null) {
      if (cfm.isMaterializedView())       throw new InvalidRequestException("Cannot use DROP TABLE on Materialized View");
      boolean rejectDrop=false;
      StringBuilder messageBuilder=new StringBuilder();
      for (      MaterializedViewDefinition def : cfm.getMaterializedViews()) {
        if (rejectDrop)         messageBuilder.append(',');
        rejectDrop=true;
        messageBuilder.append(def.viewName);
      }
      if (rejectDrop) {
        throw new InvalidRequestException(String.format("Cannot drop table when materialized views still depend on it (%s.{%s})",keyspace(),messageBuilder.toString()));
      }
    }
    MigrationManager.announceColumnFamilyDrop(keyspace(),columnFamily(),isLocalOnly);
    return true;
  }
 catch (  ConfigurationException e) {
    if (ifExists)     return false;
    throw e;
  }
}
