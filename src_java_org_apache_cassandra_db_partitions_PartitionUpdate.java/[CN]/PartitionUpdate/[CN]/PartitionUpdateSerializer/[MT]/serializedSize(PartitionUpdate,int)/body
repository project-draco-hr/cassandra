{
  if (version < MessagingService.VERSION_30) {
    throw new UnsupportedOperationException("Version is " + version);
  }
  try (UnfilteredRowIterator iter=update.sliceableUnfilteredIterator()){
    return CFMetaData.serializer.serializedSize(update.metadata(),version) + UnfilteredRowIteratorSerializer.serializer.serializedSize(iter,version,update.rows.size());
  }
 }
