{
  CFMetaData metadata=iterator.metadata();
  boolean reversed=iterator.isReverseOrder();
  List<Row> rows=new ArrayList<>();
  EncodingStats.Collector collector=new EncodingStats.Collector();
  while (iterator.hasNext()) {
    Row row=iterator.next();
    rows.add(row);
    Rows.collectStats(row,collector);
  }
  if (reversed)   Collections.reverse(rows);
  return new PartitionUpdate(metadata,iterator.partitionKey(),iterator.columns(),iterator.staticRow(),rows,MutableDeletionInfo.live(),collector.get(),true,false);
}
