{
  try {
    BufferedReader bufReader=new BufferedReader(new InputStreamReader(new FileInputStream(filepath)),16 * 1024 * 1024);
    String line=null;
    RowMutation rm=null;
    while ((line=bufReader.readLine()) != null) {
      String columns[]=line.split("\t");
      if (columns.length < 7)       continue;
      if (rm == null) {
        rm=new RowMutation("Mailbox",columns[0]);
      }
      Analyzer analyzer=new StandardAnalyzer();
      String body=null;
      if (columns.length > 7)       body=columns[6] + " " + columns[7];
 else       body=columns[6];
      TokenStream ts=analyzer.tokenStream("superColumn",new StringReader(body));
      Token token=null;
      token=ts.next();
      while (token != null) {
        if (token.termText() != "") {
          rm.add("MailboxThreadList0:" + token.termText() + ":"+ columns[1],columns[2].getBytes(),Integer.parseInt(columns[3]));
        }
        token=ts.next();
      }
      rm.add("MailboxMailList0:" + columns[1],columns[2].getBytes(),Integer.parseInt(columns[3]));
      String authors=columns[5];
      String participants=columns[4];
      if (authors == null)       authors="";
      if (participants == null)       participants="";
      String[] authorList=authors.split(":");
      String[] partList=participants.split(":");
      String[] mailersList=null;
      if (checkUser(columns[0],authorList))       mailersList=partList;
 else       mailersList=authorList;
      for (      String mailer : mailersList) {
        if (!mailer.equals(columns[0])) {
          rm.add("MailboxUserList0:" + mailer + ":"+ columns[1],columns[2].getBytes(),Integer.parseInt(columns[3]));
        }
      }
    }
    if (rm != null) {
      rm.apply();
    }
  }
 catch (  Throwable ex) {
    logger_.error(LogUtil.throwableToString(ex));
  }
}
