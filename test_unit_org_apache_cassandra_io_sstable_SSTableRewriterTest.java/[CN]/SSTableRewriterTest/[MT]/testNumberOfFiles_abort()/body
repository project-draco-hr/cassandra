{
  testNumberOfFiles_abort(new RewriterTest(){
    public void run(    ISSTableScanner scanner,    CompactionController controller,    SSTableReader sstable,    ColumnFamilyStore cfs,    SSTableRewriter rewriter){
      int files=1;
      while (scanner.hasNext()) {
        rewriter.append(new LazilyCompactedRow(controller,Arrays.asList(scanner.next())));
        if (rewriter.currentWriter().getFilePointer() > 25000000) {
          rewriter.switchWriter(getWriter(cfs,sstable.descriptor.directory));
          files++;
          assertEquals(cfs.getSSTables().size(),files);
        }
      }
      rewriter.abort();
    }
  }
);
}
