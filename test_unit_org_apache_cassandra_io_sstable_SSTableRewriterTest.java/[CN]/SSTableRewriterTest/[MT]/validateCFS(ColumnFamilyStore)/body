{
  Set<Integer> liveDescriptors=new HashSet<>();
  for (  SSTableReader sstable : cfs.getSSTables()) {
    assertFalse(sstable.isMarkedCompacted());
    assertEquals(1,sstable.sharedRef().globalCount());
    liveDescriptors.add(sstable.descriptor.generation);
  }
  for (  File dir : cfs.directories.getCFDirectories()) {
    for (    String f : dir.list()) {
      if (f.contains("Data")) {
        Descriptor d=Descriptor.fromFilename(f);
        assertTrue(d.toString(),liveDescriptors.contains(d.generation));
      }
    }
  }
  assertTrue(cfs.getDataTracker().getCompacting().isEmpty());
}
