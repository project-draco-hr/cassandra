{
  org.apache.cassandra.db.migration.avro.Migration mi=SerDeUtils.deserializeWithSchema(bytes,new org.apache.cassandra.db.migration.avro.Migration());
  Migration migration;
  try {
    Class migrationClass=Class.forName(mi.classname.toString());
    Constructor migrationConstructor=migrationClass.getDeclaredConstructor();
    migrationConstructor.setAccessible(true);
    migration=(Migration)migrationConstructor.newInstance();
  }
 catch (  Exception e) {
    throw new RuntimeException("Invalid migration class: " + mi.classname.toString(),e);
  }
  migration.lastVersion=UUIDGen.makeType1UUID(mi.old_version.bytes());
  migration.newVersion=UUIDGen.makeType1UUID(mi.new_version.bytes());
  try {
    migration.rm=RowMutation.serializer().deserialize(SerDeUtils.createDataInputStream(mi.row_mutation));
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  migration.subinflate(mi);
  return migration;
}
