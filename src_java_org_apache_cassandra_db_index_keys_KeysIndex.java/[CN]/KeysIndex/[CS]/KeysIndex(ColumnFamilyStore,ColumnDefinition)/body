{
  super(baseCfs,cdef);
  fullMemtables=new ConcurrentSkipListSet<Memtable>();
  IPartitioner<?> rowPartitioner=StorageService.getPartitioner();
  AbstractType<?> columnComparator=(rowPartitioner instanceof OrderPreservingPartitioner || rowPartitioner instanceof ByteOrderedPartitioner) ? BytesType.instance : new LocalByPartionerType(StorageService.getPartitioner());
  final CFMetaData indexedCfMetadata=CFMetaData.newIndexMetadata(baseCfs.metadata,cdef,columnComparator);
  indexedCfs=ColumnFamilyStore.createColumnFamilyStore(baseCfs.table,indexedCfMetadata.cfName,new LocalPartitioner(cdef.getValidator()),indexedCfMetadata);
}
