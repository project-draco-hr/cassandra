{
  super(reversed ? slices.length - 1 : 0);
  boolean inSlice=false;
  int columnCount=sstable.descriptor.version.hasRowSizeAndColumnCount ? file.readInt() : Integer.MAX_VALUE;
  Iterator<OnDiskAtom> atomIterator=emptyColumnFamily.metadata().getOnDiskIterator(file,columnCount,sstable.descriptor.version);
  OnDiskAtom column=null;
  while (atomIterator.hasNext() || column != null) {
    if (column == null)     column=atomIterator.next();
    if (!inSlice && isColumnBeforeSliceStart(column)) {
      if (column instanceof RangeTombstone && !isBeforeSliceStart(((RangeTombstone)column).max))       addColumn(column);
      column=null;
      continue;
    }
    if (isColumnBeforeSliceFinish(column)) {
      inSlice=true;
      addColumn(column);
      column=null;
    }
 else {
      inSlice=false;
      if (!setNextSlice())       break;
    }
  }
}
