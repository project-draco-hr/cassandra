{
  Tracing.trace("Seeking to partition indexed section in data file");
  this.sstable=sstable;
  this.originalInput=input;
  this.reversed=reversed;
  this.slices=slices;
  this.comparator=sstable.metadata.comparator;
  this.rangeTombstonesReversed=reversed ? new ArrayDeque<OnDiskAtom>() : null;
  try {
    Descriptor.Version version=sstable.descriptor.version;
    if (version.hasPromotedIndexes) {
      this.indexes=indexEntry.columnsIndex();
      if (indexes.isEmpty()) {
        setToRowStart(sstable,indexEntry,input);
        this.emptyColumnFamily=ColumnFamily.create(sstable.metadata);
        emptyColumnFamily.delete(DeletionInfo.serializer().deserializeFromSSTable(file,version));
        fetcher=new SimpleBlockFetcher();
      }
 else {
        this.emptyColumnFamily=ColumnFamily.create(sstable.metadata);
        emptyColumnFamily.delete(indexEntry.deletionTime());
        fetcher=new IndexedBlockFetcher(indexEntry.position);
      }
    }
 else {
      setToRowStart(sstable,indexEntry,input);
      IndexHelper.skipBloomFilter(file);
      this.indexes=IndexHelper.deserializeIndex(file);
      this.emptyColumnFamily=ColumnFamily.create(sstable.metadata);
      emptyColumnFamily.delete(DeletionInfo.serializer().deserializeFromSSTable(file,version));
      fetcher=indexes.isEmpty() ? new SimpleBlockFetcher() : new IndexedBlockFetcher(file.getFilePointer() + 4);
    }
  }
 catch (  IOException e) {
    sstable.markSuspect();
    throw new CorruptSSTableException(e,file.getPath());
  }
}
