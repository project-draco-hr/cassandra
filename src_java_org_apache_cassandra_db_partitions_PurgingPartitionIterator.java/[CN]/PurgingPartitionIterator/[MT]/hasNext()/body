{
  while (next == null && super.hasNext()) {
    UnfilteredRowIterator iterator=super.next();
    onNewPartition(iterator.partitionKey());
    UnfilteredRowIterator purged=purge(iterator);
    if (isForThrift() || !purged.isEmpty()) {
      next=purged;
      return true;
    }
    onEmptyPartitionPostPurge(purged.partitionKey());
    purged.close();
  }
  return next != null;
}
