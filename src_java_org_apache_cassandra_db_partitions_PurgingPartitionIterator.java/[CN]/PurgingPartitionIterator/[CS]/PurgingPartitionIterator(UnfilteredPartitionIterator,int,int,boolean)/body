{
  super(iterator);
  this.gcBefore=gcBefore;
  this.purger=new DeletionPurger(){
    public boolean shouldPurge(    long timestamp,    int localDeletionTime){
      if (onlyPurgeRepairedTombstones && localDeletionTime >= oldestUnrepairedTombstone)       return false;
      return timestamp < getMaxPurgeableTimestamp() && localDeletionTime < gcBefore;
    }
  }
;
}
