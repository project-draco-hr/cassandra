{
  if (!activeSegment.hasCapacityFor(rowMutation)) {
    CommitLogSegment oldSegment=activeSegment;
    activateNextSegment();
    archiver.maybeArchive(oldSegment.getPath(),oldSegment.getName());
  }
  try {
    activeSegment.write(rowMutation);
  }
 catch (  IOException e) {
    throw new FSWriteError(e,activeSegment.getPath());
  }
}
