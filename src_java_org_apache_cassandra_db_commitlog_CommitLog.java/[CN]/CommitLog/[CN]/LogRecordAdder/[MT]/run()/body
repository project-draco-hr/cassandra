{
  try {
    if (!activeSegment.hasCapacityFor(rowMutation)) {
      CommitLogSegment oldSegment=activeSegment;
      activateNextSegment();
      archiver.maybeArchive(oldSegment.getPath(),oldSegment.getName());
    }
    activeSegment.write(rowMutation);
  }
 catch (  IOException e) {
    throw new IOError(e);
  }
}
