{
  String directory=DatabaseDescriptor.getCommitLogLocation();
  File[] files=new File(directory).listFiles(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return CommitLogSegment.possibleCommitLogFile(name);
    }
  }
);
  if (files.length == 0)   return;
  Arrays.sort(files,new FileUtils.FileComparator());
  logger.info("Replaying " + StringUtils.join(files,", "));
  recover(files);
  for (  File f : files) {
    FileUtils.delete(CommitLogHeader.getHeaderPathFromSegmentPath(f.getAbsolutePath()));
    FileUtils.deleteWithConfirm(f);
  }
  logger.info("Log replay complete");
}
