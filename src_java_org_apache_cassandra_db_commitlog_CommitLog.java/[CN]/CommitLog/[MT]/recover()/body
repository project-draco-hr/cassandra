{
  String directory=DatabaseDescriptor.getCommitLogLocation();
  File[] files=new File(directory).listFiles(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return CommitLogSegment.possibleCommitLogFile(name) && !instance.manages(name);
    }
  }
);
  if (files.length == 0) {
    logger.info("No commitlog files found; skipping replay");
    return 0;
  }
  Arrays.sort(files,new FileUtils.FileComparator());
  logger.info("Replaying " + StringUtils.join(files,", "));
  int replayed=recover(files);
  for (  File f : files) {
    if (!f.delete())     logger.error("Unable to remove " + f + "; you should remove it manually or next restart will replay it again (harmless, but time-consuming)");
  }
  logger.info("Log replay complete, " + replayed + " replayed mutations");
  return replayed;
}
