{
  if (logWriter.length() >= SEGMENT_SIZE) {
    setNextFileName();
    String oldLogFile=logWriter.getPath();
    logWriter.close();
    logWriter=CommitLog.createWriter(logFile);
    clHeaders.put(oldLogFile,new CommitLogHeader(clHeader));
    clHeader.clear();
    writeCommitLogHeader(logWriter,clHeader.toByteArray());
    return true;
  }
  return false;
}
