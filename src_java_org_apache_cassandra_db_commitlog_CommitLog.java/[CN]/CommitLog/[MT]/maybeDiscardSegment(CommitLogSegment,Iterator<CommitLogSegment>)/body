{
  if (segment.isSafeToDelete() && iter.hasNext()) {
    logger.info("Discarding obsolete commit log:" + segment);
    segment.close();
    DeletionService.executeDelete(segment.getPath());
    iter.remove();
  }
 else {
    if (logger.isDebugEnabled())     logger.debug("Not safe to delete commit log " + segment + "; dirty is "+ segment.dirtyString()+ "; hasNext: "+ iter.hasNext());
  }
}
