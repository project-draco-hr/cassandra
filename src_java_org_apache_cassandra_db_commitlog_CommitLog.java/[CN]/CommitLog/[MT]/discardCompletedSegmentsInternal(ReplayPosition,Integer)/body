{
  if (logger.isDebugEnabled())   logger.debug("discard completed log segments for " + context + ", column family "+ id+ ".");
  Iterator<CommitLogSegment> iter=segments.iterator();
  while (iter.hasNext()) {
    CommitLogSegment segment=iter.next();
    if (segment.id == context.segment) {
      segment.turnOffIfNotWritten(id,context.position);
      maybeDiscardSegment(segment,iter);
      break;
    }
    segment.turnOff(id);
    maybeDiscardSegment(segment,iter);
  }
}
