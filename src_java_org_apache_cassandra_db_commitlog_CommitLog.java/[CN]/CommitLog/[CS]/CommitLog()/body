{
  try {
    DatabaseDescriptor.createAllDirectories();
    segmentSize=DatabaseDescriptor.getCommitLogSegmentSize();
  }
 catch (  IOException e) {
    throw new IOError(e);
  }
  segments.add(new CommitLogSegment());
  executor=DatabaseDescriptor.getCommitLogSync() == Config.CommitLogSync.batch ? new BatchCommitLogExecutorService() : new PeriodicCommitLogExecutorService(this);
}
