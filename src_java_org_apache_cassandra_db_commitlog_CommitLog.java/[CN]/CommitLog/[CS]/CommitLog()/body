{
  int cfSize=Table.TableMetadata.getColumnFamilyCount();
  segments.add(new CommitLogSegment(cfSize));
  if (DatabaseDescriptor.getCommitLogSync() == DatabaseDescriptor.CommitLogSync.periodic) {
    final Runnable syncer=new WrappedRunnable(){
      public void runMayThrow() throws IOException {
        sync();
      }
    }
;
    new Thread(new Runnable(){
      public void run(){
        while (true) {
          try {
            executor.submit(syncer).get();
            Thread.sleep(DatabaseDescriptor.getCommitLogSyncPeriod());
          }
 catch (          InterruptedException e) {
            throw new AssertionError(e);
          }
catch (          ExecutionException e) {
            throw new RuntimeException(e);
          }
        }
      }
    }
,"PERIODIC-COMMIT-LOG-SYNCER").start();
  }
}
