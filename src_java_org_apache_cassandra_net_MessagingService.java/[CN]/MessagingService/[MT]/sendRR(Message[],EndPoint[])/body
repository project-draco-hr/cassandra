{
  if (messages.length != to.length) {
    throw new IllegalArgumentException("Number of messages and the number of endpoints need to be same.");
  }
  IAsyncResult iar=new MultiAsyncResult(messages.length);
  String groupId=GuidGenerator.guid();
  taskCompletionMap_.put(groupId,iar);
  for (int i=0; i < messages.length; ++i) {
    messages[i].setMessageId(groupId);
    sendOneWay(messages[i],to[i]);
  }
  return iar;
}
