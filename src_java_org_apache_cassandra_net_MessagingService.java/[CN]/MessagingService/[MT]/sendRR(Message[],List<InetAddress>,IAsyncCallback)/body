{
  if (messages.length != to.size())   throw new IllegalArgumentException("Number of messages and the number of endpoints need to be same.");
  String groupId=GuidGenerator.guid();
  addCallback(cb,groupId);
  for (int i=0; i < messages.length; ++i) {
    messages[i].setMessageId(groupId);
    targets.put(groupId,to.get(i));
    sendOneWay(messages[i],to.get(i));
  }
  return groupId;
}
