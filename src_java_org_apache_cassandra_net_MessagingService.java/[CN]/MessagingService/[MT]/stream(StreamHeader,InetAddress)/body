{
  DebuggableThreadPoolExecutor executor=streamExecutors.get(to);
  if (executor == null) {
    executor=DebuggableThreadPoolExecutor.createWithMaximumPoolSize("Streaming to " + to,1,1,TimeUnit.SECONDS);
    DebuggableThreadPoolExecutor old=streamExecutors.putIfAbsent(to,executor);
    if (old != null) {
      executor.shutdown();
      executor=old;
    }
  }
  executor.execute(header.file == null || header.file.compressionInfo == null ? new FileStreamTask(header,to) : new CompressedFileStreamTask(header,to));
}
