{
  while (true) {
    boolean stillWaiting=false;
    streamExecutorsLock.lock();
    try {
      for (      DebuggableThreadPoolExecutor e : streamExecutors.values()) {
        e.shutdown();
        if (!e.isTerminated()) {
          stillWaiting=true;
          break;
        }
      }
    }
  finally {
      streamExecutorsLock.unlock();
    }
    if (stillWaiting) {
      Thread.sleep(1000);
    }
 else {
      break;
    }
  }
}
