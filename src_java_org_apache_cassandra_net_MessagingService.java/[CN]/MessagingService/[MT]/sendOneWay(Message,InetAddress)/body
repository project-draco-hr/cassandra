{
  if (message.getFrom().equals(to)) {
    MessagingService.receive(message);
    return;
  }
  Message processedMessage=SinkManager.processClientMessage(message,to);
  if (processedMessage == null) {
    return;
  }
  OutboundTcpConnection connection=getConnection(to,message);
  ByteBuffer buffer=serialize(message);
  connection.write(buffer);
}
