{
  Function func=Functions.find(fName,argTypes);
  if (func == null)   throw new InvalidRequestException(String.format("Referenced state function '%s %s' for aggregate '%s' does not exist",fName,Arrays.toString(UDHelper.driverTypes(argTypes)),aName));
  if (!(func instanceof ScalarFunction))   throw new InvalidRequestException(String.format("Referenced state function '%s %s' for aggregate '%s' is not a scalar function",fName,Arrays.toString(UDHelper.driverTypes(argTypes)),aName));
  return (ScalarFunction)func;
}
