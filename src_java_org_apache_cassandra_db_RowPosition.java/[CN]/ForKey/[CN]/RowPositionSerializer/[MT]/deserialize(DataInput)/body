{
  Kind kind=Kind.fromOrdinal(in.readByte());
  if (kind == Kind.ROW_KEY) {
    ByteBuffer k=ByteBufferUtil.readWithShortLength(in);
    return StorageService.getPartitioner().decorateKey(k);
  }
 else {
    Token t=Token.serializer.deserialize(in);
    return kind == Kind.MIN_BOUND ? t.minKeyBound() : t.maxKeyBound();
  }
}
