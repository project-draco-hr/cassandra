{
  ++indexKeysWritten_;
  lastWrittenKey_=key;
  blockIndex_.put(key,new BlockMetadata(position,size));
  if (indexKeysWritten_ == indexInterval_) {
    blockIndexes_.add(blockIndex_);
    blockIndex_=new TreeMap<String,BlockMetadata>(Collections.reverseOrder());
    indexKeysWritten_=0;
  }
}
