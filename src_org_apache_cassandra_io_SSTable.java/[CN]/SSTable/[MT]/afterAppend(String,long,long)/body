{
  ++indexKeysWritten_;
  lastWrittenKey_=decoratedKey;
  blockIndex_.put(decoratedKey,new BlockMetadata(position,size));
  if (indexKeysWritten_ == indexInterval_) {
    blockIndexes_.add(blockIndex_);
    blockIndex_=new TreeMap<String,BlockMetadata>(StorageService.getPartitioner().getReverseDecoratedKeyComparator());
    indexKeysWritten_=0;
  }
}
