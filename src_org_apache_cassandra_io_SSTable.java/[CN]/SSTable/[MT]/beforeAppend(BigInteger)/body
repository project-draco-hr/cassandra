{
  if (hash == null)   throw new IOException("Keys must not be null.");
  if (lastWrittenKey_ != null) {
    BigInteger previousKey=new BigInteger(lastWrittenKey_);
    if (hash.compareTo(previousKey) <= 0) {
      logger_.info("Last written key : " + previousKey);
      logger_.info("Current key : " + hash);
      logger_.info("Writing into file " + dataFile_);
      throw new IOException("Keys must be written in ascending order.");
    }
  }
  long currentPosition=(lastWrittenKey_ == null) ? SSTable.positionAfterFirstBlockIndex_ : dataWriter_.getCurrentPosition();
  return currentPosition;
}
