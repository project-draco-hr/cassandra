{
  super(cfs,directories,txn,nonExpiredSSTables,offline,keepOriginals);
  this.allSSTables=txn.originals();
  this.level=level;
  this.maxSSTableSize=maxSSTableSize;
  long totalSize=cfs.getExpectedCompactedFileSize(nonExpiredSSTables,txn.opType());
  expectedWriteSize=Math.min(maxSSTableSize,totalSize);
  estimatedTotalKeys=SSTableReader.getApproximateKeyCount(nonExpiredSSTables);
  estimatedSSTables=Math.max(1,estimatedTotalKeys / maxSSTableSize);
}
