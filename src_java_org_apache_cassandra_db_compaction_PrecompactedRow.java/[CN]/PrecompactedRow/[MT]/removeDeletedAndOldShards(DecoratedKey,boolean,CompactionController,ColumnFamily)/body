{
  ColumnFamily compacted=ColumnFamilyStore.removeDeleted(cf,shouldPurge ? controller.gcBefore : Integer.MIN_VALUE,controller.cfs.indexManager.updaterFor(key));
  if (shouldPurge && compacted != null && compacted.metadata().getDefaultValidator().isCommutative())   CounterColumn.mergeAndRemoveOldShards(key,compacted,controller.gcBefore,controller.mergeShardBefore);
  return compacted;
}
