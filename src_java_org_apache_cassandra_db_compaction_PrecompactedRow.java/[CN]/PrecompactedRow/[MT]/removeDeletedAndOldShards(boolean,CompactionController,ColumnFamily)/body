{
  ColumnFamily compacted=shouldPurge ? ColumnFamilyStore.removeDeleted(cf,controller.gcBefore) : cf;
  if (shouldPurge && compacted != null && compacted.metadata().getDefaultValidator().isCommutative())   CounterColumn.removeOldShards(compacted,controller.gcBefore);
  return compacted;
}
