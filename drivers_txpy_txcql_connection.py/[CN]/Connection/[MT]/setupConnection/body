def setupConnection(self):
    d = defer.succeed(True)
    if self.credentials:
        d.addCallback((lambda _: self.client.login(AuthenticationRequest(credentials=self.credentials))))
    if self.keyspace:
        d.addCallback((lambda _: self.execute(('USE %s;' % self.keyspace))))
    if (not self.decoder):
        d.addCallback(self.__getSchema)
    return d
