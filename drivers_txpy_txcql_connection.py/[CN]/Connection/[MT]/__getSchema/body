def __getSchema(self, res=None):

    def columns(metadata):
        results = {}
        for col in metadata:
            results[col.name] = col.validation_class
        return results

    def column_families(cf_defs):
        cfresults = {}
        for cf in cf_defs:
            cfresults[cf.name] = {'comparator': cf.comparator_type, }
            cfresults[cf.name]['default_validation_class'] = cf.default_validation_class
            cfresults[cf.name]['columns'] = columns(cf.column_metadata)
        return cfresults

    def setSchema(ksdefs):
        schema = {}
        for ksdef in ksdefs:
            schema[ksdef.name] = column_families(ksdef.cf_defs)
        self.decoder = SchemaDecoder(schema)
        return True
    d = self.client.describe_keyspaces()
    d.addCallback(setSchema)
    return d
