def prepare(self, query, *args):
    prepared_query = prepare(query, *args)
    match = connection._cfamily_re.match(prepared_query)
    if match:
        self.column_family = match.group(1)
    else:
        match = connection._keyspace_re.match(prepared_query)
        if match:
            self.keyspace = match.group(1)
    return prepared_query
