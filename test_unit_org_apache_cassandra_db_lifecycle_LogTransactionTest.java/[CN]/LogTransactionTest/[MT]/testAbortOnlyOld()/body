{
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  SSTableReader sstable=sstable(cfs,0,128);
  LogTransaction log=new LogTransaction(OperationType.COMPACTION,cfs.metadata);
  assertNotNull(log);
  LogTransaction.SSTableTidier tidier=log.obsoleted(sstable);
  assertNotNull(tidier);
  tidier.abort();
  log.abort();
  sstable.selfRef().release();
  assertFiles(log.getDataFolder(),new HashSet<>(sstable.getAllFilePaths()));
}
