{
  PartitionUpdate update=new PartitionUpdate(iterator.metadata(),iterator.partitionKey(),iterator.columns(),1);
  update.addPartitionDeletion(iterator.partitionLevelDeletion());
  if (iterator.staticRow() != Rows.EMPTY_STATIC_ROW)   iterator.staticRow().copyTo(update.staticWriter());
  while (iterator.hasNext()) {
    Unfiltered unfiltered=iterator.next();
    if (unfiltered.kind() == Unfiltered.Kind.ROW)     ((Row)unfiltered).copyTo(update.writer());
 else     ((RangeTombstoneMarker)unfiltered).copyTo(update.markerWriter(iterator.isReverseOrder()));
  }
  return update;
}
