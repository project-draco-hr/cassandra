{
  int numColumns=0;
  int position=0;
  int indexSizeInBytes=0;
  int sizeSummarized=0;
  List<IndexHelper.ColumnIndexInfo> columnIndexList=new ArrayList<IndexHelper.ColumnIndexInfo>();
  for (  IColumn column : columns) {
    if (position - sizeSummarized >= DatabaseDescriptor.getColumnIndexSize()) {
      IndexHelper.ColumnIndexInfo cIndexInfo=new IndexHelper.ColumnIndexInfo(column.name(),0,0,comparator);
      cIndexInfo.position(position);
      cIndexInfo.count(numColumns);
      columnIndexList.add(cIndexInfo);
      indexSizeInBytes+=cIndexInfo.size();
      sizeSummarized=position;
      numColumns=0;
    }
    position+=column.serializedSize();
    ++numColumns;
  }
  IndexHelper.serialize(indexSizeInBytes,columnIndexList,dos);
}
