{
  NetworkTopologyStrategy strategy=(NetworkTopologyStrategy)Table.open(table).getReplicationStrategy();
  int blockFor=(strategy.getReplicationFactor(localdc) / 2) + 1;
  for (  InetAddress pending : pendingEndpoints) {
    if (localdc.equals(snitch.getDatacenter(pending)))     blockFor++;
  }
  return blockFor;
}
