{
  logger.info("Writing " + this);
  SSTableWriter writer=cfs.createFlushWriter(columnFamilies.size());
  for (  Map.Entry<DecoratedKey,ColumnFamily> entry : columnFamilies.entrySet())   writer.append(entry.getKey(),entry.getValue());
  SSTableReader ssTable=writer.closeAndOpenReader();
  logger.info(String.format("Completed flushing %s (%d bytes)",ssTable.getFilename(),new File(ssTable.getFilename()).length()));
  return ssTable;
}
