{
  AtomicSortedColumns previous=rows.get(key);
  long initialSize=0;
  if (previous == null) {
    AtomicSortedColumns empty=cf.cloneMeShallow(AtomicSortedColumns.factory,false);
    previous=rows.putIfAbsent(new DecoratedKey(key.token,allocator.clone(key.key)),empty);
    if (previous == null) {
      previous=empty;
      initialSize+=1;
    }
  }
  final Pair<Long,Long> pair=previous.addAllWithSizeDelta(cf,allocator,localCopyFunction,indexer);
  currentSize.addAndGet(initialSize + pair.left);
  currentOperations.addAndGet(cf.getColumnCount() + (cf.isMarkedForDelete() ? 1 : 0) + cf.deletionInfo().rangeCount());
  return pair.right;
}
