{
  logger.info("Writing " + this);
  ColumnFamilyStore cfStore=Table.open(table).getColumnFamilyStore(columnfamilyName);
  SSTableWriter writer=new SSTableWriter(cfStore.getTempSSTablePath(),columnFamilies.size(),StorageService.getPartitioner());
  DataOutputBuffer buffer=new DataOutputBuffer();
  for (  DecoratedKey key : sortedKeys) {
    buffer.reset();
    ColumnFamily columnFamily=columnFamilies.get(key);
    ColumnFamily.serializer().serializeWithIndexes(columnFamily,buffer);
    writer.append(key,buffer);
  }
  SSTableReader ssTable=writer.closeAndOpenReader(DatabaseDescriptor.getKeysCachedFraction(table,columnfamilyName));
  logger.info("Completed flushing " + ssTable.getFilename());
  return ssTable;
}
