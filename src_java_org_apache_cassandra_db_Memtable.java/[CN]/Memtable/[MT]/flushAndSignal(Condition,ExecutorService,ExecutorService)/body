{
  ColumnFamilyStore.getMemtablesPendingFlushNotNull(columnfamilyName).add(this);
  sorter.submit(new Runnable(){
    public void run(){
      final List<DecoratedKey> sortedKeys=getSortedKeys();
      writer.submit(new WrappedRunnable(){
        public void runMayThrow() throws IOException {
          ColumnFamilyStore cfs=Table.open(table).getColumnFamilyStore(columnfamilyName);
          cfs.addSSTable(writeSortedContents(sortedKeys));
          ColumnFamilyStore.getMemtablesPendingFlushNotNull(columnfamilyName).remove(Memtable.this);
          condition.signalAll();
        }
      }
);
    }
  }
);
}
