{
  logger_.info("Flushing " + this);
  ColumnFamilyStore cfStore=Table.open(table_).getColumnFamilyStore(cfName_);
  SSTable ssTable=new SSTable(cfStore.getTempSSTablePath(),columnFamilies_.size(),StorageService.getPartitioner());
  final IPartitioner partitioner=StorageService.getPartitioner();
  final Comparator<String> dc=partitioner.getDecoratedKeyComparator();
  ArrayList<String> orderedKeys=new ArrayList<String>(columnFamilies_.keySet());
  Collections.sort(orderedKeys,new Comparator<String>(){
    public int compare(    String o1,    String o2){
      return dc.compare(partitioner.decorateKey(o1),partitioner.decorateKey(o2));
    }
  }
);
  DataOutputBuffer buffer=new DataOutputBuffer();
  for (  String key : orderedKeys) {
    buffer.reset();
    ColumnFamily columnFamily=columnFamilies_.get(key);
    if (columnFamily != null) {
      ColumnFamily.serializerWithIndexes().serialize(columnFamily,buffer);
      ssTable.append(partitioner.decorateKey(key),buffer);
    }
  }
  ssTable.close();
  cfStore.onMemtableFlush(cLogCtx);
  cfStore.storeLocation(ssTable);
  buffer.close();
  isFlushed_=true;
  logger_.info("Completed flushing " + this);
}
