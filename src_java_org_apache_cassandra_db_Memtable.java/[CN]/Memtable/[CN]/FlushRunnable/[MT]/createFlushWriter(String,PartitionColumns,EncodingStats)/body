{
  LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.FLUSH,cfs.metadata);
  MetadataCollector sstableMetadataCollector=new MetadataCollector(cfs.metadata.comparator).replayPosition(context);
  return new SSTableTxnWriter(txn,SSTableWriter.create(Descriptor.fromFilename(filename),(long)partitions.size(),ActiveRepairService.UNREPAIRED_SSTABLE,cfs.metadata,cfs.partitioner,sstableMetadataCollector,new SerializationHeader(cfs.metadata,columns,stats),txn));
}
