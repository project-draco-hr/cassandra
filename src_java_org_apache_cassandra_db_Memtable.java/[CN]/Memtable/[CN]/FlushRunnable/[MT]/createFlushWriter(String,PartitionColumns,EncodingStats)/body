{
  LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.FLUSH,cfs.metadata);
  MetadataCollector sstableMetadataCollector=new MetadataCollector(cfs.metadata.comparator).replayPosition(context);
  return new SSTableTxnWriter(txn,cfs.createSSTableMultiWriter(Descriptor.fromFilename(filename),(long)partitions.size(),ActiveRepairService.UNREPAIRED_SSTABLE,sstableMetadataCollector,new SerializationHeader(true,cfs.metadata,columns,stats),txn));
}
