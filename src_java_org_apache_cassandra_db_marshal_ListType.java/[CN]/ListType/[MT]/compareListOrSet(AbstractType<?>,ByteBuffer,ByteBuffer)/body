{
  if (!o1.hasRemaining() || !o2.hasRemaining())   return o1.hasRemaining() ? 1 : o2.hasRemaining() ? -1 : 0;
  ByteBuffer bb1=o1.duplicate();
  ByteBuffer bb2=o2.duplicate();
  int size1=ByteBufferUtil.readShortLength(bb1);
  int size2=ByteBufferUtil.readShortLength(bb2);
  for (int i=0; i < Math.min(size1,size2); i++) {
    ByteBuffer v1=ByteBufferUtil.readBytesWithShortLength(bb1);
    ByteBuffer v2=ByteBufferUtil.readBytesWithShortLength(bb2);
    int cmp=elementsComparator.compare(v1,v2);
    if (cmp != 0)     return cmp;
  }
  return size1 == size2 ? 0 : (size1 < size2 ? -1 : 1);
}
