{
  List<InetAddress> hosts=controller.getHosts();
  Cassandra.Client client=controller.createClient(hosts.get(0));
  Map<String,String> stratOptions=new HashMap<String,String>();
  stratOptions.put("replication_factor","" + rf);
  client.system_add_keyspace(new KsDef(name,"org.apache.cassandra.locator.SimpleStrategy",Arrays.asList(cfdef)).setStrategy_options(stratOptions));
  for (  InetAddress host : hosts) {
    try {
      client=controller.createClient(host);
      poll:       while (true) {
        List<KsDef> ksDefList=client.describe_keyspaces();
        for (        KsDef ks : ksDefList) {
          if (ks.name.equals(name))           break poll;
        }
        try {
          Thread.sleep(1000);
        }
 catch (        InterruptedException e) {
          break poll;
        }
      }
    }
 catch (    TException te) {
      continue;
    }
  }
}
