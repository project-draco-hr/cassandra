{
  long currentPosition=beforeAppend(decoratedKey);
  dataFile.writeUTF(partitioner.convertToDiskFormat(decoratedKey));
  int length=buffer.getLength();
  dataFile.writeInt(length);
  dataFile.write(buffer.getData(),0,length);
  afterAppend(decoratedKey,currentPosition);
}
