{
  if (decoratedKey == null) {
    throw new IOException("Keys must not be null.");
  }
  Comparator<DecoratedKey> c=partitioner.getDecoratedKeyComparator();
  if (lastWrittenKey != null && c.compare(lastWrittenKey,decoratedKey) > 0) {
    logger.info("Last written key : " + lastWrittenKey);
    logger.info("Current key : " + decoratedKey);
    logger.info("Writing into file " + path);
    throw new IOException("Keys must be written in ascending order.");
  }
  return (lastWrittenKey == null) ? 0 : dataFile.getFilePointer();
}
