{
  bf.add(decoratedKey);
  lastWrittenKey=decoratedKey;
  long indexPosition=indexRAF.getFilePointer();
  indexRAF.writeUTF(decoratedKey);
  indexRAF.writeLong(position);
  if (logger.isTraceEnabled())   logger.trace("wrote " + decoratedKey + " at "+ position);
  if (keysWritten++ % INDEX_INTERVAL != 0)   return;
  if (indexPositions == null) {
    indexPositions=new ArrayList<KeyPosition>();
  }
  indexPositions.add(new KeyPosition(decoratedKey,indexPosition));
  if (logger.isTraceEnabled())   logger.trace("wrote index of " + decoratedKey + " at "+ indexPosition);
}
