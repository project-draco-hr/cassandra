{
  if (clause == null || clause.isEmpty()) {
    return new EmptyClauseFilter(cfs,filter,maxResults,countCQL3Rows,isPaging);
  }
 else {
    if (isPaging)     throw new IllegalArgumentException("Cross-row paging is not supported along with index clauses");
    return cfs.getComparator() instanceof CompositeType ? new FilterWithCompositeClauses(cfs,filter,clause,maxResults,countCQL3Rows) : new FilterWithClauses(cfs,filter,clause,maxResults,countCQL3Rows);
  }
}
