{
  QueryPager pager=SinglePartitionReadCommand.fullPartitionRead(baseCfs.metadata,FBUtilities.nowInSeconds(),key).getPager(null);
  while (!pager.isExhausted()) {
    try (ReadOrderGroup orderGroup=pager.startOrderGroup();PartitionIterator partitionIterator=pager.fetchPageInternal(128,orderGroup)){
      if (!partitionIterator.hasNext())       return;
      try (RowIterator rowIterator=partitionIterator.next()){
        Collection<Mutation> mutations=view.createMutations(key.getKey(),FilteredPartition.create(rowIterator),true);
        if (mutations != null) {
          try {
            StorageProxy.mutateMV(key.getKey(),mutations);
            break;
          }
 catch (          WriteTimeoutException ex) {
            NoSpamLogger.getLogger(logger,1,TimeUnit.MINUTES).warn("Encountered write timeout when building materialized view {}, the entries were stored in the batchlog and will be replayed at another time",view.name);
          }
        }
      }
     }
   }
}
