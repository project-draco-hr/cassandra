{
  if (!isNameValid(name))   throw new ConfigurationException("Illegal index name " + name);
  if (indexType == null)   throw new ConfigurationException("Index type is null for index " + name);
  if (targetType == null)   throw new ConfigurationException("Target type is null for index " + name);
  if (indexType == IndexMetadata.IndexType.CUSTOM) {
    if (options == null || !options.containsKey(IndexTarget.CUSTOM_INDEX_OPTION_NAME))     throw new ConfigurationException(String.format("Required option missing for index %s : %s",name,IndexTarget.CUSTOM_INDEX_OPTION_NAME));
    String className=options.get(IndexTarget.CUSTOM_INDEX_OPTION_NAME);
    Class<Index> indexerClass=FBUtilities.classForName(className,"custom indexer");
    if (!Index.class.isAssignableFrom(indexerClass))     throw new ConfigurationException(String.format("Specified Indexer class (%s) does not implement the Indexer interface",className));
    validateCustomIndexOptions(indexerClass,options);
  }
}
