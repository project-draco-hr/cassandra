{
  if (!isNameValid(name))   throw new ConfigurationException("Illegal index name " + name);
  if (indexType == null)   throw new ConfigurationException("Index type is null for index " + name);
  if (targetType == null)   throw new ConfigurationException("Target type is null for index " + name);
  if (indexType == IndexMetadata.IndexType.CUSTOM)   if (options == null || !options.containsKey(SecondaryIndex.CUSTOM_INDEX_OPTION_NAME))   throw new ConfigurationException(String.format("Required option missing for index %s : %s",name,SecondaryIndex.CUSTOM_INDEX_OPTION_NAME));
}
