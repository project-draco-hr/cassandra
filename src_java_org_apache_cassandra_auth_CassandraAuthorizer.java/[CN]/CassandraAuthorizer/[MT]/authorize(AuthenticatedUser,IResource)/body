{
  if (user.isSuper())   return Permission.ALL;
  Set<Permission> permissions=EnumSet.noneOf(Permission.class);
  try {
    for (    String role : user.getRoles())     addPermissionsForRole(permissions,resource,role);
  }
 catch (  RequestValidationException e) {
    throw new AssertionError(e);
  }
catch (  RequestExecutionException e) {
    logger.warn("CassandraAuthorizer failed to authorize {} for {}",user,resource);
    return Permission.NONE;
  }
  return permissions;
}
