{
  for (  Datacenter dc : topologyConfig.topology) {
    if (oldDC != null && oldRack != null) {
      if (dc.dc_name.equals(oldDC)) {
        for (        Rack rack : dc.racks) {
          if (rack.rack_name.equals(oldRack)) {
            for (            Node node : rack.nodes) {
              if (node.broadcast_address.equals(broadcastAddress)) {
                rack.nodes.remove(node);
                break;
              }
            }
          }
        }
      }
    }
    if (newDC != null && newRack != null) {
      if (dc.dc_name.equals(newDC)) {
        for (        Rack rack : dc.racks) {
          if (rack.rack_name.equals(newRack)) {
            Node node=new Node();
            node.broadcast_address=broadcastAddress;
            node.dc_local_address=dcLocalAddress;
            rack.nodes.add(node);
          }
        }
      }
    }
  }
  return topologyConfig;
}
