def completer_for(rulename, symname):

    def registrator(f):

        def completerwrapper(ctxt):
            cass = ctxt.get_binding('cassandra_conn', None)
            if (cass is None):
                return ()
            return f(ctxt, cass)
        completerwrapper.func_name = ('completerwrapper_on_' + f.func_name)
        special_completers.append((rulename, symname, completerwrapper))
        return completerwrapper
    return registrator
