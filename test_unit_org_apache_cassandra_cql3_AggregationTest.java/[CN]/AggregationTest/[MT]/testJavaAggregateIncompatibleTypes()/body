{
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "RETURNS int " + "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "RETURNS text " + "LANGUAGE java "+ "AS 'return a.toString();'");
  String fState2=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a double, b double) " + "RETURNS double " + "LANGUAGE java "+ "AS 'return Double.valueOf((a!=null?a.doubleValue():0d) + b.doubleValue());'");
  String fFinal2=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a double) " + "RETURNS text " + "LANGUAGE java "+ "AS 'return a.toString();'");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState2)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal2));
}
