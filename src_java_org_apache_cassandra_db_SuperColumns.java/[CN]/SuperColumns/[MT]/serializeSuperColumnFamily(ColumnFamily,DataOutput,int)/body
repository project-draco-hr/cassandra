{
  DeletionInfo delInfo=scf.deletionInfo();
  Map<CellName,List<Column>> scMap=groupSuperColumns(scf);
  scf.getComparator().deletionInfoSerializer().serialize(new DeletionInfo(delInfo.getTopLevelDeletion()),out,version);
  out.writeInt(scMap.size());
  CellNameType subComparator=subType(scf.getComparator());
  for (  Map.Entry<CellName,List<Column>> entry : scMap.entrySet()) {
    scf.getComparator().cellSerializer().serialize(entry.getKey(),out);
    DeletionTime delTime=delInfo.rangeCovering(entry.getKey());
    DeletionInfo scDelInfo=delTime == null ? DeletionInfo.live() : new DeletionInfo(delTime);
    DeletionTime.serializer.serialize(scDelInfo.getTopLevelDeletion(),out);
    out.writeInt(entry.getValue().size());
    ColumnSerializer serializer=subComparator.columnSerializer();
    for (    Column subColumn : entry.getValue())     serializer.serialize(subColumn,out);
  }
}
