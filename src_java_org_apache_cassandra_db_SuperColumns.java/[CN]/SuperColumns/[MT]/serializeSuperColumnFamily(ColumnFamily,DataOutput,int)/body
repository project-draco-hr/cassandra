{
  DeletionInfo delInfo=scf.deletionInfo();
  Map<ByteBuffer,List<Column>> scMap=groupSuperColumns(scf);
  DeletionInfo.serializer().serialize(new DeletionInfo(delInfo.getTopLevelDeletion()),out,version);
  out.writeInt(scMap.size());
  for (  Map.Entry<ByteBuffer,List<Column>> entry : scMap.entrySet()) {
    ByteBufferUtil.writeWithShortLength(entry.getKey(),out);
    DeletionTime delTime=delInfo.rangeCovering(entry.getKey());
    DeletionInfo scDelInfo=delTime == null ? DeletionInfo.live() : new DeletionInfo(delTime);
    DeletionTime.serializer.serialize(scDelInfo.getTopLevelDeletion(),out);
    out.writeInt(entry.getValue().size());
    for (    Column subColumn : entry.getValue())     Column.serializer.serialize(subColumn,out);
  }
}
