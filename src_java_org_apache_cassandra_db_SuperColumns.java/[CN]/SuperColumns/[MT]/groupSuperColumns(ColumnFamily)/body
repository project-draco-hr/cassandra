{
  CellNameType type=scf.getComparator();
  Map<CellName,List<Column>> scMap=new LinkedHashMap<>();
  CellName scName=null;
  List<Column> subColumns=null;
  CellNameType scType=scType(type);
  CellNameType subType=subType(type);
  for (  Column column : scf) {
    CellName newScName=scType.makeCellName(scName(column.name()));
    CellName newSubName=subType.makeCellName(subName(column.name()));
    if (scName == null || scType.compare(scName,newScName) != 0) {
      scName=newScName;
      subColumns=new ArrayList<>();
      scMap.put(scName,subColumns);
    }
    subColumns.add(((Column)column).withUpdatedName(newSubName));
  }
  return scMap;
}
