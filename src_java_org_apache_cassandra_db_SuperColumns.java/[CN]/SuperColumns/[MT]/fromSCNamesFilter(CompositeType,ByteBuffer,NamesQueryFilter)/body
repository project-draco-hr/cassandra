{
  if (scName == null) {
    ColumnSlice[] slices=new ColumnSlice[filter.columns.size()];
    int i=0;
    for (    ByteBuffer bb : filter.columns) {
      CompositeType.Builder builder=type.builder().add(bb);
      slices[i++]=new ColumnSlice(builder.build(),builder.buildAsEndOfRange());
    }
    return new SliceQueryFilter(slices,false,slices.length,1,1);
  }
 else {
    SortedSet<ByteBuffer> newColumns=new TreeSet<ByteBuffer>(type);
    for (    ByteBuffer c : filter.columns)     newColumns.add(CompositeType.build(scName,c));
    return filter.withUpdatedColumns(newColumns);
  }
}
