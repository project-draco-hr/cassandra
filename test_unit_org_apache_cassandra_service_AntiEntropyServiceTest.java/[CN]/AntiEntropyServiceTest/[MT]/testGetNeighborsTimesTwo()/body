{
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  addTokens(2 * DatabaseDescriptor.getReplicationFactor(tablename));
  AbstractReplicationStrategy ars=Table.open(tablename).replicationStrategy;
  Set<InetAddress> expected=new HashSet<InetAddress>();
  for (  Range replicaRange : ars.getAddressRanges().get(FBUtilities.getLocalAddress())) {
    expected.addAll(ars.getRangeAddresses(tmd).get(replicaRange));
  }
  expected.remove(FBUtilities.getLocalAddress());
  assertEquals(expected,AntiEntropyService.getNeighbors(tablename));
}
