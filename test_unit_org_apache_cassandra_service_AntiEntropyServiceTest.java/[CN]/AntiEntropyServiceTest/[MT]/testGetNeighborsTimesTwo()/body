{
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  addTokens(1 + (2 * DatabaseDescriptor.getReplicationFactor(tablename)));
  AbstractReplicationStrategy ars=StorageService.instance.getReplicationStrategy(tablename);
  Set<InetAddress> expected=new HashSet<InetAddress>();
  for (  Range replicaRange : ars.getAddressRanges(tablename).get(FBUtilities.getLocalAddress())) {
    expected.addAll(ars.getRangeAddresses(tmd,tablename).get(replicaRange));
  }
  expected.remove(FBUtilities.getLocalAddress());
  assertEquals(expected,AntiEntropyService.getNeighbors(tablename));
}
