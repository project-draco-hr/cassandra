{
  final int outOffset=3;
  final WrappedArray out=new WrappedArray(new byte[outOffset + compressor.initialCompressedBufferLength(len)]);
  new Random().nextBytes(out.buffer);
  final int compressedLength=compressor.compress(data,off,len,out,outOffset);
  final int restoredOffset=5;
  final byte[] restored=new byte[restoredOffset + len];
  new Random().nextBytes(restored);
  final int decompressedLength=compressor.uncompress(out.buffer,outOffset,compressedLength,restored,restoredOffset);
  assertEquals(decompressedLength,len);
  assertArrayEquals(Arrays.copyOfRange(data,off,off + len),Arrays.copyOfRange(restored,restoredOffset,restoredOffset + decompressedLength));
}
