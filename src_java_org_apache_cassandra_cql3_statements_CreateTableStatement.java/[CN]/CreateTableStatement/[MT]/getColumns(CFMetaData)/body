{
  Map<ByteBuffer,ColumnDefinition> columnDefs=new HashMap<ByteBuffer,ColumnDefinition>();
  Integer componentIndex=null;
  if (cfm.hasCompositeComparator()) {
    CompositeType ct=(CompositeType)comparator;
    componentIndex=ct.types.get(ct.types.size() - 1) instanceof ColumnToCollectionType ? ct.types.size() - 2 : ct.types.size() - 1;
  }
  for (  Map.Entry<ColumnIdentifier,AbstractType> col : columns.entrySet()) {
    columnDefs.put(col.getKey().bytes,ColumnDefinition.regularDef(cfm,col.getKey().bytes,col.getValue(),componentIndex));
  }
  return columnDefs;
}
