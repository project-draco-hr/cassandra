{
  Map<ByteBuffer,ColumnDefinition> columnDefs=new HashMap<ByteBuffer,ColumnDefinition>();
  Integer componentIndex=null;
  if (comparator instanceof CompositeType) {
    CompositeType ct=(CompositeType)comparator;
    componentIndex=ct.types.get(ct.types.size() - 1) instanceof ColumnToCollectionType ? ct.types.size() - 2 : ct.types.size() - 1;
  }
  for (  Map.Entry<ColumnIdentifier,AbstractType> col : columns.entrySet()) {
    ColumnIdentifier id=col.getKey();
    columnDefs.put(id.key,staticColumns.contains(id) ? ColumnDefinition.staticDef(id.key,col.getValue(),componentIndex) : ColumnDefinition.regularDef(id.key,col.getValue(),componentIndex));
  }
  return columnDefs;
}
