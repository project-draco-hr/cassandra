{
  this.expression=expression;
  this.baseCfs=baseCfs;
  this.range=range;
  this.filter=filter;
  this.indexCfs=indexCfs;
  startKey=range.left instanceof DecoratedKey ? ((DecoratedKey)range.left).key : ByteBufferUtil.EMPTY_BYTE_BUFFER;
  endKey=range.right instanceof DecoratedKey ? ((DecoratedKey)range.right).key : ByteBufferUtil.EMPTY_BYTE_BUFFER;
  int meanColumns=Math.max(indexCfs.getMeanColumns(),1);
  rowsPerQuery=Math.max(Math.min(filter.maxRows(),filter.maxColumns() / meanColumns),2);
  rightRangeIsNotMinimum=!range.right.isMinimum(baseCfs.partitioner);
  path=new QueryPath(baseCfs.columnFamily);
}
