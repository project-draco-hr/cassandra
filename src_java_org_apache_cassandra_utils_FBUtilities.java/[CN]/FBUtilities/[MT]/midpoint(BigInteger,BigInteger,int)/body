{
  BigInteger midpoint;
  boolean remainder;
  if (left.compareTo(right) < 0) {
    BigInteger sum=left.add(right);
    remainder=sum.testBit(0);
    midpoint=sum.shiftRight(1);
  }
 else {
    BigInteger max=TWO.pow(sigbits);
    BigInteger distance=max.add(right).subtract(left);
    remainder=distance.testBit(0);
    midpoint=distance.shiftRight(1).add(left).mod(max);
  }
  return new Pair<BigInteger,Boolean>(midpoint,remainder);
}
