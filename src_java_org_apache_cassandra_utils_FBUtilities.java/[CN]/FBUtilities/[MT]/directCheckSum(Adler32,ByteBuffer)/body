{
  if (directUpdate != null) {
    try {
      directUpdate.invoke(checksum,bb);
      return;
    }
 catch (    IllegalAccessException e) {
      directUpdate=null;
      logger.warn("JVM doesn't support Adler32 byte buffer access");
    }
catch (    InvocationTargetException e) {
      throw new RuntimeException(e);
    }
  }
  byte[] buffer=localDigestBuffer.get();
  int remaining;
  while ((remaining=bb.remaining()) > 0) {
    remaining=Math.min(remaining,buffer.length);
    ByteBufferUtil.arrayCopy(bb,bb.position(),buffer,0,remaining);
    bb.position(bb.position() + remaining);
    checksum.update(buffer,0,remaining);
  }
}
