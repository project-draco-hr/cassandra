{
  String name=retry.toUpperCase();
  try {
    if (name.endsWith(RetryType.PERCENTILE.toString())) {
      double value=Double.parseDouble(name.substring(0,name.length() - 10));
      if (value > 100 || value < 0)       throw new ConfigurationException("PERCENTILE should be between 0 and 100");
      return new SpeculativeRetry(RetryType.PERCENTILE,(value / 100));
    }
 else     if (name.endsWith("MS")) {
      double value=Double.parseDouble(name.substring(0,name.length() - 2));
      return new SpeculativeRetry(RetryType.CUSTOM,value);
    }
 else {
      return new SpeculativeRetry(RetryType.valueOf(name),0);
    }
  }
 catch (  IllegalArgumentException e) {
  }
  throw new ConfigurationException("invalid speculative_retry type: " + retry);
}
