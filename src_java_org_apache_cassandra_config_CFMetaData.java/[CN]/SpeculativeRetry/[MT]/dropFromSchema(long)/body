{
  RowMutation rm=new RowMutation(Keyspace.SYSTEM_KS,SystemKeyspace.getSchemaKSKey(ksName));
  ColumnFamily cf=rm.addOrGet(SchemaColumnFamiliesCf);
  int ldt=(int)(System.currentTimeMillis() / 1000);
  ColumnNameBuilder builder=SchemaColumnFamiliesCf.getCfDef().getColumnNameBuilder();
  builder.add(ByteBufferUtil.bytes(cfName));
  cf.addAtom(new RangeTombstone(builder.build(),builder.buildAsEndOfRange(),timestamp,ldt));
  for (  ColumnDefinition cd : column_metadata.values())   cd.deleteFromSchema(rm,cfName,getColumnDefinitionComparator(cd),timestamp);
  for (  TriggerDefinition td : triggers.values())   td.deleteFromSchema(rm,cfName,timestamp);
  return rm;
}
