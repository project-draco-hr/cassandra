{
  RowMutation rm=new RowMutation(Table.SYSTEM_KS,SystemTable.getSchemaKSKey(ksName));
  ColumnFamily cf=rm.addOrGet(SystemTable.SCHEMA_COLUMNFAMILIES_CF);
  int ldt=(int)(System.currentTimeMillis() / 1000);
  ColumnNameBuilder builder=SchemaColumnFamiliesCf.getCfDef().getColumnNameBuilder();
  builder.add(ByteBufferUtil.bytes(cfName));
  cf.addAtom(new RangeTombstone(builder.build(),builder.buildAsEndOfRange(),timestamp,ldt));
  ColumnFamily tcf=rm.addOrGet(SystemTable.SCHEMA_TRIGGERS_CF);
  ColumnNameBuilder tbuilder=SchemaTriggerCf.getCfDef().getColumnNameBuilder();
  tbuilder.add(ByteBufferUtil.bytes(cfName));
  tcf.addAtom(new RangeTombstone(tbuilder.build(),tbuilder.buildAsEndOfRange(),timestamp,ldt));
  for (  ColumnDefinition cd : column_metadata.values())   cd.deleteFromSchema(rm,cfName,getColumnDefinitionComparator(cd),timestamp);
  return rm;
}
