{
  RowMutation rm=new RowMutation(Keyspace.SYSTEM_KS,SystemKeyspace.getSchemaKSKey(ksName));
  newState.toSchemaNoColumns(rm,modificationTimestamp);
  MapDifference<ByteBuffer,ColumnDefinition> columnDiff=Maps.difference(column_metadata,newState.column_metadata);
  for (  ColumnDefinition cd : columnDiff.entriesOnlyOnLeft().values()) {
    if (fromThrift && cd.type != ColumnDefinition.Type.REGULAR)     continue;
    cd.deleteFromSchema(rm,cfName,getColumnDefinitionComparator(cd),modificationTimestamp);
  }
  for (  ColumnDefinition cd : columnDiff.entriesOnlyOnRight().values())   cd.toSchema(rm,cfName,getColumnDefinitionComparator(cd),modificationTimestamp);
  for (  ByteBuffer name : columnDiff.entriesDiffering().keySet()) {
    ColumnDefinition cd=newState.getColumnDefinition(name);
    cd.toSchema(rm,cfName,getColumnDefinitionComparator(cd),modificationTimestamp);
  }
  MapDifference<String,Map<String,String>> tdiffrence=Maps.difference(triggers,newState.triggers);
  for (  Entry<String,Map<String,String>> tentry : tdiffrence.entriesOnlyOnLeft().entrySet())   TriggerOptions.deleteColumns(rm,cfName,tentry,modificationTimestamp);
  for (  Entry<String,Map<String,String>> tentry : tdiffrence.entriesOnlyOnRight().entrySet())   TriggerOptions.addColumns(rm,cfName,tentry,modificationTimestamp);
  return rm;
}
