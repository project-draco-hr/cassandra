{
  ColumnDefinition def=column_metadata.get(from);
  if (def == null)   throw new InvalidRequestException(String.format("Cannot rename unknown column %s in keyspace %s",strFrom,cfName));
  if (column_metadata.get(to) != null)   throw new InvalidRequestException(String.format("Cannot rename column %s to %s in keyspace %s; another column of that name already exist",strFrom,strTo,cfName));
  if (def.isPartOfCellName()) {
    throw new InvalidRequestException(String.format("Cannot rename non PRIMARY KEY part %s",strFrom));
  }
 else   if (def.isIndexed()) {
    throw new InvalidRequestException(String.format("Cannot rename column %s because it is secondary indexed",strFrom));
  }
  ColumnDefinition newDef=def.cloneWithNewName(to);
  column_metadata.put(newDef.name,newDef);
  column_metadata.remove(def.name);
}
