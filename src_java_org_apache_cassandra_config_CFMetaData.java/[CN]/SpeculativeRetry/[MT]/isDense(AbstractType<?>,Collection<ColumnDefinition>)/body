{
  boolean hasRegular=false;
  int maxClusteringIdx=-1;
  for (  ColumnDefinition def : defs) {
switch (def.type) {
case CLUSTERING_KEY:
      maxClusteringIdx=Math.max(maxClusteringIdx,def.componentIndex == null ? 0 : def.componentIndex);
    break;
case REGULAR:
  hasRegular=true;
break;
}
}
return maxClusteringIdx >= 0 ? maxClusteringIdx == comparator.componentsCount() - 1 : !hasRegular && !isCQL3OnlyPKComparator(comparator);
}
