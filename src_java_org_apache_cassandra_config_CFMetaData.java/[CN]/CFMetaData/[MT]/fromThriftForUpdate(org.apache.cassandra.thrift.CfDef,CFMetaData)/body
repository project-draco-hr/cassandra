{
  CFMetaData cfm=internalFromThrift(cf_def);
  boolean hasKeyAlias=cf_def.isSetKey_alias() && !(cfm.keyValidator instanceof CompositeType);
  if (hasKeyAlias)   cfm.addOrReplaceColumnDefinition(ColumnDefinition.partitionKeyDef(cfm,cf_def.key_alias,cfm.keyValidator,null));
  for (  ColumnDefinition def : toUpdate.allColumns()) {
    if (def.isPartOfCellName())     continue;
    if (def.kind == ColumnDefinition.Kind.PARTITION_KEY && hasKeyAlias)     continue;
    cfm.addOrReplaceColumnDefinition(def);
  }
  return cfm.rebuild();
}
