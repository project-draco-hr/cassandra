{
  if (!cf_def.id.equals(cfId))   throw new ConfigurationException("ids do not match.");
  if (!cf_def.keyspace.toString().equals(tableName))   throw new ConfigurationException("keyspaces do not match.");
  if (!cf_def.name.toString().equals(cfName))   throw new ConfigurationException("names do not match.");
  if (!cf_def.column_type.toString().equals(cfType.name()))   throw new ConfigurationException("types do not match.");
  if (comparator != DatabaseDescriptor.getComparator(cf_def.comparator_type))   throw new ConfigurationException("comparators do not match.");
  if (cf_def.subcomparator_type == null || cf_def.subcomparator_type.equals("")) {
    if (subcolumnComparator != null)     throw new ConfigurationException("subcolumncomparators do not match.");
  }
 else   if (subcolumnComparator != DatabaseDescriptor.getComparator(cf_def.subcomparator_type))   throw new ConfigurationException("subcolumncomparators do not match.");
  validateMinMaxCompactionThresholds(cf_def);
  validateMemtableSettings(cf_def);
  comment=cf_def.comment == null ? "" : cf_def.comment.toString();
  rowCacheSize=cf_def.row_cache_size;
  keyCacheSize=cf_def.key_cache_size;
  readRepairChance=cf_def.read_repair_chance;
  gcGraceSeconds=cf_def.gc_grace_seconds;
  defaultValidator=DatabaseDescriptor.getComparator(cf_def.default_validation_class);
  minCompactionThreshold=cf_def.min_compaction_threshold;
  maxCompactionThreshold=cf_def.max_compaction_threshold;
  rowCacheSavePeriodInSeconds=cf_def.row_cache_save_period_in_seconds;
  keyCacheSavePeriodInSeconds=cf_def.key_cache_save_period_in_seconds;
  memtableFlushAfterMins=cf_def.memtable_flush_after_mins;
  memtableThroughputInMb=cf_def.memtable_throughput_in_mb;
  memtableOperationsInMillions=cf_def.memtable_operations_in_millions;
  Set<ByteBuffer> toRemove=new HashSet<ByteBuffer>();
  Set<ByteBuffer> newIndexNames=new HashSet<ByteBuffer>();
  Set<org.apache.cassandra.avro.ColumnDef> toAdd=new HashSet<org.apache.cassandra.avro.ColumnDef>();
  for (  org.apache.cassandra.avro.ColumnDef def : cf_def.column_metadata) {
    newIndexNames.add(def.name);
    if (!column_metadata.containsKey(def.name))     toAdd.add(def);
  }
  for (  ByteBuffer indexName : column_metadata.keySet())   if (!newIndexNames.contains(indexName))   toRemove.add(indexName);
  for (  ByteBuffer indexName : toRemove)   column_metadata.remove(indexName);
  for (  org.apache.cassandra.avro.ColumnDef def : cf_def.column_metadata) {
    ColumnDefinition oldDef=column_metadata.get(def.name);
    if (oldDef == null)     continue;
    oldDef.setValidator(DatabaseDescriptor.getComparator(def.validation_class));
    oldDef.setIndexType(def.index_type == null ? null : org.apache.cassandra.thrift.IndexType.valueOf(def.index_type.name()));
    oldDef.setIndexName(def.index_name == null ? null : def.index_name.toString());
  }
  for (  org.apache.cassandra.avro.ColumnDef def : toAdd) {
    ColumnDefinition cd=new ColumnDefinition(def.name,def.validation_class.toString(),def.index_type == null ? null : org.apache.cassandra.thrift.IndexType.valueOf(def.index_type.toString()),def.index_name == null ? null : def.index_name.toString());
    column_metadata.put(cd.name,cd);
  }
}
