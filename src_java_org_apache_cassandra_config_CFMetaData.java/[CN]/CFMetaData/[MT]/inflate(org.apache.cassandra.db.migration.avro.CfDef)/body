{
  AbstractType comparator;
  AbstractType subcolumnComparator=null;
  AbstractType validator;
  AbstractType keyValidator;
  try {
    comparator=DatabaseDescriptor.getComparator(cf.comparator_type.toString());
    if (cf.subcomparator_type != null)     subcolumnComparator=DatabaseDescriptor.getComparator(cf.subcomparator_type.toString());
    validator=DatabaseDescriptor.getComparator(cf.default_validation_class.toString());
    keyValidator=DatabaseDescriptor.getComparator(cf.key_validation_class.toString());
  }
 catch (  Exception ex) {
    throw new RuntimeException("Could not inflate CFMetaData for " + cf,ex);
  }
  Map<ByteBuffer,ColumnDefinition> column_metadata=new TreeMap<ByteBuffer,ColumnDefinition>(BytesType.instance);
  for (  ColumnDef aColumn_metadata : cf.column_metadata) {
    ColumnDefinition cd=ColumnDefinition.inflate(aColumn_metadata);
    column_metadata.put(cd.name,cd);
  }
  CFMetaData newCFMD=new CFMetaData(cf.keyspace.toString(),cf.name.toString(),ColumnFamilyType.create(cf.column_type.toString()),comparator,subcolumnComparator,cf.id);
  if (cf.min_compaction_threshold != null) {
    newCFMD.minCompactionThreshold(cf.min_compaction_threshold);
  }
  if (cf.max_compaction_threshold != null) {
    newCFMD.maxCompactionThreshold(cf.max_compaction_threshold);
  }
  if (cf.row_cache_save_period_in_seconds != null) {
    newCFMD.rowCacheSavePeriod(cf.row_cache_save_period_in_seconds);
  }
  if (cf.key_cache_save_period_in_seconds != null) {
    newCFMD.keyCacheSavePeriod(cf.key_cache_save_period_in_seconds);
  }
  if (cf.memtable_flush_after_mins != null) {
    newCFMD.memTime(cf.memtable_flush_after_mins);
  }
  if (cf.memtable_throughput_in_mb != null) {
    newCFMD.memSize(cf.memtable_throughput_in_mb);
  }
  if (cf.memtable_operations_in_millions != null) {
    newCFMD.memOps(cf.memtable_operations_in_millions);
  }
  if (cf.merge_shards_chance != null) {
    newCFMD.mergeShardsChance(cf.merge_shards_chance);
  }
  return newCFMD.comment(cf.comment.toString()).rowCacheSize(cf.row_cache_size).keyCacheSize(cf.key_cache_size).readRepairChance(cf.read_repair_chance).replicateOnWrite(cf.replicate_on_write).gcGraceSeconds(cf.gc_grace_seconds).defaultValidator(validator).keyValidator(keyValidator).columnMetadata(column_metadata);
}
