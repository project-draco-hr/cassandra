{
  ColumnDefinition def=getColumnDefinition(from);
  if (def == null)   throw new InvalidRequestException(String.format("Cannot rename unknown column %s in keyspace %s",from,cfName));
  if (getColumnDefinition(to) != null)   throw new InvalidRequestException(String.format("Cannot rename column %s to %s in keyspace %s; another column of that name already exist",from,to,cfName));
  if (def.isPartOfCellName()) {
    throw new InvalidRequestException(String.format("Cannot rename non PRIMARY KEY part %s",from));
  }
 else   if (def.isIndexed()) {
    throw new InvalidRequestException(String.format("Cannot rename column %s because it is secondary indexed",from));
  }
  ColumnDefinition newDef=def.withNewName(to);
  addOrReplaceColumnDefinition(newDef);
  removeColumnDefinition(def);
}
