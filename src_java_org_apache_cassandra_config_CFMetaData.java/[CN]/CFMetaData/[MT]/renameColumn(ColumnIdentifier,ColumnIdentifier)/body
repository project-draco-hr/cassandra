{
  ColumnDefinition def=getColumnDefinition(from);
  if (def == null)   throw new InvalidRequestException(String.format("Cannot rename unknown column %s in keyspace %s",from,cfName));
  if (getColumnDefinition(to) != null)   throw new InvalidRequestException(String.format("Cannot rename column %s to %s in keyspace %s; another column of that name already exist",from,to,cfName));
  if (def.isPartOfCellName(isCQLTable(),isSuper())) {
    throw new InvalidRequestException(String.format("Cannot rename non PRIMARY KEY part %s",from));
  }
 else   if (getIndexes().hasIndexFor(def)) {
    throw new InvalidRequestException(String.format("Cannot rename column %s because it is secondary indexed",from));
  }
  ColumnDefinition newDef=def.withNewName(to);
  addOrReplaceColumnDefinition(newDef);
  if (def.isPartitionKey())   columnMetadata.remove(def.name.bytes);
 else   removeColumnDefinition(def);
}
