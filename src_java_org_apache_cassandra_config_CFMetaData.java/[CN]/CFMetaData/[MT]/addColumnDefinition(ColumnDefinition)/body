{
  if (columnMetadata.containsKey(def.name.bytes))   throw new ConfigurationException(String.format("Cannot add column %s, a column with the same name already exists",def.name));
  return addOrReplaceColumnDefinition(def);
}
