{
  if (cf_def.id != cfId)   throw new ConfigurationException("ids do not match.");
  if (!cf_def.keyspace.equals(tableName))   throw new ConfigurationException("keyspaces do not match.");
  if (!cf_def.name.equals(cfName))   throw new ConfigurationException("names do not match.");
  if (!cf_def.column_type.equals(cfType.name()))   throw new ConfigurationException("types do not match.");
  if (comparator != DatabaseDescriptor.getComparator(cf_def.comparator_type))   throw new ConfigurationException("comparators do not match.");
  if (cf_def.subcomparator_type == null || cf_def.subcomparator_type.equals("")) {
    if (subcolumnComparator != null)     throw new ConfigurationException("subcolumncomparators do not match.");
  }
 else   if (subcolumnComparator != DatabaseDescriptor.getComparator(cf_def.subcomparator_type))   throw new ConfigurationException("subcolumncomparators do not match.");
  validateMinMaxCompactionThresholds(cf_def);
  validateMemtableSettings(cf_def);
  Map<ByteBuffer,ColumnDefinition> metadata=new HashMap<ByteBuffer,ColumnDefinition>();
  if (cf_def.column_metadata == null) {
    metadata=column_metadata;
  }
 else {
    for (    org.apache.cassandra.thrift.ColumnDef def : cf_def.column_metadata) {
      ColumnDefinition cd=new ColumnDefinition(def.name,def.validation_class,def.index_type,def.index_name);
      metadata.put(cd.name,cd);
    }
  }
  return new CFMetaData(tableName,cfName,cfType,comparator,subcolumnComparator,cf_def.comment,cf_def.row_cache_size,cf_def.preload_row_cache,cf_def.key_cache_size,cf_def.read_repair_chance,cf_def.gc_grace_seconds,DatabaseDescriptor.getComparator(cf_def.default_validation_class == null ? null : cf_def.default_validation_class),cf_def.min_compaction_threshold,cf_def.max_compaction_threshold,cf_def.row_cache_save_period_in_seconds,cf_def.key_cache_save_period_in_seconds,cf_def.memtable_flush_after_mins,cf_def.memtable_throughput_in_mb,cf_def.memtable_operations_in_millions,cfId,metadata);
}
