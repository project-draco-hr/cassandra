{
  Mutation mutation=new Mutation(SystemKeyspace.NAME,SystemKeyspace.getSchemaKSKey(ksName));
  ColumnFamily cf=mutation.addOrGet(SystemKeyspace.SchemaColumnFamiliesTable);
  int ldt=(int)(System.currentTimeMillis() / 1000);
  Composite prefix=SystemKeyspace.SchemaColumnFamiliesTable.comparator.make(cfName);
  cf.addAtom(new RangeTombstone(prefix,prefix.end(),timestamp,ldt));
  for (  ColumnDefinition cd : allColumns())   cd.deleteFromSchema(mutation,timestamp);
  for (  TriggerDefinition td : triggers.values())   td.deleteFromSchema(mutation,cfName,timestamp);
  for (  String indexName : Keyspace.open(this.ksName).getColumnFamilyStore(this.cfName).getBuiltIndexes()) {
    ColumnFamily indexCf=mutation.addOrGet(SystemKeyspace.BuiltIndexesTable);
    indexCf.addTombstone(indexCf.getComparator().makeCellName(indexName),ldt,timestamp);
  }
  return mutation;
}
