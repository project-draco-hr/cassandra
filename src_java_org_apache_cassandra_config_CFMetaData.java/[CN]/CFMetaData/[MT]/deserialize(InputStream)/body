{
  DataInputStream din=new DataInputStream(in);
  String tableName=din.readUTF();
  String cfName=din.readUTF();
  ColumnFamilyType cfType=ColumnFamilyType.create(din.readUTF());
  ClockType clockType=ClockType.create(din.readUTF());
  AbstractType comparator=DatabaseDescriptor.getComparator(din.readUTF());
  AbstractType subcolumnComparator=null;
  subcolumnComparator=din.readBoolean() ? DatabaseDescriptor.getComparator(din.readUTF()) : null;
  AbstractReconciler reconciler=null;
  try {
    reconciler=(AbstractReconciler)Class.forName(din.readUTF()).newInstance();
  }
 catch (  Exception ex) {
    throw new IOException(ex);
  }
  String comment=din.readBoolean() ? din.readUTF() : null;
  double rowCacheSize=din.readDouble();
  boolean preloadRowCache=din.readBoolean();
  double keyCacheSize=din.readDouble();
  double readRepairChance=din.readDouble();
  int cfId=din.readInt();
  int columnMetadataSize=din.readInt();
  Map<ByteArrayKey,ColumnDefinition> column_metadata=new HashMap<ByteArrayKey,ColumnDefinition>(columnMetadataSize);
  while (columnMetadataSize > 0) {
    int cdSize=din.readInt();
    byte[] cdBytes=new byte[cdSize];
    if (in.read(cdBytes) != cdSize)     throw new IOException("short read of ColumnDefinition");
    ColumnDefinition cd=ColumnDefinition.deserialize(cdBytes);
    column_metadata.put(new ByteArrayKey(cd.name),cd);
  }
  return new CFMetaData(tableName,cfName,cfType,clockType,comparator,subcolumnComparator,reconciler,comment,rowCacheSize,preloadRowCache,keyCacheSize,readRepairChance,cfId,column_metadata);
}
