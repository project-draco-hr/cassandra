def split_cql_commands(source):
    ruleset = cql_rule_set()
    (statements, in_batch) = ruleset.cql_split_statements(source)
    if in_batch:
        raise ValueError('CQL source ends unexpectedly')
    return [ruleset.cql_extract_orig(toks, source) for toks in statements if toks]
