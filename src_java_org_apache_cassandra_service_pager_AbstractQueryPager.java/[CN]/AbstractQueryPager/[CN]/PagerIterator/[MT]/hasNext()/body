{
  while (nextPartition == null && super.hasNext()) {
    if (nextPartition == null)     nextPartition=super.next();
    DecoratedKey key=nextPartition.partitionKey();
    if (lastKey == null || !lastKey.equals(key))     remainingInPartition=limits.perPartitionCount();
    lastKey=key;
    if (isFirstPartition && isPreviouslyReturnedPartition(key) && !nextPartition.hasNext()) {
      nextPartition.close();
      nextPartition=null;
    }
    isFirstPartition=false;
  }
  return nextPartition != null;
}
