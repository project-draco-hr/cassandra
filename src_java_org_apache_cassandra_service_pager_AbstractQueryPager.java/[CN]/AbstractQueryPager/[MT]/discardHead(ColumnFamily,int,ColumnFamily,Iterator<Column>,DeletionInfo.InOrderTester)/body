{
  ColumnCounter counter=columnCounter();
  List<Column> staticColumns=new ArrayList<>(cfm.staticColumns().size());
  while (iter.hasNext()) {
    Column c=iter.next();
    ColumnDefinition columnDef=cfm.getColumnDefinitionFromColumnName(c.name());
    if (columnDef != null && columnDef.type == ColumnDefinition.Type.STATIC) {
      staticColumns.add(c);
      continue;
    }
    counter.count(c,tester);
    if (counter.live() > toDiscard) {
      for (      Column staticColumn : staticColumns)       copy.addColumn(staticColumn);
      copy.addColumn(c);
      while (iter.hasNext())       copy.addColumn(iter.next());
    }
  }
  return Math.min(counter.live(),toDiscard);
}
