{
  if (toDiscard == 0 || rows.isEmpty())   return rows;
  int i=rows.size() - 1;
  DecoratedKey lastKey=null;
  ColumnFamily lastCf=null;
  while (toDiscard > 0 && i >= 0) {
    Row last=rows.get(i--);
    lastKey=last.key;
    lastCf=last.cf.cloneMeShallow();
    toDiscard-=isReversed() ? discardFirst(last.cf,toDiscard,lastCf) : discardLast(last.cf,toDiscard,lastCf);
  }
  if (toDiscard > 0)   return Collections.<Row>emptyList();
  int count=lastCf.getColumnCount();
  int newSize=count == 0 ? i + 1 : i + 2;
  List<Row> newRows=new ArrayList<Row>(newSize);
  newRows.addAll(rows.subList(0,i + 1));
  if (count != 0)   newRows.add(new Row(lastKey,lastCf));
  return newRows;
}
