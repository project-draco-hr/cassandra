{
  this.cfs=cfs;
  this.sstable=sstable;
  this.toUpgrade=Collections.singletonList(sstable);
  this.outputHandler=outputHandler;
  this.directory=new File(sstable.getFilename()).getParentFile();
  this.controller=new UpgradeController(cfs);
  this.strategy=cfs.getCompactionStrategy();
  long estimatedTotalKeys=Math.max(cfs.metadata.getIndexInterval(),SSTableReader.getApproximateKeyCount(toUpgrade,cfs.metadata));
  long estimatedSSTables=Math.max(1,SSTableReader.getTotalBytes(this.toUpgrade) / strategy.getMaxSSTableSize());
  this.estimatedRows=(long)Math.ceil((double)estimatedTotalKeys / estimatedSSTables);
}
