{
  this.cfs=cfs;
  this.sstable=sstable;
  this.toUpgrade=new HashSet<>(Collections.singleton(sstable));
  this.outputHandler=outputHandler;
  this.directory=new File(sstable.getFilename()).getParentFile();
  this.controller=new UpgradeController(cfs);
  this.strategy=cfs.getCompactionStrategy();
  long estimatedTotalKeys=Math.max(cfs.metadata.getMinIndexInterval(),SSTableReader.getApproximateKeyCount(toUpgrade));
  long estimatedSSTables=Math.max(1,SSTableReader.getTotalBytes(this.toUpgrade) / strategy.getMaxSSTableBytes());
  this.estimatedRows=(long)Math.ceil((double)estimatedTotalKeys / estimatedSSTables);
}
