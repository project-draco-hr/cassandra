{
  this.cfs=cfs;
  this.transaction=txn;
  this.sstable=txn.onlyOne();
  this.outputHandler=outputHandler;
  this.directory=new File(sstable.getFilename()).getParentFile();
  this.controller=new UpgradeController(cfs);
  this.strategy=cfs.getCompactionStrategy();
  long estimatedTotalKeys=Math.max(cfs.metadata.getMinIndexInterval(),SSTableReader.getApproximateKeyCount(Arrays.asList(this.sstable)));
  long estimatedSSTables=Math.max(1,SSTableReader.getTotalBytes(Arrays.asList(this.sstable)) / strategy.getMaxSSTableBytes());
  this.estimatedRows=(long)Math.ceil((double)estimatedTotalKeys / estimatedSSTables);
}
