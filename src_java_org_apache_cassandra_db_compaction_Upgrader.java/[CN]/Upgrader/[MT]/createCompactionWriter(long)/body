{
  MetadataCollector sstableMetadataCollector=new MetadataCollector(cfs.getComparator());
  sstableMetadataCollector.addAncestor(sstable.descriptor.generation);
  for (  Integer i : sstable.getAncestors()) {
    if (new File(sstable.descriptor.withGeneration(i).filenameFor(Component.DATA)).exists())     sstableMetadataCollector.addAncestor(i);
  }
  sstableMetadataCollector.sstableLevel(sstable.getSSTableLevel());
  return SSTableWriter.create(Descriptor.fromFilename(cfs.getTempSSTablePath(directory)),estimatedRows,repairedAt,cfs.metadata,cfs.partitioner,sstableMetadataCollector,SerializationHeader.make(cfs.metadata,Sets.newHashSet(sstable)));
}
