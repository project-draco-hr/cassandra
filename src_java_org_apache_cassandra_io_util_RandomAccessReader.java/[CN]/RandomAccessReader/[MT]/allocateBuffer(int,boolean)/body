{
  int size=(int)Math.min(fileLength,bufferSize);
  return useDirectBuffer ? ByteBuffer.allocate(size) : ByteBuffer.allocateDirect(size);
}
