{
  int size=(int)Math.min(fileLength,bufferSize);
  return useDirectBuffer ? ByteBuffer.allocateDirect(size) : ByteBuffer.allocate(size);
}
