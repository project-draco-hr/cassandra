{
  if (in.readInt() != DatabaseDescriptor.getIndexInterval())   throw new IOException("Cannot read the saved summary because Index Interval changed.");
  int size=in.readInt();
  long[] positions=new long[size];
  byte[][] keys=new byte[size][];
  for (int i=0; i < size; i++) {
    positions[i]=in.readLong();
    int len=in.readInt();
    keys[i]=len == 0 ? new byte[0] : ByteBufferUtil.readBytes(in,len);
  }
  return new IndexSummary(partitioner,keys,positions);
}
