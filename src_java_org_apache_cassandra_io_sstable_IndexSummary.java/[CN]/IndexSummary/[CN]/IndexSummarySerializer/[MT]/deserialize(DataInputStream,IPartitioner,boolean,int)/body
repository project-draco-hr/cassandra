{
  int indexInterval=in.readInt();
  if (indexInterval != expectedIndexInterval) {
    throw new IOException(String.format("Cannot read index summary because Index Interval changed from %d to %d.",indexInterval,expectedIndexInterval));
  }
  int summarySize=in.readInt();
  long offheapSize=in.readLong();
  int samplingLevel, fullSamplingSummarySize;
  if (haveSamplingLevel) {
    samplingLevel=in.readInt();
    fullSamplingSummarySize=in.readInt();
  }
 else {
    samplingLevel=BASE_SAMPLING_LEVEL;
    fullSamplingSummarySize=summarySize;
  }
  Memory memory=Memory.allocate(offheapSize);
  FBUtilities.copy(in,new MemoryOutputStream(memory),offheapSize);
  return new IndexSummary(partitioner,memory,summarySize,fullSamplingSummarySize,indexInterval,samplingLevel);
}
