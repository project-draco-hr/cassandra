def test_create_indexs(self):
    'creating column indexes'
    cursor = init()
    cursor.execute('USE Keyspace1')
    cursor.execute('CREATE COLUMNFAMILY CreateIndex1 (KEY text PRIMARY KEY)')
    cursor.execute('CREATE INDEX namedIndex ON CreateIndex1 (items)')
    cursor.execute('CREATE INDEX ON CreateIndex1 (stuff)')
    ksdef = thrift_client.describe_keyspace('Keyspace1')
    cfam = [i for i in ksdef.cf_defs if (i.name == 'CreateIndex1')][0]
    items = [i for i in cfam.column_metadata if (i.name == 'items')][0]
    stuff = [i for i in cfam.column_metadata if (i.name == 'stuff')][0]
    assert (items.index_name == 'namedIndex'), 'missing index (or name)'
    assert (items.index_type == 0), 'missing index'
    assert (not stuff.index_name), ('index_name should be unset, not %s' % stuff.index_name)
    assert (stuff.index_type == 0), 'missing index'
    assert_raises(cql.ProgrammingError, cursor.execute, 'CREATE INDEX ON CreateIndex1 (stuff)')
