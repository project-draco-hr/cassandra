{
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, f int, PRIMARY KEY ((a, b), c, d, e))");
  createIndex("CREATE INDEX ON %s (c)");
  createIndex("CREATE INDEX ON %s (f)");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,1,0,1);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,1,1,2);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,0,0,3);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,1,0,4);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,1,1,5);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,2,0,0,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c = ? ALLOW FILTERING",0,1),row(0,0,1,0,0,3),row(0,0,1,1,0,4),row(0,0,1,1,1,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c = ? AND d = ? ALLOW FILTERING",0,1,1),row(0,0,1,1,0,4),row(0,0,1,1,1,5));
  assertInvalidMessage("Partition key part b must be restricted since preceding part is","SELECT * FROM %s WHERE a = ? AND c >= ? ALLOW FILTERING",0,1);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND c >= ? AND f = ?",0,0,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c >= ? AND f = ? ALLOW FILTERING",0,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND c = ? AND d >= ? AND f = ?",0,0,1,1,5),row(0,0,1,1,1,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c = ? AND d >= ? AND f = ? ALLOW FILTERING",0,1,1,5),row(0,0,1,1,1,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering and thus may have unpredictable performance. If you want to execute this query despite the performance unpredictability, use ALLOW FILTERING","SELECT * FROM %s WHERE a = ? AND d >= ? AND f = ?",0,1,5);
}
