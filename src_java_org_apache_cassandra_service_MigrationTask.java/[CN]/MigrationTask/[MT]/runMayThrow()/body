{
  MessageOut<MigrationTask> message=new MessageOut<MigrationTask>(MessagingService.Verb.MIGRATION_REQUEST,this,serializer);
  int retries=0;
  while (retries < MigrationManager.MIGRATION_REQUEST_RETRIES) {
    if (!FailureDetector.instance.isAlive(endpoint)) {
      logger.error("Can't send migration request: node {} is down.",endpoint);
      return;
    }
    IAsyncResult iar=MessagingService.instance().sendRR(message,endpoint);
    try {
      byte[] reply=iar.get(DatabaseDescriptor.getRpcTimeout(),TimeUnit.MILLISECONDS);
      DefsTable.mergeRemoteSchema(reply,Gossiper.instance.getVersion(endpoint));
      return;
    }
 catch (    TimeoutException e) {
      retries++;
    }
  }
}
