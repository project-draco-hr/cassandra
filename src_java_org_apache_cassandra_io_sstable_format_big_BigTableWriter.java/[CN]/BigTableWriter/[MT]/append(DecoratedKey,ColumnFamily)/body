{
  long startPosition=beforeAppend(decoratedKey);
  try {
    RowIndexEntry entry=rawAppend(cf,startPosition,decoratedKey,dataFile.stream);
    afterAppend(decoratedKey,startPosition,entry);
  }
 catch (  IOException e) {
    throw new FSWriteError(e,dataFile.getPath());
  }
  metadataCollector.update(dataFile.getFilePointer() - startPosition,cf.getColumnStats());
}
