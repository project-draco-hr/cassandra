{
  long startPosition=beforeAppend(row.key);
  RowIndexEntry entry;
  try {
    entry=row.write(startPosition,dataFile);
    if (entry == null)     return null;
    long endPosition=dataFile.getFilePointer();
    long rowSize=endPosition - startPosition;
    maybeLogLargePartitionWarning(row.key,rowSize);
    metadataCollector.update(rowSize,row.columnStats());
    afterAppend(row.key,endPosition,entry);
    return entry;
  }
 catch (  IOException e) {
    throw new FSWriteError(e,dataFile.getPath());
  }
}
