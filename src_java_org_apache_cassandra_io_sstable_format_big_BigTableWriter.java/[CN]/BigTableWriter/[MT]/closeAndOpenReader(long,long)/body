{
  Pair<Descriptor,StatsMetadata> p=close(repairedAt);
  Descriptor newdesc=p.left;
  StatsMetadata sstableMetadata=p.right;
  SegmentedFile ifile=iwriter.builder.complete(newdesc.filenameFor(Component.PRIMARY_INDEX));
  SegmentedFile dfile=dbuilder.complete(newdesc.filenameFor(Component.DATA));
  SSTableReader sstable=SSTableReader.internalOpen(newdesc,components,metadata,partitioner,ifile,dfile,iwriter.summary.build(partitioner),iwriter.bf,maxDataAge,sstableMetadata,SSTableReader.OpenReason.NORMAL);
  sstable.first=getMinimalKey(first);
  sstable.last=getMinimalKey(last);
  sstable.saveSummary(iwriter.builder,dbuilder);
  iwriter=null;
  dbuilder=null;
  return sstable;
}
