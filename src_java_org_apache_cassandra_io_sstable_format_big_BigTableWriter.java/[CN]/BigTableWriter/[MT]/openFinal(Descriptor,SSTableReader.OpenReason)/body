{
  if (maxDataAge < 0)   maxDataAge=System.currentTimeMillis();
  StatsMetadata stats=statsMetadata();
  SegmentedFile ifile=iwriter.builder.complete(desc.filenameFor(Component.PRIMARY_INDEX));
  SegmentedFile dfile=dbuilder.complete(desc.filenameFor(Component.DATA));
  SSTableReader sstable=SSTableReader.internalOpen(desc.asType(Descriptor.Type.FINAL),components,this.metadata,partitioner,ifile,dfile,iwriter.summary.build(partitioner),iwriter.bf.sharedCopy(),maxDataAge,stats,openReason);
  sstable.first=getMinimalKey(first);
  sstable.last=getMinimalKey(last);
  return sstable;
}
