{
  Map<MetadataType,MetadataComponent> metadataComponents=finalizeMetadata();
  iwriter.prepareToCommit();
  dataFile.setDescriptor(descriptor).prepareToCommit();
  writeMetadata(descriptor,metadataComponents);
  SSTable.appendTOC(descriptor,components);
  if (openResult)   finalReader=openFinal(descriptor,SSTableReader.OpenReason.NORMAL);
}
