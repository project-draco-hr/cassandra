{
  Map<MetadataType,MetadataComponent> metadataComponents=finalizeMetadata();
  iwriter.prepareToCommit();
  dataFile.setDescriptor(descriptor).prepareToCommit();
  writeMetadata(descriptor,metadataComponents);
  SSTable.appendTOC(descriptor,components);
  rename(descriptor,components);
  if (openResult)   finalReader=openFinal(descriptor.asType(Descriptor.Type.FINAL),SSTableReader.OpenReason.NORMAL);
}
