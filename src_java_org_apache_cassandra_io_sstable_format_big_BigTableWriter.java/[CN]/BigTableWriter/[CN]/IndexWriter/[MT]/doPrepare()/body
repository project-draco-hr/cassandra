{
  flushBf();
  long position=iwriter.indexFile.position();
  iwriter.indexFile.setDescriptor(descriptor).prepareToCommit();
  FileUtils.truncate(iwriter.indexFile.getPath(),position);
  summary.prepareToCommit();
  try (IndexSummary summary=iwriter.summary.build(getPartitioner())){
    SSTableReader.saveSummary(descriptor,first,last,iwriter.builder,dbuilder,summary);
  }
 }
