{
  bf.add(key.getKey());
  long indexPosition=indexFile.getFilePointer();
  try {
    ByteBufferUtil.writeWithShortLength(key.getKey(),indexFile.stream);
    rowIndexEntrySerializer.serialize(indexEntry,indexFile.stream);
  }
 catch (  IOException e) {
    throw new FSWriteError(e,indexFile.getPath());
  }
  if (logger.isTraceEnabled())   logger.trace("wrote index entry: {} at {}",indexEntry,indexPosition);
  summary.maybeAddEntry(key,indexPosition);
  builder.addPotentialBoundary(indexPosition);
}
