{
  KsDef keyspace=new KsDef();
  String defaultComparator=comparator == null ? DEFAULT_COMPARATOR : comparator;
  CfDef standardCfDef=new CfDef(KEYSPACE_NAME,"Standard1");
  Map<String,String> compressionOptions=new HashMap<String,String>();
  if (compression != null)   compressionOptions.put("sstable_compression",compression);
  standardCfDef.setComparator_type(defaultComparator).setDefault_validation_class(DEFAULT_VALIDATOR).setCompression_options(compressionOptions);
  if (!timeUUIDComparator) {
    for (int i=0; i < getColumnsPerKey(); i++) {
      standardCfDef.addToColumn_metadata(new ColumnDef(ByteBufferUtil.bytes("C" + i),"BytesType"));
    }
  }
  if (indexType != null) {
    ColumnDef standardColumn=new ColumnDef(ByteBufferUtil.bytes("C1"),"BytesType");
    standardColumn.setIndex_type(indexType).setIndex_name("Idx1");
    standardCfDef.setColumn_metadata(Arrays.asList(standardColumn));
  }
  CfDef superCfDef=new CfDef(KEYSPACE_NAME,"Super1").setColumn_type("Super");
  superCfDef.setComparator_type(DEFAULT_COMPARATOR).setSubcomparator_type(defaultComparator).setDefault_validation_class(DEFAULT_VALIDATOR).setCompression_options(compressionOptions);
  CfDef counterCfDef=new CfDef(KEYSPACE_NAME,"Counter1").setComparator_type(defaultComparator).setComparator_type(defaultComparator).setDefault_validation_class("CounterColumnType").setReplicate_on_write(replicateOnWrite).setCompression_options(compressionOptions);
  CfDef counterSuperCfDef=new CfDef(KEYSPACE_NAME,"SuperCounter1").setComparator_type(defaultComparator).setDefault_validation_class("CounterColumnType").setReplicate_on_write(replicateOnWrite).setColumn_type("Super").setCompression_options(compressionOptions);
  keyspace.setName(KEYSPACE_NAME);
  keyspace.setStrategy_class(replicationStrategy);
  if (!replicationStrategyOptions.isEmpty()) {
    keyspace.setStrategy_options(replicationStrategyOptions);
  }
  if (compactionStrategy != null) {
    standardCfDef.setCompaction_strategy(compactionStrategy);
    superCfDef.setCompaction_strategy(compactionStrategy);
    counterCfDef.setCompaction_strategy(compactionStrategy);
    counterSuperCfDef.setCompaction_strategy(compactionStrategy);
  }
  keyspace.setCf_defs(new ArrayList<CfDef>(Arrays.asList(standardCfDef,superCfDef,counterCfDef,counterSuperCfDef)));
  CassandraClient client=getClient(false);
  try {
    client.system_add_keyspace(keyspace);
    client.set_cql_version("3.0.0");
    client.set_keyspace(KEYSPACE_NAME);
    client.execute_cql3_query(createCounterCFStatementForCQL3(),Compression.NONE,ConsistencyLevel.ONE);
    if (enable_cql)     client.set_cql_version(cqlVersion);
    System.out.println(String.format("Created keyspaces. Sleeping %ss for propagation.",nodes.length));
    Thread.sleep(nodes.length * 1000);
  }
 catch (  InvalidRequestException e) {
    System.err.println("Unable to create stress keyspace: " + e.getWhy());
  }
catch (  Exception e) {
    System.err.println(e.getMessage());
  }
}
