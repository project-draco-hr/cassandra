{
  CFMetaData cfMetaData=newCFMetaData(4);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  ByteBuffer value4=ByteBufferUtil.bytes(4);
  Restriction singleEq=newSingleEq(cfMetaData,0,value1);
  Restriction multiEq=newMultiEq(cfMetaData,1,value2,value3);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiEq);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3);
  singleEq=newSingleEq(cfMetaData,0,value1);
  Restriction singleEq2=newSingleEq(cfMetaData,1,value2);
  multiEq=newMultiEq(cfMetaData,2,value3,value4);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(singleEq2).mergeWith(multiEq);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3,value4);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3,value4);
  singleEq=newSingleEq(cfMetaData,2,value3);
  multiEq=newMultiEq(cfMetaData,0,value1,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiEq);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3);
  singleEq=newSingleEq(cfMetaData,0,value1);
  singleEq2=newSingleEq(cfMetaData,3,value4);
  multiEq=newMultiEq(cfMetaData,1,value2,value3);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiEq).mergeWith(singleEq2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3,value4);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3,value4);
}
