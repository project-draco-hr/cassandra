{
  try (ChannelProxy channel=new ChannelProxy(file)){
    RandomAccessReader crcReader=RandomAccessReader.open(crcFile);
    boolean closeCrcReader=true;
    try {
      DataIntegrityMetadata.ChecksumValidator validator=new DataIntegrityMetadata.ChecksumValidator(new Adler32(),crcReader,file.getPath());
      closeCrcReader=false;
      boolean closeValidator=true;
      try {
        ChecksummedRandomAccessReader retval=new ChecksummedRandomAccessReader(file,channel,validator);
        closeValidator=false;
        return retval;
      }
  finally {
        if (closeValidator)         validator.close();
      }
    }
  finally {
      if (closeCrcReader)       crcReader.close();
    }
  }
 }
