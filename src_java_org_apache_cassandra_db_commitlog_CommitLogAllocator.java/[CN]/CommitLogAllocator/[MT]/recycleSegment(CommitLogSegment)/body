{
  activeSegments.remove(segment);
  if (isCapExceeded()) {
    discardSegment(segment);
    return;
  }
  queue.add(new Runnable(){
    public void run(){
      CommitLogSegment recycled=segment.recycle();
      internalAddReadySegment(recycled);
    }
  }
);
}
