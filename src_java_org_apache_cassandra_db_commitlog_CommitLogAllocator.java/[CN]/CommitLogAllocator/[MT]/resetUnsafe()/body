{
  logger.debug("Closing and clearing existing commit log segments...");
  while (StorageService.tasks.getActiveCount() > 0 || !queue.isEmpty())   Thread.yield();
  Uninterruptibles.sleepUninterruptibly(10,TimeUnit.MILLISECONDS);
  for (  CommitLogSegment segment : Iterables.concat(activeSegments,availableSegments))   segment.close();
  activeSegments.clear();
  availableSegments.clear();
}
