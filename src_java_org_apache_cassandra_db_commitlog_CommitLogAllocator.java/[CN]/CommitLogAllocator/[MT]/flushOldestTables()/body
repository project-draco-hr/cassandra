{
  CommitLogSegment oldestSegment=activeSegments.peek();
  if (oldestSegment != null && oldestSegment != CommitLog.instance.activeSegment) {
    for (    UUID dirtyCFId : oldestSegment.getDirtyCFIDs()) {
      Pair<String,String> pair=Schema.instance.getCF(dirtyCFId);
      if (pair == null) {
        logger.debug("Marking clean CF {} that doesn't exist anymore",dirtyCFId);
        oldestSegment.markClean(dirtyCFId,oldestSegment.getContext());
      }
 else {
        String keypace=pair.left;
        final ColumnFamilyStore cfs=Table.open(keypace).getColumnFamilyStore(dirtyCFId);
        Runnable runnable=new Runnable(){
          public void run(){
            cfs.forceFlush();
          }
        }
;
        StorageService.optionalTasks.execute(runnable);
      }
    }
  }
}
