{
  for (  MessageIn<ReadResponse> message : messages)   resolver.preprocess(message);
  final int threadCount=45;
  ExecutorService executorService=Executors.newFixedThreadPool(threadCount);
  final CountDownLatch finished=new CountDownLatch(threadCount);
  for (int i=0; i < threadCount; i++) {
    executorService.submit(new Runnable(){
      public void run(){
        try {
          Row row=resolver.getData();
          checkSame(expected,row);
          row=resolver.resolve();
          checkSame(expected,row);
        }
 catch (        DigestMismatchException ex) {
          fail(ex.getMessage());
        }
 finally {
          finished.countDown();
        }
      }
    }
);
  }
  finished.await();
  assertEquals(0,executorService.shutdownNow().size());
}
