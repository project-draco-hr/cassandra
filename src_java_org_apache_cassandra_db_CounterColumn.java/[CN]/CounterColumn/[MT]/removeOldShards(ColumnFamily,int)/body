{
  if (!cf.isSuper()) {
    for (    Map.Entry<ByteBuffer,IColumn> entry : cf.getColumnsMap().entrySet()) {
      ByteBuffer cname=entry.getKey();
      IColumn c=entry.getValue();
      if (!(c instanceof CounterColumn))       continue;
      CounterColumn cleaned=((CounterColumn)c).removeOldShards(gcBefore);
      if (cleaned != c) {
        cf.remove(cname);
        cf.addColumn(cleaned);
      }
    }
  }
 else {
    for (    Map.Entry<ByteBuffer,IColumn> entry : cf.getColumnsMap().entrySet()) {
      SuperColumn c=(SuperColumn)entry.getValue();
      for (      IColumn subColumn : c.getSubColumns()) {
        if (!(subColumn instanceof CounterColumn))         continue;
        CounterColumn cleaned=((CounterColumn)subColumn).removeOldShards(gcBefore);
        if (cleaned != subColumn) {
          c.remove(subColumn.name());
          c.addColumn(cleaned);
        }
      }
    }
  }
}
