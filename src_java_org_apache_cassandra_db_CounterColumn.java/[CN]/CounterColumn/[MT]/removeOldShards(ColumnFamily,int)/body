{
  if (!cf.isSuper()) {
    for (    IColumn c : cf) {
      if (!(c instanceof CounterColumn))       continue;
      CounterColumn cleaned=((CounterColumn)c).removeOldShards(gcBefore);
      if (cleaned != c)       cf.replace(c,cleaned);
    }
  }
 else {
    for (    IColumn col : cf) {
      SuperColumn c=(SuperColumn)col;
      for (      IColumn subColumn : c.getSubColumns()) {
        if (!(subColumn instanceof CounterColumn))         continue;
        CounterColumn cleaned=((CounterColumn)subColumn).removeOldShards(gcBefore);
        if (cleaned != subColumn)         c.replace(subColumn,cleaned);
      }
    }
  }
}
