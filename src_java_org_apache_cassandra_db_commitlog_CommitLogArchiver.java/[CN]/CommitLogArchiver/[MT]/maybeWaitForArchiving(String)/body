{
  Future<?> f=archivePending.remove(name);
  if (f == null)   return true;
  try {
    f.get();
  }
 catch (  InterruptedException e) {
    throw new AssertionError(e);
  }
catch (  ExecutionException e) {
    if (e.getCause() instanceof IOException) {
      logger.error("Looks like the archiving of file {} failed earlier, cassandra is going to ignore this segment for now.",name);
      return false;
    }
    throw new RuntimeException(e);
  }
  return true;
}
