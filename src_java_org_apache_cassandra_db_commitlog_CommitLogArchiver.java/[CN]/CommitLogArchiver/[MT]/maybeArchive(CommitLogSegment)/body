{
  if (Strings.isNullOrEmpty(archiveCommand))   return;
  archivePending.put(segment.getName(),executor.submit(new WrappedRunnable(){
    protected void runMayThrow() throws IOException {
      segment.waitForFinalSync();
      String command=archiveCommand.replace("%name",segment.getName());
      if (FBUtilities.isWindows())       archiveCommand.replace('/',File.separatorChar);
      command=command.replace("%path",segment.getPath());
      exec(command);
    }
  }
));
}
