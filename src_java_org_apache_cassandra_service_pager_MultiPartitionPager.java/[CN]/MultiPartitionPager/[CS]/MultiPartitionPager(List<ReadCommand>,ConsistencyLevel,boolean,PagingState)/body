{
  int i=0;
  if (state != null)   for (; i < commands.size(); i++)   if (commands.get(i).key.equals(state.partitionKey))   break;
  if (i >= commands.size()) {
    pagers=null;
    timestamp=-1;
    return;
  }
  pagers=new SinglePartitionPager[commands.size() - i];
  pagers[0]=makePager(commands.get(i),consistencyLevel,localQuery,state);
  timestamp=commands.get(i).timestamp;
  for (int j=i + 1; j < commands.size(); j++) {
    ReadCommand command=commands.get(j);
    if (command.timestamp != timestamp)     throw new IllegalArgumentException("All commands must have the same timestamp or weird results may happen.");
    pagers[j - i]=makePager(command,consistencyLevel,localQuery,null);
  }
  remaining=state == null ? computeRemaining(pagers) : state.remaining;
}
