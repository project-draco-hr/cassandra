{
  Map<String,String> options=copyOptions(opts);
  String sstableCompressionClass;
  if (!removeEnabled(options)) {
    sstableCompressionClass=null;
    if (!options.isEmpty())     throw new ConfigurationException("If the '" + ENABLED + "' option is set to false"+ " no other options must be specified");
  }
 else {
    sstableCompressionClass=removeSstableCompressionClass(options);
  }
  Integer chunkLength=removeChunkLength(options);
  CompressionParameters cp=new CompressionParameters(sstableCompressionClass,chunkLength,options);
  cp.validate();
  return cp;
}
