{
  for (  FilteredPartition newPartition : after.values()) {
    FilteredPartition oldPartition=before.remove(newPartition.partitionKey());
    if (oldPartition == null || oldPartition.isEmpty()) {
      Schema.instance.addKeyspace(createKeyspaceFromSchemaPartition(newPartition.rowIterator()));
    }
 else {
      String name=AsciiType.instance.compose(newPartition.partitionKey().getKey());
      Schema.instance.updateKeyspace(name);
    }
  }
  return asKeyspaceNamesSet(before.keySet());
}
