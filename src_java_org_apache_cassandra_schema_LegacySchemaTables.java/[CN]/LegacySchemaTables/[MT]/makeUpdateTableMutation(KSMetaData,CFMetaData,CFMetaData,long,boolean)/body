{
  Mutation mutation=makeCreateKeyspaceMutation(keyspace,timestamp,false);
  addTableToSchemaMutation(newTable,timestamp,false,mutation);
  MapDifference<ByteBuffer,ColumnDefinition> columnDiff=Maps.difference(oldTable.getColumnMetadata(),newTable.getColumnMetadata());
  for (  ColumnDefinition column : columnDiff.entriesOnlyOnLeft().values()) {
    if (fromThrift && column.kind != ColumnDefinition.Kind.REGULAR)     continue;
    dropColumnFromSchemaMutation(oldTable,column,timestamp,mutation);
  }
  for (  ColumnDefinition column : columnDiff.entriesOnlyOnRight().values())   addColumnToSchemaMutation(newTable,column,timestamp,mutation);
  for (  ByteBuffer name : columnDiff.entriesDiffering().keySet())   addColumnToSchemaMutation(newTable,newTable.getColumnDefinition(name),timestamp,mutation);
  MapDifference<String,TriggerDefinition> triggerDiff=Maps.difference(oldTable.getTriggers(),newTable.getTriggers());
  for (  TriggerDefinition trigger : triggerDiff.entriesOnlyOnLeft().values())   dropTriggerFromSchemaMutation(oldTable,trigger,timestamp,mutation);
  for (  TriggerDefinition trigger : triggerDiff.entriesOnlyOnRight().values())   addTriggerToSchemaMutation(newTable,trigger,timestamp,mutation);
  return mutation;
}
