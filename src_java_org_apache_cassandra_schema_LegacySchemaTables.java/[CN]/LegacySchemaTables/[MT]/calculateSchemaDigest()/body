{
  MessageDigest digest;
  try {
    digest=MessageDigest.getInstance("MD5");
  }
 catch (  NoSuchAlgorithmException e) {
    throw new RuntimeException(e);
  }
  for (  String table : ALL) {
    for (    Row partition : getSchemaPartitionsForTable(table)) {
      if (isEmptySchemaPartition(partition) || isSystemKeyspaceSchemaPartition(partition))       continue;
      ColumnFamilyStore.removeDeletedColumnsOnly(partition.cf,Integer.MAX_VALUE,SecondaryIndexManager.nullUpdater);
      partition.cf.purgeTombstones(Integer.MAX_VALUE);
      partition.cf.updateDigest(digest);
    }
  }
  return UUID.nameUUIDFromBytes(digest.digest());
}
