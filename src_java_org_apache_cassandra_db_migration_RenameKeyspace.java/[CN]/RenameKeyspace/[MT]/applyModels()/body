{
  if (!StorageService.instance.isClientMode())   renameKsStorageFiles(oldName,newName);
  KSMetaData oldKsm=schema.getTableDefinition(oldName);
  for (  CFMetaData cfm : oldKsm.cfMetaData().values())   schema.purge(cfm);
  KSMetaData newKsm=rename(oldKsm,newName,true);
  for (  CFMetaData cfm : newKsm.cfMetaData().values()) {
    try {
      schema.load(cfm);
    }
 catch (    ConfigurationException ex) {
      throw new RuntimeException(ex);
    }
  }
  schema.clearTableDefinition(oldKsm,newVersion);
  schema.setTableDefinition(newKsm,newVersion);
  if (!StorageService.instance.isClientMode()) {
    Table.clear(oldKsm.name,schema);
    Table.open(newName,schema);
  }
}
