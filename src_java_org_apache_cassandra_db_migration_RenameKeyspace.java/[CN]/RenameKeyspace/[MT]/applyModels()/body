{
  if (!clientMode)   renameKsStorageFiles(oldName,newName);
  KSMetaData oldKsm=DatabaseDescriptor.getTableDefinition(oldName);
  KSMetaData newKsm=KSMetaData.rename(oldKsm,newName,true);
  DatabaseDescriptor.clearTableDefinition(oldKsm,newVersion);
  DatabaseDescriptor.setTableDefinition(newKsm,newVersion);
  if (!clientMode) {
    Table.clear(oldKsm.name);
    Table.open(newName);
    CommitLog.instance().forceNewSegment();
    HintedHandOffManager.renameHints(oldName,newName);
  }
}
