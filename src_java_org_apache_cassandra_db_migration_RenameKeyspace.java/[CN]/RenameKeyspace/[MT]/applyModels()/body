{
  if (!clientMode)   renameKsStorageFiles(oldName,newName);
  KSMetaData oldKsm=DatabaseDescriptor.getTableDefinition(oldName);
  for (  CFMetaData cfm : oldKsm.cfMetaData().values())   CFMetaData.purge(cfm);
  KSMetaData newKsm=rename(oldKsm,newName,true);
  for (  CFMetaData cfm : newKsm.cfMetaData().values()) {
    try {
      CFMetaData.map(cfm);
    }
 catch (    ConfigurationException ex) {
      throw new RuntimeException(ex);
    }
  }
  DatabaseDescriptor.clearTableDefinition(oldKsm,newVersion);
  DatabaseDescriptor.setTableDefinition(newKsm,newVersion);
  if (!clientMode) {
    Table.clear(oldKsm.name);
    Table.open(newName);
    CommitLog.instance().forceNewSegment();
    HintedHandOffManager.renameHints(oldName,newName);
  }
}
