{
  KsDef keyspace=new KsDef();
  ColumnDef standardColumn=new ColumnDef(ByteBuffer.wrap("C1".getBytes()),"UTF8Type");
  ColumnDef superSubColumn=new ColumnDef(ByteBuffer.wrap("S1".getBytes()),"UTF8Type");
  if (indexType != null)   standardColumn.setIndex_type(indexType).setIndex_name("Idx1");
  CfDef standardCfDef=new CfDef("Keyspace1","Standard1").setColumn_metadata(Arrays.asList(standardColumn));
  CfDef superCfDef=new CfDef("Keyspace1","Super1").setColumn_metadata(Arrays.asList(superSubColumn)).setColumn_type("Super");
  keyspace.setName("Keyspace1");
  keyspace.setStrategy_class("org.apache.cassandra.locator.SimpleStrategy");
  keyspace.setReplication_factor(replicationFactor);
  keyspace.setCf_defs(new ArrayList<CfDef>(Arrays.asList(standardCfDef,superCfDef)));
  Cassandra.Client client=getClient(false);
  try {
    client.system_add_keyspace(keyspace);
    out.println(String.format("Created keyspaces. Sleeping %ss for propagation.",nodes.length));
    Thread.sleep(nodes.length * 1000);
  }
 catch (  InvalidRequestException e) {
    out.println(e.getWhy());
  }
catch (  Exception e) {
    out.println(e.getMessage());
  }
}
