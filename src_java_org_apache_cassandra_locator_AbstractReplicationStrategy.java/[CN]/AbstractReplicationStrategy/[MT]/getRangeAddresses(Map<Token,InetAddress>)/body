{
  Map<Range,Set<InetAddress>> map=new HashMap<Range,Set<InetAddress>>();
  for (  Token token : tokenMap.keySet()) {
    Range range=getPrimaryRangeFor(token,tokenMap);
    HashSet<InetAddress> addresses=new HashSet<InetAddress>();
    for (    InetAddress ep : getNaturalEndpoints(token,tokenMap)) {
      addresses.add(ep);
    }
    map.put(range,addresses);
  }
  return map;
}
