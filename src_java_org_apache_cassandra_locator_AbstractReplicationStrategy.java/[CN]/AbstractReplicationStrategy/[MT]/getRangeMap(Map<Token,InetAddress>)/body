{
  Map<InetAddress,Set<Range>> map=new HashMap<InetAddress,Set<Range>>();
  for (  InetAddress ep : tokenMap.values()) {
    map.put(ep,new HashSet<Range>());
  }
  for (  Token token : tokenMap.keySet()) {
    Range range=getPrimaryRangeFor(token,tokenMap);
    for (    InetAddress ep : getReadStorageEndPoints(token,tokenMap)) {
      map.get(ep).add(range);
    }
  }
  return map;
}
