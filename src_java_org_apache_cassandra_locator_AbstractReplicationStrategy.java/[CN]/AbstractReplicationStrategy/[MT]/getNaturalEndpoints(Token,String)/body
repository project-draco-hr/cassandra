{
  Token keyToken=TokenMetadata.ringIterator(tokenMetadata.sortedTokens(),searchToken).next();
  EndpointCacheKey cacheKey=new EndpointCacheKey(table,keyToken);
  ArrayList<InetAddress> endpoints=cachedEndpoints.get(cacheKey);
  if (endpoints == null) {
    TokenMetadata tokenMetadataClone=tokenMetadata.cloneOnlyTokenMap();
    keyToken=TokenMetadata.ringIterator(tokenMetadataClone.sortedTokens(),searchToken).next();
    cacheKey=new EndpointCacheKey(table,keyToken);
    endpoints=new ArrayList<InetAddress>(calculateNaturalEndpoints(searchToken,tokenMetadataClone,table));
    cachedEndpoints.put(cacheKey,endpoints);
  }
  return new ArrayList<InetAddress>(endpoints);
}
