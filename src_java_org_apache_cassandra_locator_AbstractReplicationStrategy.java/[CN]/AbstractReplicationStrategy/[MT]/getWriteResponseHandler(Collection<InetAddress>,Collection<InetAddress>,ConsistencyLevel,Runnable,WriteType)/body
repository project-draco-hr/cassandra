{
  if (consistency_level.isDatacenterLocal()) {
    return new DatacenterWriteResponseHandler(naturalEndpoints,pendingEndpoints,consistency_level,getTable(),callback,writeType);
  }
 else   if (consistency_level == ConsistencyLevel.EACH_QUORUM && (this instanceof NetworkTopologyStrategy)) {
    return new DatacenterSyncWriteResponseHandler(naturalEndpoints,pendingEndpoints,consistency_level,getTable(),callback,writeType);
  }
  return new WriteResponseHandler(naturalEndpoints,pendingEndpoints,consistency_level,getTable(),callback,writeType);
}
