{
  if (consistency_level == ConsistencyLevel.LOCAL_QUORUM) {
    return new DatacenterWriteResponseHandler(naturalEndpoints,pendingEndpoints,consistency_level,table,callback,writeType);
  }
 else   if (consistency_level == ConsistencyLevel.EACH_QUORUM) {
    return new DatacenterSyncWriteResponseHandler(naturalEndpoints,pendingEndpoints,consistency_level,table,callback,writeType);
  }
  return new WriteResponseHandler(naturalEndpoints,pendingEndpoints,consistency_level,table,callback,writeType);
}
