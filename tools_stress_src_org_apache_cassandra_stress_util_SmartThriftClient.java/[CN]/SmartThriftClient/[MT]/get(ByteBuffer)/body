{
  Set<Host> hosts=metadata.getReplicas(metadata.quote(keyspace),pk);
  int pos=roundrobin.incrementAndGet() % hosts.size();
  if (pos < 0)   pos=-pos;
  Host host=Iterators.get(hosts.iterator(),pos);
  ConcurrentLinkedQueue<Client> q=cache.get(host);
  if (q == null) {
    ConcurrentLinkedQueue<Client> newQ=new ConcurrentLinkedQueue<Client>();
    q=cache.putIfAbsent(host,newQ);
    if (q == null)     q=newQ;
  }
  Client tclient=q.poll();
  if (tclient != null)   return tclient;
  return new Client(settings.getRawThriftClient(host.getAddress().getHostAddress()),host);
}
