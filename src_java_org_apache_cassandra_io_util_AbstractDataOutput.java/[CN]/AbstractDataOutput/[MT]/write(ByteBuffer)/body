{
  int len=buffer.remaining();
  if (len < 16) {
    int offset=buffer.position();
    for (int i=0; i < len; i++)     write(buffer.get(i + offset));
    return;
  }
  byte[] buf=this.buf;
  if (buf == null)   this.buf=buf=new byte[256];
  int offset=0;
  while (len > 0) {
    int sublen=Math.min(buf.length,len);
    ByteBufferUtil.arrayCopy(buffer,buffer.position() + offset,buf,0,sublen);
    write(buf,0,sublen);
    offset+=sublen;
    len-=sublen;
  }
}
