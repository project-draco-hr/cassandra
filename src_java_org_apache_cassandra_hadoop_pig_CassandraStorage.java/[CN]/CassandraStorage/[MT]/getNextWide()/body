{
  CfInfo cfInfo=getCfInfo(loadSignature);
  CfDef cfDef=cfInfo.cfDef;
  ByteBuffer key=null;
  Tuple tuple=null;
  DefaultDataBag bag=new DefaultDataBag();
  try {
    while (true) {
      hasNext=reader.nextKeyValue();
      if (!hasNext) {
        if (tuple == null)         tuple=TupleFactory.getInstance().newTuple();
        if (lastRow != null) {
          if (tuple.size() == 0) {
            key=(ByteBuffer)reader.getCurrentKey();
            tuple=keyToTuple(key,cfDef,parseType(cfDef.getKey_validation_class()));
          }
          for (          Map.Entry<ByteBuffer,Column> entry : lastRow.entrySet()) {
            bag.add(columnToTuple(entry.getValue(),cfInfo,parseType(cfDef.getComparator_type())));
          }
          lastKey=null;
          lastRow=null;
          tuple.append(bag);
          return tuple;
        }
 else {
          if (tuple.size() == 1) {
            tuple.append(bag);
            return tuple;
          }
 else           return null;
        }
      }
      if (key != null && !((ByteBuffer)reader.getCurrentKey()).equals(key)) {
        lastKey=(ByteBuffer)reader.getCurrentKey();
        lastRow=(SortedMap<ByteBuffer,Column>)reader.getCurrentValue();
        tuple.append(bag);
        return tuple;
      }
      if (key == null) {
        key=(ByteBuffer)reader.getCurrentKey();
        if (lastKey != null && !(key.equals(lastKey))) {
          if (tuple == null)           tuple=keyToTuple(lastKey,cfDef,parseType(cfDef.getKey_validation_class()));
 else           addKeyToTuple(tuple,lastKey,cfDef,parseType(cfDef.getKey_validation_class()));
          for (          Map.Entry<ByteBuffer,Column> entry : lastRow.entrySet()) {
            bag.add(columnToTuple(entry.getValue(),cfInfo,parseType(cfDef.getComparator_type())));
          }
          tuple.append(bag);
          lastKey=key;
          lastRow=(SortedMap<ByteBuffer,Column>)reader.getCurrentValue();
          return tuple;
        }
        if (tuple == null)         tuple=keyToTuple(key,cfDef,parseType(cfDef.getKey_validation_class()));
 else         addKeyToTuple(tuple,lastKey,cfDef,parseType(cfDef.getKey_validation_class()));
      }
      SortedMap<ByteBuffer,Column> row=(SortedMap<ByteBuffer,Column>)reader.getCurrentValue();
      if (lastRow != null) {
        for (        Map.Entry<ByteBuffer,Column> entry : lastRow.entrySet()) {
          bag.add(columnToTuple(entry.getValue(),cfInfo,parseType(cfDef.getComparator_type())));
        }
        lastKey=null;
        lastRow=null;
      }
      for (      Map.Entry<ByteBuffer,Column> entry : row.entrySet()) {
        bag.add(columnToTuple(entry.getValue(),cfInfo,parseType(cfDef.getComparator_type())));
      }
    }
  }
 catch (  InterruptedException e) {
    throw new IOException(e.getMessage());
  }
}
