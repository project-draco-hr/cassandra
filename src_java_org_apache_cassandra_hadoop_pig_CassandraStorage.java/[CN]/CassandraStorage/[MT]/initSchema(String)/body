{
  Properties properties=UDFContext.getUDFContext().getUDFProperties(CassandraStorage.class);
  if (!properties.containsKey(signature)) {
    try {
      Cassandra.Client client=ConfigHelper.getClientFromInputAddressList(conf);
      client.set_keyspace(keyspace);
      if (username != null && password != null) {
        Map<String,String> credentials=new HashMap<String,String>(2);
        credentials.put(PasswordAuthenticator.USERNAME_KEY,username);
        credentials.put(PasswordAuthenticator.PASSWORD_KEY,password);
        try {
          client.login(new AuthenticationRequest(credentials));
        }
 catch (        AuthenticationException e) {
          logger.error("Authentication exception: invalid username and/or password");
          throw new IOException(e);
        }
      }
      CfDef cfDef=getCfDef(client);
      if (cfDef != null) {
        StringBuilder sb=new StringBuilder();
        sb.append(cfdefToString(cfDef));
        properties.setProperty(signature,sb.toString());
      }
 else       throw new IOException(String.format("Table '%s' not found in keyspace '%s'",column_family,keyspace));
    }
 catch (    Exception e) {
      throw new IOException(e);
    }
  }
}
