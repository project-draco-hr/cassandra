def buildProtocol(self, addr):
    p = self.protocol(self.thriftFactory(), keyspace=self.keyspace, credentials=self.credentials, decoder=self.decoder)
    p.factory = self
    self.resetDelay()
    return p
