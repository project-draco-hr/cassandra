def execute(self, query, *args, **kwargs):
    if ('retries' in kwargs):
        retries = kwargs['retries']
        del kwargs['retries']
    else:
        retries = self.request_retries
    d = defer.Deferred()
    self._pending.append(d)
    self.queue.put(((query, args, kwargs), d, retries))
    return d
