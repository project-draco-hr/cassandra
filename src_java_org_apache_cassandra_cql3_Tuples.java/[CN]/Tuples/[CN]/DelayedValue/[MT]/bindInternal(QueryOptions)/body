{
  int version=options.getProtocolVersion();
  ByteBuffer[] buffers=new ByteBuffer[elements.size()];
  for (int i=0; i < elements.size(); i++) {
    buffers[i]=elements.get(i).bindAndGet(options);
    if (buffers[i] == ByteBufferUtil.UNSET_BYTE_BUFFER)     throw new InvalidRequestException(String.format("Invalid unset value for tuple field number %d",i));
    if (version < 3 && type.type(i).isCollection())     buffers[i]=((CollectionType)type.type(i)).getSerializer().reserializeToV3(buffers[i]);
  }
  return buffers;
}
