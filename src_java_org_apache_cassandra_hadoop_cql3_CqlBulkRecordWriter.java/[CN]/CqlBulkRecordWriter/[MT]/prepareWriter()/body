{
  try {
    if (writer == null) {
      writer=CQLSSTableWriter.builder().forTable(schema).using(insertStatement).withPartitioner(ConfigHelper.getOutputPartitioner(conf)).inDirectory(outputDir).withBufferSizeInMB(Integer.parseInt(conf.get(BUFFER_SIZE_IN_MB,"64"))).build();
    }
    if (loader == null) {
      BulkLoader.ExternalClient externalClient=getExternalClient(conf);
      this.loader=new SSTableLoader(outputDir,externalClient,new BulkRecordWriter.NullOutputHandler()){
        @Override public void onSuccess(        StreamState finalState){
          if (deleteSrc)           FileUtils.deleteRecursive(outputDir);
        }
      }
;
    }
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
