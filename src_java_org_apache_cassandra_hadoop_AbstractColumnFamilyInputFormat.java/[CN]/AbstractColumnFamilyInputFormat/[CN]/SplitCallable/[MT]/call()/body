{
  ArrayList<InputSplit> splits=new ArrayList<>();
  Map<TokenRange,Long> subSplits;
  subSplits=getSubSplits(keyspace,cfName,tokenRange,conf,session);
  String[] endpoints=new String[hosts.size()];
  int endpointIndex=0;
  for (  Host endpoint : hosts)   endpoints[endpointIndex++]=endpoint.getAddress().getHostName();
  for (  TokenRange subSplit : subSplits.keySet()) {
    List<TokenRange> ranges=subSplit.unwrap();
    for (    TokenRange subrange : ranges) {
      ColumnFamilySplit split=new ColumnFamilySplit(partitioner.preservesOrder() ? subrange.getStart().toString().substring(2) : subrange.getStart().toString(),partitioner.preservesOrder() ? subrange.getEnd().toString().substring(2) : subrange.getStart().toString(),subSplits.get(subSplit),endpoints);
      logger.trace("adding {}",split);
      splits.add(split);
    }
  }
  return splits;
}
