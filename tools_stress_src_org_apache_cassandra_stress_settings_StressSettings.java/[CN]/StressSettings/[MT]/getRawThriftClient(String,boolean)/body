{
  TSocket socket=new TSocket(host,port.thriftPort);
  Cassandra.Client client;
  try {
    TTransport transport=this.transport.getFactory().getTransport(socket);
    transport.open();
    client=new Cassandra.Client(new TBinaryProtocol(transport));
    if (mode.cqlVersion.isCql())     client.set_cql_version(mode.cqlVersion.connectVersion);
    if (setKeyspace)     client.set_keyspace("Keyspace1");
  }
 catch (  InvalidRequestException e) {
    throw new RuntimeException(e.getWhy());
  }
catch (  Exception e) {
    throw new RuntimeException(e.getMessage());
  }
  return client;
}
