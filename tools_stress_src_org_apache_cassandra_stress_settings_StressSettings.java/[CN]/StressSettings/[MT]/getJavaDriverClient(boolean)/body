{
  if (client != null)   return client;
  try {
synchronized (this) {
      String currentNode=node.randomNode();
      if (client != null)       return client;
      EncryptionOptions.ClientEncryptionOptions encOptions=transport.getEncryptionOptions();
      JavaDriverClient c=new JavaDriverClient(this,currentNode,port.nativePort,encOptions);
      c.connect(mode.compression());
      if (setKeyspace)       c.execute("USE \"" + schema.keyspace + "\";",org.apache.cassandra.db.ConsistencyLevel.ONE);
      return client=c;
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
