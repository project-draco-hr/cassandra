{
  String keyspace=in.readUTF();
  String columnFamily=in.readUTF();
  long timestamp=in.readLong();
  AbstractBounds<RowPosition> keyRange=AbstractBounds.serializer.deserialize(in,MessagingService.globalPartitioner(),version).toRowBounds();
  CFMetaData metadata=Schema.instance.getCFMetaData(keyspace,columnFamily);
  SliceQueryFilter predicate=metadata.comparator.sliceQueryFilterSerializer().deserialize(in,version);
  Composite start=metadata.comparator.serializer().deserialize(in);
  Composite stop=metadata.comparator.serializer().deserialize(in);
  int filterCount=in.readInt();
  List<IndexExpression> rowFilter=new ArrayList<IndexExpression>(filterCount);
  for (int i=0; i < filterCount; i++) {
    rowFilter.add(IndexExpression.readFrom(in));
  }
  int limit=in.readInt();
  boolean countCQL3Rows=version >= MessagingService.VERSION_21 ? in.readBoolean() : predicate.compositesToGroup >= 0 || predicate.count != 1;
  return new PagedRangeCommand(keyspace,columnFamily,timestamp,keyRange,predicate,start,stop,rowFilter,limit,countCQL3Rows);
}
