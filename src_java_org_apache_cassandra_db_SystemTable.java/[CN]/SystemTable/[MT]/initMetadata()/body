{
  Table table=Table.open(Table.SYSTEM_TABLE);
  ColumnFamily cf=table.getColumnFamilyStore(LOCATION_CF).getColumnFamily(new NamesQueryFilter(LOCATION_KEY,new QueryPath(LOCATION_KEY),GENERATION));
  IPartitioner p=StorageService.getPartitioner();
  if (cf == null) {
    Token token=p.getDefaultToken();
    int generation=1;
    RowMutation rm=new RowMutation(Table.SYSTEM_TABLE,LOCATION_KEY);
    cf=ColumnFamily.create(Table.SYSTEM_TABLE,SystemTable.LOCATION_CF);
    cf.addColumn(new Column(TOKEN,p.getTokenFactory().toByteArray(token)));
    cf.addColumn(new Column(GENERATION,BasicUtilities.intToByteArray(generation)));
    rm.add(cf);
    rm.apply();
    return new StorageMetadata(token,generation);
  }
  IColumn tokenColumn=cf.getColumn(TOKEN);
  Token token=p.getTokenFactory().fromByteArray(tokenColumn.value());
  IColumn generation=cf.getColumn(GENERATION);
  int gen=BasicUtilities.byteArrayToInt(generation.value()) + 1;
  RowMutation rm=new RowMutation(Table.SYSTEM_TABLE,LOCATION_KEY);
  cf=ColumnFamily.create(Table.SYSTEM_TABLE,SystemTable.LOCATION_CF);
  Column generation2=new Column(GENERATION,BasicUtilities.intToByteArray(gen),generation.timestamp() + 1);
  cf.addColumn(generation2);
  rm.add(cf);
  rm.apply();
  return new StorageMetadata(token,gen);
}
