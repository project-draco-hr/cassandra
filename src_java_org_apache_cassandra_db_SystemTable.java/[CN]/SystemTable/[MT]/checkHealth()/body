{
  Table table=null;
  try {
    table=Table.open(Table.SYSTEM_TABLE);
  }
 catch (  AssertionError err) {
    ConfigurationException ex=new ConfigurationException("Could not read system table!");
    ex.initCause(err);
    throw ex;
  }
  QueryFilter filter=QueryFilter.getNamesFilter(decorate(LOCAL_KEY),new QueryPath(LOCAL_CF),ImmutableSortedSet.<ByteBuffer>of(ByteBufferUtil.bytes("cluster_name")));
  ColumnFamilyStore cfs=table.getColumnFamilyStore(LOCAL_CF);
  ColumnFamily cf=cfs.getColumnFamily(filter);
  if (cf == null) {
    if (!cfs.getSSTables().isEmpty())     throw new ConfigurationException("Found system table files, but they couldn't be loaded!");
    RowMutation rm=new RowMutation(Table.SYSTEM_TABLE,LOCAL_KEY);
    cf=ColumnFamily.create(Table.SYSTEM_TABLE,LOCAL_CF);
    cf.addColumn(Column.create(ByteBufferUtil.bytes(DatabaseDescriptor.getClusterName()),FBUtilities.timestampMicros(),"cluster_name"));
    rm.add(cf);
    rm.apply();
    return;
  }
  IColumn clusterCol=cf.columns.iterator().next();
  String savedClusterName=ByteBufferUtil.string(clusterCol.value());
  if (!DatabaseDescriptor.getClusterName().equals(savedClusterName))   throw new ConfigurationException("Saved cluster name " + savedClusterName + " != configured name "+ DatabaseDescriptor.getClusterName());
}
