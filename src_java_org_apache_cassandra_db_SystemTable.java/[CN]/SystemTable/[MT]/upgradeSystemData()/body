{
  Table table=Table.open(Table.SYSTEM_TABLE);
  ColumnFamilyStore oldStatusCfs=table.getColumnFamilyStore(OLD_STATUS_CF);
  if (oldStatusCfs.getSSTables().size() > 0) {
    SortedSet<ByteBuffer> cols=new TreeSet<ByteBuffer>(BytesType.instance);
    cols.add(ByteBufferUtil.bytes("ClusterName"));
    cols.add(ByteBufferUtil.bytes("Token"));
    QueryFilter filter=QueryFilter.getNamesFilter(decorate(ByteBufferUtil.bytes("L")),new QueryPath(OLD_STATUS_CF),cols);
    ColumnFamily oldCf=oldStatusCfs.getColumnFamily(filter);
    Iterator<IColumn> oldColumns=oldCf.columns.iterator();
    String clusterName=ByteBufferUtil.string(oldColumns.next().value());
    String tokenBytes=ByteBufferUtil.bytesToHex(oldColumns.next().value());
    String req="INSERT INTO system.%s (key, cluster_name, token_bytes, bootstrapped) VALUES ('%s', '%s', '%s', 'true')";
    processInternal(String.format(req,LOCAL_CF,LOCAL_KEY,clusterName,tokenBytes));
    oldStatusCfs.truncate();
  }
  ColumnFamilyStore oldHintsCfs=table.getColumnFamilyStore(OLD_HINTS_CF);
  if (oldHintsCfs.getSSTables().size() > 0) {
    logger.info("Possible old-format hints found. Truncating");
    oldHintsCfs.truncate();
  }
}
