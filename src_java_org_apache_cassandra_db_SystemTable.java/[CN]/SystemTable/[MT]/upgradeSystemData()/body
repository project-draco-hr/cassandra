{
  Table table=Table.open(Table.SYSTEM_TABLE);
  ColumnFamilyStore oldStatusCfs=table.getColumnFamilyStore(OLD_STATUS_CF);
  if (oldStatusCfs.getSSTables().size() > 0) {
    SortedSet<ByteBuffer> cols=new TreeSet<ByteBuffer>(BytesType.instance);
    cols.add(ByteBufferUtil.bytes("ClusterName"));
    cols.add(ByteBufferUtil.bytes("Token"));
    QueryFilter filter=QueryFilter.getNamesFilter(decorate(ByteBufferUtil.bytes("L")),new QueryPath(OLD_STATUS_CF),cols);
    ColumnFamily oldCf=oldStatusCfs.getColumnFamily(filter);
    Iterator<IColumn> oldColumns=oldCf.columns.iterator();
    ColumnFamily cf=ColumnFamily.create(Table.SYSTEM_TABLE,LOCAL_CF);
    cf.addColumn(Column.create(oldColumns.next().value(),FBUtilities.timestampMicros(),"cluster_name"));
    cf.addColumn(Column.create(oldColumns.next().value(),FBUtilities.timestampMicros(),"token_bytes"));
    cf.addColumn(Column.create(true,FBUtilities.timestampMicros(),"bootstrapped"));
    RowMutation rm=new RowMutation(Table.SYSTEM_TABLE,LOCAL_KEY);
    rm.add(cf);
    rm.apply();
    oldStatusCfs.truncate();
  }
  ColumnFamilyStore oldHintsCfs=table.getColumnFamilyStore(OLD_HINTS_CF);
  if (oldHintsCfs.getSSTables().size() > 0) {
    logger.info("Possible old-format hints found. Truncating");
    oldHintsCfs.truncate();
  }
}
