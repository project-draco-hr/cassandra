{
  if (Table.SYSTEM_KS.equals(cfs.table.name))   return null;
  UUID compactionId=UUIDGen.getTimeUUID();
  String req="INSERT INTO system.%s (id, keyspace_name, columnfamily_name, inputs) VALUES (%s, '%s', '%s', {%s})";
  Iterable<Integer> generations=Iterables.transform(toCompact,new Function<SSTableReader,Integer>(){
    public Integer apply(    SSTableReader sstable){
      return sstable.descriptor.generation;
    }
  }
);
  processInternal(String.format(req,COMPACTION_LOG,compactionId,cfs.table.name,cfs.columnFamily,StringUtils.join(Sets.newHashSet(generations),',')));
  forceBlockingFlush(COMPACTION_LOG);
  return compactionId;
}
