{
  List<CounterId.CounterIdRecord> l=new ArrayList<CounterId.CounterIdRecord>();
  Table table=Table.open(Table.SYSTEM_KS);
  QueryFilter filter=QueryFilter.getIdentityFilter(decorate(ALL_LOCAL_NODE_ID_KEY),COUNTER_ID_CF,System.currentTimeMillis());
  ColumnFamily cf=table.getColumnFamilyStore(COUNTER_ID_CF).getColumnFamily(filter);
  CounterId previous=null;
  for (  Column c : cf) {
    if (previous != null)     l.add(new CounterId.CounterIdRecord(previous,c.timestamp()));
    previous=CounterId.wrap(c.name());
  }
  return l;
}
