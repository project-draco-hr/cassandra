{
  Set<Token> tokenSet=new HashSet<Token>(tokens);
  for (  Map.Entry<InetAddress,Collection<Token>> entry : loadTokens().asMap().entrySet()) {
    Set<Token> toRemove=Sets.intersection(tokenSet,((Set<Token>)entry.getValue())).immutableCopy();
    if (toRemove.isEmpty())     continue;
    String req="UPDATE system.%s SET tokens = tokens - %s WHERE peer = '%s'";
    processInternal(String.format(req,PEERS_CF,serializeTokens(toRemove),entry.getKey().getHostAddress()));
  }
  forceBlockingFlush(PEERS_CF);
}
