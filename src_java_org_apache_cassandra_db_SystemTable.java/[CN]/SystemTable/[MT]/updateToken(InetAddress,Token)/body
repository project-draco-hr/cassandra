{
  if (ep.equals(FBUtilities.getBroadcastAddress())) {
    removeToken(token);
    return;
  }
  IPartitioner p=StorageService.getPartitioner();
  ColumnFamily cf=ColumnFamily.create(Table.SYSTEM_TABLE,PEERS_CF);
  cf.addColumn(Column.create(ep,FBUtilities.timestampMicros(),"peer"));
  RowMutation rm=new RowMutation(Table.SYSTEM_TABLE,p.getTokenFactory().toByteArray(token));
  rm.add(cf);
  try {
    rm.apply();
  }
 catch (  IOException e) {
    throw new IOError(e);
  }
  forceBlockingFlush(PEERS_CF);
}
