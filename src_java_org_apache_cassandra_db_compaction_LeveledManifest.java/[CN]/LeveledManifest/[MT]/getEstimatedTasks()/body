{
  long tasks=0;
  for (int i=generations.length - 1; i >= 0; i--) {
    List<SSTableReader> sstables=generations[i];
    long n=Math.max(0L,SSTableReader.getTotalBytes(sstables) - maxBytesForLevel(i)) / (maxSSTableSizeInMB * 1024L * 1024);
    logger.debug("Estimating " + n + " compaction tasks in level "+ i);
    tasks+=n;
  }
  return Ints.checkedCast(tasks);
}
