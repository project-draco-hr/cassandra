{
  long tasks=0;
  long[] estimated=new long[generations.length];
  for (int i=generations.length - 1; i >= 0; i--) {
    List<SSTableReader> sstables=generations[i];
    estimated[i]=Math.max(0L,SSTableReader.getTotalBytes(sstables) - maxBytesForLevel(i)) / maxSSTableSizeInBytes;
    tasks+=estimated[i];
  }
  logger.debug("Estimating {} compactions to do for {}.{}",new Object[]{Arrays.toString(estimated),cfs.table.getName(),cfs.name});
  return Ints.checkedCast(tasks);
}
