{
  long tasks=0;
  long[] estimated=new long[generations.length];
  for (int i=generations.length - 1; i >= 0; i--) {
    List<SSTableReader> sstables=getLevel(i);
    estimated[i]=Math.max(0L,SSTableReader.getTotalBytes(sstables) - maxBytesForLevel(i)) / maxSSTableSizeInBytes;
    tasks+=estimated[i];
  }
  logger.debug("Estimating {} compactions to do for {}.{}",Arrays.toString(estimated),cfs.keyspace.getName(),cfs.name);
  return Ints.checkedCast(tasks);
}
