{
  for (int i=generations.length - 1; i >= 0; i--) {
    List<SSTableReader> sstables=generations[i];
    if (sstables.isEmpty())     continue;
    double score=SSTableReader.getTotalBytes(sstables) / maxBytesForLevel(i);
    logger.debug("Compaction score for level {} is {}",i,score);
    if (score > 1.001 || i == 0) {
      Collection<SSTableReader> candidates=getCandidatesFor(i);
      if (logger.isDebugEnabled())       logger.debug("Compaction candidates for L{} are {}",i,toString(candidates));
      return candidates;
    }
  }
  return Collections.emptyList();
}
