{
  logger.debug("Mutating {} to level {}",descriptor.filenameFor(Component.STATS),level);
  SSTableMetadata metadata=SSTableMetadata.copyWithNewSSTableLevel(oldMetadata.left,level);
  DataOutputStream out=new DataOutputStream(new FileOutputStream(filename + "-tmp"));
  SSTableMetadata.serializer.legacySerialize(metadata,oldMetadata.right,descriptor,out);
  out.flush();
  out.close();
  if (!FBUtilities.isUnix())   FileUtils.delete(filename);
  FileUtils.renameWithConfirm(filename + "-tmp",filename);
}
