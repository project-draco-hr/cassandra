{
  setLocation(location,job);
  CfInfo cfInfo=getCfInfo(loadSignature);
  CfDef cfDef=cfInfo.cfDef;
  ResourceSchema schema=new ResourceSchema();
  Map<MarshallerType,AbstractType> marshallers=getDefaultMarshallers(cfDef);
  Map<ByteBuffer,AbstractType> validators=getValidatorMap(cfDef);
  List<ResourceFieldSchema> allSchemaFields=new ArrayList<ResourceFieldSchema>();
  for (  ColumnDef cdef : cfDef.column_metadata) {
    ResourceFieldSchema valSchema=new ResourceFieldSchema();
    AbstractType validator=validators.get(cdef.name);
    if (validator == null)     validator=marshallers.get(MarshallerType.DEFAULT_VALIDATOR);
    valSchema.setName(new String(cdef.getName()));
    valSchema.setType(getPigType(validator));
    allSchemaFields.add(valSchema);
  }
  schema.setFields(allSchemaFields.toArray(new ResourceFieldSchema[allSchemaFields.size()]));
  return schema;
}
