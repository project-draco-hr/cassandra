{
  if (logger_.isDebugEnabled())   logger_.debug("Received a StreamRequestMessage from " + message.getFrom());
  byte[] body=message.getMessageBody();
  ByteArrayInputStream bufIn=new ByteArrayInputStream(body);
  try {
    StreamRequestMessage streamRequestMessage=StreamRequestMessage.serializer().deserialize(new DataInputStream(bufIn));
    StreamRequestMetadata[] streamRequestMetadata=streamRequestMessage.streamRequestMetadata_;
    for (    StreamRequestMetadata srm : streamRequestMetadata) {
      if (logger_.isDebugEnabled())       logger_.debug(srm.toString());
      Streaming.transferRanges(srm.target_,srm.ranges_,null);
    }
  }
 catch (  IOException ex) {
    throw new IOError(ex);
  }
}
