{
  boolean hasRegular=false;
  int maxClusteringIdx=-1;
  for (  UntypedResultSet.Row columnRow : columnRows) {
switch (columnRow.getString("type")) {
case "clustering_key":
      maxClusteringIdx=Math.max(maxClusteringIdx,columnRow.has("component_index") ? columnRow.getInt("component_index") : 0);
    break;
case "regular":
  hasRegular=true;
break;
}
}
return maxClusteringIdx >= 0 ? maxClusteringIdx == comparator.componentsCount() - 1 : !hasRegular && !isCQL3OnlyPKComparator(comparator);
}
