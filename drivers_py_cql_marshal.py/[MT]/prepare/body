def prepare(query, params):
    (new, count) = re.subn(_param_re, (lambda m: marshal(params[m.group(1)[1:]])), query)
    if (len(params) > count):
        raise cql.ProgrammingError('More keywords were provided than parameters')
    return new.replace('\\:', ':')
