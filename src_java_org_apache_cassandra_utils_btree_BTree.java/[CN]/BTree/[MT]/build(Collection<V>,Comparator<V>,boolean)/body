{
  int size=source.size();
  if (size < FAN_FACTOR) {
    V[] values=source.toArray((V[])new Object[size + (size & 1)]);
    if (!sorted)     Arrays.sort(values,0,size,comparator);
    return values;
  }
  if (!sorted)   source=sorted(source,comparator,size);
  return modifier.get().build(source,size);
}
