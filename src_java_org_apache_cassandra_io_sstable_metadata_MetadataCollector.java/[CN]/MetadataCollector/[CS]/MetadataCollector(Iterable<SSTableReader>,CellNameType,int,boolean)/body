{
  this(columnNameComparator);
  ReplayPosition min=null, max=null;
  for (  SSTableReader sstable : sstables) {
    if (min == null) {
      min=sstable.getSSTableMetadata().commitLogLowerBound;
      max=sstable.getSSTableMetadata().commitLogUpperBound;
    }
 else {
      min=Ordering.natural().min(min,sstable.getSSTableMetadata().commitLogLowerBound);
      max=Ordering.natural().max(max,sstable.getSSTableMetadata().commitLogUpperBound);
    }
  }
  commitLogLowerBound(min);
  commitLogUpperBound(max);
  sstableLevel(level);
  if (!skipAncestors) {
    for (    SSTableReader sstable : sstables) {
      addAncestor(sstable.descriptor.generation);
      for (      Integer i : sstable.getAncestors())       if (new File(sstable.descriptor.withGeneration(i).filenameFor(Component.DATA)).exists())       addAncestor(i);
    }
  }
}
