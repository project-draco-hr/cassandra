{
  FileInputStream tsf=null;
  FileInputStream ksf=null;
  SSLContext ctx=null;
  try {
    tsf=new FileInputStream(truststorePath);
    ksf=new FileInputStream(keystorePath);
    ctx=SSLContext.getInstance("SSL");
    KeyStore ts=KeyStore.getInstance("JKS");
    ts.load(tsf,truststorePassword.toCharArray());
    TrustManagerFactory tmf=TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    tmf.init(ts);
    KeyStore ks=KeyStore.getInstance("JKS");
    ks.load(ksf,keystorePassword.toCharArray());
    KeyManagerFactory kmf=KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
    kmf.init(ks,keystorePassword.toCharArray());
    ctx.init(kmf.getKeyManagers(),tmf.getTrustManagers(),new SecureRandom());
  }
  finally {
    FileUtils.closeQuietly(tsf);
    FileUtils.closeQuietly(ksf);
  }
  return ctx;
}
