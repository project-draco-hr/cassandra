{
  byte[] body=message.getMessageBody();
  ByteArrayInputStream bufIn=new ByteArrayInputStream(body);
  try {
    StreamInManager.StreamStatusMessage streamStatusMessage=StreamInManager.StreamStatusMessage.serializer().deserialize(new DataInputStream(bufIn));
    StreamInManager.StreamStatus streamStatus=streamStatusMessage.getStreamStatus();
switch (streamStatus.getAction()) {
case DELETE:
      StreamOutManager.get(message.getFrom()).finishAndStartNext(streamStatus.getFile());
    break;
case STREAM:
  if (logger.isDebugEnabled())   logger.debug("Need to re-stream file " + streamStatus.getFile());
StreamOutManager.get(message.getFrom()).startNext();
break;
default :
break;
}
}
 catch (IOException ex) {
throw new IOError(ex);
}
}
