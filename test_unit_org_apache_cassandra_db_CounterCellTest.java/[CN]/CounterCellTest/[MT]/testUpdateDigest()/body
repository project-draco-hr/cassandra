{
  Allocator allocator=HeapAllocator.instance;
  MessageDigest digest1=MessageDigest.getInstance("md5");
  MessageDigest digest2=MessageDigest.getInstance("md5");
  CounterContext.ContextState state=CounterContext.ContextState.allocate(4,2,allocator);
  state.writeElement(CounterId.fromInt(1),4L,4L);
  state.writeElement(CounterId.fromInt(2),4L,4L,true);
  state.writeElement(CounterId.fromInt(3),4L,4L);
  state.writeElement(CounterId.fromInt(4),4L,4L,true);
  CounterCell original=new CounterCell(Util.cellname("x"),state.context,1L);
  CounterCell cleared=new CounterCell(Util.cellname("x"),cc.clearAllDelta(state.context),1L);
  original.updateDigest(digest1);
  cleared.updateDigest(digest2);
  Assert.assertTrue(Arrays.equals(digest1.digest(),digest2.digest()));
}
