{
  if (keysWritten == nextSamplePosition) {
    keys.add(getMinimalKey(decoratedKey));
    offheapSize+=decoratedKey.getKey().remaining();
    positions.add(indexStart);
    offheapSize+=TypeSizes.NATIVE.sizeof(indexStart);
    setNextSamplePosition(keysWritten);
  }
 else   if (dataEnd != 0 && keysWritten + 1 == nextSamplePosition) {
    ReadableBoundary boundary=new ReadableBoundary(decoratedKey,indexEnd,dataEnd);
    lastReadableByData.put(dataEnd,boundary);
    lastReadableByIndex.put(indexEnd,boundary);
  }
  keysWritten++;
  return this;
}
