{
  this.jobconf=job;
  String cassConfig;
  try {
    localFiles=DistributedCache.getLocalCacheFiles(job);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  cassConfig=localFiles[0].getParent().toString();
  System.setProperty("storage-config",cassConfig);
  startMessagingService();
  for (  String token : this.tokens) {
    String[] values=token.split(":");
    InetAddress address;
    try {
      address=InetAddress.getByName(values[1]);
    }
 catch (    UnknownHostException e) {
      throw new RuntimeException(e);
    }
    StorageService.instance().updateTokenMetadataUnsafe(new BigIntegerToken(new BigInteger(values[0])),address);
  }
}
