{
  Row row=null;
  boolean foundLocal=false;
  EndPoint[] endpoints=StorageService.instance().getNStorageEndPoint(key);
  for (  EndPoint endPoint : endpoints) {
    if (endPoint.equals(StorageService.getLocalStorageEndPoint())) {
      foundLocal=true;
      break;
    }
  }
  if (!foundLocal && consistencyLevel == StorageService.ConsistencyLevel.WEAK) {
    ReadCommand readCommand=null;
    readCommand=new ReadCommand(tablename,key,columnFamily,sinceTimestamp);
    return doReadProtocol(key,readCommand);
  }
 else {
switch (consistencyLevel) {
case WEAK:
      row=weakReadProtocol(tablename,key,columnFamily,sinceTimestamp);
    break;
case STRONG:
  row=strongReadProtocol(tablename,key,columnFamily,sinceTimestamp);
break;
default :
row=weakReadProtocol(tablename,key,columnFamily,sinceTimestamp);
break;
}
}
return row;
}
