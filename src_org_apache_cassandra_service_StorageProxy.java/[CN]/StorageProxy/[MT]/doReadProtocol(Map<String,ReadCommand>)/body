{
  Map<String,Row> rows=new HashMap<String,Row>();
  Set<String> keys=readMessages.keySet();
  Map<String,EndPoint> endPoints=StorageService.instance().findSuitableEndPoints(keys.toArray(new String[0]));
  Map<String,Message> messages=constructMessages(readMessages);
  IAsyncResult iar=dispatchMessages(endPoints,messages);
  List<Object[]> results=iar.multiget(2 * DatabaseDescriptor.getRpcTimeout(),TimeUnit.MILLISECONDS);
  for (  Object[] result : results) {
    byte[] body=(byte[])result[0];
    DataInputBuffer bufIn=new DataInputBuffer();
    bufIn.reset(body,body.length);
    ReadResponse response=ReadResponse.serializer().deserialize(bufIn);
    Row row=response.row();
    rows.put(row.key(),row);
  }
  return rows;
}
