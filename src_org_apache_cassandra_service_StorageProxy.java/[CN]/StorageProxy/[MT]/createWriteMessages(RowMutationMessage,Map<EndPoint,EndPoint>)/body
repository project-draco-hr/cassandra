{
  Map<EndPoint,Message> messageMap=new HashMap<EndPoint,Message>();
  Message message=RowMutationMessage.makeRowMutationMessage(rmMessage);
  Set<EndPoint> targets=endpointMap.keySet();
  for (  EndPoint target : targets) {
    EndPoint hint=endpointMap.get(target);
    if (!target.equals(hint)) {
      Message hintedMessage=RowMutationMessage.makeRowMutationMessage(rmMessage);
      hintedMessage.addHeader(RowMutationMessage.hint_,EndPoint.toBytes(hint));
      logger_.debug("Sending the hint of " + target.getHost() + " to "+ hint.getHost());
      messageMap.put(target,hintedMessage);
    }
 else {
      messageMap.put(target,message);
    }
  }
  return messageMap;
}
