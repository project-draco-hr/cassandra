{
  Keyspace keyspace=Keyspace.open("Keyspace1");
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard1");
  RowMutation rm;
  DecoratedKey dk=Util.dk("key1");
  rm=new RowMutation("Keyspace1",dk.key);
  rm.add("Standard1",ByteBufferUtil.bytes("Column1"),ByteBufferUtil.bytes("asdf"),0);
  rm.apply();
  store.forceBlockingFlush();
  rm=new RowMutation("Keyspace1",dk.key);
  rm.delete("Standard1",10);
  rm.apply();
  rm=new RowMutation("Keyspace1",Util.dk("key2").key);
  rm.add("Standard1",ByteBufferUtil.bytes("Column1"),ByteBufferUtil.bytes("zxcv"),20);
  rm.apply();
  store.forceBlockingFlush();
  rm=new RowMutation("Keyspace1",dk.key);
  rm.add("Standard1",ByteBufferUtil.bytes("Column1"),ByteBufferUtil.bytes("foobar"),30);
  rm.apply();
  store.forceBlockingFlush();
  QueryFilter filter=QueryFilter.getNamesFilter(dk,"Standard1",ByteBufferUtil.bytes("Column1"),System.currentTimeMillis());
  CollationController controller=new CollationController(store,filter,Integer.MIN_VALUE);
  controller.getTopLevelColumns();
  assertEquals(1,controller.getSstablesIterated());
  filter=QueryFilter.getIdentityFilter(dk,"Standard1",System.currentTimeMillis());
  controller=new CollationController(store,filter,Integer.MIN_VALUE);
  controller.getTopLevelColumns();
  assertEquals(2,controller.getSstablesIterated());
}
