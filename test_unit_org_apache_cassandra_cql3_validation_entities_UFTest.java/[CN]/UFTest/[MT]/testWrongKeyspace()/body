{
  String typeName=createType("CREATE TYPE %s (txt text, i int)");
  String type=KEYSPACE + '.' + typeName;
  assertInvalidMessage(String.format("Statement on keyspace %s cannot refer to a user type in keyspace %s; user types can only be used in the keyspace they are defined in",KEYSPACE_PER_TEST,KEYSPACE),"CREATE FUNCTION " + KEYSPACE_PER_TEST + ".test_wrong_ks( val int ) "+ "CALLED ON NULL INPUT "+ "RETURNS "+ type+ " "+ "LANGUAGE java\n"+ "AS $$return val;$$;");
  assertInvalidMessage(String.format("Statement on keyspace %s cannot refer to a user type in keyspace %s; user types can only be used in the keyspace they are defined in",KEYSPACE_PER_TEST,KEYSPACE),"CREATE FUNCTION " + KEYSPACE_PER_TEST + ".test_wrong_ks( val "+ type+ " ) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java\n"+ "AS $$return val;$$;");
}
