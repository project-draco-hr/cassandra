{
  KSMetaData ksm=Schema.instance.getTableDefinition(cfm.ksName);
  ksm=KSMetaData.cloneWith(ksm,Iterables.concat(ksm.cfMetaData().values(),Collections.singleton(cfm)));
  Schema.instance.load(cfm);
  RowMutation mutation=null;
  if (withSchemaRecord) {
    mutation=cfm.toSchema(timestamp);
    mutation.apply();
  }
  Table.open(cfm.ksName);
  Schema.instance.setTableDefinition(ksm);
  if (!StorageService.instance.isClientMode())   Table.open(ksm.name).initCf(cfm.cfId,cfm.cfName);
  return toCollection(mutation);
}
