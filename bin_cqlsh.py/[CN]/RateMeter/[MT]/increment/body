def increment(self):
    self.current_record += 1
    if ((self.current_record % self.log_rate) == 0):
        new_checkpoint_time = time.time()
        new_rate = (self.log_rate / (new_checkpoint_time - self.last_checkpoint_time))
        self.last_checkpoint_time = new_checkpoint_time
        if (self.current_rate == 0.0):
            self.current_rate = new_rate
        else:
            self.current_rate = ((self.current_rate + new_rate) / 2.0)
        output = ('Processed %s rows; Write: %.2f rows/s\r' % (self.current_record, self.current_rate))
        sys.stdout.write(output)
        sys.stdout.flush()
