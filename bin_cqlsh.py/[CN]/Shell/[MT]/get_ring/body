def get_ring(self):
    if ((self.current_keyspace is None) or (self.current_keyspace == 'system')):
        raise NoKeyspaceError('Ring view requires a current non-system keyspace')
    self.conn.metadata.token_map.rebuild_keyspace(self.current_keyspace, build_if_absent=True)
    return self.conn.metadata.token_map.tokens_to_hosts_by_ks[self.current_keyspace]
