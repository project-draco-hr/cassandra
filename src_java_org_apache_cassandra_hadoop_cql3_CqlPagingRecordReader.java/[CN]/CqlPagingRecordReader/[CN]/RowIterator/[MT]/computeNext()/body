{
  if (rows == null)   return endOfData();
  int index=-2;
  while (!rows.hasNext()) {
    if (index == -1 || emptyPartitionKeyValues()) {
      logger.debug("no more data");
      return endOfData();
    }
    index=setTailNull(clusterColumns);
    logger.debug("set tail to null, index: {}",index);
    executeQuery();
    pageRows=0;
    if (rows == null || !rows.hasNext() && index < 0) {
      logger.debug("no more data");
      return endOfData();
    }
  }
  Map<String,ByteBuffer> valueColumns=createValue();
  Map<String,ByteBuffer> keyColumns=createKey();
  int i=0;
  CqlRow row=rows.next();
  for (  Column column : row.columns) {
    String columnName=stringValue(ByteBuffer.wrap(column.getName()));
    logger.debug("column: {}",columnName);
    if (i < partitionBoundColumns.size() + clusterColumns.size())     keyColumns.put(stringValue(column.name),column.value);
 else     valueColumns.put(stringValue(column.name),column.value);
    i++;
  }
  pageRows++;
  if (newRow(keyColumns,previousRowKey))   totalRead++;
  if (pageRows >= pageRowSize || !rows.hasNext()) {
    Iterator<String> newKeys=keyColumns.keySet().iterator();
    for (    BoundColumn column : partitionBoundColumns)     column.value=keyColumns.get(newKeys.next());
    for (    BoundColumn column : clusterColumns)     column.value=keyColumns.get(newKeys.next());
    executeQuery();
    pageRows=0;
  }
  return Pair.create(keyColumns,valueColumns);
}
