{
  super(Type.FILE);
  this.sstable=sstable;
  this.ref=ref;
  CompressionInfo compressionInfo=null;
  if (sstable.compression) {
    CompressionMetadata meta=sstable.getCompressionMetadata();
    compressionInfo=new CompressionInfo(meta.getChunksForSections(sections),meta.parameters);
  }
  this.header=new FileMessageHeader(sstable.metadata.cfId,sequenceNumber,sstable.descriptor.version.toString(),sstable.descriptor.formatType,estimatedKeys,sections,compressionInfo,repairedAt,keepSSTableLevel ? sstable.getSSTableLevel() : 0);
}
