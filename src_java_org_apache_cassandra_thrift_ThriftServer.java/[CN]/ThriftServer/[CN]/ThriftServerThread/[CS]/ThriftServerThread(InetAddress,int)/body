{
  logger.info(String.format("Binding thrift service to %s:%s",listenAddr,listenPort));
  TServerFactory.Args args=new TServerFactory.Args();
  args.tProtocolFactory=new TBinaryProtocol.Factory(true,true);
  args.addr=new InetSocketAddress(listenAddr,listenPort);
  args.cassandraServer=new CassandraServer();
  args.processor=new Cassandra.Processor(args.cassandraServer);
  args.keepAlive=DatabaseDescriptor.getRpcKeepAlive();
  args.sendBufferSize=DatabaseDescriptor.getRpcSendBufferSize();
  args.recvBufferSize=DatabaseDescriptor.getRpcRecvBufferSize();
  int tFramedTransportSize=DatabaseDescriptor.getThriftFramedTransportSize();
  logger.info("Using TFramedTransport with a max frame size of {} bytes.",tFramedTransportSize);
  args.inTransportFactory=new TFramedTransport.Factory(tFramedTransportSize);
  args.outTransportFactory=new TFramedTransport.Factory(tFramedTransportSize);
  serverEngine=new TServerCustomFactory(DatabaseDescriptor.getRpcServerType()).buildTServer(args);
}
