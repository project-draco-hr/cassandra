{
  UUID sessionId=UUIDSerializer.serializer.deserialize(in,MessagingService.current_version);
  InetAddress target=CompactEndpointSerializationHelper.deserialize(in);
  boolean singleFile=in.readBoolean();
  if (singleFile) {
    PendingFile file=PendingFile.serializer.deserialize(in,version);
    return new StreamRequest(target,file,sessionId);
  }
 else {
    String table=in.readUTF();
    int size=in.readInt();
    List<Range<Token>> ranges=(size == 0) ? null : new ArrayList<Range<Token>>(size);
    for (int i=0; i < size; ++i)     ranges.add((Range<Token>)AbstractBounds.serializer.deserialize(in,version).toTokenBounds());
    OperationType type=OperationType.valueOf(in.readUTF());
    List<ColumnFamilyStore> stores=new ArrayList<ColumnFamilyStore>();
    int cfsSize=in.readInt();
    for (int i=0; i < cfsSize; ++i)     stores.add(Table.open(table).getColumnFamilyStore(ColumnFamily.serializer.deserializeCfId(in,version)));
    return new StreamRequest(target,ranges,table,stores,sessionId,type);
  }
}
