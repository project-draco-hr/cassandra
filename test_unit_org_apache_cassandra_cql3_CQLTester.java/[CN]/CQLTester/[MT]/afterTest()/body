{
  if (currentTable == null)   return;
  final String tableToDrop=currentTable;
  final Set<String> typesToDrop=currentTypes.isEmpty() ? Collections.emptySet() : new HashSet(currentTypes);
  currentTable=null;
  currentTypes.clear();
  StorageService.optionalTasks.execute(new Runnable(){
    public void run(){
      try {
        schemaChange(String.format("DROP TABLE %s.%s",KEYSPACE,tableToDrop));
        for (        String typeName : typesToDrop)         schemaChange(String.format("DROP TYPE %s.%s",KEYSPACE,typeName));
        final CountDownLatch latch=new CountDownLatch(1);
        StorageService.tasks.execute(new Runnable(){
          public void run(){
            latch.countDown();
          }
        }
);
        latch.await(2,TimeUnit.SECONDS);
        removeAllSSTables(KEYSPACE,tableToDrop);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
}
