{
  if (currentTable == null)   throw new RuntimeException("You must create a table first with createTable");
  try {
    query=String.format(query,KEYSPACE + "." + currentTable);
    UntypedResultSet rs;
    if (usePrepared) {
      logger.info("Executing: {} with values {}",query,formatAllValues(values));
      rs=QueryProcessor.executeOnceInternal(query,transformValues(values));
    }
 else {
      query=replaceValues(query,values);
      logger.info("Executing: {}",query);
      rs=QueryProcessor.executeOnceInternal(query);
    }
    if (rs != null)     logger.info("Got {} rows",rs.size());
    return rs;
  }
 catch (  RuntimeException e) {
    Throwable cause=e.getCause() != null ? e.getCause() : e;
    logger.info("Got error: {}",cause.getMessage() == null ? cause.toString() : cause.getMessage());
    throw cause;
  }
}
