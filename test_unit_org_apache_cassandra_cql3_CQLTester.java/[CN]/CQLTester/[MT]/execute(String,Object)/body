{
  query=formatQuery(query);
  UntypedResultSet rs;
  if (usePrepared) {
    logger.info("Executing: {} with values {}",query,formatAllValues(values));
    rs=QueryProcessor.executeOnceInternal(query,transformValues(values));
  }
 else {
    query=replaceValues(query,values);
    logger.info("Executing: {}",query);
    rs=QueryProcessor.executeOnceInternal(query);
  }
  if (rs != null)   logger.info("Got {} rows",rs.size());
  return rs;
}
