{
  logger_.info("Starting in bootstrap mode (first, sleeping to get load information)");
  StorageService ss=StorageService.instance();
  StorageLoadBalancer slb=StorageLoadBalancer.instance();
  slb.waitForLoadInfo();
  if (DatabaseDescriptor.getInitialToken() == null) {
    double maxLoad=0;
    EndPoint maxEndpoint=null;
    for (    Map.Entry<EndPoint,Double> entry : slb.getLoadInfo().entrySet()) {
      if (maxEndpoint == null || entry.getValue() > maxLoad) {
        maxEndpoint=entry.getKey();
        maxLoad=entry.getValue();
      }
    }
    if (maxEndpoint == null) {
      throw new RuntimeException("No bootstrap sources found");
    }
    if (!maxEndpoint.equals(StorageService.getLocalStorageEndPoint())) {
      EndPoint maxStorageEndpoint=new EndPoint(maxEndpoint.getHost(),DatabaseDescriptor.getStoragePort());
      Token<?> t=getBootstrapTokenFrom(maxStorageEndpoint);
      logger_.info("Setting token to " + t + " to assume load from "+ maxEndpoint.getHost());
      ss.updateToken(t);
    }
  }
  BootStrapper bs=new BootStrapper(new EndPoint[]{StorageService.getLocalStorageEndPoint()},ss.getLocalToken());
  bootstrapExecutor_.submit(bs);
  Gossiper.instance().addApplicationState(StorageService.BOOTSTRAP_MODE,new ApplicationState(""));
}
