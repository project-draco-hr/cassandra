{
  if (!in.readBoolean())   return null;
  ColumnFamily cf=factory.create(Schema.instance.getCFMetaData(deserializeCfId(in,version)));
  if (cf.metadata().isSuper() && version < MessagingService.VERSION_20) {
    SuperColumns.deserializerSuperColumnFamily(in,cf,flag,version);
  }
 else {
    cf.delete(cf.getComparator().deletionInfoSerializer().deserialize(in,version));
    ColumnSerializer columnSerializer=cf.getComparator().columnSerializer();
    int size=in.readInt();
    for (int i=0; i < size; ++i)     cf.addColumn(columnSerializer.deserialize(in,flag));
  }
  return cf;
}
