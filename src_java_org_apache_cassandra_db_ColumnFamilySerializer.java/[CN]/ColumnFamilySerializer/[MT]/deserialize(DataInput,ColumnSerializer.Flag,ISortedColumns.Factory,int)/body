{
  if (!dis.readBoolean())   return null;
  ColumnFamily cf=ColumnFamily.create(deserializeCfId(dis,version),factory);
  int expireBefore=(int)(System.currentTimeMillis() / 1000);
  if (cf.metadata().isSuper() && version < MessagingService.VERSION_20) {
    SuperColumns.deserializerSuperColumnFamily(dis,cf,flag,expireBefore,version);
  }
 else {
    cf.delete(DeletionInfo.serializer().deserialize(dis,version,cf.getComparator()));
    ColumnSerializer columnSerializer=Column.serializer;
    int size=dis.readInt();
    for (int i=0; i < size; ++i) {
      cf.addColumn(columnSerializer.deserialize(dis,flag,expireBefore));
    }
  }
  return cf;
}
