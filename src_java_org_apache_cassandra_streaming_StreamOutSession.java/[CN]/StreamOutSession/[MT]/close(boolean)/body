{
  if (!isClosed.compareAndSet(false,true)) {
    logger.debug("StreamOutSession {} to {} already closed",getSessionId(),getHost());
    return;
  }
  Gossiper.instance.unregister(this);
  FailureDetector.instance.unregisterFailureDetectionEventListener(this);
  for (  PendingFile file : files.values())   file.sstable.releaseReference();
  streams.remove(context);
  if (callback != null && success)   callback.run();
}
