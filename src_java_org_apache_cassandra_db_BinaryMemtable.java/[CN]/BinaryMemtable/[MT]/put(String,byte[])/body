{
  if (isThresholdViolated()) {
    lock_.lock();
    try {
      ColumnFamilyStore cfStore=Table.open(table_).getColumnFamilyStore(cfName_);
      if (!isFrozen_) {
        isFrozen_=true;
        BinaryMemtableManager.instance().submit(cfStore.getColumnFamilyName(),this);
        cfStore.switchBinaryMemtable(key,buffer);
      }
 else {
        cfStore.applyBinary(key,buffer);
      }
    }
  finally {
      lock_.unlock();
    }
  }
 else {
    resolve(key,buffer);
  }
}
