{
  long rowSize=0;
  for (  SSTableIdentityIterator row : rows) {
    rowSize+=row.dataSize;
  }
  if (rowSize > DatabaseDescriptor.getInMemoryCompactionLimit()) {
    logger.info(String.format("Compacting large row %s (%d bytes) incrementally",ByteBufferUtil.bytesToHex(rows.get(0).getKey().key),rowSize));
    return new LazilyCompactedRow(controller,rows);
  }
  return new PrecompactedRow(controller,rows);
}
