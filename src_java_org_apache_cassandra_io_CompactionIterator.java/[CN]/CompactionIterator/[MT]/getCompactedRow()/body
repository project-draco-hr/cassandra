{
  long rowSize=0;
  for (  SSTableIdentityIterator row : rows) {
    rowSize+=row.getDataSize();
  }
  if (rowSize > DatabaseDescriptor.getInMemoryCompactionLimit()) {
    logger.info("Compacting large row (" + rowSize + " bytes) incrementally");
    return new LazilyCompactedRow(rows,major,gcBefore);
  }
  return new PrecompactedRow(rows,major,gcBefore);
}
