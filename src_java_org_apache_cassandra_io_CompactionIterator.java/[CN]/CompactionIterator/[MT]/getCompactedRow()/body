{
  long rowSize=0;
  for (  SSTableIdentityIterator row : rows) {
    rowSize+=row.dataSize;
  }
  if (rowSize > DatabaseDescriptor.getInMemoryCompactionLimit()) {
    logger.info(String.format("Compacting large row %s (%d bytes) incrementally",FBUtilities.bytesToHex(rows.get(0).getKey().key),rowSize));
    return new LazilyCompactedRow(cfs,rows,major,gcBefore);
  }
  return new PrecompactedRow(cfs,rows,major,gcBefore);
}
