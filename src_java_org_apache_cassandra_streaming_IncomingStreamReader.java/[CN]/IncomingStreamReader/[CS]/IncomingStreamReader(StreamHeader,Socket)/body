{
  socket.setSoTimeout(DatabaseDescriptor.getStreamingSocketTimeout());
  this.socket=socket;
  InetSocketAddress remoteAddress=(InetSocketAddress)socket.getRemoteSocketAddress();
  session=StreamInSession.get(remoteAddress.getAddress(),header.sessionId);
  session.addFiles(header.pendingFiles);
  session.setCurrentFile(header.file);
  session.setTable(header.table);
  remoteFile=header.file;
  localFile=remoteFile != null ? StreamIn.getContextMapping(remoteFile) : null;
}
