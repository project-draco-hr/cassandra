{
  Map<EndPoint,GossipDigest> epToDigestMap=new HashMap<EndPoint,GossipDigest>();
  for (  GossipDigest gDigest : gDigestList) {
    epToDigestMap.put(gDigest.getEndPoint(),gDigest);
  }
  List<GossipDigest> diffDigests=new ArrayList<GossipDigest>();
  for (  GossipDigest gDigest : gDigestList) {
    EndPoint ep=gDigest.getEndPoint();
    EndPointState epState=Gossiper.instance().getEndPointStateForEndPoint(ep);
    int version=(epState != null) ? Gossiper.instance().getMaxEndPointStateVersion(epState) : 0;
    int diffVersion=Math.abs(version - gDigest.getMaxVersion());
    diffDigests.add(new GossipDigest(ep,gDigest.getGeneration(),diffVersion));
  }
  gDigestList.clear();
  Collections.sort(diffDigests);
  int size=diffDigests.size();
  for (int i=size - 1; i >= 0; --i) {
    gDigestList.add(epToDigestMap.get(diffDigests.get(i).getEndPoint()));
  }
}
