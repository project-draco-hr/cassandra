{
  Map<String,ApplicationState> localAppStateMap=localStatePtr.getApplicationState();
  Map<String,ApplicationState> remoteAppStateMap=remoteStatePtr.getApplicationState();
  Set<String> remoteKeys=remoteAppStateMap.keySet();
  for (  String remoteKey : remoteKeys) {
    ApplicationState remoteAppState=remoteAppStateMap.get(remoteKey);
    ApplicationState localAppState=localAppStateMap.get(remoteKey);
    if (localAppState == null) {
      localStatePtr.addApplicationState(remoteKey,remoteAppState);
      EndPointState deltaState=new EndPointState(localStatePtr.getHeartBeatState());
      deltaState.addApplicationState(remoteKey,remoteAppState);
      doNotifications(addr,deltaState);
      continue;
    }
    int remoteGeneration=remoteStatePtr.getHeartBeatState().getGeneration();
    int localGeneration=localStatePtr.getHeartBeatState().getGeneration();
    if (remoteGeneration > localGeneration) {
      localStatePtr.addApplicationState(remoteKey,remoteAppState);
      EndPointState deltaState=new EndPointState(localStatePtr.getHeartBeatState());
      deltaState.addApplicationState(remoteKey,remoteAppState);
      doNotifications(addr,deltaState);
      continue;
    }
    if (remoteGeneration == localGeneration) {
      int remoteVersion=remoteAppState.getStateVersion();
      int localVersion=localAppState.getStateVersion();
      if (remoteVersion > localVersion) {
        localStatePtr.addApplicationState(remoteKey,remoteAppState);
        EndPointState deltaState=new EndPointState(localStatePtr.getHeartBeatState());
        deltaState.addApplicationState(remoteKey,remoteAppState);
        doNotifications(addr,deltaState);
      }
    }
  }
}
