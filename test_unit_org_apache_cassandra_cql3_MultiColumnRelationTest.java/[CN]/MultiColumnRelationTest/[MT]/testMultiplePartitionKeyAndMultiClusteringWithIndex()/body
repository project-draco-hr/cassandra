{
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, PRIMARY KEY ((a, b), c, d, e))");
  createIndex("CREATE INDEX ON %s (c)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,0,1,0);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,0,1,1);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,1,0,0);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,1,1,0);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,1,1,1);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,2,0,0);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c) = (?) ALLOW FILTERING",0,1),row(0,0,1,0,0),row(0,0,1,1,0),row(0,0,1,1,1));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c, d) = (?, ?) ALLOW FILTERING",0,1,1),row(0,0,1,1,0),row(0,0,1,1,1));
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE a = ? AND (c, d) IN ((?, ?)) ALLOW FILTERING",0,1,1);
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE a = ? AND (c, d) >= (?, ?) ALLOW FILTERING",0,1,1);
}
