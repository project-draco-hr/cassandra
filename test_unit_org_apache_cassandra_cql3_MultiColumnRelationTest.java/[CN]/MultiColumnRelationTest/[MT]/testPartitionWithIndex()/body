{
  execute("INSERT INTO %s.partition_with_indices (a, b, c, d, e, f) VALUES (0, 0, 0, 0, 0, 0)");
  execute("INSERT INTO %s.partition_with_indices (a, b, c, d, e, f) VALUES (0, 0, 0, 1, 0, 1)");
  execute("INSERT INTO %s.partition_with_indices (a, b, c, d, e, f) VALUES (0, 0, 0, 1, 1, 2)");
  execute("INSERT INTO %s.partition_with_indices (a, b, c, d, e, f) VALUES (0, 0, 1, 0, 0, 3)");
  execute("INSERT INTO %s.partition_with_indices (a, b, c, d, e, f) VALUES (0, 0, 1, 1, 0, 4)");
  execute("INSERT INTO %s.partition_with_indices (a, b, c, d, e, f) VALUES (0, 0, 1, 1, 1, 5)");
  execute("INSERT INTO %s.partition_with_indices (a, b, c, d, e, f) VALUES (0, 0, 2, 0, 0, 5)");
  UntypedResultSet results=execute("SELECT * FROM %s.partition_with_indices WHERE a = 0 AND (c) = (1) ALLOW FILTERING");
  assertEquals(3,results.size());
  checkRow(0,results,0,0,1,0,0,3);
  checkRow(1,results,0,0,1,1,0,4);
  checkRow(2,results,0,0,1,1,1,5);
  results=execute("SELECT * FROM %s.partition_with_indices WHERE a = 0 AND (c, d) = (1, 1) ALLOW FILTERING");
  assertEquals(2,results.size());
  checkRow(0,results,0,0,1,1,0,4);
  checkRow(1,results,0,0,1,1,1,5);
  results=execute("SELECT * FROM %s.partition_with_indices WHERE a = 0  AND (c) IN ((1)) AND f = 5 ALLOW FILTERING");
  assertEquals(1,results.size());
  checkRow(0,results,0,0,1,1,1,5);
  results=execute("SELECT * FROM %s.partition_with_indices WHERE a = 0 AND (c) IN ((1), (2)) AND f = 5 ALLOW FILTERING");
  assertEquals(2,results.size());
  checkRow(0,results,0,0,1,1,1,5);
  checkRow(1,results,0,0,2,0,0,5);
  results=execute("SELECT * FROM %s.partition_with_indices WHERE a = 0  AND (c, d) IN ((1, 0)) AND f = 3 ALLOW FILTERING");
  assertEquals(1,results.size());
  checkRow(0,results,0,0,1,0,0,3);
  results=execute("SELECT * FROM %s.partition_with_indices WHERE a = 0 AND (c) >= (1) AND f = 5 ALLOW FILTERING");
  assertEquals(2,results.size());
  checkRow(0,results,0,0,1,1,1,5);
  checkRow(1,results,0,0,2,0,0,5);
  results=execute("SELECT * FROM %s.partition_with_indices WHERE a = 0 AND (c, d) >= (1, 1) AND f = 5 ALLOW FILTERING");
  assertEquals(2,results.size());
  checkRow(0,results,0,0,1,1,1,5);
  checkRow(1,results,0,0,2,0,0,5);
}
