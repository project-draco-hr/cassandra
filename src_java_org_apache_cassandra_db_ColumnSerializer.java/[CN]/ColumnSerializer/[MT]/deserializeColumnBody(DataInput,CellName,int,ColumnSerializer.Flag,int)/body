{
  if ((mask & COUNTER_MASK) != 0) {
    long timestampOfLastDelete=in.readLong();
    long ts=in.readLong();
    ByteBuffer value=ByteBufferUtil.readWithLength(in);
    return CounterCell.create(name,value,ts,timestampOfLastDelete,flag);
  }
 else   if ((mask & EXPIRATION_MASK) != 0) {
    int ttl=in.readInt();
    int expiration=in.readInt();
    long ts=in.readLong();
    ByteBuffer value=ByteBufferUtil.readWithLength(in);
    return ExpiringCell.create(name,value,ts,ttl,expiration,expireBefore,flag);
  }
 else {
    long ts=in.readLong();
    ByteBuffer value=ByteBufferUtil.readWithLength(in);
    return (mask & COUNTER_UPDATE_MASK) != 0 ? new CounterUpdateCell(name,value,ts) : ((mask & DELETION_MASK) == 0 ? new Cell(name,value,ts) : new DeletedCell(name,value,ts));
  }
}
