{
  TTransport trans=transportFactory.openTransport(host,port);
  TProtocol protocol=new TBinaryProtocol(trans);
  Cassandra.Client client=new Cassandra.Client(protocol);
  if (user != null && passwd != null) {
    Map<String,String> credentials=new HashMap<String,String>();
    credentials.put(IAuthenticator.USERNAME_KEY,user);
    credentials.put(IAuthenticator.PASSWORD_KEY,passwd);
    AuthenticationRequest authenticationRequest=new AuthenticationRequest(credentials);
    client.login(authenticationRequest);
  }
  return client;
}
