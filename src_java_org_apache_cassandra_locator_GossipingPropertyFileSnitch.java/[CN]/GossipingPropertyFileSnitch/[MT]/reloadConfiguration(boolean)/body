{
  final SnitchProperties properties=new SnitchProperties();
  String newDc=properties.get("dc",null);
  String newRack=properties.get("rack",null);
  if (newDc == null || newRack == null)   throw new ConfigurationException("DC or rack not found in snitch properties, check your configuration in: " + SnitchProperties.RACKDC_PROPERTY_FILENAME);
  newDc=newDc.trim();
  newRack=newRack.trim();
  final boolean newPreferLocal=Boolean.parseBoolean(properties.get("prefer_local","false"));
  if (!newDc.equals(myDC) || !newRack.equals(myRack) || (preferLocal != newPreferLocal)) {
    myDC=newDc;
    myRack=newRack;
    preferLocal=newPreferLocal;
    reloadGossiperState();
    if (StorageService.instance != null) {
      if (isUpdate)       StorageService.instance.updateTopology(FBUtilities.getBroadcastAddress());
 else       StorageService.instance.getTokenMetadata().invalidateCachedRings();
    }
    if (gossipStarted)     StorageService.instance.gossipSnitchInfo();
  }
}
