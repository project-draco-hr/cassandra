{
  ColumnFamily purged=PrecompactedRow.removeDeletedAndOldShards(key,shouldPurge,controller,container);
  if (purged == null || !purged.iterator().hasNext()) {
    container.clear();
    return null;
  }
  IColumn reduced=purged.iterator().next();
  container.clear();
  serializedSize+=reduced.serializedSize(TypeSizes.NATIVE);
  columns++;
  maxTimestampSeen=Math.max(maxTimestampSeen,reduced.maxTimestamp());
  int deletionTime=reduced.getLocalDeletionTime();
  if (deletionTime < Integer.MAX_VALUE) {
    tombstones.update(deletionTime);
  }
  return reduced;
}
