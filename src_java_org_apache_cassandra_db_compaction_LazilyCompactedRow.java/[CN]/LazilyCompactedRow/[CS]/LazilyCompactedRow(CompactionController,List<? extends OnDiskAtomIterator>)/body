{
  super(rows.get(0).getKey());
  this.rows=rows;
  this.controller=controller;
  indexer=controller.cfs.indexManager.updaterFor(key);
  maxRowTombstone=DeletionTime.LIVE;
  for (  OnDiskAtomIterator row : rows) {
    DeletionTime rowTombstone=row.getColumnFamily().deletionInfo().getTopLevelDeletion();
    if (maxRowTombstone.compareTo(rowTombstone) < 0)     maxRowTombstone=rowTombstone;
  }
  this.shouldPurge=controller.shouldPurge(key,Long.MAX_VALUE);
  emptyColumnFamily=EmptyColumns.factory.create(controller.cfs.metadata);
  emptyColumnFamily.delete(maxRowTombstone);
  if (shouldPurge)   emptyColumnFamily.purgeTombstones(controller.gcBefore);
}
