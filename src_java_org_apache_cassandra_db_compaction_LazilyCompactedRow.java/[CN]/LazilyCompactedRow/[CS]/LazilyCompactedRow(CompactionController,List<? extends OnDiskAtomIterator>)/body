{
  super(rows.get(0).getKey());
  this.rows=rows;
  this.controller=controller;
  indexer=controller.cfs.indexManager.gcUpdaterFor(key);
  maxRowTombstone=DeletionTime.LIVE;
  for (  OnDiskAtomIterator row : rows) {
    DeletionTime rowTombstone=row.getColumnFamily().deletionInfo().getTopLevelDeletion();
    if (maxRowTombstone.compareTo(rowTombstone) < 0)     maxRowTombstone=rowTombstone;
  }
  maxPurgeableTimestamp=controller.maxPurgeableTimestamp(key);
  emptyColumnFamily=EmptyColumns.factory.create(controller.cfs.metadata);
  emptyColumnFamily.delete(maxRowTombstone);
  if (maxRowTombstone.markedForDeleteAt < maxPurgeableTimestamp)   emptyColumnFamily.purgeTombstones(controller.gcBefore);
  reducer=new Reducer();
  merger=Iterators.filter(MergeIterator.get(rows,emptyColumnFamily.getComparator().onDiskAtomComparator(),reducer),Predicates.notNull());
}
