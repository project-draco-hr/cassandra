{
  super(rows.get(0).getKey());
  this.rows=rows;
  this.controller=controller;
  indexer=controller.cfs.indexManager.updaterFor(key);
  maxDelTimestamp=Long.MIN_VALUE;
  for (  OnDiskAtomIterator row : rows) {
    ColumnFamily cf=row.getColumnFamily();
    maxDelTimestamp=Math.max(maxDelTimestamp,cf.deletionInfo().maxTimestamp());
    if (emptyColumnFamily == null)     emptyColumnFamily=cf;
 else     emptyColumnFamily.delete(cf);
  }
  this.shouldPurge=controller.shouldPurge(key,maxDelTimestamp);
}
