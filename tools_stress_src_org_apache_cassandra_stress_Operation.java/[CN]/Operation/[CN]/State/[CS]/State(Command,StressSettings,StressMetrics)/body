{
  this.type=type;
  this.timer=metrics.getTiming().newTimer();
  if (type == Command.MIXED) {
    commandSelector=((SettingsCommandMixed)settings.command).selector();
    substates=new EnumMap<>(Command.class);
  }
 else {
    commandSelector=null;
    substates=null;
  }
  this.settings=settings;
  this.keyGen=settings.keys.newKeyGen();
  this.rowGen=settings.columns.newRowGen();
  this.metrics=metrics;
  if (!settings.columns.useSuperColumns)   columnParents=Collections.singletonList(new ColumnParent(settings.schema.columnFamily));
 else {
    ColumnParent[] cp=new ColumnParent[settings.columns.superColumns];
    for (int i=0; i < cp.length; i++)     cp[i]=new ColumnParent("Super1").setSuper_column(ByteBufferUtil.bytes("S" + i));
    columnParents=Arrays.asList(cp);
  }
}
