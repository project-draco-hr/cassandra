{
  this.type=type;
  this.timer=metrics.getTiming().newTimer();
  if (type == Command.MIXED) {
    commandSelector=((SettingsCommandMixed)settings.command).selector();
    substates=new EnumMap<>(Command.class);
  }
 else {
    commandSelector=null;
    substates=null;
  }
  counteradd=settings.command.add.get();
  this.settings=settings;
  this.keyGen=settings.keys.newKeyGen();
  this.rowGen=settings.columns.newRowGen();
  this.metrics=metrics;
  this.columnParents=columnParents(type,settings);
}
