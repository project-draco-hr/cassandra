{
  while (next == null && super.hasNext()) {
    UnfilteredRowIterator iterator=super.next();
    if (shouldFilter(iterator)) {
      next=new FilteringIterator(iterator);
      if (!isForThrift() && next.isEmpty()) {
        onEmpty(iterator.partitionKey());
        iterator.close();
        next=null;
      }
    }
 else {
      next=iterator;
    }
  }
  return next != null;
}
