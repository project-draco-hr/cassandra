{
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  SSTableReader sstable=sstable(cfs,0,128);
  File dataFolder=sstable.descriptor.directory;
  TransactionLog transactionLogs=new TransactionLog(OperationType.COMPACTION,cfs.metadata);
  assertNotNull(transactionLogs);
  TransactionLog.SSTableTidier tidier=transactionLogs.obsoleted(sstable);
  transactionLogs.finish();
  sstable.markObsolete(tidier);
  sstable.selfRef().release();
  for (int i=0; i < 1000; i++) {
    TransactionLog.getTemporaryFiles(cfs.metadata,dataFolder);
  }
}
