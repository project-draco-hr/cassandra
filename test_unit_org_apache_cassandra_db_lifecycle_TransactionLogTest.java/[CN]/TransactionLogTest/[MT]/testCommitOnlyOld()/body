{
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  SSTableReader sstable=sstable(cfs,0,128);
  TransactionLog transactionLog=new TransactionLog(OperationType.COMPACTION,cfs.metadata);
  assertNotNull(transactionLog);
  TransactionLog.SSTableTidier tidier=transactionLog.obsoleted(sstable);
  assertNotNull(tidier);
  transactionLog.finish();
  sstable.markObsolete(tidier);
  sstable.selfRef().release();
  assertFiles(transactionLog.getDataFolder(),new HashSet<>());
}
