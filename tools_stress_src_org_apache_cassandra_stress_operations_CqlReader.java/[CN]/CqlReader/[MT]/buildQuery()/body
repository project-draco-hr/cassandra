{
  StringBuilder query=new StringBuilder("SELECT ");
  if (state.settings.columns.slice) {
    if (state.isCql2())     query.append("FIRST ").append(state.settings.columns.maxColumnsPerKey).append(" ''..''");
 else     query.append("*");
  }
 else {
    try {
      for (int i=0; i < state.settings.columns.names.size(); i++) {
        if (i > 0)         query.append(",");
        query.append(wrapInQuotesIfRequired(ByteBufferUtil.string(state.settings.columns.names.get(i))));
      }
    }
 catch (    CharacterCodingException e) {
      throw new IllegalStateException(e);
    }
  }
  query.append(" FROM ").append(wrapInQuotesIfRequired(state.type.table));
  if (state.isCql2())   query.append(" USING CONSISTENCY ").append(state.settings.command.consistencyLevel);
  query.append(" WHERE KEY=?");
  return query.toString();
}
