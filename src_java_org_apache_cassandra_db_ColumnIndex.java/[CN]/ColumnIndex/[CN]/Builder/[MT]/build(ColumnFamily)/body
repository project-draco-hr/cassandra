{
  Iterator<RangeTombstone> rangeIter=cf.deletionInfo().rangeIterator();
  RangeTombstone tombstone=rangeIter.hasNext() ? rangeIter.next() : null;
  Comparator<ByteBuffer> comparator=cf.getComparator();
  for (  Column c : cf) {
    while (tombstone != null && comparator.compare(c.name(),tombstone.min) >= 0) {
      add(tombstone);
      tombstone=rangeIter.hasNext() ? rangeIter.next() : null;
    }
    add(c);
  }
  while (tombstone != null) {
    add(tombstone);
    tombstone=rangeIter.hasNext() ? rangeIter.next() : null;
  }
  ColumnIndex index=build();
  maybeWriteEmptyRowHeader();
  return index;
}
