{
  long pos=currentPosition();
  if (firstClustering == null) {
    firstClustering=unfiltered.clustering();
    startPosition=pos;
  }
  UnfilteredSerializer.serializer.serialize(unfiltered,header,writer,pos - previousRowStart,version);
  lastClustering=unfiltered.clustering();
  previousRowStart=pos;
  ++written;
  if (unfiltered.kind() == Unfiltered.Kind.RANGE_TOMBSTONE_MARKER) {
    RangeTombstoneMarker marker=(RangeTombstoneMarker)unfiltered;
    openMarker=marker.isOpen(false) ? marker.openDeletionTime(false) : null;
  }
  if (currentPosition() - startPosition >= DatabaseDescriptor.getColumnIndexSize())   addIndexBlock();
}
