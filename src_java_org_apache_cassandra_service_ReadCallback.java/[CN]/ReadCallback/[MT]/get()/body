{
  if (!await(command.getTimeout(),TimeUnit.MILLISECONDS)) {
    int acks=received.get();
    if (resolver.isDataPresent() && acks >= blockfor)     acks=blockfor - 1;
    ReadTimeoutException ex=new ReadTimeoutException(consistencyLevel,received.get(),blockfor,resolver.isDataPresent());
    if (logger.isDebugEnabled())     logger.debug("Read timeout: {}",ex.toString());
    throw ex;
  }
  return blockfor == 1 ? resolver.getData() : resolver.resolve();
}
