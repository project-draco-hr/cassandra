{
  if (!await(command.getTimeout(),TimeUnit.MILLISECONDS)) {
    ReadTimeoutException ex=new ReadTimeoutException(consistencyLevel,received.get(),blockfor,resolver.isDataPresent());
    Tracing.trace("Read timeout: {}",ex.toString());
    if (logger.isDebugEnabled())     logger.debug("Read timeout: {}",ex.toString());
    throw ex;
  }
  return blockfor == 1 ? resolver.getData() : resolver.resolve();
}
