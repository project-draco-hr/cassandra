{
  this.command=command;
  this.blockfor=determineBlockFor(consistencyLevel,command.getKeyspace());
  this.resolver=resolver;
  this.startTime=System.currentTimeMillis();
  boolean repair=randomlyReadRepair();
  sortForConsistencyLevel(endpoints);
  this.endpoints=repair || resolver instanceof RowRepairResolver ? endpoints : endpoints.subList(0,Math.min(endpoints.size(),blockfor));
  if (logger.isDebugEnabled())   logger.debug(String.format("Blockfor/repair is %s/%s; setting up requests to %s",blockfor,repair,StringUtils.join(this.endpoints,",")));
}
