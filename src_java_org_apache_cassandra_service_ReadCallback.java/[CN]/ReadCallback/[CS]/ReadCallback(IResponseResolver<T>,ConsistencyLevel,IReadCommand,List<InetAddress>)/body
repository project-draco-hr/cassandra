{
  this.command=command;
  this.blockfor=determineBlockFor(consistencyLevel,command.getKeyspace());
  this.resolver=resolver;
  this.startTime=System.currentTimeMillis();
  boolean repair=randomlyReadRepair();
  this.endpoints=repair || resolver instanceof RowRepairResolver ? endpoints : preferredEndpoints(endpoints);
  if (logger.isDebugEnabled())   logger.debug(String.format("Blockfor/repair is %s/%s; setting up requests to %s",blockfor,repair,StringUtils.join(this.endpoints,",")));
}
