{
  this.command=command;
  this.blockfor=determineBlockFor(consistencyLevel,command.getKeyspace());
  this.resolver=resolver;
  this.startTime=System.currentTimeMillis();
  sortForConsistencyLevel(endpoints);
  this.endpoints=resolver instanceof RowRepairResolver ? endpoints : filterEndpoints(endpoints);
  if (logger.isDebugEnabled())   logger.debug(String.format("Blockfor is %s; setting up requests to %s",blockfor,StringUtils.join(this.endpoints,",")));
}
