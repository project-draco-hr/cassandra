{
  Keyspace systemKeyspace=Keyspace.open("system");
  ColumnFamilyStore hintStore=systemKeyspace.getColumnFamilyStore(SystemKeyspace.HINTS_CF);
  hintStore.clearUnsafe();
  hintStore.metadata.gcGraceSeconds(36000);
  hintStore.setCompactionStrategyClass(SizeTieredCompactionStrategy.class.getCanonicalName());
  hintStore.disableAutoCompaction();
  RowMutation rm=new RowMutation(KEYSPACE4,ByteBufferUtil.bytes(1));
  rm.add(STANDARD1_CF,ByteBufferUtil.bytes(String.valueOf(COLUMN1)),ByteBufferUtil.EMPTY_BYTE_BUFFER,System.currentTimeMillis());
  HintedHandOffManager.instance.hintFor(rm,System.currentTimeMillis(),HintedHandOffManager.calculateHintTTL(rm),UUID.randomUUID()).apply();
  hintStore.forceBlockingFlush();
  assertEquals(1,hintStore.getSSTables().size());
  FBUtilities.waitOnFuture(HintedHandOffManager.instance.compact());
  while (CompactionManager.instance.getPendingTasks() > 0 || CompactionManager.instance.getActiveCompactions() > 0)   TimeUnit.SECONDS.sleep(1);
  assertEquals(1,hintStore.getSSTables().size());
}
