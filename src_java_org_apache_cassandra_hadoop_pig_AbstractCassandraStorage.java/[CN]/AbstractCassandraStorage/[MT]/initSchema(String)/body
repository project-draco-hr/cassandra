{
  Properties properties=UDFContext.getUDFContext().getUDFProperties(AbstractCassandraStorage.class);
  if (!properties.containsKey(signature)) {
    try {
      Cassandra.Client client=ConfigHelper.getClientFromInputAddressList(conf);
      client.set_keyspace(keyspace);
      if (username != null && password != null) {
        Map<String,String> credentials=new HashMap<String,String>(2);
        credentials.put(IAuthenticator.USERNAME_KEY,username);
        credentials.put(IAuthenticator.PASSWORD_KEY,password);
        try {
          client.login(new AuthenticationRequest(credentials));
        }
 catch (        AuthenticationException e) {
          logger.error("Authentication exception: invalid username and/or password");
          throw new IOException(e);
        }
catch (        AuthorizationException e) {
          throw new AssertionError(e);
        }
      }
      CfDef cfDef=getCfDef(client);
      if (cfDef != null)       properties.setProperty(signature,cfdefToString(cfDef));
 else       throw new IOException(String.format("Column family '%s' not found in keyspace '%s'",column_family,keyspace));
    }
 catch (    Exception e) {
      throw new IOException(e);
    }
  }
}
