@completer_for('username', 'name')
def username_name_completer(ctxt, cass):

    def maybe_quote(name):
        if CqlRuleSet.is_valid_cql3_name(name):
            return name
        return ("'%s'" % name)
    if (ctxt.matched[0][0] == 'K_CREATE'):
        return [Hint('<username>')]
    cursor = cass.conn.cursor()
    cursor.execute('LIST USERS')
    return [maybe_quote(row[0].replace("'", "''")) for row in cursor.fetchall()]
