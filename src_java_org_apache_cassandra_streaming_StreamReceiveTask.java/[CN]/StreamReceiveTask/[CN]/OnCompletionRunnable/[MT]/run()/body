{
  Pair<String,String> kscf=Schema.instance.getCF(task.cfId);
  if (kscf == null) {
    for (    SSTableWriter writer : task.sstables)     writer.abort();
    task.sstables.clear();
    task.txn.abort();
    return;
  }
  ColumnFamilyStore cfs=Keyspace.open(kscf.left).getColumnFamilyStore(kscf.right);
  List<SSTableReader> readers=new ArrayList<>();
  for (  SSTableWriter writer : task.sstables)   readers.add(writer.finish(true));
  task.txn.finish();
  task.sstables.clear();
  try (Refs<SSTableReader> refs=Refs.ref(readers)){
    cfs.addSSTables(readers);
    cfs.indexManager.maybeBuildSecondaryIndexes(readers,cfs.indexManager.allIndexesNames());
  }
   task.session.taskCompleted(task);
}
