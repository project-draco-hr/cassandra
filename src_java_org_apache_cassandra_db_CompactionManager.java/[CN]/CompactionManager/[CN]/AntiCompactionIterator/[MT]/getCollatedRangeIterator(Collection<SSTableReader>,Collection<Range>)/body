{
  org.apache.commons.collections.Predicate rangesPredicate=new org.apache.commons.collections.Predicate(){
    public boolean evaluate(    Object row){
      return Range.isTokenInRanges(((SSTableIdentityIterator)row).getKey().token,ranges);
    }
  }
;
  CollatingIterator iter=FBUtilities.getCollatingIterator();
  for (  SSTableReader sstable : sstables) {
    SSTableScanner scanner=sstable.getScanner(FILE_BUFFER_SIZE);
    iter.addIterator(new FilterIterator(scanner,rangesPredicate));
  }
  return iter;
}
