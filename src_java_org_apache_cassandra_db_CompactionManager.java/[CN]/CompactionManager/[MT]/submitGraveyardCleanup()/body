{
  Callable c=new Callable(){
    public Object call() throws Exception {
      logger.debug("Cleaning up abandoned column families...");
      ColumnFamily dropped=SystemTable.getDroppedCFs();
      Collection<IColumn> successes=new ArrayList<IColumn>();
      for (      IColumn col : dropped.getSortedColumns()) {
        if (!col.isMarkedForDelete()) {
          final String[] parts=new String(col.name()).split("-");
          for (          String dataDir : DatabaseDescriptor.getAllDataFileLocationsForTable(parts[0])) {
            File dir=new File(dataDir);
            if (dir.exists()) {
              File[] dbFiles=dir.listFiles(new FileFilter(){
                public boolean accept(                File pathname){
                  return pathname.getName().startsWith(parts[1] + "-") && pathname.exists();
                }
              }
);
              for (              File f : dbFiles) {
                FileUtils.deleteWithConfirm(f);
              }
            }
          }
          successes.add(col);
        }
      }
      SystemTable.deleteDroppedCfMarkers(successes);
      return null;
    }
  }
;
  return executor.submit(c);
}
