{
  Collection<SSTableReader> sstables=cfs.getSSTables();
  CompactionIterator ci=new CompactionIterator(sstables,(int)(System.currentTimeMillis() / 1000) - cfs.metadata.gcGraceSeconds,true);
  executor.beginCompaction(cfs,ci);
  try {
    Iterator<AbstractCompactedRow> nni=new FilterIterator(ci,PredicateUtils.notNullPredicate());
    validator.prepare(cfs);
    while (nni.hasNext()) {
      AbstractCompactedRow row=nni.next();
      validator.add(row);
    }
    validator.complete();
  }
  finally {
    ci.close();
  }
}
