{
  for (  final ColumnFamilyStore cfs : ColumnFamilyStore.all()) {
    Runnable runnable=new Runnable(){
      public void run(){
        logger.debug("Estimating compactions for " + cfs.columnFamily_);
        final Set<List<SSTableReader>> buckets=getBuckets(convertSSTablesToPairs(cfs.getSSTables()),50L * 1024L * 1024L);
        updateEstimateFor(cfs,buckets);
      }
    }
;
    executor.submit(runnable);
  }
  for (  ColumnFamilyStore cfs : ColumnFamilyStore.all()) {
    submitMinorIfNeeded(cfs);
  }
}
