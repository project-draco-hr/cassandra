{
  Runnable runnable=new Runnable(){
    public void run(){
      compactionLock.lock();
      try {
        if (cfs.isInvalid())         return;
        executor.beginCompaction(cfs.columnFamily,builder);
        builder.build();
      }
  finally {
        compactionLock.unlock();
      }
    }
  }
;
  if (compactionLock.isHeldByCurrentThread())   return new SimpleFuture(runnable);
 else   return executor.submit(runnable);
}
