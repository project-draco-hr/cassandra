{
  logger.debug("get_slice_by_name_range");
  String[] values=ThriftValidation.validateColumnParent(tablename,columnParent);
  ColumnFamily cfamily=readColumnFamily(new SliceByRangeReadCommand(tablename,key,columnParent,start,finish,count));
  if (cfamily == null) {
    return EMPTY_COLUMNS;
  }
  if (DatabaseDescriptor.getColumnFamilyType(tablename,values[0]).equals("Standard")) {
    return thriftifyColumns(cfamily.getAllColumns());
  }
 else {
    IColumn superColumn=cfamily.getColumn(values[1]);
    if (superColumn == null) {
      return EMPTY_COLUMNS;
    }
    return thriftifyColumns(superColumn.getSubColumns());
  }
}
