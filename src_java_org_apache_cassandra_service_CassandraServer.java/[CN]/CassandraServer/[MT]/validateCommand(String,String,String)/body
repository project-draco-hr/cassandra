{
  if (key.isEmpty()) {
    throw new InvalidRequestException("Key may not be empty");
  }
  if (!DatabaseDescriptor.getTables().contains(tablename)) {
    throw new TableNotDefinedException("Table " + tablename + " does not exist in this schema.");
  }
  Table table=Table.open(tablename);
  for (  String cfName : columnFamilyNames) {
    if (!table.getColumnFamilies().contains(cfName)) {
      throw new ColumnFamilyNotDefinedException("Column Family " + cfName + " is invalid.");
    }
  }
}
