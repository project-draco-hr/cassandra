{
  String cfName=commands.get(0).getColumnFamilyName();
  Map<String,ColumnFamily> columnFamilyKeyMap=new HashMap<String,ColumnFamily>();
  if (consistency_level == ConsistencyLevel.ZERO) {
    throw new InvalidRequestException("Consistency level zero may not be applied to read operations");
  }
  if (consistency_level == ConsistencyLevel.ALL) {
    throw new InvalidRequestException("Consistency level all is not yet supported on read operations");
  }
  List<Row> rows;
  try {
    rows=StorageProxy.readProtocol(commands,consistency_level);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  TimeoutException e) {
    throw new RuntimeException(e);
  }
  for (  Row row : rows) {
    columnFamilyKeyMap.put(row.key(),row.getColumnFamily(cfName));
  }
  return columnFamilyKeyMap;
}
