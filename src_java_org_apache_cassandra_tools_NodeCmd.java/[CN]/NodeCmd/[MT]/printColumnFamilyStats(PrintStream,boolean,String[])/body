{
  OptionFilter filter=new OptionFilter(ignoreMode,filterList);
  Map<String,List<ColumnFamilyStoreMBean>> cfstoreMap=new HashMap<String,List<ColumnFamilyStoreMBean>>();
  Iterator<Map.Entry<String,ColumnFamilyStoreMBean>> cfamilies=probe.getColumnFamilyStoreMBeanProxies();
  while (cfamilies.hasNext()) {
    Entry<String,ColumnFamilyStoreMBean> entry=cfamilies.next();
    String tableName=entry.getKey();
    ColumnFamilyStoreMBean cfsProxy=entry.getValue();
    if (!cfstoreMap.containsKey(tableName) && filter.isColumnFamilyIncluded(entry.getKey(),cfsProxy.getColumnFamilyName())) {
      List<ColumnFamilyStoreMBean> columnFamilies=new ArrayList<ColumnFamilyStoreMBean>();
      columnFamilies.add(cfsProxy);
      cfstoreMap.put(tableName,columnFamilies);
    }
 else     if (filter.isColumnFamilyIncluded(entry.getKey(),cfsProxy.getColumnFamilyName())) {
      cfstoreMap.get(tableName).add(cfsProxy);
    }
  }
  filter.verifyKeyspaces(probe.getKeyspaces());
  filter.verifyColumnFamilies();
  for (  Entry<String,List<ColumnFamilyStoreMBean>> entry : cfstoreMap.entrySet()) {
    String tableName=entry.getKey();
    List<ColumnFamilyStoreMBean> columnFamilies=entry.getValue();
    long tableReadCount=0;
    long tableWriteCount=0;
    int tablePendingTasks=0;
    double tableTotalReadTime=0.0f;
    double tableTotalWriteTime=0.0f;
    outs.println("Keyspace: " + tableName);
    for (    ColumnFamilyStoreMBean cfstore : columnFamilies) {
      long writeCount=cfstore.getWriteCount();
      long readCount=cfstore.getReadCount();
      if (readCount > 0) {
        tableReadCount+=readCount;
        tableTotalReadTime+=cfstore.getTotalReadLatencyMicros();
      }
      if (writeCount > 0) {
        tableWriteCount+=writeCount;
        tableTotalWriteTime+=cfstore.getTotalWriteLatencyMicros();
      }
      tablePendingTasks+=cfstore.getPendingTasks();
    }
    double tableReadLatency=tableReadCount > 0 ? tableTotalReadTime / tableReadCount / 1000 : Double.NaN;
    double tableWriteLatency=tableWriteCount > 0 ? tableTotalWriteTime / tableWriteCount / 1000 : Double.NaN;
    outs.println("\tRead Count: " + tableReadCount);
    outs.println("\tRead Latency: " + String.format("%s",tableReadLatency) + " ms.");
    outs.println("\tWrite Count: " + tableWriteCount);
    outs.println("\tWrite Latency: " + String.format("%s",tableWriteLatency) + " ms.");
    outs.println("\tPending Tasks: " + tablePendingTasks);
    for (    ColumnFamilyStoreMBean cfstore : columnFamilies) {
      String cfName=cfstore.getColumnFamilyName();
      if (cfName.contains("."))       outs.println("\t\tColumn Family (index): " + cfName);
 else       outs.println("\t\tColumn Family: " + cfName);
      outs.println("\t\tSSTable count: " + cfstore.getLiveSSTableCount());
      int[] leveledSStables=cfstore.getSSTableCountPerLevel();
      if (leveledSStables != null) {
        outs.print("\t\tSSTables in each level: [");
        for (int level=0; level < leveledSStables.length; level++) {
          int count=leveledSStables[level];
          outs.print(count);
          long maxCount=4L;
          if (level > 0)           maxCount=(long)Math.pow(10,level);
          if (count > maxCount)           outs.print("/" + maxCount);
          if (level < leveledSStables.length - 1)           outs.print(", ");
 else           outs.println("]");
        }
      }
      outs.println("\t\tSpace used (live): " + cfstore.getLiveDiskSpaceUsed());
      outs.println("\t\tSpace used (total): " + cfstore.getTotalDiskSpaceUsed());
      outs.println("\t\tSSTable Compression Ratio: " + cfstore.getCompressionRatio());
      outs.println("\t\tNumber of Keys (estimate): " + cfstore.estimateKeys());
      outs.println("\t\tMemtable Columns Count: " + cfstore.getMemtableColumnsCount());
      outs.println("\t\tMemtable Data Size: " + cfstore.getMemtableDataSize());
      outs.println("\t\tMemtable Switch Count: " + cfstore.getMemtableSwitchCount());
      outs.println("\t\tRead Count: " + cfstore.getReadCount());
      outs.println("\t\tRead Latency: " + String.format("%01.3f",cfstore.getRecentReadLatencyMicros() / 1000) + " ms.");
      outs.println("\t\tWrite Count: " + cfstore.getWriteCount());
      outs.println("\t\tWrite Latency: " + String.format("%01.3f",cfstore.getRecentWriteLatencyMicros() / 1000) + " ms.");
      outs.println("\t\tPending Tasks: " + cfstore.getPendingTasks());
      outs.println("\t\tBloom Filter False Positives: " + cfstore.getBloomFilterFalsePositives());
      outs.println("\t\tBloom Filter False Ratio: " + String.format("%01.5f",cfstore.getRecentBloomFilterFalseRatio()));
      outs.println("\t\tBloom Filter Space Used: " + cfstore.getBloomFilterDiskSpaceUsed());
      outs.println("\t\tCompacted row minimum size: " + cfstore.getMinRowSize());
      outs.println("\t\tCompacted row maximum size: " + cfstore.getMaxRowSize());
      outs.println("\t\tCompacted row mean size: " + cfstore.getMeanRowSize());
      outs.println("\t\tAverage live cells per slice (last five minutes): " + cfstore.getLiveCellsPerSlice());
      outs.println("\t\tAverage tombstones per slice (last five minutes): " + cfstore.getTombstonesPerSlice());
      outs.println("");
    }
    outs.println("----------------");
  }
}
