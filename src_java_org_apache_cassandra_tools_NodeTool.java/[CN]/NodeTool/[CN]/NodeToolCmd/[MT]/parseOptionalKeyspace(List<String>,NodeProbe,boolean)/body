{
  List<String> keyspaces=new ArrayList<>();
  if (cmdArgs == null || cmdArgs.isEmpty())   keyspaces.addAll(includeSystemKS ? nodeProbe.getKeyspaces() : nodeProbe.getNonSystemKeyspaces());
 else   keyspaces.add(cmdArgs.get(0));
  for (  String keyspace : keyspaces) {
    if (!nodeProbe.getKeyspaces().contains(keyspace))     throw new IllegalArgumentException("Keyspace [" + keyspace + "] does not exist.");
  }
  return Collections.unmodifiableList(keyspaces);
}
