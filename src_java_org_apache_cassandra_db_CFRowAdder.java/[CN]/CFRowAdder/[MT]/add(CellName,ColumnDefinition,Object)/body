{
  if (value == null) {
    cf.addColumn(new BufferDeletedCell(name,ldt,timestamp));
  }
 else {
    AbstractType valueType=def.type.isCollection() ? ((CollectionType)def.type).valueComparator() : def.type;
    ByteBuffer valueBytes=value instanceof ByteBuffer ? (ByteBuffer)value : valueType.decompose(value);
    if (ttl == 0)     cf.addColumn(new BufferCell(name,valueBytes,timestamp));
 else     cf.addColumn(new BufferExpiringCell(name,valueBytes,timestamp,ttl));
  }
  return this;
}
