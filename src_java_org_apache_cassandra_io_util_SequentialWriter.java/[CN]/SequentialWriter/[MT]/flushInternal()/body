{
  if (isDirty) {
    flushData();
    if (trickleFsync) {
      bytesSinceTrickleFsync+=validBufferBytes;
      if (bytesSinceTrickleFsync >= trickleFsyncByteInterval) {
        syncDataOnlyInternal();
        bytesSinceTrickleFsync=0;
      }
    }
    resetBuffer();
    isDirty=false;
  }
}
