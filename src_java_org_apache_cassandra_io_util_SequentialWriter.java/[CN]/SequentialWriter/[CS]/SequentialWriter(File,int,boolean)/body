{
  try {
    out=new RandomAccessFile(file,"rw");
  }
 catch (  FileNotFoundException e) {
    throw new RuntimeException(e);
  }
  filePath=file.getAbsolutePath();
  buffer=new byte[bufferSize];
  this.skipIOCache=skipIOCache;
  this.trickleFsync=DatabaseDescriptor.getTrickleFsync();
  this.trickleFsyncByteInterval=DatabaseDescriptor.getTrickleFsyncIntervalInKb() * 1024;
  try {
    fd=CLibrary.getfd(out.getFD());
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  directoryFD=CLibrary.tryOpenDirectory(file.getParent());
  stream=new DataOutputStream(this);
}
