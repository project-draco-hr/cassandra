{
  Gossiper gossiper=Gossiper.instance;
  int waited=0;
  while (!gossiper.getEndpointStateForEndpoint(endpoint).getApplicationState(ApplicationState.SCHEMA).value.equals(gossiper.getEndpointStateForEndpoint(FBUtilities.getLocalAddress()).getApplicationState(ApplicationState.SCHEMA).value)) {
    Thread.sleep(1000);
    waited+=1000;
    if (waited > 2 * StorageService.RING_DELAY)     throw new RuntimeException("Could not reach schema agreement with " + endpoint + " in "+ 2 * StorageService.RING_DELAY + "ms");
  }
  logger_.debug("schema for {} matches local schema",endpoint);
  return waited;
}
