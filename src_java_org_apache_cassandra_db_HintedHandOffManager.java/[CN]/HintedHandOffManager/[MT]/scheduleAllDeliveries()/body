{
  logger.debug("Started scheduleAllDeliveries");
  compact();
  ReadCommand cmd=new PartitionRangeReadCommand(hintStore.metadata,FBUtilities.nowInSeconds(),ColumnFilter.all(hintStore.metadata),RowFilter.NONE,DataLimits.cqlLimits(Integer.MAX_VALUE,1),DataRange.allData(hintStore.metadata.partitioner));
  try (ReadOrderGroup orderGroup=cmd.startOrderGroup();UnfilteredPartitionIterator iter=cmd.executeLocally(orderGroup)){
    while (iter.hasNext()) {
      try (UnfilteredRowIterator partition=iter.next()){
        UUID hostId=UUIDGen.getUUID(partition.partitionKey().getKey());
        InetAddress target=StorageService.instance.getTokenMetadata().getEndpointForHostId(hostId);
        if (target != null)         scheduleHintDelivery(target,false);
      }
     }
  }
   logger.debug("Finished scheduleAllDeliveries");
}
