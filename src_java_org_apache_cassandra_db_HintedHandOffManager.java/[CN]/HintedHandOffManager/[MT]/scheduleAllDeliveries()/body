{
  if (logger.isDebugEnabled())   logger.debug("Started scheduleAllDeliveries");
  IPartitioner p=StorageService.getPartitioner();
  RowPosition minPos=p.getMinimumToken().minKeyBound();
  Range<RowPosition> range=new Range<RowPosition>(minPos,minPos,p);
  IDiskAtomFilter filter=new NamesQueryFilter(ImmutableSortedSet.<CellName>of());
  List<Row> rows=hintStore.getRangeSlice(range,null,filter,Integer.MAX_VALUE,System.currentTimeMillis());
  for (  Row row : rows) {
    UUID hostId=UUIDGen.getUUID(row.key.key);
    InetAddress target=StorageService.instance.getTokenMetadata().getEndpointForHostId(hostId);
    if (target != null)     scheduleHintDelivery(target);
  }
  if (logger.isDebugEnabled())   logger.debug("Finished scheduleAllDeliveries");
}
