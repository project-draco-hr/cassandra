{
  logger_.debug("Started hinted handoff for endPoint " + endPoint.getHost());
  Table table=Table.open(DatabaseDescriptor.getTables().get(0));
  try {
    ColumnFamily hintedColumnFamily=table.get(key_,Table.hints_);
    if (hintedColumnFamily == null) {
      return;
    }
    Collection<IColumn> keys=hintedColumnFamily.getAllColumns();
    if (keys == null) {
      return;
    }
    for (    IColumn keyColumn : keys) {
      Collection<IColumn> endpoints=keyColumn.getSubColumns();
      for (      IColumn endpoint : endpoints) {
        if (endpoint.name().equals(endPoint.getHost()) && sendMessage(endpoint.name(),keyColumn.name())) {
          deleteEndPoint(endpoint.name(),keyColumn.name(),keyColumn.timestamp());
          if (endpoints.size() == 1) {
            deleteHintedData(keyColumn.name());
          }
        }
      }
    }
  }
 catch (  Exception ex) {
    logger_.error(ex.getMessage());
  }
 finally {
    logger_.debug("Finished hinted handoff for endpoint " + endPoint.getHost());
  }
}
