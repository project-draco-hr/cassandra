{
  logger_.debug("Started hinted handoff for endPoint " + endPoint.getHost());
  Table systemTable=Table.open(Table.SYSTEM_TABLE);
  for (  String tableName : DatabaseDescriptor.getTables()) {
    ColumnFamily hintedColumnFamily=systemTable.get(tableName,HINTS_CF);
    if (hintedColumnFamily == null) {
      continue;
    }
    Collection<IColumn> keys=hintedColumnFamily.getAllColumns();
    for (    IColumn keyColumn : keys) {
      Collection<IColumn> endpoints=keyColumn.getSubColumns();
      for (      IColumn endpoint : endpoints) {
        if (endpoint.name().equals(endPoint.getHost()) && sendMessage(endpoint.name(),null,keyColumn.name())) {
          deleteEndPoint(endpoint.name(),tableName,keyColumn.name(),keyColumn.timestamp());
          if (endpoints.size() == 1) {
            deleteHintedData(tableName,keyColumn.name());
          }
        }
      }
    }
  }
  logger_.debug("Finished hinted handoff for endpoint " + endPoint.getHost());
}
