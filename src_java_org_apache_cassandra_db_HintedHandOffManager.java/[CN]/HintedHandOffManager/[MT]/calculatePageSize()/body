{
  int meanColumnCount=hintStore.getMeanColumns();
  if (meanColumnCount <= 0)   return PAGE_SIZE;
  int averageColumnSize=(int)(hintStore.getMeanRowSize() / meanColumnCount);
  if (averageColumnSize <= 0)   return PAGE_SIZE;
  return Math.max(2,Math.min(PAGE_SIZE,DatabaseDescriptor.getInMemoryCompactionLimit() / averageColumnSize));
}
