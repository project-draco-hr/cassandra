{
  int meanColumnCount=hintStore.getMeanColumns();
  if (meanColumnCount > 0) {
    int averageColumnSize=(int)(hintStore.getMeanRowSize() / meanColumnCount);
    return Math.max(2,Math.min(PAGE_SIZE,DatabaseDescriptor.getInMemoryCompactionLimit() / averageColumnSize));
  }
 else {
    return PAGE_SIZE;
  }
}
