{
  if (logger_.isDebugEnabled())   logger_.debug("Started deliverAllHints");
  for (  String tableName : DatabaseDescriptor.getTables()) {
    ColumnFamily hintColumnFamily=ColumnFamilyStore.removeDeleted(hintStore.getColumnFamily(new IdentityQueryFilter(tableName,new QueryPath(HINTS_CF))),Integer.MAX_VALUE);
    if (hintColumnFamily == null) {
      continue;
    }
    Collection<IColumn> keys=hintColumnFamily.getAllColumns();
    for (    IColumn keyColumn : keys) {
      Collection<IColumn> endpoints=keyColumn.getSubColumns();
      int deleted=0;
      for (      IColumn endpoint : endpoints) {
        if (sendMessage(endpoint.name(),tableName,keyColumn.name())) {
          deleteEndPoint(endpoint.name(),tableName,keyColumn.name(),keyColumn.timestamp());
          deleted++;
        }
      }
      if (deleted == endpoints.size()) {
        deleteHintedData(tableName,keyColumn.name());
      }
    }
  }
  hintStore.forceFlush();
  hintStore.forceCompaction(null,null,0,null);
  if (logger_.isDebugEnabled())   logger_.debug("Finished deliverAllHints");
}
