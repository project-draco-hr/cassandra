{
  if (!queuedDeliveries.add(to))   return;
  logger.trace("Scheduling delivery of Hints to {}",to);
  hintDeliveryExecutor.execute(new Runnable(){
    public void run(){
      try {
        if (precompact)         compact();
        deliverHintsToEndpoint(to);
      }
  finally {
        queuedDeliveries.remove(to);
      }
    }
  }
);
}
