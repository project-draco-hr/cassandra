{
  if (!StorageService.instance.getTokenMetadata().isMember(endpoint))   return;
  UUID hostId=StorageService.instance.getTokenMetadata().getHostId(endpoint);
  DecoratedKey dk=StorageService.getPartitioner().decorateKey(ByteBuffer.wrap(UUIDGen.decompose(hostId)));
  final Mutation mutation=new Mutation(PartitionUpdate.fullPartitionDelete(SystemKeyspace.Hints,dk,System.currentTimeMillis(),FBUtilities.nowInSeconds()));
  Runnable runnable=new Runnable(){
    public void run(){
      try {
        logger.info("Deleting any stored hints for {}",endpoint);
        mutation.apply();
        hintStore.forceBlockingFlush();
        compact();
      }
 catch (      Exception e) {
        JVMStabilityInspector.inspectThrowable(e);
        logger.warn("Could not delete hints for {}: {}",endpoint,e);
      }
    }
  }
;
  executor.submit(runnable);
}
