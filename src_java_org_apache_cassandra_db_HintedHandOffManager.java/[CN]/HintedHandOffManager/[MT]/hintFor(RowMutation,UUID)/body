{
  UUID hintId=UUIDGen.getTimeUUID();
  int ttl=Integer.MAX_VALUE;
  for (  ColumnFamily cf : mutation.getColumnFamilies())   ttl=Math.min(ttl,cf.metadata().getGcGraceSeconds());
  ByteBuffer name=comparator.decompose(hintId,MessagingService.current_version);
  ByteBuffer value=ByteBuffer.wrap(FBUtilities.serialize(mutation,RowMutation.serializer,MessagingService.current_version));
  ColumnFamily cf=ArrayBackedSortedColumns.factory.create(Schema.instance.getCFMetaData(Table.SYSTEM_KS,SystemTable.HINTS_CF));
  cf.addColumn(name,value,System.currentTimeMillis(),ttl);
  return new RowMutation(Table.SYSTEM_KS,UUIDType.instance.decompose(targetId),cf);
}
