{
  RefCountedMemory offsets;
switch (finishType) {
case EARLY:
    offsets=this.offsets;
  break;
case NORMAL:
case FINISH_EARLY:
offsets=this.offsets.copy(count * 8L);
this.offsets.unreference();
break;
default :
throw new AssertionError();
}
return new CompressionMetadata(filePath,parameters,offsets,count * 8L,dataLength,compressedLength,latestVersion.hasPostCompressionAdlerChecksums());
}
