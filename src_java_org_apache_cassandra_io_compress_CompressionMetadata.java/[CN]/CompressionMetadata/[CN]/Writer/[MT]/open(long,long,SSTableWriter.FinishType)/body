{
  RefCountedMemory offsets;
  if (finishType.isFinal) {
    offsets=this.offsets.copy(count * 8L);
    this.offsets.unreference();
  }
 else {
    offsets=this.offsets;
  }
  return new CompressionMetadata(filePath,parameters,offsets,count * 8L,dataLength,compressedLength);
}
