{
  if (!Migration.isLegalName(keyspaceDef.name))   throw new RuntimeException("invalid keyspace name: " + keyspaceDef.name);
  for (  CFMetaData cfm : keyspaceDef.cfMetaData().values()) {
    if (!Migration.isLegalName(cfm.cfName))     throw new RuntimeException("invalid column family name: " + cfm.cfName);
    try {
      load(cfm);
    }
 catch (    ConfigurationException ex) {
      throw new IOError(ex);
    }
  }
  setTableDefinition(keyspaceDef);
  fixCFMaxId();
  return this;
}
