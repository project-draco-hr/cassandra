{
  long totalSize=totalSize();
  RandomAccessReader file=sstable.openDataReader();
  FileChannel fc=file.getChannel();
  long progress=0L;
  List<Pair<Long,Long>> sections=getTransferSections(compressionInfo.chunks);
  try {
    for (    Pair<Long,Long> section : sections) {
      long length=section.right - section.left;
      long bytesTransferred=0;
      while (bytesTransferred < length) {
        int toTransfer=(int)Math.min(CHUNK_SIZE,length - bytesTransferred);
        limiter.acquire(toTransfer);
        long lastWrite=fc.transferTo(section.left + bytesTransferred,toTransfer,channel);
        bytesTransferred+=lastWrite;
        progress+=lastWrite;
        session.progress(sstable.descriptor,ProgressInfo.Direction.OUT,progress,totalSize);
      }
    }
  }
  finally {
    FileUtils.closeQuietly(file);
  }
}
