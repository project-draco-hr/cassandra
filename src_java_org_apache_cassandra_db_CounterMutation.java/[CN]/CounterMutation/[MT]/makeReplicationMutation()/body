{
  List<ReadCommand> readCommands=new LinkedList<ReadCommand>();
  long timestamp=System.currentTimeMillis();
  for (  ColumnFamily columnFamily : rowMutation.getColumnFamilies()) {
    if (!columnFamily.metadata().getReplicateOnWrite())     continue;
    addReadCommandFromColumnFamily(rowMutation.getKeyspaceName(),rowMutation.key(),columnFamily,timestamp,readCommands);
  }
  RowMutation replicationMutation=new RowMutation(rowMutation.getKeyspaceName(),rowMutation.key());
  for (  ReadCommand readCommand : readCommands) {
    Keyspace keyspace=Keyspace.open(readCommand.ksName);
    Row row=readCommand.getRow(keyspace);
    if (row == null || row.cf == null)     continue;
    ColumnFamily cf=row.cf;
    replicationMutation.add(cf);
  }
  return replicationMutation.isEmpty() ? null : replicationMutation;
}
