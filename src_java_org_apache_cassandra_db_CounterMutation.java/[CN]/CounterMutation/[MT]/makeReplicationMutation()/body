{
  List<ReadCommand> readCommands=new LinkedList<ReadCommand>();
  long timestamp=System.currentTimeMillis();
  for (  ColumnFamily columnFamily : rowMutation.getColumnFamilies()) {
    if (!columnFamily.metadata().getReplicateOnWrite())     continue;
    addReadCommandFromColumnFamily(rowMutation.getTable(),rowMutation.key(),columnFamily,timestamp,readCommands);
  }
  RowMutation replicationMutation=new RowMutation(rowMutation.getTable(),rowMutation.key());
  for (  ReadCommand readCommand : readCommands) {
    Table table=Table.open(readCommand.table);
    Row row=readCommand.getRow(table);
    if (row == null || row.cf == null)     continue;
    ColumnFamily cf=row.cf;
    replicationMutation.add(cf);
  }
  return replicationMutation;
}
