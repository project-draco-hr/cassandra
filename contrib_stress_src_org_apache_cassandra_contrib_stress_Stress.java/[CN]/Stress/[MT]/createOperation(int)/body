{
switch (session.getOperation()) {
case READ:
    return new Reader(index);
case INSERT:
  return new Inserter(index);
case RANGE_SLICE:
return new RangeSlicer(index);
case INDEXED_RANGE_SLICE:
return new IndexedRangeSlicer(index);
case MULTI_GET:
return new MultiGetter(index);
}
throw new UnsupportedOperationException();
}
