{
switch (session.getOperation()) {
case READ:
    return new Reader(index);
case COUNTER_GET:
  return new CounterGetter(index);
case INSERT:
return new Inserter(index);
case COUNTER_ADD:
return new CounterAdder(index);
case RANGE_SLICE:
return new RangeSlicer(index);
case INDEXED_RANGE_SLICE:
return new IndexedRangeSlicer(index);
case MULTI_GET:
return new MultiGetter(index);
}
throw new UnsupportedOperationException();
}
