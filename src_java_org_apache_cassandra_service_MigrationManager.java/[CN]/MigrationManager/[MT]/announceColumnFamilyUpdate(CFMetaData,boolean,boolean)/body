{
  cfm.validate();
  CFMetaData oldCfm=Schema.instance.getCFMetaData(cfm.ksName,cfm.cfName);
  if (oldCfm == null)   throw new ConfigurationException(String.format("Cannot update non existing table '%s' in keyspace '%s'.",cfm.cfName,cfm.ksName));
  oldCfm.validateCompatility(cfm);
  logger.info(String.format("Update table '%s/%s' From %s To %s",cfm.ksName,cfm.cfName,oldCfm,cfm));
  announce(addSerializedKeyspace(oldCfm.toSchemaUpdate(cfm,FBUtilities.timestampMicros(),fromThrift),cfm.ksName),announceLocally);
}
