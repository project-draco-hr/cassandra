{
  UUID myVersion=Schema.instance.getVersion();
  if (theirVersion.timestamp() < myVersion.timestamp() && !StorageService.instance.isClientMode()) {
    if (lastPushed.get(endpoint) == null || theirVersion.timestamp() >= lastPushed.get(endpoint).timestamp()) {
      logger.debug("Schema on {} is old. Sending updates since {}",endpoint,theirVersion);
      Collection<IColumn> migrations=Migration.getLocalMigrations(theirVersion,myVersion);
      pushMigrations(endpoint,migrations);
      lastPushed.put(endpoint,TimeUUIDType.instance.compose(Iterables.getLast(migrations).name()));
    }
 else {
      logger.debug("Waiting for {} to process migrations up to {} before sending more",endpoint,lastPushed.get(endpoint));
    }
  }
}
