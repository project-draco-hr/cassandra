{
  ksm.validate();
  KSMetaData oldKsm=Schema.instance.getKSMetaData(ksm.name);
  if (oldKsm == null)   throw new ConfigurationException(String.format("Cannot update non existing keyspace '%s'.",ksm.name));
  announce(oldKsm.toSchemaUpdate(ksm,FBUtilities.timestampMicros()));
}
