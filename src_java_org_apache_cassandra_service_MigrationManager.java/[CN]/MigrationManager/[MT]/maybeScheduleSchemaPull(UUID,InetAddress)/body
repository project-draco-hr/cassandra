{
  if (Gossiper.instance.getVersion(endpoint) < MessagingService.VERSION_117)   return;
  if (Schema.instance.getVersion().equals(theirVersion))   return;
  if (Schema.emptyVersion.equals(Schema.instance.getVersion()) || runtimeMXBean.getUptime() < MIGRATION_DELAY_IN_MS) {
    submitMigrationTask(endpoint);
  }
 else {
    Runnable runnable=new Runnable(){
      public void run(){
        VersionedValue value=Gossiper.instance.getEndpointStateForEndpoint(endpoint).getApplicationState(ApplicationState.SCHEMA);
        UUID currentVersion=UUID.fromString(value.value);
        if (Schema.instance.getVersion().equals(currentVersion))         return;
        submitMigrationTask(endpoint);
      }
    }
;
    StorageService.optionalTasks.schedule(runnable,MIGRATION_DELAY_IN_MS,TimeUnit.MILLISECONDS);
  }
}
