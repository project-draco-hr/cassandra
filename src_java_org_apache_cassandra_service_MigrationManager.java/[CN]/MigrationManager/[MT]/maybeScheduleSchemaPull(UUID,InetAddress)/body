{
  if ((Schema.instance.getVersion() != null && Schema.instance.getVersion().equals(theirVersion)) || !shouldPullSchemaFrom(endpoint))   return;
  if (Schema.emptyVersion.equals(Schema.instance.getVersion()) || runtimeMXBean.getUptime() < MIGRATION_DELAY_IN_MS) {
    submitMigrationTask(endpoint);
  }
 else {
    Runnable runnable=new Runnable(){
      public void run(){
        EndpointState epState=Gossiper.instance.getEndpointStateForEndpoint(endpoint);
        if (epState == null)         return;
        VersionedValue value=epState.getApplicationState(ApplicationState.SCHEMA);
        UUID currentVersion=UUID.fromString(value.value);
        if (Schema.instance.getVersion().equals(currentVersion))         return;
        submitMigrationTask(endpoint);
      }
    }
;
    StorageService.optionalTasks.schedule(runnable,MIGRATION_DELAY_IN_MS,TimeUnit.MILLISECONDS);
  }
}
