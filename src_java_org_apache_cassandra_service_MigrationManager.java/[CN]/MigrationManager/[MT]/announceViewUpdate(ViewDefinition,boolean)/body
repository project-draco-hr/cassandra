{
  view.metadata.validate();
  ViewDefinition oldView=Schema.instance.getView(view.ksName,view.viewName);
  if (oldView == null)   throw new ConfigurationException(String.format("Cannot update non existing materialized view '%s' in keyspace '%s'.",view.viewName,view.ksName));
  KeyspaceMetadata ksm=Schema.instance.getKSMetaData(view.ksName);
  oldView.metadata.validateCompatility(view.metadata);
  logger.info(String.format("Update view '%s/%s' From %s To %s",view.ksName,view.viewName,oldView,view));
  announce(SchemaKeyspace.makeUpdateViewMutation(ksm,oldView,view,FBUtilities.timestampMicros()),announceLocally);
}
