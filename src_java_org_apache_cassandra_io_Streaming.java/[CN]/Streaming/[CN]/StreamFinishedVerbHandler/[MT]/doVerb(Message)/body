{
  byte[] body=message.getMessageBody();
  DataInputBuffer bufIn=new DataInputBuffer();
  bufIn.reset(body,body.length);
  try {
    StreamContextManager.StreamStatusMessage streamStatusMessage=StreamContextManager.StreamStatusMessage.serializer().deserialize(bufIn);
    StreamContextManager.StreamStatus streamStatus=streamStatusMessage.getStreamStatus();
switch (streamStatus.getAction()) {
case DELETE:
      StreamManager.instance(message.getFrom()).finish(streamStatus.getFile());
    break;
case STREAM:
  if (logger.isDebugEnabled())   logger.debug("Need to re-stream file " + streamStatus.getFile());
StreamManager.instance(message.getFrom()).repeat();
break;
default :
break;
}
}
 catch (IOException ex) {
throw new IOError(ex);
}
}
