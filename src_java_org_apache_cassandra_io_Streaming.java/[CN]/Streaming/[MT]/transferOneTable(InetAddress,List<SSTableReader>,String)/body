{
  if (sstables.isEmpty())   return;
  StreamContextManager.StreamContext[] streamContexts=new StreamContextManager.StreamContext[SSTable.FILES_ON_DISK * sstables.size()];
  int i=0;
  for (  SSTableReader sstable : sstables) {
    for (    String filename : sstable.getAllFilenames()) {
      File file=new File(filename);
      streamContexts[i++]=new StreamContextManager.StreamContext(file.getAbsolutePath(),file.length(),table);
    }
  }
  if (logger.isDebugEnabled())   logger.debug("Stream context metadata " + StringUtils.join(streamContexts,", "));
  StreamManager.instance(target).addFilesToStream(streamContexts);
  StreamInitiateMessage biMessage=new StreamInitiateMessage(streamContexts);
  Message message=StreamInitiateMessage.makeStreamInitiateMessage(biMessage);
  if (logger.isDebugEnabled())   logger.debug("Sending a stream initiate message to " + target + " ...");
  MessagingService.instance().sendOneWay(message,target);
  if (logger.isDebugEnabled())   logger.debug("Waiting for transfer to " + target + " to complete");
  StreamManager.instance(target).waitForStreamCompletion();
  if (logger.isDebugEnabled())   logger.debug("Done with transfer to " + target + " of "+ StringUtils.join(sstables,", "));
}
