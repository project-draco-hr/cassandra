{
  RowIndexEntry rie=sstableWriter.append(partition);
  if (sstableWriter.currentWriter().getOnDiskFilePointer() > currentBytesToWrite && currentRatioIndex < ratios.length - 1) {
    currentRatioIndex++;
    currentBytesToWrite=Math.round(totalSize * ratios[currentRatioIndex]);
    switchCompactionLocation(getWriteDirectory(Math.round(totalSize * ratios[currentRatioIndex])));
  }
  return rie != null;
}
