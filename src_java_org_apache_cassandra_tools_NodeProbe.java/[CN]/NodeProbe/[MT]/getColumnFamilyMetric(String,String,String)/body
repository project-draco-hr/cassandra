{
  try {
switch (metricName) {
case "BloomFilterDiskSpaceUsed":
case "BloomFilterFalsePositives":
case "BloomFilterFalseRatio":
case "CompressionRatio":
case "EstimatedColumnCountHistogram":
case "EstimatedRowSizeHistogram":
case "KeyCacheHitRate":
case "LiveSSTableCount":
case "MaxRowSize":
case "MeanRowSize":
case "MemtableColumnsCount":
case "MemtableDataSize":
case "MinRowSize":
case "PendingTasks":
case "RecentBloomFilterFalsePositives":
case "RecentBloomFilterFalseRatio":
      return JMX.newMBeanProxy(mbeanServerConn,new ObjectName("org.apache.cassandra.metrics:type=ColumnFamily,keyspace=" + ks + ",scope="+ cf+ ",name="+ metricName),JmxReporter.GaugeMBean.class).getValue();
case "LiveDiskSpaceUsed":
case "MemtableSwitchCount":
case "SpeculativeRetries":
case "TotalDiskSpaceUsed":
case "WriteTotalLatency":
case "ReadTotalLatency":
    return JMX.newMBeanProxy(mbeanServerConn,new ObjectName("org.apache.cassandra.metrics:type=ColumnFamily,keyspace=" + ks + ",scope="+ cf+ ",name="+ metricName),JmxReporter.CounterMBean.class).getCount();
case "ReadLatency":
case "CoordinatorReadLatency":
case "CoordinatorScanLatency":
case "WriteLatency":
  return JMX.newMBeanProxy(mbeanServerConn,new ObjectName("org.apache.cassandra.metrics:type=ColumnFamily,keyspace=" + ks + ",scope="+ cf+ ",name="+ metricName),JmxReporter.TimerMBean.class);
case "LiveScannedHistogram":
case "SSTablesPerReadHistogram":
case "TombstoneScannedHistogram":
return JMX.newMBeanProxy(mbeanServerConn,new ObjectName("org.apache.cassandra.metrics:type=ColumnFamily,keyspace=" + ks + ",scope="+ cf+ ",name="+ metricName),JmxReporter.HistogramMBean.class);
default :
throw new RuntimeException("Unknown column family metric.");
}
}
 catch (MalformedObjectNameException e) {
throw new RuntimeException(e);
}
}
