{
  RepairRunner runner=new RepairRunner(out,keyspaceName,columnFamilies);
  try {
    ssProxy.addNotificationListener(runner,null,null);
    if (!runner.repairAndWait(ssProxy,isSequential,isLocal,primaryRange))     failed=true;
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
 finally {
    try {
      ssProxy.removeNotificationListener(runner);
    }
 catch (    ListenerNotFoundException ignored) {
    }
  }
}
