{
  RepairRunner runner=new RepairRunner(out,tableName,columnFamilies);
  try {
    jmxc.addConnectionNotificationListener(runner,null,null);
    ssProxy.addNotificationListener(runner,null,null);
    if (!runner.repairAndWait(ssProxy,isSequential,isLocal,primaryRange))     failed=true;
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
 finally {
    try {
      ssProxy.removeNotificationListener(runner);
      jmxc.removeConnectionNotificationListener(runner);
    }
 catch (    Throwable ignored) {
    }
  }
}
