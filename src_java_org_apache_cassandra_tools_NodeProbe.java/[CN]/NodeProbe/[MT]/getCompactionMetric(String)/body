{
  try {
switch (metricName) {
case "BytesCompacted":
      return JMX.newMBeanProxy(mbeanServerConn,new ObjectName("org.apache.cassandra.metrics:type=Compaction,name=" + metricName),JmxReporter.CounterMBean.class);
case "CompletedTasks":
case "PendingTasks":
    return JMX.newMBeanProxy(mbeanServerConn,new ObjectName("org.apache.cassandra.metrics:type=Compaction,name=" + metricName),JmxReporter.GaugeMBean.class).getValue();
case "TotalCompactionsCompleted":
  return JMX.newMBeanProxy(mbeanServerConn,new ObjectName("org.apache.cassandra.metrics:type=Compaction,name=" + metricName),JmxReporter.MeterMBean.class);
default :
throw new RuntimeException("Unknown compaction metric.");
}
}
 catch (MalformedObjectNameException e) {
throw new RuntimeException(e);
}
}
