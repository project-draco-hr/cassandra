{
  logger.debug("Decoding credentials from client token");
  byte[] user=null;
  byte[] pass=null;
  int end=bytes.length;
  for (int i=bytes.length - 1; i >= 0; i--) {
    if (bytes[i] == NUL) {
      if (pass == null)       pass=Arrays.copyOfRange(bytes,i + 1,end);
 else       if (user == null)       user=Arrays.copyOfRange(bytes,i + 1,end);
      end=i;
    }
  }
  if (user == null)   throw new AuthenticationException("Authentication ID must not be null");
  if (pass == null)   throw new AuthenticationException("Password must not be null");
  Map<String,String> credentials=new HashMap<String,String>();
  credentials.put(IAuthenticator.USERNAME_KEY,new String(user,StandardCharsets.UTF_8));
  credentials.put(IAuthenticator.PASSWORD_KEY,new String(pass,StandardCharsets.UTF_8));
  return credentials;
}
