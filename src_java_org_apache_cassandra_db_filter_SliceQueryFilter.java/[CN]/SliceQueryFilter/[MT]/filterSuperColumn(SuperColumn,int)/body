{
  int liveColumns=0;
  for (  IColumn column : superColumn.getSubColumns()) {
    final boolean outOfRange=isAscending ? (start.length > 0 && superColumn.getComparator().compare(column.name(),start) < 0) || (finish.length > 0 && superColumn.getComparator().compare(column.name(),finish) > 0) : (start.length > 0 && superColumn.getComparator().compare(column.name(),start) > 0) || (finish.length > 0 && superColumn.getComparator().compare(column.name(),finish) < 0);
    if (outOfRange || (column.isMarkedForDelete() && column.getLocalDeletionTime() <= gcBefore) || liveColumns > count) {
      superColumn.remove(column.name());
    }
 else     if (!column.isMarkedForDelete()) {
      liveColumns++;
    }
  }
}
