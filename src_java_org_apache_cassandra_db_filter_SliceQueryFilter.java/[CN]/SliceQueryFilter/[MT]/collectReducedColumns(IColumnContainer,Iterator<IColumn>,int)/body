{
  AbstractType<?> comparator=container.getComparator();
  if (compositesToGroup < 0)   columnCounter=new ColumnCounter();
 else   if (compositesToGroup == 0)   columnCounter=new ColumnCounter.GroupByPrefix(null,0);
 else   columnCounter=new ColumnCounter.GroupByPrefix((CompositeType)comparator,compositesToGroup);
  while (reducedColumns.hasNext()) {
    if (columnCounter.count() >= count)     break;
    IColumn column=reducedColumns.next();
    if (logger.isDebugEnabled())     logger.debug(String.format("collecting %s of %s: %s",columnCounter.count(),count,column.getString(comparator)));
    columnCounter.countColum(column,container);
    if (QueryFilter.isRelevant(column,container,gcBefore))     container.addColumn(column);
  }
}
