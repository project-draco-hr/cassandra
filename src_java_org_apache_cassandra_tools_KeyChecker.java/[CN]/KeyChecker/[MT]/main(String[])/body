{
  if (args.length != 1) {
    System.out.println("Usage : java com.facebook.infrastructure.tools.KeyChecker <file containing all keys>");
    System.exit(1);
  }
  LogUtil.init();
  StorageService s=StorageService.instance();
  s.start();
  Thread.sleep(240000);
  RandomAccessFile raf=new RandomAccessFile("Missing-" + FBUtilities.getLocalAddress() + ".dat","rw");
  BufferedReader bufReader=new BufferedReader(new InputStreamReader(new FileInputStream(args[0])),KeyChecker.bufSize_);
  String key=null;
  boolean bStarted=false;
  while ((key=bufReader.readLine()) != null) {
    if (!bStarted) {
      bStarted=true;
      System.out.println("Started the processing of the file ...");
    }
    key=key.trim();
    if (StorageService.instance().isPrimary(key)) {
      System.out.println("Processing key " + key);
      Row row=Table.open("Mailbox").getRow(key,"MailboxMailList0");
      if (row.isEmpty()) {
        System.out.println("MISSING KEY : " + key);
        raf.write(key.getBytes());
        raf.write(System.getProperty("line.separator").getBytes());
      }
    }
  }
  System.out.println("DONE checking keys ...");
  raf.close();
}
