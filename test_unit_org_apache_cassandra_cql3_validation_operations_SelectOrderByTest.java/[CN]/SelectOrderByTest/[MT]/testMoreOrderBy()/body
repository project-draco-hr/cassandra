{
  createTable("CREATE TABLE %s (row text, number int, string text, PRIMARY KEY(row, number)) WITH COMPACT STORAGE ");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 1, 'one')");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 2, 'two')");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 3, 'three')");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 4, 'four')");
  for (  boolean flush : new boolean[]{true,false}) {
    if (flush)     flush();
    assertRows(execute("SELECT number FROM %s WHERE row='row' AND number < 3 ORDER BY number ASC"),row(1),row(2));
    assertRows(execute("SELECT number FROM %s WHERE row='row' AND number >= 3 ORDER BY number ASC"),row(3),row(4));
    assertRows(execute("SELECT number FROM %s WHERE row='row' AND number < 3 ORDER BY number DESC"),row(2),row(1));
    assertRows(execute("SELECT number FROM %s WHERE row='row' AND number >= 3 ORDER BY number DESC"),row(4),row(3));
    assertRows(execute("SELECT number FROM %s WHERE row='row' AND number > 3 ORDER BY number DESC"),row(4));
    assertRows(execute("SELECT number FROM %s WHERE row='row' AND number <= 3 ORDER BY number DESC"),row(3),row(2),row(1));
  }
}
