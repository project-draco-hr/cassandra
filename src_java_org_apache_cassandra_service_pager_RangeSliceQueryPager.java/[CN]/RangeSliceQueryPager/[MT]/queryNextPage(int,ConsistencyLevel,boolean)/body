{
  SliceQueryFilter sf=(SliceQueryFilter)columnFilter;
  AbstractBounds<RowPosition> keyRange=lastReturnedKey == null ? command.keyRange : makeIncludingKeyBounds(lastReturnedKey);
  ByteBuffer start=lastReturnedName == null ? sf.start() : lastReturnedName;
  PagedRangeCommand pageCmd=new PagedRangeCommand(command.keyspace,command.columnFamily,command.timestamp,keyRange,sf,start,sf.finish(),command.rowFilter,pageSize);
  return localQuery ? pageCmd.executeLocally() : StorageProxy.getRangeSlice(pageCmd,consistencyLevel);
}
