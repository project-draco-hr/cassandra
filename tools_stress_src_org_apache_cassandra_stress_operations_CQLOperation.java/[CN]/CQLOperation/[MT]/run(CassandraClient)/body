{
  run(new CQLQueryExecutor(){
    public boolean execute(    String cqlQuery,    List<String> queryParams) throws Exception {
      CqlResult result=null;
      if (session.usePreparedStatements()) {
        Integer stmntId=getPreparedStatement(client,cqlQuery);
        if (session.cqlVersion.startsWith("3"))         result=client.execute_prepared_cql3_query(stmntId,queryParamsAsByteBuffer(queryParams),session.getConsistencyLevel());
 else         result=client.execute_prepared_cql_query(stmntId,queryParamsAsByteBuffer(queryParams));
      }
 else {
        String formattedQuery=formatCqlQuery(cqlQuery,queryParams);
        if (session.cqlVersion.startsWith("3"))         result=client.execute_cql3_query(ByteBuffer.wrap(formattedQuery.getBytes()),Compression.NONE,session.getConsistencyLevel());
 else         result=client.execute_cql_query(ByteBuffer.wrap(formattedQuery.getBytes()),Compression.NONE);
      }
      return validateThriftResult(result);
    }
  }
);
}
