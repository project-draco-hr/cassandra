{
  if (b.hasArray()) {
    update(b.array(),b.arrayOffset() + off,len);
  }
 else   if (len < 16) {
    doUpdate(b,off,len);
  }
 else {
    byte[] buf=BUFFER.get();
    while (len > 0) {
      int l=Math.min(len,buf.length);
      ByteBufferUtil.arrayCopy(b,off,buf,0,l);
      update(buf,0,l);
      len-=l;
      off+=l;
    }
  }
}
