{
  StringTokenizer st=new StringTokenizer(name,String.valueOf(separator));
  String nexttok;
  String ksname=st.nextToken();
  String cfname=st.nextToken();
  nexttok=st.nextToken();
  boolean temporary=false;
  if (nexttok.equals(SSTable.TEMPFILE_MARKER)) {
    temporary=true;
    nexttok=st.nextToken();
  }
  Version version=Version.LEGACY;
  if (Version.validate(nexttok)) {
    version=new Version(nexttok);
    nexttok=st.nextToken();
  }
  int generation=Integer.parseInt(nexttok);
  String component=st.nextToken();
  directory=directory != null ? directory : new File(".");
  return new Pair<Descriptor,String>(new Descriptor(version,directory,ksname,cfname,generation,temporary),component);
}
