{
  String ksname=extractKeyspaceName(directory);
  StringTokenizer st=new StringTokenizer(name,"-");
  String nexttok=null;
  String cfname=st.nextToken();
  nexttok=st.nextToken();
  boolean temporary=false;
  if (nexttok.equals(SSTable.TEMPFILE_MARKER)) {
    temporary=true;
    nexttok=st.nextToken();
  }
  String version=LEGACY_VERSION;
  if (versionValidate(nexttok)) {
    version=nexttok;
    nexttok=st.nextToken();
  }
  int generation=Integer.parseInt(nexttok);
  String component=st.nextToken();
  return new Pair<Descriptor,String>(new Descriptor(version,directory,ksname,cfname,generation,temporary),component);
}
