{
  CommonTree queryTree=null;
  CqlLexer lexer=null;
  CqlParserX parser=null;
  CommonTokenStream tokens=null;
  ANTLRStringStream input=new ANTLRNoCaseStringStream(query);
  lexer=new CqlLexer(input);
  tokens=new CommonTokenStream(lexer);
  parser=new CqlParserX(tokens);
  try {
    queryTree=(CommonTree)(parser.root().getTree());
  }
 catch (  RecognitionException e) {
    throw new ParseException(parser.getErrors());
  }
catch (  RewriteEmptyStreamException e) {
    throw new ParseException(parser.getErrors());
  }
  if (!parser.getErrors().isEmpty()) {
    throw new ParseException(parser.getErrors());
  }
  if (!parser.errors.isEmpty()) {
    throw new ParseException("parser error");
  }
  return SemanticPhase.doSemanticAnalysis(queryTree);
}
