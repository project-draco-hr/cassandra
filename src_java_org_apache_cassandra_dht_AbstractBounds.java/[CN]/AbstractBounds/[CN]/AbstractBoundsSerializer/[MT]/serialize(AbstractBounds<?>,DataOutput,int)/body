{
  if (version < MessagingService.VERSION_11)   range=range.toTokenBounds();
  boolean isToken=range.left instanceof Token;
  int kind=range instanceof Range ? Type.RANGE.ordinal() : Type.BOUNDS.ordinal();
  if (!isToken)   kind=-(kind + 1);
  out.writeInt(kind);
  if (isToken) {
    Token.serializer().serialize((Token)range.left,out);
    Token.serializer().serialize((Token)range.right,out);
  }
 else {
    RowPosition.serializer().serialize((RowPosition)range.left,out);
    RowPosition.serializer().serialize((RowPosition)range.right,out);
  }
}
