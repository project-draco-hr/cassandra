{
  UserType old=Schema.instance.userTypes.getType(name);
  if (old == null) {
    if (ifExists)     return;
 else     throw new InvalidRequestException(String.format("No user type named %s exists.",name));
  }
  for (  UserType ut : Schema.instance.userTypes.getAllTypes().values()) {
    if (ut.name.equals(name.bytes))     continue;
    if (isUsedBy(ut))     throw new InvalidRequestException(String.format("Cannot drop user type %s as it is still used by user type %s",name,ut.asCQL3Type()));
  }
  for (  KSMetaData ksm : Schema.instance.getKeyspaceDefinitions())   for (  CFMetaData cfm : ksm.cfMetaData().values())   for (  ColumnDefinition def : cfm.allColumns())   if (isUsedBy(def.type))   throw new InvalidRequestException(String.format("Cannot drop user type %s as it is still used by table %s.%s",name,cfm.ksName,cfm.cfName));
}
