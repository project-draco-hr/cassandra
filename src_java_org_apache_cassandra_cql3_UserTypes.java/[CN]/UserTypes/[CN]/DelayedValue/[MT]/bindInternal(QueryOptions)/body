{
  int version=options.getProtocolVersion();
  ByteBuffer[] buffers=new ByteBuffer[values.size()];
  for (int i=0; i < type.size(); i++) {
    buffers[i]=values.get(i).bindAndGet(options);
    if (buffers[i] == ByteBufferUtil.UNSET_BYTE_BUFFER)     throw new InvalidRequestException(String.format("Invalid unset value for field '%s' of user defined type %s",type.fieldNameAsString(i),type.getNameAsString()));
    if (version < Server.VERSION_3 && type.fieldType(i).isCollection() && buffers[i] != null)     buffers[i]=((CollectionType)type.fieldType(i)).getSerializer().reserializeToV3(buffers[i]);
  }
  return buffers;
}
