{
  ClusteringIndexSliceFilter filter=deserializeSlicePartitionFilter(in,metadata);
  int count=in.readInt();
  int compositesToGroup=in.readInt();
  boolean selectsStatics=filter.selects(Clustering.STATIC_CLUSTERING);
  PartitionColumns columns=selectsStatics ? metadata.partitionColumns() : metadata.partitionColumns().withoutStatics();
  ColumnFilter columnFilter=new ColumnFilter.Builder(metadata).addAll(columns).build();
  boolean isDistinct=compositesToGroup == -2 || (count == 1 && selectsStatics);
  DataLimits limits;
  if (compositesToGroup == -2 || isDistinct)   limits=DataLimits.distinctLimits(count);
 else   if (compositesToGroup == -1)   limits=DataLimits.thriftLimits(1,count);
 else   limits=DataLimits.cqlLimits(count);
  return new SinglePartitionSliceCommand(isDigest,version,true,metadata,nowInSeconds,columnFilter,RowFilter.NONE,limits,key,filter);
}
