{
  Table table=Table.open("Table1");
  ColumnFamilyStore store=table.getColumnFamilyStore(columnFamilyName);
  Set<String> inserted=new HashSet<String>();
  for (int j=0; j < insertsPerTable; j++) {
    String key="0";
    RowMutation rm=new RowMutation("Table1",key);
    rm.add(columnFamilyName + ":0",new byte[0],j);
    rm.apply();
    inserted.add(key);
    store.forceBlockingFlush();
    assertEquals(table.getKeyRange(Arrays.asList(columnFamilyName),"","",10000).size(),inserted.size());
  }
  Future<Integer> ft=MinorCompactionManager.instance().submit(store,2);
  ft.get();
  assertEquals(1,store.getSSTableFilenames().size());
  assertEquals(table.getKeyRange(Arrays.asList(columnFamilyName),"","",10000).size(),inserted.size());
}
