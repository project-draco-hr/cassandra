{
  Table table=Table.open("Keyspace1");
  ColumnFamilyStore store=table.getColumnFamilyStore("Standard3");
  store.getCompactionStrategy();
  for (int j=0; j < 8; j++) {
    DecoratedKey key=Util.dk("row" + j);
    RowMutation rm=new RowMutation("Keyspace1",key.key);
    for (int i=100; i < 150; i++) {
      rm.add("Standard3",ByteBufferUtil.bytes(j + "col" + i),ByteBufferUtil.EMPTY_BYTE_BUFFER,System.currentTimeMillis());
    }
    rm.apply();
  }
  store.forceBlockingFlush();
  assertEquals(1,store.getSSTables().size());
  for (  SSTableReader sstable : store.getSSTables()) {
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().minColumnNames.get(0)),"0col100");
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().maxColumnNames.get(0)),"7col149");
  }
  DecoratedKey key=Util.dk("row2");
  RowMutation rm=new RowMutation("Keyspace1",key.key);
  for (int i=101; i < 299; i++) {
    rm.add("Standard3",ByteBufferUtil.bytes(9 + "col" + i),ByteBufferUtil.EMPTY_BYTE_BUFFER,System.currentTimeMillis());
  }
  rm.apply();
  store.forceBlockingFlush();
  store.forceMajorCompaction();
  assertEquals(1,store.getSSTables().size());
  for (  SSTableReader sstable : store.getSSTables()) {
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().minColumnNames.get(0)),"0col100");
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().maxColumnNames.get(0)),"9col298");
  }
}
