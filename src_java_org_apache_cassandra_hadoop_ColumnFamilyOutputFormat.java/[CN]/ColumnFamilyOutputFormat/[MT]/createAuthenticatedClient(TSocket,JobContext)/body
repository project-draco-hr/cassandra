{
  TBinaryProtocol binaryProtocol=new TBinaryProtocol(new TFramedTransport(socket));
  Cassandra.Client client=new Cassandra.Client(binaryProtocol);
  socket.open();
  client.set_keyspace(ConfigHelper.getOutputKeyspace(context.getConfiguration()));
  if (ConfigHelper.getOutputKeyspaceUserName(context.getConfiguration()) != null) {
    Map<String,String> creds=new HashMap<String,String>();
    creds.put(SimpleAuthenticator.USERNAME_KEY,ConfigHelper.getOutputKeyspaceUserName(context.getConfiguration()));
    creds.put(SimpleAuthenticator.PASSWORD_KEY,ConfigHelper.getOutputKeyspacePassword(context.getConfiguration()));
    AuthenticationRequest authRequest=new AuthenticationRequest(creds);
    client.login(authRequest);
  }
  return client;
}
