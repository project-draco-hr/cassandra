{
switch (consistencyLevel) {
case ONE:
case ANY:
    return 1;
case QUORUM:
  return (Table.open(table).getReplicationStrategy().getReplicationFactor() / 2) + 1;
case ALL:
return Table.open(table).getReplicationStrategy().getReplicationFactor();
default :
throw new UnsupportedOperationException("invalid consistency level: " + consistencyLevel);
}
}
