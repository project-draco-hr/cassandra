{
  DataOutputBuffer out=new DataOutputBuffer();
  try {
    ColumnFamily.serializer().serializeCFInfo(emptyColumnFamily,out);
    out.writeInt(columnCount);
    digest.update(out.getData(),0,out.getLength());
  }
 catch (  IOException e) {
    throw new IOError(e);
  }
  Iterator<IColumn> iter=iterator();
  while (iter.hasNext()) {
    IColumn column=iter.next();
    out.reset();
    try {
      emptyColumnFamily.getColumnSerializer().serialize(column,out);
    }
 catch (    IOException e) {
      throw new IOError(e);
    }
    digest.update(out.getData(),0,out.getLength());
  }
}
