{
  if (rows.size() == 1 && !major) {
    SSTableIdentityIterator row=rows.get(0);
    out.writeLong(row.getDataSize());
    row.echoData(out);
    return;
  }
  DataOutputBuffer clockOut=new DataOutputBuffer();
  ColumnFamily.serializer().serializeCFInfo(emptyColumnFamily,clockOut);
  out.writeLong(headerBuffer.getLength() + clockOut.getLength() + columnSerializedSize);
  out.write(headerBuffer.getData(),0,headerBuffer.getLength());
  out.write(clockOut.getData(),0,clockOut.getLength());
  out.writeInt(columnCount);
  Iterator<IColumn> iter=iterator();
  while (iter.hasNext()) {
    IColumn column=iter.next();
    emptyColumnFamily.getColumnSerializer().serialize(column,out);
  }
}
