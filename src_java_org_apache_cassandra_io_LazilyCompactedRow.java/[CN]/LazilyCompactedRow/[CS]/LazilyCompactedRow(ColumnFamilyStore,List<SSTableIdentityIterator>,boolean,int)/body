{
  super(rows.get(0).getKey());
  this.gcBefore=gcBefore;
  this.rows=new ArrayList<SSTableIdentityIterator>(rows);
  Set<SSTable> sstables=new HashSet<SSTable>();
  for (  SSTableIdentityIterator row : rows) {
    sstables.add(row.sstable);
    ColumnFamily cf=row.getColumnFamily();
    if (emptyColumnFamily == null)     emptyColumnFamily=cf;
 else     emptyColumnFamily.delete(cf);
  }
  this.shouldPurge=major || !cfStore.isKeyInRemainingSSTables(key,sstables);
  headerBuffer=new DataOutputBuffer();
  ColumnIndexer.serialize(this,headerBuffer);
  columnCount=iter.size;
  columnSerializedSize=iter.serializedSize;
  iter=null;
}
