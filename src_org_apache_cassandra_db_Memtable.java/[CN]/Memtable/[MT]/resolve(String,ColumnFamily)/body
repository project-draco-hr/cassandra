{
  ColumnFamily oldCf=columnFamilies_.get(key);
  if (oldCf != null) {
    int oldSize=oldCf.size();
    int oldObjectCount=oldCf.getColumnCount();
    oldCf.addColumns(columnFamily);
    int newSize=oldCf.size();
    int newObjectCount=oldCf.getColumnCount();
    resolveSize(oldSize,newSize);
    resolveCount(oldObjectCount,newObjectCount);
    oldCf.delete(Math.max(oldCf.getLocalDeletionTime(),columnFamily.getLocalDeletionTime()),Math.max(oldCf.getMarkedForDeleteAt(),columnFamily.getMarkedForDeleteAt()));
  }
 else {
    columnFamilies_.put(key,columnFamily);
    currentSize_.addAndGet(columnFamily.size() + key.length());
    currentObjectCount_.addAndGet(columnFamily.getColumnCount());
  }
}
