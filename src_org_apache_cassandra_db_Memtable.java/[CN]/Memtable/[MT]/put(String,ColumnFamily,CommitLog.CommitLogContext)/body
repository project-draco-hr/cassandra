{
  if (isThresholdViolated(key)) {
    lock_.lock();
    try {
      final ColumnFamilyStore cfStore=Table.open(table_).getColumnFamilyStore(cfName_);
      if (!isFrozen_) {
        isFrozen_=true;
        Runnable flushQueuer=new Runnable(){
          public void run(){
            MemtableManager.instance().submit(cfStore.getColumnFamilyName(),Memtable.this,cLogCtx);
          }
        }
;
        cfStore.switchMemtable(key,columnFamily,cLogCtx);
        executor_.runOnTermination(flushQueuer);
        executor_.shutdown();
      }
 else {
        cfStore.apply(key,columnFamily,cLogCtx);
      }
    }
  finally {
      lock_.unlock();
    }
  }
 else {
    printExecutorStats();
    Runnable putter=new Putter(key,columnFamily);
    executor_.submit(putter);
  }
}
