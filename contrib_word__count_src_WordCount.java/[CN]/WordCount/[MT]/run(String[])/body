{
  String outputReducerType="filesystem";
  if (args != null && args[0].startsWith(OUTPUT_REDUCER_VAR)) {
    String[] s=args[0].split("=");
    if (s != null && s.length == 2)     outputReducerType=s[1];
  }
  logger.info("output reducer type: " + outputReducerType);
  for (int i=0; i < WordCountSetup.TEST_COUNT; i++) {
    String columnName="text" + i;
    getConf().set(CONF_COLUMN_NAME,columnName);
    Job job=new Job(getConf(),"wordcount");
    job.setJarByClass(WordCount.class);
    job.setMapperClass(TokenizerMapper.class);
    if (outputReducerType.equalsIgnoreCase("filesystem")) {
      job.setCombinerClass(ReducerToFilesystem.class);
      job.setReducerClass(ReducerToFilesystem.class);
      job.setOutputKeyClass(Text.class);
      job.setOutputValueClass(IntWritable.class);
      FileOutputFormat.setOutputPath(job,new Path(OUTPUT_PATH_PREFIX + i));
    }
 else {
      job.setReducerClass(ReducerToCassandra.class);
      job.setMapOutputKeyClass(Text.class);
      job.setMapOutputValueClass(IntWritable.class);
      job.setOutputKeyClass(ByteBuffer.class);
      job.setOutputValueClass(List.class);
      job.setOutputFormatClass(ColumnFamilyOutputFormat.class);
      ConfigHelper.setOutputColumnFamily(job.getConfiguration(),KEYSPACE,OUTPUT_COLUMN_FAMILY);
    }
    job.setInputFormatClass(ColumnFamilyInputFormat.class);
    ConfigHelper.setRpcPort(job.getConfiguration(),"9160");
    ConfigHelper.setInitialAddress(job.getConfiguration(),"localhost");
    ConfigHelper.setPartitioner(job.getConfiguration(),"org.apache.cassandra.dht.RandomPartitioner");
    ConfigHelper.setInputColumnFamily(job.getConfiguration(),KEYSPACE,COLUMN_FAMILY);
    SlicePredicate predicate=new SlicePredicate().setColumn_names(Arrays.asList(columnName.getBytes()));
    ConfigHelper.setInputSlicePredicate(job.getConfiguration(),predicate);
    job.waitForCompletion(true);
  }
  return 0;
}
