{
  for (int i=0; i < WordCountSetup.TEST_COUNT; i++) {
    String columnName="text" + i;
    getConf().set(CONF_COLUMN_NAME,columnName);
    Job job=new Job(getConf(),"wordcount");
    job.setJarByClass(WordCount.class);
    job.setMapperClass(TokenizerMapper.class);
    job.setCombinerClass(IntSumReducer.class);
    job.setReducerClass(IntSumReducer.class);
    job.setOutputKeyClass(Text.class);
    job.setOutputValueClass(IntWritable.class);
    job.setInputFormatClass(ColumnFamilyInputFormat.class);
    FileOutputFormat.setOutputPath(job,new Path(OUTPUT_PATH_PREFIX + i));
    ConfigHelper.setRpcPort(job.getConfiguration(),"9160");
    ConfigHelper.setInitialAddress(job.getConfiguration(),"localhost");
    ConfigHelper.setInputColumnFamily(job.getConfiguration(),KEYSPACE,COLUMN_FAMILY);
    SlicePredicate predicate=new SlicePredicate().setColumn_names(Arrays.asList(columnName.getBytes()));
    ConfigHelper.setInputSlicePredicate(job.getConfiguration(),predicate);
    job.waitForCompletion(true);
  }
  return 0;
}
