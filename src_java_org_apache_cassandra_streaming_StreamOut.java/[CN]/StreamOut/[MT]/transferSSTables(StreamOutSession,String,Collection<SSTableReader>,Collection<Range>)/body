{
  List<PendingFile> pending=createPendingFiles(sstables,ranges);
  if (pending.size() > 0) {
    StreamHeader header=new StreamHeader(session.getSessionId(),pending.get(0),true);
    session.addFilesToStream(pending);
    logger.info("Streaming file {} to {}",header.getStreamFile(),session.getHost());
    MessagingService.instance.stream(header,session.getHost());
    logger.info("Waiting for transfer to {} to complete",session.getHost());
    session.waitForStreamCompletion();
    logger.info("Done with transfer to {}",session.getHost());
  }
}
