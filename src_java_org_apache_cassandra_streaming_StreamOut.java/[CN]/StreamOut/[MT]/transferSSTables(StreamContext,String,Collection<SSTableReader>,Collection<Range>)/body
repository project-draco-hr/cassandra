{
  List<PendingFile> pending=createPendingFiles(sstables,ranges);
  if (pending.size() > 0) {
    StreamHeader header=new StreamHeader(context.sessionId,pending.get(0),true);
    StreamOutSession.get(context).addFilesToStream(pending);
    logger.info("Streaming file {} to {}",header.getStreamFile(),context.host);
    MessagingService.instance.stream(header,context.host);
    logger.info("Waiting for transfer to {} to complete",context);
    StreamOutSession.get(context).waitForStreamCompletion();
    logger.info("Done with transfer to {}",context);
  }
}
