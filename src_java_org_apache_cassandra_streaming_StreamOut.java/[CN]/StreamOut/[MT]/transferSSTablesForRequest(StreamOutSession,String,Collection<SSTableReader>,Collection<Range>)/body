{
  List<PendingFile> pending=createPendingFiles(sstables,ranges);
  if (pending.size() > 0) {
    StreamHeader header=new StreamHeader(session.getSessionId(),pending.get(0),pending,false);
    if (session.getFiles().isEmpty())     session.addFilesToStream(pending);
    logger.info("Streaming file {} to {}",header.getStreamFile(),session.getHost());
    MessagingService.instance.stream(header,session.getHost());
    session.removePending(header.getStreamFile());
  }
 else {
    FileStatus status=new FileStatus("",session.getSessionId());
    status.setAction(FileStatus.Action.EMPTY);
    Message message=status.makeStreamStatusMessage();
    message.setHeader(StreamOut.TABLE_NAME,table.getBytes());
    MessagingService.instance.sendOneWay(message,session.getHost());
  }
}
