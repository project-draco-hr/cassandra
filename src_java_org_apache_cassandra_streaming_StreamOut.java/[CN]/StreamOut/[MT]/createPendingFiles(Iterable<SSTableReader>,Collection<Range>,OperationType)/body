{
  List<PendingFile> pending=new ArrayList<PendingFile>();
  for (  SSTableReader sstable : sstables) {
    Descriptor desc=sstable.descriptor;
    List<Pair<Long,Long>> sections=sstable.getPositionsForRanges(ranges);
    if (sections.isEmpty()) {
      sstable.releaseReference();
      continue;
    }
    pending.add(new PendingFile(sstable,desc,SSTable.COMPONENT_DATA,sections,type,sstable.estimatedKeysForRanges(ranges)));
  }
  logger.info("Stream context metadata {}, {} sstables.",pending,Iterables.size(sstables));
  return pending;
}
