{
  List<PendingFile> pending=createPendingFiles(sstables,ranges);
  if (pending.size() > 0) {
    StreamHeader header=new StreamHeader(context.sessionId,pending.get(0),pending,false);
    if (StreamOutManager.getPendingFiles(context).size() == 0)     StreamOutManager.get(context).addFilesToStream(pending);
    logger.info("Streaming file {} to {}",header.getStreamFile(),context.host);
    MessagingService.instance.stream(header,context.host);
    StreamOutManager.get(context).removePending(header.getStreamFile());
  }
 else {
    FileStatus status=new FileStatus("",context.sessionId);
    status.setAction(FileStatus.Action.EMPTY);
    Message message=status.makeStreamStatusMessage();
    message.setHeader(StreamOut.TABLE_NAME,table.getBytes());
    MessagingService.instance.sendOneWay(message,context.host);
  }
}
