{
  Keyspace keyspace=Keyspace.open("Keyspace1");
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard1");
  store.disableAutoCompaction();
  store.truncateBlocking();
  assertEquals(0,store.metric.liveDiskSpaceUsed.count());
  assertEquals(0,store.metric.totalDiskSpaceUsed.count());
  for (int j=0; j < 10; j++) {
    ByteBuffer key=ByteBufferUtil.bytes(String.valueOf(j));
    RowMutation rm=new RowMutation("Keyspace1",key);
    rm.add("Standard1",ByteBufferUtil.bytes("0"),ByteBufferUtil.EMPTY_BYTE_BUFFER,j);
    rm.apply();
  }
  store.forceBlockingFlush();
  Collection<SSTableReader> sstables=store.getSSTables();
  long size=0;
  for (  SSTableReader reader : sstables) {
    size+=reader.bytesOnDisk();
  }
  assertEquals(size,store.metric.liveDiskSpaceUsed.count());
  assertEquals(size,store.metric.totalDiskSpaceUsed.count());
  store.truncateBlocking();
  assertEquals(0,store.metric.liveDiskSpaceUsed.count());
  assertEquals(0,store.metric.totalDiskSpaceUsed.count());
  store.enableAutoCompaction();
}
