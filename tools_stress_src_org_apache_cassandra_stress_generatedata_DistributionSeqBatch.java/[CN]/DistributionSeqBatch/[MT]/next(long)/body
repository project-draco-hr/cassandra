{
  if (batchIndex >= batchSize) {
    batchKey=delegate.next();
    batchIndex=0;
  }
  long r=batchKey + batchIndex++;
  if (r > maxKey) {
    batchKey=delegate.next();
    batchIndex=1;
    r=batchKey;
  }
  return r;
}
