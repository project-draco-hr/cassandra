{
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(columnFamilyName);
  Set<DecoratedKey> inserted=new HashSet<DecoratedKey>();
  for (int j=0; j < insertsPerTable; j++) {
    DecoratedKey key=Util.dk(String.valueOf(j));
    Mutation rm=new Mutation(KEYSPACE1,key.getKey());
    rm.add(columnFamilyName,Util.cellname("0"),ByteBufferUtil.EMPTY_BYTE_BUFFER,j);
    rm.applyUnsafe();
    inserted.add(key);
    store.forceBlockingFlush();
    assertEquals(inserted.size(),Util.getRangeSlice(store).size());
  }
  CompactionManager.instance.performMaximal(store,false);
  assertEquals(1,store.getSSTables().size());
}
