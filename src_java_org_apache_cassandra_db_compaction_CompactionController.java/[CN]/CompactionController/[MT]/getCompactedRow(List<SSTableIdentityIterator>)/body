{
  long rowSize=0;
  for (  SSTableIdentityIterator row : rows)   rowSize+=row.dataSize;
  if (rows.size() == 1 && !deserializeRequired && (rowSize > DatabaseDescriptor.getInMemoryCompactionLimit() || !keyExistenceIsExpensive) && !shouldPurge(rows.get(0).getKey())) {
    return new EchoedRow(rows.get(0));
  }
  if (rowSize > DatabaseDescriptor.getInMemoryCompactionLimit()) {
    String keyString=cfs.metadata.getKeyValidator().getString(rows.get(0).getKey().key);
    logger.info(String.format("Compacting large row %s/%s:%s (%d bytes) incrementally",cfs.table.name,cfs.columnFamily,keyString,rowSize));
    return new LazilyCompactedRow(this,rows);
  }
  return new PrecompactedRow(this,rows);
}
