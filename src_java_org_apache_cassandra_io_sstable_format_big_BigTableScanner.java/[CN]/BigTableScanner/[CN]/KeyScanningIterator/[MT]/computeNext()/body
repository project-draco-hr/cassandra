{
  try {
    if (nextEntry == null) {
      do {
        if (!rangeIterator.hasNext())         return endOfData();
        currentRange=rangeIterator.next();
        seekToCurrentRangeStart();
        if (ifile.isEOF())         return endOfData();
        currentKey=sstable.decorateKey(ByteBufferUtil.readWithShortLength(ifile));
        currentEntry=rowIndexEntrySerializer.deserialize(ifile);
      }
 while (!currentRange.contains(currentKey));
    }
 else {
      currentKey=nextKey;
      currentEntry=nextEntry;
    }
    if (ifile.isEOF()) {
      nextEntry=null;
      nextKey=null;
    }
 else {
      nextKey=sstable.decorateKey(ByteBufferUtil.readWithShortLength(ifile));
      nextEntry=rowIndexEntrySerializer.deserialize(ifile);
      if (!currentRange.contains(nextKey)) {
        nextKey=null;
        nextEntry=null;
      }
    }
    return new LazilyInitializedUnfilteredRowIterator(currentKey){
      protected UnfilteredRowIterator initializeIterator(){
        try {
          if (dataRange == null) {
            dfile.seek(currentEntry.position + currentEntry.headerOffset());
            ByteBufferUtil.readWithShortLength(dfile);
            return new SSTableIdentityIterator(sstable,dfile,partitionKey());
          }
          ClusteringIndexFilter filter=dataRange.clusteringIndexFilter(partitionKey());
          return filter.filter(sstable.iterator(dfile,partitionKey(),currentEntry,columns,filter.isReversed(),isForThrift));
        }
 catch (        CorruptSSTableException|IOException e) {
          sstable.markSuspect();
          throw new CorruptSSTableException(e,sstable.getFilename());
        }
      }
    }
;
  }
 catch (  CorruptSSTableException|IOException e) {
    sstable.markSuspect();
    throw new CorruptSSTableException(e,sstable.getFilename());
  }
}
