{
  try {
    if (version != StreamMessage.CURRENT_VERSION)     throw new IOException(String.format("Received stream using protocol version %d (my version %d). Terminating connection",version,MessagingService.current_version));
    DataInput input=new DataInputStream(socket.getInputStream());
    StreamInitMessage init=StreamInitMessage.serializer.deserialize(input,version);
    StreamResultFuture.initReceivingSide(init.sessionIndex,init.planId,init.description,init.from,socket,init.isForOutgoing,version);
  }
 catch (  IOException e) {
    logger.debug("IOException reading from socket; closing",e);
    try {
      socket.close();
    }
 catch (    IOException e2) {
      logger.debug("error closing socket",e2);
    }
  }
}
