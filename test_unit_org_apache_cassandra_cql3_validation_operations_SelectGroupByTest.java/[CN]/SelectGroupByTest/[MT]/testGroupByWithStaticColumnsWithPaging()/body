{
  createTable("CREATE TABLE %s (a int, b int, c int, s int static, d int, primary key (a, b, c))");
  execute("UPDATE %s SET s = 1 WHERE a = 1");
  execute("UPDATE %s SET s = 2 WHERE a = 2");
  execute("UPDATE %s SET s = 3 WHERE a = 4");
  for (int pageSize=1; pageSize < 10; pageSize++) {
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L),row(4,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a, b",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L),row(4,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s",pageSize),row(1,null,1,0L,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s GROUP BY a, b",pageSize),row(1,null,1),row(2,null,2),row(4,null,3));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a, b LIMIT 2",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s LIMIT 2",pageSize),row(1,null,1,0L,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a PER PARTITION LIMIT 2",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L),row(4,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a PER PARTITION LIMIT 2 LIMIT 2",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s GROUP BY a",pageSize),row(1,1,1L),row(2,2,1L),row(4,3,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s ",pageSize),row(1,1,3L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s GROUP BY a LIMIT 2",pageSize),row(1,1,1L),row(2,2,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s LIMIT 2",pageSize),row(1,1,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 1 GROUP BY a",pageSize),row(1,null,1,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 1 GROUP BY a, b",pageSize),row(1,null,1,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 1",pageSize),row(1,null,1,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a = 1 GROUP BY a, b",pageSize),row(1,null,1));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 1 GROUP BY a, b LIMIT 2",pageSize),row(1,null,1,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 1 LIMIT 2",pageSize),row(1,null,1,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s WHERE a = 1 GROUP BY a",pageSize),row(1,1,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s WHERE a = 1",pageSize),row(1,1,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L),row(4,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L),row(4,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4)",pageSize),row(1,null,1,0L,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b",pageSize),row(1,null,1),row(2,null,2),row(4,null,3));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b LIMIT 2",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) LIMIT 2",pageSize),row(1,null,1,0L,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a PER PARTITION LIMIT 2",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L),row(4,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a PER PARTITION LIMIT 2 LIMIT 2",pageSize),row(1,null,1,0L,1L),row(2,null,2,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a",pageSize),row(1,1,1L),row(2,2,1L),row(4,3,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s WHERE a IN (1, 2, 3, 4)",pageSize),row(1,1,3L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a LIMIT 2",pageSize),row(1,1,1L),row(2,2,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(s) FROM %s WHERE a IN (1, 2, 3, 4) LIMIT 2",pageSize),row(1,1,3L));
  }
  execute("UPDATE %s SET s = 3 WHERE a = 3");
  execute("DELETE s FROM %s WHERE a = 4");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 2, 1, 3)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 2, 2, 6)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 3, 2, 12)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 4, 2, 12)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 4, 3, 6)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (2, 2, 3, 3)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (2, 4, 3, 6)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (4, 8, 2, 12)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (5, 8, 2, 12)");
  execute("DELETE FROM %s WHERE a = 1 AND b = 3 AND c = 2");
  execute("DELETE FROM %s WHERE a = 5");
  for (int pageSize=1; pageSize < 10; pageSize++) {
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a",pageSize),row(1,2,1,4L,4L),row(2,2,2,2L,2L),row(4,8,null,1L,0L),row(3,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a, b",pageSize),row(1,2,1,2L,2L),row(1,4,1,2L,2L),row(2,2,2,1L,1L),row(2,4,2,1L,1L),row(4,8,null,1L,0L),row(3,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s",pageSize),row(1,2,1,7L,7L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE b = 2 GROUP BY a, b ALLOW FILTERING",pageSize),row(1,2,1,2L,2L),row(2,2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE b = 2 ALLOW FILTERING",pageSize),row(1,2,1,3L,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s GROUP BY a",pageSize),row(1,2,1),row(2,2,2),row(4,8,null),row(3,null,3));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s GROUP BY a, b",pageSize),row(1,2,1),row(1,4,1),row(2,2,2),row(2,4,2),row(4,8,null),row(3,null,3));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a LIMIT 2",pageSize),row(1,2,1,4L,4L),row(2,2,2,2L,2L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s LIMIT 2",pageSize),row(1,2,1,7L,7L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s GROUP BY a LIMIT 2",pageSize),row(1,2,1),row(2,2,2));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s GROUP BY a, b LIMIT 10",pageSize),row(1,2,1),row(1,4,1),row(2,2,2),row(2,4,2),row(4,8,null),row(3,null,3));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a, b PER PARTITION LIMIT 2",pageSize),row(1,2,1,2L,2L),row(1,4,1,2L,2L),row(2,2,2,1L,1L),row(2,4,2,1L,1L),row(4,8,null,1L,0L),row(3,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a, b PER PARTITION LIMIT 1",pageSize),row(1,2,1,2L,2L),row(2,2,2,1L,1L),row(4,8,null,1L,0L),row(3,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a, b PER PARTITION LIMIT 2 LIMIT 3",pageSize),row(1,2,1,2L,2L),row(1,4,1,2L,2L),row(2,2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s GROUP BY a, b PER PARTITION LIMIT 1 LIMIT 3",pageSize),row(1,2,1,2L,2L),row(2,2,2,1L,1L),row(4,8,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s GROUP BY a, b PER PARTITION LIMIT 1",pageSize),row(1,2,1),row(2,2,2),row(4,8,null),row(3,null,3));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s GROUP BY a",pageSize),row(1,1,1L,1L),row(2,2,1L,1L),row(4,null,1L,0L),row(3,3,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s",pageSize),row(1,1,4L,3L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s GROUP BY a LIMIT 2",pageSize),row(1,1,1L,1L),row(2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s LIMIT 2",pageSize),row(1,1,4L,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 1 GROUP BY a",pageSize),row(1,2,1,4L,4L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 3 GROUP BY a, b",pageSize),row(3,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 3",pageSize),row(3,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 AND b = 2 GROUP BY a, b",pageSize),row(2,2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 AND b = 2",pageSize),row(2,2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a = 1 GROUP BY a",pageSize),row(1,2,1));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a = 4 GROUP BY a, b",pageSize),row(4,8,null));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 GROUP BY a, b LIMIT 1",pageSize),row(2,2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 LIMIT 1",pageSize),row(2,2,2,2L,2L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a = 2 GROUP BY a, b LIMIT 1",pageSize),row(2,2,2));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a = 2 GROUP BY a, b LIMIT 2",pageSize),row(2,2,2),row(2,4,2));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s WHERE a = 2 GROUP BY a",pageSize),row(2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s WHERE a = 4 GROUP BY a",pageSize),row(4,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 GROUP BY a, b ORDER BY b DESC, c DESC",pageSize),row(2,4,2,1L,1L),row(2,2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 ORDER BY b DESC, c DESC",pageSize),row(2,4,2,2L,2L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 GROUP BY a, b ORDER BY b DESC, c DESC LIMIT 1",pageSize),row(2,4,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a = 2 ORDER BY b DESC, c DESC LIMIT 2",pageSize),row(2,4,2,2L,2L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a",pageSize),row(1,2,1,4L,4L),row(2,2,2,2L,2L),row(3,null,3,0L,1L),row(4,8,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b",pageSize),row(1,2,1,2L,2L),row(1,4,1,2L,2L),row(2,2,2,1L,1L),row(2,4,2,1L,1L),row(3,null,3,0L,1L),row(4,8,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4)",pageSize),row(1,2,1,7L,7L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) AND b = 2 GROUP BY a, b",pageSize),row(1,2,1,2L,2L),row(2,2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) AND b = 2",pageSize),row(1,2,1,3L,3L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a",pageSize),row(1,2,1),row(2,2,2),row(3,null,3),row(4,8,null));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b",pageSize),row(1,2,1),row(1,4,1),row(2,2,2),row(2,4,2),row(3,null,3),row(4,8,null));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a LIMIT 2",pageSize),row(1,2,1,4L,4L),row(2,2,2,2L,2L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) LIMIT 2",pageSize),row(1,2,1,7L,7L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a LIMIT 2",pageSize),row(1,2,1),row(2,2,2));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b LIMIT 10",pageSize),row(1,2,1),row(1,4,1),row(2,2,2),row(2,4,2),row(3,null,3),row(4,8,null));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b PER PARTITION LIMIT 1",pageSize),row(1,2,1,2L,2L),row(2,2,2,1L,1L),row(3,null,3,0L,1L),row(4,8,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b PER PARTITION LIMIT 3",pageSize),row(1,2,1,2L,2L),row(1,4,1,2L,2L),row(2,2,2,1L,1L),row(2,4,2,1L,1L),row(3,null,3,0L,1L),row(4,8,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b PER PARTITION LIMIT 1 LIMIT 3",pageSize),row(1,2,1,2L,2L),row(2,2,2,1L,1L),row(3,null,3,0L,1L));
    assertRowsNet(executeNetWithPaging("SELECT a, b, s, count(b), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a, b PER PARTITION LIMIT 3 LIMIT 10",pageSize),row(1,2,1,2L,2L),row(1,4,1,2L,2L),row(2,2,2,1L,1L),row(2,4,2,1L,1L),row(3,null,3,0L,1L),row(4,8,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a",pageSize),row(1,1,1L,1L),row(2,2,1L,1L),row(3,3,1L,1L),row(4,null,1L,0L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s WHERE a IN (1, 2, 3, 4)",pageSize),row(1,1,4L,3L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s WHERE a IN (1, 2, 3, 4) GROUP BY a LIMIT 2",pageSize),row(1,1,1L,1L),row(2,2,1L,1L));
    assertRowsNet(executeNetWithPaging("SELECT DISTINCT a, s, count(a), count(s) FROM %s WHERE a IN (1, 2, 3, 4) LIMIT 2",pageSize),row(1,1,4L,3L));
  }
}
