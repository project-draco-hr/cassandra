{
  for (  Map.Entry<UUID,AtomicInteger> entry : invalidMutations.entrySet())   logger.warn(String.format("Skipped %d mutations from unknown (probably removed) CF with id %s",entry.getValue().intValue(),entry.getKey()));
  FBUtilities.waitOnFutures(futures);
  logger.trace("Finished waiting on mutations from recovery");
  futures.clear();
  boolean flushingSystem=false;
  for (  Keyspace keyspace : keyspacesRecovered) {
    if (keyspace.getName().equals(SystemKeyspace.NAME))     flushingSystem=true;
    futures.addAll(keyspace.flush());
  }
  if (!flushingSystem)   futures.add(Keyspace.open(SystemKeyspace.NAME).getColumnFamilyStore(SystemKeyspace.BATCHES).forceFlush());
  FBUtilities.waitOnFutures(futures);
  return replayedCount.get();
}
