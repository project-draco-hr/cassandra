{
  this.keyspacesRecovered=new NonBlockingHashSet<Keyspace>();
  this.futures=new ArrayDeque<Future<Integer>>();
  this.buffer=new byte[4096];
  this.invalidMutations=new HashMap<UUID,AtomicInteger>();
  this.replayedCount=new AtomicInteger();
  this.checksum=new CRC32();
  this.cfPersisted=cfPersisted;
  this.globalPosition=globalPosition;
  this.replayFilter=replayFilter;
  this.archiver=commitLog.archiver;
}
