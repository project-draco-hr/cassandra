{
  UntypedResultSet res=executeInternal("SELECT * FROM system." + SystemKeyspace.RANGE_XFERS_CF);
  if (res.size() < 1) {
    LOG.info("No queued ranges to transfer, shuffle complete.  Run 'cassandra-shuffle disable' to stop this message.");
    return;
  }
  if (!isReady())   return;
  UntypedResultSet.Row row=res.iterator().next();
  Date requestedAt=row.getTimestamp("requested_at");
  ByteBuffer tokenBytes=row.getBytes("token_bytes");
  Token token=StorageService.getPartitioner().getTokenFactory().fromByteArray(tokenBytes);
  LOG.info("Initiating transfer of {} (scheduled at {})",token,requestedAt.toString());
  try {
    StorageService.instance.relocateTokens(Collections.singleton(token));
  }
 catch (  Exception e) {
    LOG.error("Error removing {}: {}",token,e);
  }
 finally {
    LOG.debug("Removing queued entry for transfer of {}",token);
    executeInternal(String.format("DELETE FROM system.%s WHERE token_bytes = ?",SystemKeyspace.RANGE_XFERS_CF),tokenBytes);
  }
}
