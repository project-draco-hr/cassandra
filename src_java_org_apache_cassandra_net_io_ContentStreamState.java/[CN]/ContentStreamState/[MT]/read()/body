{
  SocketChannel socketChannel=stream_.getStream();
  InetSocketAddress remoteAddress=(InetSocketAddress)socketChannel.socket().getRemoteSocketAddress();
  createFileChannel();
  if (streamContext_ != null) {
    try {
      bytesRead_+=fc_.transferFrom(socketChannel,bytesRead_,ContentStreamState.count_);
      if (bytesRead_ != streamContext_.getExpectedBytes())       return null;
    }
 catch (    IOException ex) {
      streamStatus_.setAction(StreamContextManager.StreamCompletionAction.STREAM);
      handleStreamCompletion(remoteAddress.getAddress());
      File file=new File(streamContext_.getTargetFile());
      file.delete();
      throw ex;
    }
    if (bytesRead_ == streamContext_.getExpectedBytes()) {
      if (logger_.isDebugEnabled())       logger_.debug("Removing stream context " + streamContext_);
      fc_.close();
      handleStreamCompletion(remoteAddress.getAddress());
      bytesRead_=0L;
      morphState();
    }
  }
  return new byte[0];
}
