{
  if (keyspace == null || keyspace.toString().equals(Table.SYSTEM_TABLE))   throw newInvalidRequestException("There is no ring for the keyspace: " + keyspace);
  List<TokenRange> ranges=new ArrayList<TokenRange>();
  Token.TokenFactory<?> tf=StorageService.getPartitioner().getTokenFactory();
  for (  Map.Entry<Range,List<String>> entry : StorageService.instance.getRangeToEndpointMap(keyspace.toString()).entrySet()) {
    Range range=entry.getKey();
    List<String> endpoints=entry.getValue();
    ranges.add(newTokenRange(tf.toString(range.left),tf.toString(range.right),endpoints));
  }
  return ranges;
}
