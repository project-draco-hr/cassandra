{
  Map<DecoratedKey<?>,ColumnFamily> columnFamilies=readColumnFamily(commands,consistencyLevel);
  Map<ByteBuffer,GenericArray<ColumnOrSuperColumn>> columnFamiliesMap=new HashMap<ByteBuffer,GenericArray<ColumnOrSuperColumn>>();
  for (  ReadCommand cmd : commands) {
    ColumnFamily cf=columnFamilies.get(StorageService.getPartitioner().decorateKey(cmd.key));
    boolean reverseOrder=cmd instanceof SliceFromReadCommand && ((SliceFromReadCommand)cmd).reversed;
    GenericArray<ColumnOrSuperColumn> avroColumns=avronateColumnFamily(cf,cmd.queryPath.superColumnName != null,reverseOrder);
    columnFamiliesMap.put(ByteBuffer.wrap(cmd.key),avroColumns);
  }
  return columnFamiliesMap;
}
