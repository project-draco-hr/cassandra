{
  if (logger.isDebugEnabled())   logger.debug("scan");
  try {
    clientState.hasKeyspaceAccess(Permission.READ_VALUE);
  }
 catch (  org.apache.cassandra.thrift.InvalidRequestException thriftE) {
    throw newInvalidRequestException(thriftE);
  }
  String keyspace=clientState.getKeyspace();
  AvroValidation.validateColumnParent(keyspace,column_parent);
  AvroValidation.validatePredicate(keyspace,column_parent,column_predicate);
  AvroValidation.validateIndexClauses(keyspace,column_parent.column_family.toString(),index_clause);
  List<Row> rows;
  try {
    rows=StorageProxy.scan(keyspace.toString(),column_parent.column_family.toString(),thriftIndexClause(index_clause),thriftSlicePredicate(column_predicate),thriftConsistencyLevel(consistency_level));
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  TimeoutException e) {
    throw new TimedOutException();
  }
  return avronateKeySlices(rows,column_parent,column_predicate);
}
