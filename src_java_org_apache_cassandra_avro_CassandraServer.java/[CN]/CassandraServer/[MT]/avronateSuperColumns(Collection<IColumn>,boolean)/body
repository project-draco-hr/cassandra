{
  ArrayList<ColumnOrSuperColumn> avroSuperColumns=new ArrayList<ColumnOrSuperColumn>(columns.size());
  for (  IColumn column : columns) {
    GenericArray<Column> subColumns=avronateSubColumns(column.getSubColumns());
    if (subColumns.size() == 0)     continue;
    SuperColumn superColumn=newSuperColumn(column.name(),subColumns);
    avroSuperColumns.add(newColumnOrSuperColumn(superColumn));
  }
  if (reverseOrder)   Collections.reverse(avroSuperColumns);
  GenericArray<ColumnOrSuperColumn> avroArray=new GenericData.Array<ColumnOrSuperColumn>(avroSuperColumns.size(),Schema.createArray(ColumnOrSuperColumn.SCHEMA$));
  for (  ColumnOrSuperColumn cosc : avroSuperColumns)   avroArray.add(cosc);
  return avroArray;
}
