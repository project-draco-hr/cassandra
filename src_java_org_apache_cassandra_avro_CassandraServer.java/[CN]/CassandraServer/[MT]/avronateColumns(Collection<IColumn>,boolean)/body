{
  ArrayList<ColumnOrSuperColumn> avroColumns=new ArrayList<ColumnOrSuperColumn>(columns.size());
  for (  IColumn column : columns) {
    if (column.isMarkedForDelete())     continue;
    Column avroColumn=newColumn(column.name(),column.value(),avronateIClock(column.clock()));
    if (column instanceof ExpiringColumn)     avroColumn.ttl=((ExpiringColumn)column).getTimeToLive();
    avroColumns.add(newColumnOrSuperColumn(avroColumn));
  }
  if (reverseOrder)   Collections.reverse(avroColumns);
  GenericArray<ColumnOrSuperColumn> avroArray=new GenericData.Array<ColumnOrSuperColumn>(avroColumns.size(),Schema.createArray(ColumnOrSuperColumn.SCHEMA$));
  for (  ColumnOrSuperColumn cosc : avroColumns)   avroArray.add(cosc);
  return avroArray;
}
