{
  KSMetaData ksMetadata=DatabaseDescriptor.getTableDefinition(keyspace.toString());
  if (ksMetadata == null)   throw new NotFoundException();
  KsDef ksDef=new KsDef();
  ksDef.name=keyspace;
  ksDef.replication_factor=ksMetadata.replicationFactor;
  ksDef.strategy_class=ksMetadata.strategyClass.getName();
  if (ksMetadata.strategyOptions != null) {
    ksDef.strategy_options=new HashMap<CharSequence,CharSequence>();
    ksDef.strategy_options.putAll(ksMetadata.strategyOptions);
  }
  GenericArray<CfDef> cfDefs=new GenericData.Array<CfDef>(ksMetadata.cfMetaData().size(),Schema.createArray(CfDef.SCHEMA$));
  for (  CFMetaData cfm : ksMetadata.cfMetaData().values()) {
    cfDefs.add(CFMetaData.convertToAvro(cfm));
  }
  ksDef.cf_defs=cfDefs;
  return ksDef;
}
