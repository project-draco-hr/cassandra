{
  String keyspaceStr=keyspace.toString();
  if (DatabaseDescriptor.getTableDefinition(keyspaceStr) == null) {
    throw newInvalidRequestException("Keyspace does not exist");
  }
  if (this.curKeyspace.get() != null && !this.curKeyspace.get().equals(keyspaceStr))   loginDone.set(AccessLevel.NONE);
  this.curKeyspace.set(keyspaceStr);
  if (DatabaseDescriptor.getRequestSchedulerId().equals(Config.RequestSchedulerId.keyspace)) {
    requestSchedulerId.set(curKeyspace.get());
  }
  return null;
}
