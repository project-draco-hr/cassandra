{
  if (oldCell.equals(cell))   return;
  for (  SecondaryIndex index : indexFor(cell.column())) {
    if (index instanceof PerColumnSecondaryIndex) {
      if (cell.isLive(nowInSec)) {
        ((PerColumnSecondaryIndex)index).update(update.partitionKey().getKey(),clustering,oldCell,cell,opGroup,nowInSec);
      }
 else {
        if (shouldCleanupOldValue(oldCell,cell))         ((PerColumnSecondaryIndex)index).delete(update.partitionKey().getKey(),clustering,oldCell,opGroup,nowInSec);
      }
    }
  }
}
