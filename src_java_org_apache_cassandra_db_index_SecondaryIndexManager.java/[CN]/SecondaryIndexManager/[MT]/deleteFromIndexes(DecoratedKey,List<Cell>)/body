{
  Set<Class<? extends SecondaryIndex>> cleanedRowLevelIndexes=null;
  for (  Cell cell : indexedColumnsInRow) {
    SecondaryIndex index=indexesByColumn.get(cell.name().toByteBuffer());
    if (index == null)     continue;
    if (index instanceof PerRowSecondaryIndex) {
      if (cleanedRowLevelIndexes == null)       cleanedRowLevelIndexes=new HashSet<>();
      if (cleanedRowLevelIndexes.add(index.getClass()))       ((PerRowSecondaryIndex)index).delete(key);
    }
 else {
      ((PerColumnSecondaryIndex)index).delete(key.key,cell);
    }
  }
}
