{
  Set<Class<? extends SecondaryIndex>> cleanedRowLevelIndexes=null;
  for (  Column column : indexedColumnsInRow) {
    for (    SecondaryIndex index : indexFor(column.name())) {
      if (index instanceof PerRowSecondaryIndex) {
        if (cleanedRowLevelIndexes == null)         cleanedRowLevelIndexes=new HashSet<>();
        if (cleanedRowLevelIndexes.add(index.getClass()))         ((PerRowSecondaryIndex)index).delete(key);
      }
 else {
        ((PerColumnSecondaryIndex)index).delete(key.key,column);
      }
    }
  }
}
