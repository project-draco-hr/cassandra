{
  Set<Class<? extends SecondaryIndex>> appliedRowLevelIndexes=null;
  for (  SecondaryIndex index : allIndexes) {
    if (index instanceof PerRowSecondaryIndex) {
      if (appliedRowLevelIndexes == null)       appliedRowLevelIndexes=new HashSet<>();
      if (appliedRowLevelIndexes.add(index.getClass()))       ((PerRowSecondaryIndex)index).index(key,cf);
    }
 else {
      for (      Cell cell : cf)       if (cell.isLive() && index.indexes(cell.name()))       ((PerColumnSecondaryIndex)index).insert(key,cell,opGroup);
    }
  }
}
