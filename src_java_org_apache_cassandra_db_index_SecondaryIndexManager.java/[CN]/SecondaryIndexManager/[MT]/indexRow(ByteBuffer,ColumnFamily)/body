{
  Set<Class<? extends SecondaryIndex>> appliedRowLevelIndexes=null;
  for (  SecondaryIndex index : allIndexes) {
    if (index instanceof PerRowSecondaryIndex) {
      if (appliedRowLevelIndexes == null)       appliedRowLevelIndexes=new HashSet<>();
      if (appliedRowLevelIndexes.add(index.getClass()))       ((PerRowSecondaryIndex)index).index(key,cf);
    }
 else {
      for (      Column column : cf)       if (column.isLive(System.currentTimeMillis()) && index.indexes(column.name()))       ((PerColumnSecondaryIndex)index).insert(key,column);
    }
  }
}
