{
  Set<Class<? extends SecondaryIndex>> appliedRowLevelIndexes=null;
  for (  SecondaryIndex index : indexesByColumn.values()) {
    if (index instanceof PerRowSecondaryIndex) {
      if (appliedRowLevelIndexes == null)       appliedRowLevelIndexes=new HashSet<>();
      if (appliedRowLevelIndexes.add(index.getClass()))       ((PerRowSecondaryIndex)index).index(key,cf);
    }
 else {
      for (      Cell cell : cf)       if (index.indexes(cell.name()))       ((PerColumnSecondaryIndex)index).insert(key,cell);
    }
  }
}
