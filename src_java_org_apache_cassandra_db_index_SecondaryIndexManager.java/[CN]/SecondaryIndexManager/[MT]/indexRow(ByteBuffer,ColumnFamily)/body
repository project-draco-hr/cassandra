{
  Set<Class<? extends SecondaryIndex>> appliedRowLevelIndexes=null;
  for (  SecondaryIndex index : indexesByColumn.values()) {
    if (index instanceof PerRowSecondaryIndex) {
      if (appliedRowLevelIndexes == null)       appliedRowLevelIndexes=new HashSet<Class<? extends SecondaryIndex>>();
      if (appliedRowLevelIndexes.add(index.getClass()))       ((PerRowSecondaryIndex)index).index(key,cf);
    }
 else {
      for (      IColumn column : cf) {
        if (column.isLive() && index.indexes(column.name()))         ((PerColumnSecondaryIndex)index).insert(key,column);
      }
    }
  }
}
