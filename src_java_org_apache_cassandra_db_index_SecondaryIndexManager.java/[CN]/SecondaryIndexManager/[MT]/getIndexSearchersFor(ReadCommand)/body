{
  Map<String,Set<ColumnDefinition>> groupByIndexType=new HashMap<>();
  for (  RowFilter.Expression e : command.rowFilter()) {
    SecondaryIndex index=getIndexForColumn(e.column());
    if (index == null || !index.supportsOperator(e.operator()))     continue;
    Set<ColumnDefinition> columns=groupByIndexType.get(index.indexTypeForGrouping());
    if (columns == null) {
      columns=new HashSet<>();
      groupByIndexType.put(index.indexTypeForGrouping(),columns);
    }
    columns.add(e.column());
  }
  List<SecondaryIndexSearcher> indexSearchers=new ArrayList<>(groupByIndexType.size());
  for (  Set<ColumnDefinition> column : groupByIndexType.values())   indexSearchers.add(getIndexForColumn(column.iterator().next()).createSecondaryIndexSearcher(column));
  return indexSearchers;
}
