{
  CommitLog.instance.resetUnsafe();
  boolean prevAutoSnapshot=DatabaseDescriptor.isAutoSnapshot();
  DatabaseDescriptor.setAutoSnapshot(false);
  Keyspace notDurableKs=Keyspace.open("NoCommitlogSpace");
  Assert.assertFalse(notDurableKs.getMetadata().durableWrites);
  ColumnFamilyStore cfs=notDurableKs.getColumnFamilyStore("Standard1");
  RowMutation rm;
  DecoratedKey dk=Util.dk("key1");
  rm=new RowMutation("NoCommitlogSpace",dk.key);
  rm.add("Standard1",ByteBufferUtil.bytes("Column1"),ByteBufferUtil.bytes("abcd"),0);
  rm.apply();
  ReadCommand command=new SliceByNamesReadCommand("Keyspace1",dk.key,"Standard1",System.currentTimeMillis(),new NamesQueryFilter(FBUtilities.singleton(ByteBufferUtil.bytes("Column1"),cfs.getComparator())));
  Row row=command.getRow(notDurableKs);
  Column col=row.cf.getColumn(ByteBufferUtil.bytes("Column1"));
  Assert.assertEquals(col.value(),ByteBuffer.wrap("abcd".getBytes()));
  cfs.truncateBlocking();
  DatabaseDescriptor.setAutoSnapshot(prevAutoSnapshot);
  row=command.getRow(notDurableKs);
  Assert.assertEquals(null,row.cf);
}
