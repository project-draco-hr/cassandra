{
  createTable("CREATE TABLE %s (key text, clustering int, a int, s int static, PRIMARY KEY(key, clustering))");
  CFMetaData cfm=currentTableMetadata();
  long timestamp=FBUtilities.timestampMicros();
  PartitionUpdate update=new RowUpdateBuilder(cfm,timestamp,"key0").clustering(1).add("a",1).buildUpdate();
  Assert.assertEquals(1,update.operationCount());
  update=new RowUpdateBuilder(cfm,timestamp,"key0").buildUpdate();
  Assert.assertEquals(0,update.operationCount());
  update=new RowUpdateBuilder(cfm,timestamp,"key0").add("s",1).buildUpdate();
  Assert.assertEquals(1,update.operationCount());
  update=new RowUpdateBuilder(cfm,timestamp,"key0").add("s",1).buildUpdate();
  update=new RowUpdateBuilder(update,timestamp,cfm.params.defaultTimeToLive).clustering(1).add("a",1).buildUpdate();
  Assert.assertEquals(2,update.operationCount());
}
