{
  Map<Pair<String,ByteBuffer>,Mutation> groupedMutations=new HashMap<>();
  for (  Mutation mutation : mutations) {
    Pair<String,ByteBuffer> key=Pair.create(mutation.getKeyspaceName(),mutation.key());
    Mutation current=groupedMutations.get(key);
    if (current == null) {
      groupedMutations.put(key,mutation.copy());
    }
 else {
      current.addAll(mutation);
    }
  }
  return groupedMutations.values();
}
