{
  if (FBUtilities.isWindows())   WindowsTimer.startTimerPeriod(1);
  final StressSettings settings;
  try {
    settings=StressSettings.parse(arguments);
  }
 catch (  IllegalArgumentException e) {
    printHelpMessage();
    e.printStackTrace();
    return;
  }
  PrintStream logout=settings.log.getOutput();
  if (settings.sendToDaemon != null) {
    Socket socket=new Socket(settings.sendToDaemon,2159);
    ObjectOutputStream out=new ObjectOutputStream(socket.getOutputStream());
    BufferedReader inp=new BufferedReader(new InputStreamReader(socket.getInputStream()));
    Runtime.getRuntime().addShutdownHook(new ShutDown(socket,out));
    out.writeObject(settings);
    String line;
    try {
      while (!socket.isClosed() && (line=inp.readLine()) != null) {
        if (line.equals("END") || line.equals("FAILURE")) {
          out.writeInt(1);
          break;
        }
        logout.println(line);
      }
    }
 catch (    SocketException e) {
      if (!stopped)       e.printStackTrace();
    }
    out.close();
    inp.close();
    socket.close();
  }
 else {
    StressAction stressAction=new StressAction(settings,logout);
    stressAction.run();
  }
  if (FBUtilities.isWindows())   WindowsTimer.endTimerPeriod(1);
  System.exit(0);
}
