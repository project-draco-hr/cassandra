{
  int replicas=DatabaseDescriptor.getReplicationFactor(table);
  List<Token> tokens=metadata.sortedTokens();
  ArrayList<InetAddress> endpoints=new ArrayList<InetAddress>(replicas);
  if (tokens.isEmpty())   return endpoints;
  Iterator<Token> iter=TokenMetadata.ringIterator(tokens,token);
  while (endpoints.size() < replicas && iter.hasNext()) {
    endpoints.add(metadata.getEndpoint(iter.next()));
  }
  return endpoints;
}
