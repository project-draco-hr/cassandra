{
  if (!record.isValid())   return true;
  if (record.type == Type.UNKNOWN) {
    record.error(String.format("Could not parse record [%s]",record));
    return true;
  }
  if (record.checksum != record.computeChecksum()) {
    record.error(String.format("Invalid checksum for sstable [%s], record [%s]: [%d] should have been [%d]",record.relativeFilePath,record,record.checksum,record.computeChecksum()));
    return true;
  }
  if (record.type != Type.REMOVE)   return false;
  List<File> files=record.getExistingFiles(folder);
  record.onDiskRecord=LogRecord.make(record.type,files,0,record.relativeFilePath);
  if (record.updateTime != record.onDiskRecord.updateTime && record.onDiskRecord.numFiles > 0) {
    record.error(String.format("Unexpected files detected for sstable [%s], record [%s]: last update time [%tT] should have been [%tT]",record.relativeFilePath,record,record.onDiskRecord.updateTime,record.updateTime));
    return true;
  }
  return false;
}
