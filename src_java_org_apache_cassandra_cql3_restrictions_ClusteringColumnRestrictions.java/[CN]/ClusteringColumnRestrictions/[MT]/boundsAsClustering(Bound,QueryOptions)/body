{
  MultiCBuilder builder=MultiCBuilder.create(comparator,hasIN() || hasMultiColumnSlice());
  int keyPosition=0;
  for (  SingleRestriction r : restrictions) {
    if (handleInFilter(r,keyPosition))     break;
    if (r.isSlice()) {
      r.appendBoundTo(builder,bound,options);
      return builder.buildBoundForSlice(bound.isStart(),r.isInclusive(bound),r.isInclusive(bound.reverse()),r.getColumnDefs());
    }
    r.appendBoundTo(builder,bound,options);
    if (builder.hasMissingElements())     return BTreeSet.empty(comparator);
    keyPosition=r.getLastColumn().position() + 1;
  }
  return builder.buildBound(bound.isStart(),true);
}
