{
  while (true) {
    try {
      return attemptList();
    }
 catch (    Throwable t) {
      if (attempts >= MAX_ATTEMPTS)       throw new RuntimeException(String.format("Failed to list files in %s after multiple attempts, giving up",folder),t);
      logger.warn("Failed to list files in {} : {}",folder,t.getMessage());
      try {
        Thread.sleep(REATTEMPT_DELAY_MILLIS);
      }
 catch (      InterruptedException e) {
        logger.error("Interrupted whilst waiting to reattempt listing files in {}, giving up",folder,e);
        throw new RuntimeException(String.format("Failed to list files in %s due to interruption, giving up",folder),t);
      }
    }
  }
}
