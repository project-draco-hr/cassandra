{
  Matcher matcher=LINE_REGEX.matcher(line);
  if (!matcher.matches() || matcher.groupCount() != 2) {
    handleReadRecordError(String.format("cannot parse line \"%s\"",line),isLast);
    return Record.make(line,isLast);
  }
  byte[] bytes=matcher.group(1).getBytes();
  checksum.update(bytes,0,bytes.length);
  if (checksum.getValue() != Long.valueOf(matcher.group(2)))   handleReadRecordError(String.format("invalid line checksum %s for \"%s\"",matcher.group(2),line),isLast);
  try {
    return Record.make(matcher.group(1),isLast);
  }
 catch (  Throwable t) {
    throw new CorruptTransactionLogException(String.format("Cannot make record \"%s\": %s",line,t.getMessage()),this);
  }
}
