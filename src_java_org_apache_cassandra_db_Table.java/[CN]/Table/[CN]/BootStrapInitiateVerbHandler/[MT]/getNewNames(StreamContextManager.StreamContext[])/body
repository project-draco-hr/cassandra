{
  Map<String,String> fileNames=new HashMap<String,String>();
  Set<String> distinctEntries=new HashSet<String>();
  for (  StreamContextManager.StreamContext streamContext : streamContexts) {
    String[] peices=FBUtilities.strip(streamContext.getTargetFile(),"-");
    distinctEntries.add(peices[0] + "-" + peices[1]+ "-"+ peices[2]);
  }
  for (  String distinctEntry : distinctEntries) {
    String tableName;
    String[] peices=FBUtilities.strip(distinctEntry,"-");
    tableName=peices[0];
    Table table=Table.open(tableName);
    Map<String,ColumnFamilyStore> columnFamilyStores=table.getColumnFamilyStores();
    ColumnFamilyStore cfStore=columnFamilyStores.get(peices[1]);
    logger_.debug("Generating file name for " + distinctEntry + " ...");
    fileNames.put(distinctEntry,cfStore.getNextFileName());
  }
  return fileNames;
}
