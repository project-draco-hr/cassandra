{
  Map<String,String> fileNames=new HashMap<String,String>();
  Set<String> distinctEntries=new HashSet<String>();
  for (  StreamContextManager.StreamContext streamContext : streamContexts) {
    String[] pieces=FBUtilities.strip(new File(streamContext.getTargetFile()).getName(),"-");
    distinctEntries.add(streamContext.getTable() + "-" + pieces[0]+ "-"+ pieces[1]);
  }
  for (  String distinctEntry : distinctEntries) {
    String tableName;
    String[] peices=FBUtilities.strip(distinctEntry,"-");
    tableName=peices[0];
    Table table=Table.open(tableName);
    Map<String,ColumnFamilyStore> columnFamilyStores=table.getColumnFamilyStores();
    ColumnFamilyStore cfStore=columnFamilyStores.get(peices[1]);
    if (logger_.isDebugEnabled())     logger_.debug("Generating file name for " + distinctEntry + " ...");
    fileNames.put(distinctEntry,cfStore.getTempSSTableFileName());
  }
  return fileNames;
}
