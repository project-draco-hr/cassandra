{
  while (iter.hasNext()) {
    DecoratedKey<?> key=iter.next();
    logger.debug("Indexing row {} ",key);
    List<Memtable> memtablesToFlush=Collections.emptyList();
synchronized (indexLockFor(key.key)) {
      ColumnFamily cf=readCurrentIndexedColumns(key,cfs,columns);
      if (cf != null)       memtablesToFlush=applyIndexUpdates(key.key,cf,cfs,cf.getColumnNames(),null);
    }
    for (    Memtable memtable : memtablesToFlush)     memtable.cfs.maybeSwitchMemtable(memtable,false);
  }
  try {
    iter.close();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
