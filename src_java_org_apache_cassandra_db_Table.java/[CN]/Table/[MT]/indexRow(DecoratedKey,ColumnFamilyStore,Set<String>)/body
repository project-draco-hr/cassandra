{
  if (logger.isDebugEnabled())   logger.debug("Indexing row {} ",cfs.metadata.getKeyValidator().getString(key.key));
  switchLock.readLock().lock();
  try {
    SliceQueryPager pager=new SliceQueryPager(cfs,key,ColumnSlice.ALL_COLUMNS_ARRAY);
    while (pager.hasNext()) {
synchronized (cfs.table.indexLockFor(key.key)) {
        ColumnFamily cf=pager.next();
        ColumnFamily cf2=cf.cloneMeShallow();
        for (        IColumn column : cf) {
          if (cfs.indexManager.indexes(column.name(),idxNames))           cf2.addColumn(column);
        }
        cfs.indexManager.applyIndexUpdates(key.key,cf2,cf2.getColumnNames(),null);
      }
    }
  }
  finally {
    switchLock.readLock().unlock();
  }
}
