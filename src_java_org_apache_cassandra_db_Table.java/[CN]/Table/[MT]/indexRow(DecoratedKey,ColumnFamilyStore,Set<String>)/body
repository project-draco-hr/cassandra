{
  if (logger.isDebugEnabled())   logger.debug("Indexing row {} ",cfs.metadata.getKeyValidator().getString(key.key));
  Collection<SecondaryIndex> indexes=cfs.indexManager.getIndexesByNames(idxNames);
  switchLock.readLock().lock();
  try {
    SliceQueryPager pager=new SliceQueryPager(cfs,key,ColumnSlice.ALL_COLUMNS_ARRAY);
    while (pager.hasNext()) {
synchronized (cfs.table.indexLockFor(key.key)) {
        ColumnFamily cf=pager.next();
        ColumnFamily cf2=cf.cloneMeShallow();
        for (        Column column : cf) {
          if (cfs.indexManager.indexes(column.name(),indexes))           cf2.addColumn(column);
        }
        cfs.indexManager.indexRow(key.key,cf2);
      }
    }
  }
  finally {
    switchLock.readLock().unlock();
  }
}
