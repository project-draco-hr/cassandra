{
  Directories.DataDirectory directory;
  directory=getDirectory();
  if (directory == null)   directory=getDirectories().getWriteableLocation(writeSize);
  if (directory == null)   throw new RuntimeException(String.format("Insufficient disk space to write %s",FBUtilities.prettyPrintMemory(writeSize)));
  return directory;
}
