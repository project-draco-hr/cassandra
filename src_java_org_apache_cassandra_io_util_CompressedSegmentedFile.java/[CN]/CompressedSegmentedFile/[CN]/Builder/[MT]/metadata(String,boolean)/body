{
  if (writer == null)   return CompressionMetadata.create(path);
 else   if (early)   return writer.openEarly();
 else   return writer.openAfterClose();
}
