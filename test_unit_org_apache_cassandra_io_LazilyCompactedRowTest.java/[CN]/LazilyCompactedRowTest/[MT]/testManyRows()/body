{
  CompactionManager.instance.disableAutoCompaction();
  Table table=Table.open("Keyspace1");
  ColumnFamilyStore cfs=table.getColumnFamilyStore("Standard1");
  final int ROWS_PER_SSTABLE=10;
  for (int j=0; j < (DatabaseDescriptor.getIndexInterval() * 3) / ROWS_PER_SSTABLE; j++) {
    for (int i=0; i < ROWS_PER_SSTABLE; i++) {
      ByteBuffer key=ByteBuffer.wrap(String.valueOf(i % 2).getBytes());
      RowMutation rm=new RowMutation("Keyspace1",key);
      rm.add(new QueryPath("Standard1",null,ByteBuffer.wrap(String.valueOf(i / 2).getBytes())),ByteBufferUtil.EMPTY_BYTE_BUFFER,j * ROWS_PER_SSTABLE + i);
      rm.apply();
    }
    cfs.forceBlockingFlush();
  }
  assertBytes(cfs,Integer.MAX_VALUE,true);
  assertDigest(cfs,Integer.MAX_VALUE,true);
}
