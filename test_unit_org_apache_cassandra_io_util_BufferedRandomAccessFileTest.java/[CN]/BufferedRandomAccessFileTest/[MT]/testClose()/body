{
  BufferedRandomAccessFile file=createTempFile("brafClose");
  byte[] data=new byte[BufferedRandomAccessFile.DEFAULT_BUFFER_SIZE + 20];
  for (int i=0; i < data.length; i++) {
    data[i]='c';
  }
  file.write(data);
  file.close();
  file.read();
  file.write(new byte[1]);
  BufferedRandomAccessFile copy=new BufferedRandomAccessFile(file.getPath(),"r");
  ByteBuffer contents=copy.readBytes((int)copy.length());
  assertEquals(contents.limit(),data.length);
  assertEquals(ByteBufferUtil.compare(contents,data),0);
}
