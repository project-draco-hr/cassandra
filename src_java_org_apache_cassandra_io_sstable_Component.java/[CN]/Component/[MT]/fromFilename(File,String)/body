{
  Pair<Descriptor,String> path=Descriptor.fromFilename(directory,name);
  String repr=path.right;
  int id=-1;
  int separatorPos=repr.indexOf(separator);
  if (separatorPos != -1) {
    id=Integer.parseInt(repr.substring(0,separatorPos));
    repr=repr.substring(separatorPos + 1,repr.length());
  }
  Type type=Type.fromRepresentation(repr);
  Component component;
switch (type) {
case DATA:
    component=Component.DATA;
  break;
case PRIMARY_INDEX:
component=Component.PRIMARY_INDEX;
break;
case FILTER:
component=Component.FILTER;
break;
case COMPACTED_MARKER:
component=Component.COMPACTED_MARKER;
break;
case COMPRESSION_INFO:
component=Component.COMPRESSION_INFO;
break;
case STATS:
component=Component.STATS;
break;
case BITMAP_INDEX:
component=new Component(type,id);
break;
default :
throw new IllegalStateException();
}
return new Pair<Descriptor,Component>(path.left,component);
}
