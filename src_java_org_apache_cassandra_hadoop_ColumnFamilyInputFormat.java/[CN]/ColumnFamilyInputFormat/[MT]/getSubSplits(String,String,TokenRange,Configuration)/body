{
  int splitsize=ConfigHelper.getInputSplitSize(conf);
  for (  String host : range.endpoints) {
    try {
      Cassandra.Client client=createConnection(host,ConfigHelper.getRpcPort(conf),true);
      client.set_keyspace(keyspace);
      return client.describe_splits(cfName,range.start_token,range.end_token,splitsize);
    }
 catch (    IOException e) {
      logger.debug("failed connect to endpoint " + host,e);
    }
catch (    TException e) {
      throw new RuntimeException(e);
    }
catch (    InvalidRequestException e) {
      throw new RuntimeException(e);
    }
  }
  throw new IOException("failed connecting to all endpoints " + StringUtils.join(range.endpoints,","));
}
