{
  try {
    String str=cb.toString(cb.readerIndex(),length,CharsetUtil.UTF_8);
    cb.readerIndex(cb.readerIndex() + length);
    return str;
  }
 catch (  IllegalStateException e) {
    if (e.getCause() instanceof CharacterCodingException)     throw new ProtocolException("Cannot decode string as UTF8");
 else     throw e;
  }
}
