{
  Set<ByteBuffer> buffers=new TreeSet<ByteBuffer>(comparator);
  for (  Term t : elements) {
    ByteBuffer bytes=t.bindAndGet(values);
    if (bytes == null)     throw new InvalidRequestException("null is not supported inside collections");
    if (bytes.remaining() > FBUtilities.MAX_UNSIGNED_SHORT)     throw new InvalidRequestException(String.format("Set value is too long. Set values are limited to %d bytes but %d bytes value provided",FBUtilities.MAX_UNSIGNED_SHORT,bytes.remaining()));
    buffers.add(bytes);
  }
  return new Value(buffers);
}
