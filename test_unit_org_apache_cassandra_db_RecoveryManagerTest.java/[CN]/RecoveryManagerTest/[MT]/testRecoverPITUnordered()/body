{
  Date date=CommitLogArchiver.format.parse("2112:12:12 12:12:12");
  long timeMS=date.getTime();
  Keyspace keyspace1=Keyspace.open("Keyspace1");
  DecoratedKey dk=Util.dk("dkey");
  for (int i=0; i < 10; ++i) {
    long ts;
    if (i == 9)     ts=TimeUnit.MILLISECONDS.toMicros(timeMS - 1000);
 else     ts=TimeUnit.MILLISECONDS.toMicros(timeMS + (i * 1000));
    ColumnFamily cf=ArrayBackedSortedColumns.factory.create("Keyspace1","Standard1");
    cf.addColumn(column("name-" + i,"value",ts));
    RowMutation rm=new RowMutation("Keyspace1",dk.key,cf);
    rm.apply();
  }
  ColumnFamily cf=Util.getColumnFamily(keyspace1,dk,"Standard1");
  Assert.assertEquals(10,cf.getColumnCount());
  keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
  CommitLog.instance.resetUnsafe();
  CommitLog.instance.recover();
  cf=Util.getColumnFamily(keyspace1,dk,"Standard1");
  Assert.assertEquals(2,cf.getColumnCount());
}
