{
  List<ListenableFuture<?>> tasks=new ArrayList<>(neighbors.size() + 1);
  for (  InetAddress neighbor : neighbors) {
    AnticompactionTask task=new AnticompactionTask(parentSession,neighbor,doAntiCompaction);
    tasks.add(task);
    task.run();
  }
  if (doAntiCompaction) {
    tasks.add(doAntiCompaction(parentSession));
  }
 else {
    removeParentRepairSession(parentSession);
  }
  return Futures.successfulAsList(tasks);
}
