{
  List<InetAddress> allEndpoints=new ArrayList<InetAddress>(endpoints);
  allEndpoints.add(FBUtilities.getBroadcastAddress());
  if (isSequential)   makeSnapshots(endpoints);
  int gcBefore=(int)(System.currentTimeMillis() / 1000) - Table.open(tablename).getColumnFamilyStore(cfname).metadata.getGcGraceSeconds();
  for (  InetAddress endpoint : allEndpoints)   treeRequests.add(new TreeRequest(getName(),endpoint,range,gcBefore,new CFPair(tablename,cfname)));
  logger.info(String.format("[repair #%s] requesting merkle trees for %s (to %s)",getName(),cfname,allEndpoints));
  treeRequests.start();
  requestsSent.signalAll();
}
