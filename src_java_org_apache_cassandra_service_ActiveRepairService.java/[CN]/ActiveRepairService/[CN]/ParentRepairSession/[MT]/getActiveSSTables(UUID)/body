{
  if (failed)   return Collections.emptySet();
  if (!columnFamilyStores.containsKey(cfId))   return null;
  Set<String> repairedSSTables=sstableMap.get(cfId);
  Set<SSTableReader> activeSSTables=new HashSet<>();
  Set<String> activeSSTableNames=new HashSet<>();
  for (  SSTableReader sstable : columnFamilyStores.get(cfId).getSSTables()) {
    if (repairedSSTables.contains(sstable.getFilename())) {
      activeSSTables.add(sstable);
      activeSSTableNames.add(sstable.getFilename());
    }
  }
  sstableMap.put(cfId,activeSSTableNames);
  return activeSSTables;
}
