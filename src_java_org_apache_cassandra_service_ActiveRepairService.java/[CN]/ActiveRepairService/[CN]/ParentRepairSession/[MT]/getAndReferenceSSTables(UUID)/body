{
  Set<SSTableReader> sstables=sstableMap.get(cfId);
  Iterator<SSTableReader> sstableIterator=sstables.iterator();
  ImmutableMap.Builder<SSTableReader,Ref> references=ImmutableMap.builder();
  while (sstableIterator.hasNext()) {
    SSTableReader sstable=sstableIterator.next();
    if (!new File(sstable.descriptor.filenameFor(Component.DATA)).exists()) {
      sstableIterator.remove();
    }
 else {
      Ref ref=sstable.tryRef();
      if (ref == null)       sstableIterator.remove();
 else       references.put(sstable,ref);
    }
  }
  return new Refs<>(references.build());
}
