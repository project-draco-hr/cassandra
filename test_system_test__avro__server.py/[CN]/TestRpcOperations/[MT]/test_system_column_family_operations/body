def test_system_column_family_operations(self):
    'adding, renaming, and removing column families'
    self.__set_keyspace('Keyspace1')
    columnDef = dict()
    columnDef['name'] = 'ValidationColumn'
    columnDef['validation_class'] = 'BytesType'
    cfDef = dict()
    cfDef['keyspace'] = 'Keyspace1'
    cfDef['name'] = 'NewColumnFamily'
    cfDef['column_metadata'] = [columnDef]
    s = self.client.request('system_add_column_family', {'cf_def': cfDef, })
    assert isinstance(s, unicode), ("returned type is %s, (not 'unicode')" % type(s))
    ks1 = self.client.request('describe_keyspace', {'keyspace': 'Keyspace1', })
    assert ('NewColumnFamily' in [x['name'] for x in ks1['cf_defs']])
    self.client.request('system_rename_column_family', {'old_name': 'NewColumnFamily', 'new_name': 'RenameColumnFamily', })
    ks1 = self.client.request('describe_keyspace', {'keyspace': 'Keyspace1', })
    assert ('RenameColumnFamily' in [x['name'] for x in ks1['cf_defs']])
    self.client.request('system_drop_column_family', {'column_family': 'RenameColumnFamily', })
    ks1 = self.client.request('describe_keyspace', {'keyspace': 'Keyspace1', })
    assert ('RenameColumnFamily' not in [x['name'] for x in ks1['cf_defs']])
    assert ('NewColumnFamily' not in [x['name'] for x in ks1['cf_defs']])
    assert ('Standard1' in [x['name'] for x in ks1['cf_defs']])
