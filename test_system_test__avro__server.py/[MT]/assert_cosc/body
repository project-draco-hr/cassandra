def assert_cosc(thing, with_supercolumn=False):
    containing = ((with_supercolumn and 'super_column') or 'column')
    assert isinstance(thing, dict), ('Expected dict, got %s' % type(thing))
    assert (thing.has_key(containing) and thing[containing].has_key('name')), ('Invalid or missing "%s"' % containing)
