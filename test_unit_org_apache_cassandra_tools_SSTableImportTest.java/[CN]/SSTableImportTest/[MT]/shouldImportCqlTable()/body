{
  String cql_keyspace="cql_keyspace";
  String cql_table="table1";
  String jsonUrl=resourcePath("CQLTable.json");
  File tempSS=tempSSTableFile(cql_keyspace,cql_table);
  new SSTableImport(true).importJson(jsonUrl,cql_keyspace,cql_table,tempSS.getPath());
  SSTableReader reader=SSTableReader.open(Descriptor.fromFilename(tempSS.getPath()));
  Keyspace.open(cql_keyspace).getColumnFamilyStore(cql_table).addSSTable(reader);
  UntypedResultSet result=QueryProcessor.executeOnceInternal(String.format("SELECT * FROM %s.%s",cql_keyspace,cql_table));
  assertThat(result.size(),is(2));
  assertThat(result,hasItem(withElements(1,"NY",1980)));
  assertThat(result,hasItem(withElements(2,"CA",2014)));
  reader.selfRef().release();
}
