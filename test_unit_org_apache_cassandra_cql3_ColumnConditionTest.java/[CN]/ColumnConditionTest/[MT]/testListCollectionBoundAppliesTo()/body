{
  ColumnDefinition definition=new ColumnDefinition("ks","cf",new ColumnIdentifier("c",true),ListType.getInstance(Int32Type.instance),null,null,null,null,null);
  ColumnCondition condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Relation.Type.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Relation.Type.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Relation.Type.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Relation.Type.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Relation.Type.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Relation.Type.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}
