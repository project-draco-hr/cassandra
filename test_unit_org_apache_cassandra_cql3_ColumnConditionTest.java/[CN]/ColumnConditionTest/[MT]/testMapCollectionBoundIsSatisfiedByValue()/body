{
  ColumnDefinition definition=new ColumnDefinition("ks","cf",new ColumnIdentifier("b",true),MapType.getInstance(Int32Type.instance,Int32Type.instance),null,null,null,null,null);
  Map<ByteBuffer,ByteBuffer> placeholderMap=new TreeMap<>();
  placeholderMap.put(ONE,ONE);
  Maps.Value placeholder=new Maps.Value(placeholderMap);
  ColumnCondition condition=ColumnCondition.condition(definition,null,placeholder,Relation.Type.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Relation.Type.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Relation.Type.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Relation.Type.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Relation.Type.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Relation.Type.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}
