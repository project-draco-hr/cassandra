{
  if (queryStatements == null) {
synchronized (this) {
      if (queryStatements == null) {
        try {
          JavaDriverClient jclient=settings.getJavaDriverClient();
          ThriftClient tclient=settings.getThriftClient();
          Map<String,PreparedStatement> stmts=new HashMap<>();
          Map<String,Integer> tids=new HashMap<>();
          for (          Map.Entry<String,String> e : queries.entrySet()) {
            stmts.put(e.getKey().toLowerCase(),jclient.prepare(e.getValue()));
            tids.put(e.getKey().toLowerCase(),tclient.prepare_cql3_query(e.getValue(),Compression.NONE));
          }
          thriftQueryIds=tids;
          queryStatements=stmts;
        }
 catch (        TException e) {
          throw new RuntimeException(e);
        }
      }
    }
  }
  name=name.toLowerCase();
  return new SchemaQuery(timer,generator,settings,thriftQueryIds.get(name),queryStatements.get(name),ThriftConversion.fromThrift(settings.command.consistencyLevel),ValidationType.NOT_FAIL);
}
