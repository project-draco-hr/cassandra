{
  super(System.nanoTime());
  if (Schema.instance.getTableDefinition(ksm.name) != null)   throw new ConfigurationException(String.format("Can't add Keyspace '%s': Already exists.",ksm.name));
 else   if (!Migration.isLegalName(ksm.name))   throw new ConfigurationException(String.format("Can't add Keyspace '%s': Invalid name.",ksm.name));
  for (  CFMetaData cfm : ksm.cfMetaData().values())   if (!Migration.isLegalName(cfm.cfName))   throw new ConfigurationException(String.format("Can't add Keyspace '%s': Invalid ColumnFamily name '%s'.",ksm.name,cfm.cfName));
  this.ksm=ksm;
}
