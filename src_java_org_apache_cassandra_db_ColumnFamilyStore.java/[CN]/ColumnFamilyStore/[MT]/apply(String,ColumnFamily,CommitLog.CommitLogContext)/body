{
  long start=System.currentTimeMillis();
  Memtable initialMemtable=getMemtableThreadSafe();
  if (initialMemtable.isThresholdViolated()) {
    switchMemtable();
    initialMemtable.enqueueFlush(cLogCtx);
  }
  memtableLock_.writeLock().lock();
  try {
    memtable_.put(key,columnFamily);
  }
  finally {
    memtableLock_.writeLock().unlock();
  }
  writeStats_.add(System.currentTimeMillis() - start);
}
