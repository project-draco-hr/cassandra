{
  logger.info("Enqueuing flush of {}",name);
synchronized (data) {
    Flush flush=new Flush(false);
    flushExecutor.execute(flush);
    ListenableFutureTask<?> task=ListenableFutureTask.create(flush.postFlush,null);
    postFlushExecutor.submit(task);
    return task;
  }
}
