{
  try {
    forceBlockingFlush();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  final long truncatedAt=System.currentTimeMillis();
  snapshot(Table.getTimestampedSnapshotName("before-truncate"));
  Runnable runnable=new WrappedRunnable(){
    public void runMayThrow() throws InterruptedException, IOException {
      List<SSTableReader> truncatedSSTables=new ArrayList<SSTableReader>();
      for (      SSTableReader sstable : ssTables_.getSSTables()) {
        if (!sstable.newSince(truncatedAt))         truncatedSSTables.add(sstable);
      }
      markCompacted(truncatedSSTables);
      invalidateRowCache();
    }
  }
;
  return postFlushExecutor_.submit(runnable);
}
