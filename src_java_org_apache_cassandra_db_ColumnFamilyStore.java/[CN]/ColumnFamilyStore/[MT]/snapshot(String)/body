{
  try {
    forceBlockingFlush();
  }
 catch (  ExecutionException e) {
    throw new RuntimeException(e);
  }
catch (  InterruptedException e) {
    throw new AssertionError(e);
  }
  for (  SSTableReader ssTable : ssTables_) {
    File sourceFile=new File(ssTable.getFilename());
    File dataDirectory=sourceFile.getParentFile().getParentFile();
    String snapshotDirectoryPath=Table.getSnapshotPath(dataDirectory.getAbsolutePath(),table_,snapshotName);
    FileUtils.createDirectory(snapshotDirectoryPath);
    File targetLink=new File(snapshotDirectoryPath,sourceFile.getName());
    FileUtils.createHardLink(sourceFile,targetLink);
    sourceFile=new File(ssTable.indexFilename());
    targetLink=new File(snapshotDirectoryPath,sourceFile.getName());
    FileUtils.createHardLink(sourceFile,targetLink);
    sourceFile=new File(ssTable.filterFilename());
    targetLink=new File(snapshotDirectoryPath,sourceFile.getName());
    FileUtils.createHardLink(sourceFile,targetLink);
    if (logger_.isDebugEnabled())     logger_.debug("Snapshot for " + table_ + " table data file "+ sourceFile.getAbsolutePath()+ " created as "+ targetLink.getAbsolutePath());
  }
}
