{
  int invalidatedKeys=0;
  for (  RowCacheKey key : CacheService.instance.rowCache.getKeySet()) {
    DecoratedKey dk=partitioner.decorateKey(ByteBuffer.wrap(key.key));
    if (key.ksAndCFName.equals(metadata.ksAndCFName) && Bounds.isInBounds(dk.getToken(),boundsToInvalidate)) {
      invalidateCachedRow(dk);
      invalidatedKeys++;
    }
  }
  return invalidatedKeys;
}
