{
  return new Function<View,List<SSTableReader>>(){
    public List<SSTableReader> apply(    View view){
      Set<SSTableReader> sstables=Sets.newHashSet();
      for (      AbstractBounds<PartitionPosition> rowBounds : rowBoundsCollection) {
        for (        SSTableReader sstable : view.sstablesInBounds(rowBounds)) {
          if (includeRepaired || !sstable.isRepaired())           sstables.add(sstable);
        }
      }
      logger.debug("ViewFilter for {}/{} sstables",sstables.size(),getSSTables().size());
      return ImmutableList.copyOf(sstables);
    }
  }
;
}
