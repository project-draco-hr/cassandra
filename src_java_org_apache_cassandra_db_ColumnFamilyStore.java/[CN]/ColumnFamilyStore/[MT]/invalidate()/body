{
  valid=false;
  try {
    unregisterMBean();
  }
 catch (  Exception e) {
    JVMStabilityInspector.inspectThrowable(e);
    logger.warn("Failed unregistering mbean: {}",mbeanName,e);
  }
  latencyCalculator.cancel(false);
  compactionStrategyWrapper.shutdown();
  SystemKeyspace.removeTruncationRecord(metadata.cfId);
  data.unreferenceSSTables();
  indexManager.invalidate();
  invalidateCaches();
}
