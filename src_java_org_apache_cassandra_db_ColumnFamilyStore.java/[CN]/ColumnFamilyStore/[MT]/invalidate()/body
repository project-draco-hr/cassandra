{
  valid=false;
  try {
    unregisterMBean();
  }
 catch (  Exception e) {
    logger.warn("Failed unregistering mbean: " + mbeanName,e);
  }
  compactionStrategy.shutdown();
  SystemKeyspace.removeTruncationRecord(metadata.cfId);
  data.unreferenceSSTables();
  indexManager.invalidate();
  for (  RowCacheKey key : CacheService.instance.rowCache.getKeySet())   if (key.cfId == metadata.cfId)   invalidateCachedRow(key);
}
