{
  try {
    valid=false;
    unregisterMBean();
    SystemKeyspace.removeTruncationRecord(metadata.cfId);
    data.unreferenceSSTables();
    indexManager.invalidate();
    for (    RowCacheKey key : CacheService.instance.rowCache.getKeySet()) {
      if (key.cfId == metadata.cfId)       invalidateCachedRow(key);
    }
  }
 catch (  Exception e) {
    logger.warn("Failed unregistering mbean: {}",mbeanName,e);
  }
}
