{
  isCompacting_.set(true);
  List<String> filesInternal=new ArrayList<String>(ssTables_);
  List<String> files;
  try {
    if (skip > 0L) {
      files=new ArrayList<String>();
      for (      String file : filesInternal) {
        File f=new File(file);
        if (f.length() < skip * 1024L * 1024L* 1024L) {
          files.add(file);
        }
      }
    }
 else {
      files=filesInternal;
    }
    doFileCompaction(files,BUFSIZE);
  }
 catch (  IOException ex) {
    logger_.error(ex);
  }
 finally {
    isCompacting_.set(false);
  }
}
