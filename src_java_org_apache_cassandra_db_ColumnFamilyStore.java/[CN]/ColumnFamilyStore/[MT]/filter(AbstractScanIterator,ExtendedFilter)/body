{
  List<Row> rows=new ArrayList<Row>();
  try {
    while (rowIterator.hasNext() && rows.size() < filter.maxResults) {
      Row rawRow=rowIterator.next();
      ColumnFamily data=rawRow.cf;
      IFilter extraFilter=filter.getExtraFilter(data);
      if (extraFilter != null) {
        QueryPath path=new QueryPath(columnFamily);
        ColumnFamily cf=filter.cfs.getColumnFamily(new QueryFilter(rawRow.key,path,extraFilter));
        if (cf != null)         data.addAll(cf,HeapAllocator.instance);
      }
      if (!filter.isSatisfiedBy(data))       continue;
      logger.debug("{} satisfies all filter expressions",data);
      data=filter.prune(data);
      rows.add(new Row(rawRow.key,data));
    }
    return rows;
  }
  finally {
    try {
      rowIterator.close();
    }
 catch (    IOException e) {
      throw new IOError(e);
    }
  }
}
