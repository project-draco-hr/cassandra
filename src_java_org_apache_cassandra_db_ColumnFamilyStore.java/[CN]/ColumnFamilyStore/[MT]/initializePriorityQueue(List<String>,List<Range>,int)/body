{
  PriorityQueue<FileStruct> pq=new PriorityQueue<FileStruct>();
  if (files.size() > 1 || (ranges != null && files.size() > 0)) {
    int bufferSize=Math.min((ColumnFamilyStore.COMPACTION_MEMORY_THRESHOLD / files.size()),minBufferSize);
    FileStruct fs=null;
    for (    String file : files) {
      fs=SSTableReader.get(file).getFileStruct();
      fs.advance(true);
      if (fs.isExhausted()) {
        continue;
      }
      pq.add(fs);
    }
  }
  return pq;
}
