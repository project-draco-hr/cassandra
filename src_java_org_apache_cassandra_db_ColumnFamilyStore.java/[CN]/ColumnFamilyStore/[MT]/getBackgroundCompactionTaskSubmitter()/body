{
  return new Runnable(){
    public void run(){
      List<ColumnFamilyStore> submitted=new ArrayList<>();
      for (      Keyspace keyspace : Keyspace.all())       for (      ColumnFamilyStore cfs : keyspace.getColumnFamilyStores())       if (!CompactionManager.instance.submitBackground(cfs,false).isEmpty())       submitted.add(cfs);
      while (!submitted.isEmpty() && CompactionManager.instance.getActiveCompactions() < CompactionManager.instance.getMaximumCompactorThreads()) {
        List<ColumnFamilyStore> submitMore=ImmutableList.copyOf(submitted);
        submitted.clear();
        for (        ColumnFamilyStore cfs : submitMore)         if (!CompactionManager.instance.submitBackground(cfs,false).isEmpty())         submitted.add(cfs);
      }
    }
  }
;
}
