{
  Iterator<Column> iter=cf.iterator();
  DeletionInfo.InOrderTester tester=cf.inOrderDeletionTester();
  boolean hasDroppedColumns=!cf.metadata.getDroppedColumns().isEmpty();
  long removedBytes=0;
  while (iter.hasNext()) {
    Column c=iter.next();
    if (c.getLocalDeletionTime() < gcBefore || tester.isDeleted(c) || (hasDroppedColumns && isDroppedColumn(c,cf.metadata()))) {
      iter.remove();
      indexer.remove(c);
      removedBytes+=c.dataSize();
    }
  }
  return removedBytes;
}
