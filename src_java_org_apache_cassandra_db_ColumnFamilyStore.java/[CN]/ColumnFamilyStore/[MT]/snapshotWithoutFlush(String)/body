{
  for (  ColumnFamilyStore cfs : concatWithIndexes()) {
    DataTracker.View currentView=cfs.markCurrentViewReferenced();
    try {
      for (      SSTableReader ssTable : currentView.sstables) {
        File snapshotDirectory=Directories.getSnapshotDirectory(ssTable.descriptor,snapshotName);
        ssTable.createLinks(snapshotDirectory.getPath());
        if (logger.isDebugEnabled())         logger.debug("Snapshot for {} keyspace data file {} created in {}",keyspace,ssTable.getFilename(),snapshotDirectory);
      }
    }
  finally {
      SSTableReader.releaseReferences(currentView.sstables);
    }
  }
}
