{
  Collection<Range<Token>> ranges=StorageService.instance.getLocalRanges(keyspace.getName());
  for (  RowCacheKey key : CacheService.instance.rowCache.getKeySet()) {
    DecoratedKey dk=partitioner.decorateKey(ByteBuffer.wrap(key.key));
    if (key.cfId == metadata.cfId && !Range.isInRanges(dk.token,ranges))     invalidateCachedRow(dk);
  }
}
