{
  Iterator<IColumn> iter=cf.iterator();
  while (iter.hasNext()) {
    SuperColumn c=(SuperColumn)iter.next();
    long minTimestamp=Math.max(c.getMarkedForDeleteAt(),cf.getMarkedForDeleteAt());
    Iterator<IColumn> subIter=c.getSubColumns().iterator();
    while (subIter.hasNext()) {
      IColumn subColumn=subIter.next();
      if (subColumn.timestamp() <= minTimestamp || subColumn.getLocalDeletionTime() < gcBefore) {
        subIter.remove();
      }
    }
    if (c.getSubColumns().isEmpty() && c.getLocalDeletionTime() < gcBefore) {
      iter.remove();
    }
 else {
      c.maybeResetDeletionTimes(gcBefore);
    }
  }
}
