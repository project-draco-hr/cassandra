{
  Iterator<IColumn> iter=cf.iterator();
  while (iter.hasNext()) {
    SuperColumn c=(SuperColumn)iter.next();
    Iterator<IColumn> subIter=c.getSubColumns().iterator();
    while (subIter.hasNext()) {
      IColumn subColumn=subIter.next();
      if (subColumn.getLocalDeletionTime() < gcBefore || cf.deletionInfo().isDeleted(c.name(),subColumn.timestamp()) || c.deletionInfo().isDeleted(subColumn)) {
        subIter.remove();
      }
    }
    c.maybeResetDeletionTimes(gcBefore);
    if (c.getSubColumns().isEmpty() && !c.isMarkedForDelete()) {
      iter.remove();
    }
  }
}
