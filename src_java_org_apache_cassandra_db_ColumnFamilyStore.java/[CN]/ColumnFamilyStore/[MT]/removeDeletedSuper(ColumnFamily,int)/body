{
  Iterator<IColumn> iter=cf.iterator();
  while (iter.hasNext()) {
    SuperColumn c=(SuperColumn)iter.next();
    long minTimestamp=Math.max(c.getMarkedForDeleteAt(),cf.getMarkedForDeleteAt());
    for (    IColumn subColumn : c.getSubColumns()) {
      if (subColumn.timestamp() <= minTimestamp || (subColumn.isMarkedForDelete() && subColumn.getLocalDeletionTime() <= gcBefore)) {
        c.remove(subColumn.name());
      }
    }
    if (c.getSubColumns().isEmpty() && c.getLocalDeletionTime() <= gcBefore) {
      iter.remove();
    }
 else {
      c.maybeResetDeletionTimes(gcBefore);
    }
  }
}
