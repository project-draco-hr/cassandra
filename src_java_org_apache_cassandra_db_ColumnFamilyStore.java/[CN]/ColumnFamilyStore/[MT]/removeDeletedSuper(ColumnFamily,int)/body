{
  for (  Map.Entry<ByteBuffer,IColumn> entry : cf.getColumnsMap().entrySet()) {
    SuperColumn c=(SuperColumn)entry.getValue();
    long minTimestamp=Math.max(c.getMarkedForDeleteAt(),cf.getMarkedForDeleteAt());
    for (    IColumn subColumn : c.getSubColumns()) {
      if (subColumn.timestamp() <= minTimestamp || (subColumn.isMarkedForDelete() && subColumn.getLocalDeletionTime() <= gcBefore)) {
        c.remove(subColumn.name());
      }
    }
    if (c.getSubColumns().isEmpty() && c.getLocalDeletionTime() <= gcBefore) {
      cf.remove(c.name());
    }
 else {
      c.maybeResetDeletionTimes(gcBefore);
    }
  }
}
