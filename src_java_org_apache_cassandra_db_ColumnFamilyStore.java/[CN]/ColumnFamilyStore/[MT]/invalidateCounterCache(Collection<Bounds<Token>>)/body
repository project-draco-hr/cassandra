{
  int invalidatedKeys=0;
  for (  CounterCacheKey key : CacheService.instance.counterCache.getKeySet()) {
    DecoratedKey dk=partitioner.decorateKey(ByteBuffer.wrap(key.partitionKey));
    if (key.ksAndCFName.equals(metadata.ksAndCFName) && Bounds.isInBounds(dk.getToken(),boundsToInvalidate)) {
      CacheService.instance.counterCache.remove(key);
      invalidatedKeys++;
    }
  }
  return invalidatedKeys;
}
