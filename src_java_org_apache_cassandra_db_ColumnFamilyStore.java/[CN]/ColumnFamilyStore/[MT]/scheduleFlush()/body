{
  int period=metadata.getMemtableFlushPeriod();
  if (period > 0) {
    logger.debug("scheduling flush in {} ms",period);
    WrappedRunnable runnable=new WrappedRunnable(){
      protected void runMayThrow() throws Exception {
synchronized (data) {
          Memtable current=data.getView().getCurrentMemtable();
          if (current.isExpired()) {
            if (current.isClean()) {
              scheduleFlush();
            }
 else {
              forceFlush();
            }
          }
        }
      }
    }
;
    ScheduledExecutors.scheduledTasks.schedule(runnable,period,TimeUnit.MILLISECONDS);
  }
}
