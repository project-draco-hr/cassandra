{
  int period=metadata.getMemtableFlushPeriod();
  if (period > 0) {
    logger.debug("scheduling flush in {} ms",period);
    WrappedRunnable runnable=new WrappedRunnable(){
      protected void runMayThrow() throws Exception {
        if (getMemtableThreadSafe().isExpired()) {
          if (isClean())           scheduleFlush();
 else           forceFlush();
        }
      }
    }
;
    StorageService.scheduledTasks.schedule(runnable,period,TimeUnit.MILLISECONDS);
  }
}
