{
  Directories directories=Directories.create(keyspace.getName(),columnFamily);
  Directories.SSTableLister lister=directories.sstableLister().includeBackups(true);
  List<Integer> generations=new ArrayList<Integer>();
  for (  Map.Entry<Descriptor,Set<Component>> entry : lister.list().entrySet()) {
    Descriptor desc=entry.getKey();
    generations.add(desc.generation);
    if (!desc.isCompatible())     logger.warn(String.format("Old SSTable found: Current version %s, found file: %s.  Please run upgradesstables.",Descriptor.Version.CURRENT,desc));
  }
  Collections.sort(generations);
  int value=(generations.size() > 0) ? (generations.get(generations.size() - 1)) : 0;
  return new ColumnFamilyStore(keyspace,columnFamily,partitioner,value,metadata,directories,loadSSTables);
}
