{
  ReplayPosition rp=ReplayPosition.getReplayPosition(sstables);
  SSTableMetadata.Collector sstableMetadataCollector=SSTableMetadata.createCollector().replayPosition(rp);
  for (  SSTableReader sstable : sstables)   sstableMetadataCollector.updateMaxTimestamp(sstable.getMaxTimestamp());
  return new SSTableWriter(getTempSSTablePath(location),estimatedRows,metadata,partitioner,sstableMetadataCollector);
}
