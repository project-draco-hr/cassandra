{
  int filesCompacted=0;
  for (  List<SSTableReader> sstables : getCompactionBuckets(ssTables_.values(),50L * 1024L * 1024L)) {
    if (sstables.size() < minThreshold) {
      continue;
    }
    Collections.sort(sstables);
    filesCompacted+=doFileCompaction(sstables.subList(0,Math.min(sstables.size(),maxThreshold)));
  }
  return filesCompacted;
}
