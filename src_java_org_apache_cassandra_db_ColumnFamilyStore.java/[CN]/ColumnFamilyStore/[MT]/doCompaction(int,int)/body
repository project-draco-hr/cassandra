{
  int filesCompacted=0;
  for (  List<String> files : getCompactionBuckets(ssTables_.keySet(),50L * 1024L * 1024L)) {
    if (files.size() < minThreshold) {
      continue;
    }
    Collections.sort(files,new FileNameComparator(FileNameComparator.Ascending));
    filesCompacted+=doFileCompaction(files.subList(0,Math.min(files.size(),maxThreshold)));
  }
  return filesCompacted;
}
