{
  long expectedFileSize=0;
  if (operation == OperationType.CLEANUP) {
    Collection<Range<Token>> ranges=StorageService.instance.getLocalRanges(table.name);
    for (    SSTableReader sstable : sstables) {
      List<Pair<Long,Long>> positions=sstable.getPositionsForRanges(ranges);
      for (      Pair<Long,Long> position : positions)       expectedFileSize+=position.right - position.left;
    }
  }
 else {
    for (    SSTableReader sstable : sstables)     expectedFileSize+=sstable.onDiskLength();
  }
  return expectedFileSize;
}
