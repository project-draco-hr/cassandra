{
  int ssTableSize=0;
  lock_.writeLock().lock();
  try {
    ssTables_.add(filename);
    SSTable.storeBloomFilter(filename,bf);
    ssTableSize=ssTables_.size();
  }
  finally {
    lock_.writeLock().unlock();
  }
  if ((ssTableSize >= COMPACTION_THRESHOLD && !isCompacting_.get()) || (isCompacting_.get() && ssTableSize % COMPACTION_THRESHOLD == 0)) {
    logger_.debug("Submitting for  compaction ...");
    MinorCompactionManager.instance().submit(ColumnFamilyStore.this);
    logger_.debug("Submitted for compaction ...");
  }
}
