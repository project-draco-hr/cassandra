{
  long start=System.currentTimeMillis();
  Memtable initialMemtable=getMemtableThreadSafe();
  boolean isFlush=false;
  if (initialMemtable.isThresholdViolated()) {
    isFlush=true;
  }
  memtableLock_.readLock().lock();
  try {
    initialMemtable.put(key,columnFamily);
  }
  finally {
    memtableLock_.readLock().unlock();
  }
  writeStats_.add(System.currentTimeMillis() - start);
  return isFlush ? initialMemtable : null;
}
