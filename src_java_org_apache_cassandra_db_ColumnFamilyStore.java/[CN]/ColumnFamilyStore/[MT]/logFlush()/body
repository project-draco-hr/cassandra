{
  float onHeapRatio=0, offHeapRatio=0;
  long onHeapTotal=0, offHeapTotal=0;
  Memtable memtable=getDataTracker().getView().getCurrentMemtable();
  onHeapRatio+=memtable.getAllocator().onHeap().ownershipRatio();
  offHeapRatio+=memtable.getAllocator().offHeap().ownershipRatio();
  onHeapTotal+=memtable.getAllocator().onHeap().owns();
  offHeapTotal+=memtable.getAllocator().offHeap().owns();
  for (  SecondaryIndex index : indexManager.getIndexes()) {
    if (index.getIndexCfs() != null) {
      MemtableAllocator allocator=index.getIndexCfs().getDataTracker().getView().getCurrentMemtable().getAllocator();
      onHeapRatio+=allocator.onHeap().ownershipRatio();
      offHeapRatio+=allocator.offHeap().ownershipRatio();
      onHeapTotal+=allocator.onHeap().owns();
      offHeapTotal+=allocator.offHeap().owns();
    }
  }
  logger.info("Enqueuing flush of {}: {}",name,String.format("%d (%.0f%%) on-heap, %d (%.0f%%) off-heap",onHeapTotal,onHeapRatio * 100,offHeapTotal,offHeapRatio * 100));
}
