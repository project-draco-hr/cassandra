{
  for (  Map.Entry<Descriptor,Set<Component>> sstableFiles : files(table,columnFamily).entrySet()) {
    Descriptor desc=sstableFiles.getKey();
    Set<Component> components=sstableFiles.getValue();
    if (SSTable.conditionalDelete(desc,components))     continue;
    File dataFile=new File(desc.filenameFor(Component.DATA));
    if (components.contains(Component.DATA) && dataFile.length() > 0)     continue;
    logger.warn("Removing orphans for {}: {}",desc,components);
    for (    Component component : components) {
      try {
        FileUtils.deleteWithConfirm(desc.filenameFor(component));
      }
 catch (      IOException e) {
        throw new IOError(e);
      }
    }
  }
}
