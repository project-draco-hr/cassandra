{
  Pattern auxFilePattern=Pattern.compile("(.*)(-Filter\\.db$|-Index\\.db$)");
  for (  File file : files(table,columnFamily)) {
    String filename=file.getName();
    Matcher matcher=auxFilePattern.matcher(file.getAbsolutePath());
    if (matcher.matches()) {
      String basePath=matcher.group(1);
      if (!new File(basePath + "-Data.db").exists()) {
        logger_.info(String.format("Removing orphan %s",file.getAbsolutePath()));
        try {
          FileUtils.deleteWithConfirm(file);
        }
 catch (        IOException e) {
          throw new IOError(e);
        }
      }
    }
 else     if (((file.length() == 0 && !filename.endsWith("-Compacted")) || (filename.contains("-" + SSTable.TEMPFILE_MARKER)))) {
      try {
        FileUtils.deleteWithConfirm(file);
      }
 catch (      IOException e) {
        throw new IOError(e);
      }
    }
  }
}
