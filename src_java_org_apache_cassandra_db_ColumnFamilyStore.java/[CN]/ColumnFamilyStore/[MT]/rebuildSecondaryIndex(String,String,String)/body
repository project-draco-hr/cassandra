{
  ColumnFamilyStore cfs=Keyspace.open(ksName).getColumnFamilyStore(cfName);
  Set<String> indexes=new HashSet<String>(Arrays.asList(idxNames));
  Iterable<SSTableReader> sstables=cfs.getSSTables(SSTableSet.CANONICAL);
  try (Refs<SSTableReader> refs=Refs.ref(sstables)){
    cfs.indexManager.setIndexRemoved(indexes);
    logger.info(String.format("User Requested secondary index re-build for %s/%s indexes",ksName,cfName));
    cfs.indexManager.maybeBuildSecondaryIndexes(refs,indexes);
    cfs.indexManager.setIndexBuilt(indexes);
  }
 }
