{
{
    while (true) {
      try {
        Buffer b=writeQueue.take();
        if (b == SENTINEL)         return;
        try (SSTableWriter writer=getWriter()){
          for (          Map.Entry<DecoratedKey,ColumnFamily> entry : b.entrySet()) {
            if (entry.getValue().getColumnCount() > 0)             writer.append(entry.getKey(),entry.getValue());
 else             if (!entry.getKey().equals(b.getFirstInsertedKey()))             throw new AssertionError("Empty partition");
          }
          writer.finish(false);
        }
       }
 catch (      Throwable e) {
        JVMStabilityInspector.inspectThrowable(e);
        if (exception == null)         exception=e;
      }
    }
  }
}
