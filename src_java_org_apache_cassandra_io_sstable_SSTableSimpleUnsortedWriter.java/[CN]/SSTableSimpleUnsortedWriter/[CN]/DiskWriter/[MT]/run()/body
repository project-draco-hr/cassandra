{
  try {
    while (true) {
      Buffer b=writeQueue.take();
      if (b == SENTINEL)       return;
      SSTableWriter writer=getWriter();
      for (      Map.Entry<DecoratedKey,ColumnFamily> entry : b.entrySet())       writer.append(entry.getKey(),entry.getValue());
      writer.closeAndOpenReader();
    }
  }
 catch (  Exception e) {
    exception=e;
  }
}
