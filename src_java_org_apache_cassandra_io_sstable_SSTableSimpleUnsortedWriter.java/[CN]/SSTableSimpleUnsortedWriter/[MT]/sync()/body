{
  if (buffer.isEmpty())   return;
  while (true) {
    checkForWriterException();
    columnFamily=null;
    try {
      if (writeQueue.offer(buffer,1L,TimeUnit.SECONDS))       break;
    }
 catch (    InterruptedException e) {
      throw new RuntimeException(e);
    }
  }
  buffer=new Buffer();
  currentSize=0;
  columnFamily=getColumnFamily();
}
