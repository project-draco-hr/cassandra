{
  if (keys.isEmpty())   return;
  SSTableWriter writer=null;
  try {
    writer=getWriter();
    for (    Map.Entry<DecoratedKey,ColumnFamily> entry : keys.entrySet()) {
      writer.append(entry.getKey(),entry.getValue());
    }
    writer.closeAndOpenReader();
  }
 catch (  IOException e) {
    if (writer != null)     writer.abort();
    throw e;
  }
  currentSize=0;
  keys.clear();
}
