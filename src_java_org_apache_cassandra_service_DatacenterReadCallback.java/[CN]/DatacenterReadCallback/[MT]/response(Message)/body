{
  resolver.preprocess(message);
  int n=localdc.equals(snitch.getDatacenter(message.getFrom())) ? received.incrementAndGet() : received.get();
  if (n == blockfor && resolver.isDataPresent()) {
    condition.signal();
  }
}
