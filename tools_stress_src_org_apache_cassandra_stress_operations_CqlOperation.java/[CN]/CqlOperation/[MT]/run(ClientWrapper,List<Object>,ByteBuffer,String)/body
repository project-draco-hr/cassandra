{
  final CqlRunOp<V> op;
  if (state.settings.mode.style == ConnectionStyle.CQL_PREPARED) {
    final Object id;
    Object idobj=state.getCqlCache();
    if (idobj == null) {
      try {
        id=client.createPreparedStatement(buildQuery());
      }
 catch (      TException e) {
        throw new RuntimeException(e);
      }
      state.storeCqlCache(id);
    }
 else     id=idobj;
    op=buildRunOp(client,null,id,queryParams,keyid,key);
  }
 else {
    final String query;
    Object qobj=state.getCqlCache();
    if (qobj == null)     state.storeCqlCache(query=buildQuery());
 else     query=qobj.toString();
    op=buildRunOp(client,query,null,queryParams,keyid,key);
  }
  timeWithRetry(op);
  return op;
}
