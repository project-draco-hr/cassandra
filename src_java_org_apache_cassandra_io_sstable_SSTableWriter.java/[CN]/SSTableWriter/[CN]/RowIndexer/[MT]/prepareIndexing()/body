{
  long estimatedRows;
  try {
    estimatedRows=SSTable.estimateRowsFromData(desc,dfile);
    iwriter=new IndexWriter(desc,StorageService.getPartitioner(),estimatedRows);
    return estimatedRows;
  }
 catch (  IOException e) {
    dfile.close();
    throw e;
  }
}
