{
  bf.add(key.getKey());
  long indexStart=indexFile.getFilePointer();
  try {
    ByteBufferUtil.writeWithShortLength(key.getKey(),indexFile.stream);
    metadata.comparator.rowIndexEntrySerializer().serialize(indexEntry,indexFile.stream);
  }
 catch (  IOException e) {
    throw new FSWriteError(e,indexFile.getPath());
  }
  long indexEnd=indexFile.getFilePointer();
  if (logger.isTraceEnabled())   logger.trace("wrote index entry: " + indexEntry + " at "+ indexStart);
  summary.maybeAddEntry(key,indexStart,indexEnd,dataEnd);
  builder.addPotentialBoundary(indexStart);
}
