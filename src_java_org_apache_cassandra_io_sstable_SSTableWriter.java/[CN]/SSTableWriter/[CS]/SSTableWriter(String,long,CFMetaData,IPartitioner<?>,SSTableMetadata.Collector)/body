{
  super(Descriptor.fromFilename(filename),components(metadata),metadata,partitioner);
  iwriter=new IndexWriter(keyCount);
  if (compression) {
    dbuilder=SegmentedFile.getCompressedBuilder();
    dataFile=CompressedSequentialWriter.open(getFilename(),descriptor.filenameFor(Component.COMPRESSION_INFO),!metadata.populateIoCacheOnFlush(),metadata.compressionParameters(),sstableMetadataCollector);
  }
 else {
    dbuilder=SegmentedFile.getBuilder(DatabaseDescriptor.getDiskAccessMode());
    dataFile=SequentialWriter.open(new File(getFilename()),!metadata.populateIoCacheOnFlush());
    dataFile.setDataIntegrityWriter(DataIntegrityMetadata.checksumWriter(descriptor));
  }
  this.sstableMetadataCollector=sstableMetadataCollector;
}
