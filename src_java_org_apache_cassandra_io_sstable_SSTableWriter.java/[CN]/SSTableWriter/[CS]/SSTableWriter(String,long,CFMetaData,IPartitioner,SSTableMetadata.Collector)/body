{
  super(Descriptor.fromFilename(filename),new HashSet<Component>(Arrays.asList(Component.DATA,Component.FILTER,Component.PRIMARY_INDEX,Component.STATS)),metadata,partitioner);
  iwriter=new IndexWriter(descriptor,partitioner,keyCount);
  dbuilder=SegmentedFile.getBuilder(DatabaseDescriptor.getDiskAccessMode());
  dataFile=SequentialWriter.open(new File(getFilename()),true);
  this.sstableMetadataCollector=sstableMetadataCollector;
}
