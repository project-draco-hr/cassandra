{
  super(Descriptor.fromFilename(filename),new HashSet<Component>(Arrays.asList(Component.DATA,Component.FILTER,Component.PRIMARY_INDEX,Component.STATS)),metadata,partitioner);
  iwriter=new IndexWriter(descriptor,partitioner,keyCount);
  dbuilder=SegmentedFile.getBuilder(DatabaseDescriptor.getDiskAccessMode());
  dataFile=new BufferedRandomAccessFile(new File(getFilename()),"rw",BufferedRandomAccessFile.DEFAULT_BUFFER_SIZE,true);
  this.sstableMetadataCollector=sstableMetadataCollector;
}
