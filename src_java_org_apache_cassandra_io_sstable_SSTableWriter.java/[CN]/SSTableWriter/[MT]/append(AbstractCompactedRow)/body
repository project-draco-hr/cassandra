{
  long startPosition=beforeAppend(row.key);
  RowIndexEntry entry;
  try {
    entry=row.write(startPosition,dataFile.stream);
    if (entry == null)     return null;
  }
 catch (  IOException e) {
    throw new FSWriteError(e,dataFile.getPath());
  }
  long endPosition=dataFile.getFilePointer();
  long rowSize=endPosition - startPosition;
  maybeLogLargePartitionWarning(row.key,rowSize);
  sstableMetadataCollector.update(rowSize,row.columnStats());
  afterAppend(row.key,endPosition,entry);
  return entry;
}
