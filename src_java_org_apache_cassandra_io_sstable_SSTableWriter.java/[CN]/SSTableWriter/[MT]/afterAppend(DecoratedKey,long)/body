{
  byte[] diskKey=partitioner.convertToDiskFormat(decoratedKey);
  bf.add(diskKey);
  lastWrittenKey=decoratedKey;
  long indexPosition=indexFile.getFilePointer();
  FBUtilities.writeShortByteArray(diskKey,indexFile);
  indexFile.writeLong(dataPosition);
  if (logger.isTraceEnabled())   logger.trace("wrote " + decoratedKey + " at "+ dataPosition);
  if (logger.isTraceEnabled())   logger.trace("wrote index of " + decoratedKey + " at "+ indexPosition);
  int rowSize=(int)(dataFile.getFilePointer() - dataPosition);
  indexSummary.maybeAddEntry(decoratedKey,dataPosition,rowSize,indexPosition,indexFile.getFilePointer());
}
