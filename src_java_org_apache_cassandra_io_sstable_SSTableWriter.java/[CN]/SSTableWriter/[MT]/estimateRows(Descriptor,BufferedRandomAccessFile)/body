{
  final int SAMPLES_CAP=1000, BYTES_CAP=(int)Math.min(100000000,dfile.length());
  int keys=0;
  long dataPosition=0;
  while (dataPosition < BYTES_CAP && keys < SAMPLES_CAP) {
    dfile.seek(dataPosition);
    FBUtilities.readShortByteArray(dfile);
    long dataSize=SSTableReader.readRowSize(dfile,desc);
    dataPosition=dfile.getFilePointer() + dataSize;
    keys++;
  }
  dfile.seek(0);
  return dfile.length() / (dataPosition / keys);
}
