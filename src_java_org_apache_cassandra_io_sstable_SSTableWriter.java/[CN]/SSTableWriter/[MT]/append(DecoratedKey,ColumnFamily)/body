{
  long startPosition=beforeAppend(decoratedKey);
  ByteBufferUtil.writeWithShortLength(decoratedKey.key,dataFile.stream);
  ColumnIndex index=new ColumnIndex.Builder(cf.getComparator(),decoratedKey.key,cf.getColumnCount()).build(cf);
  dataFile.stream.writeLong(ColumnFamily.serializer.serializedSizeForSSTable(cf,typeSizes));
  ColumnFamily.serializer.serializeForSSTable(cf,dataFile.stream);
  afterAppend(decoratedKey,startPosition,cf.deletionInfo(),index);
  sstableMetadataCollector.update(dataFile.getFilePointer() - startPosition,cf.getColumnStats());
}
