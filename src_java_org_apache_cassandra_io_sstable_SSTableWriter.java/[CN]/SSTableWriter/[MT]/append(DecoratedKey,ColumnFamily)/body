{
  long startPosition=beforeAppend(decoratedKey);
  ByteBufferUtil.writeWithShortLength(decoratedKey.key,dataFile);
  long sizePosition=dataFile.getFilePointer();
  dataFile.writeLong(-1);
  int columnCount=ColumnFamily.serializer().serializeWithIndexes(cf,dataFile);
  long endPosition=dataFile.getFilePointer();
  dataFile.seek(sizePosition);
  dataFile.writeLong(endPosition - (sizePosition + 8));
  dataFile.seek(endPosition);
  afterAppend(decoratedKey,startPosition);
  estimatedRowSize.add(endPosition - startPosition);
  estimatedColumnCount.add(columnCount);
}
