{
  if (decoratedKey.getKey().remaining() > FBUtilities.MAX_UNSIGNED_SHORT) {
    logger.error("Key size {} exceeds maximum of {}, skipping row",decoratedKey.getKey().remaining(),FBUtilities.MAX_UNSIGNED_SHORT);
    return;
  }
  long startPosition=beforeAppend(decoratedKey);
  try {
    RowIndexEntry entry=rawAppend(cf,startPosition,decoratedKey,dataFile.stream);
    afterAppend(decoratedKey,startPosition,entry);
  }
 catch (  IOException e) {
    throw new FSWriteError(e,dataFile.getPath());
  }
  sstableMetadataCollector.update(dataFile.getFilePointer() - startPosition,cf.getColumnStats());
}
