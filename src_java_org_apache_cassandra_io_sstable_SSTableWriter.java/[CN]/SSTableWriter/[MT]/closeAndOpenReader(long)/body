{
  FileOutputStream fos=new FileOutputStream(filterFilename());
  DataOutputStream stream=new DataOutputStream(fos);
  BloomFilter.serializer().serialize(bf,stream);
  stream.flush();
  fos.getFD().sync();
  stream.close();
  indexFile.getChannel().force(true);
  indexFile.close();
  dataFile.close();
  Descriptor newdesc=rename(desc);
  indexSummary.complete();
  SegmentedFile ifile=ibuilder.complete(newdesc.filenameFor(SSTable.COMPONENT_INDEX));
  SegmentedFile dfile=dbuilder.complete(newdesc.filenameFor(SSTable.COMPONENT_DATA));
  ibuilder=null;
  dbuilder=null;
  return RowIndexedReader.internalOpen(newdesc,partitioner,ifile,dfile,indexSummary,bf,maxDataAge);
}
