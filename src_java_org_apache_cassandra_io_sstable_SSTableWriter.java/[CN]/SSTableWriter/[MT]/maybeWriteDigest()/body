{
  byte[] digest=dataFile.digest();
  if (digest == null)   return;
  SequentialWriter out=SequentialWriter.open(new File(descriptor.filenameFor(SSTable.COMPONENT_DIGEST)),true);
  Descriptor newdesc=descriptor.asTemporary(false);
  String[] tmp=newdesc.filenameFor(SSTable.COMPONENT_DATA).split(Pattern.quote(File.separator));
  String dataFileName=tmp[tmp.length - 1];
  try {
    out.write(String.format("%s  %s",Hex.bytesToHex(digest),dataFileName).getBytes());
  }
 catch (  ClosedChannelException e) {
    throw new AssertionError();
  }
  out.close();
}
