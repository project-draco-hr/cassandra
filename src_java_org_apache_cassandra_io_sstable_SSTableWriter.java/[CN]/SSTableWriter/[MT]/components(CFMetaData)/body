{
  Set<Component> components=new HashSet<Component>(Arrays.asList(Component.DATA,Component.PRIMARY_INDEX,Component.STATS,Component.SUMMARY,Component.TOC));
  if (metadata.getBloomFilterFpChance() < 1.0)   components.add(Component.FILTER);
  if (metadata.compressionParameters().sstableCompressor != null) {
    components.add(Component.COMPRESSION_INFO);
  }
 else {
    components.add(Component.DIGEST);
    components.add(Component.CRC);
  }
  return components;
}
