{
  if (thriftDefs == null)   return Indexes.none();
  Set<String> indexNames=new HashSet<>();
  Indexes.Builder indexes=Indexes.builder();
  for (  ColumnDef def : thriftDefs) {
    if (def.isSetIndex_type()) {
      ColumnDefinition column=fromThrift(ksName,cfName,thriftComparator,thriftSubComparator,def);
      String indexName=def.getIndex_name();
      if (Strings.isNullOrEmpty(indexName))       indexName=Indexes.getAvailableIndexName(ksName,cfName,column.name);
      if (indexNames.contains(indexName))       throw new ConfigurationException("Duplicate index name " + indexName);
      indexNames.add(indexName);
      Map<String,String> indexOptions=def.getIndex_options();
      IndexMetadata.IndexType indexType=IndexMetadata.IndexType.valueOf(def.index_type.name());
      indexes.add(IndexMetadata.legacyIndex(column,indexName,indexType,indexOptions));
    }
  }
  return indexes.build();
}
