{
  this.type=type;
  this.scanners=scanners;
  this.controller=controller;
  row=0;
  totalBytes=bytesRead=0;
  for (  SSTableScanner scanner : scanners)   totalBytes+=scanner.getFileLength();
  this.throttle=new Throttle(toString(),new Throttle.ThroughputFunction(){
    /** 
 * @return Instantaneous throughput target in bytes per millisecond. 
 */
    public int targetThroughput(){
      if (DatabaseDescriptor.getCompactionThroughputMbPerSec() < 1 || StorageService.instance.isBootstrapMode())       return 0;
      int totalBytesPerMS=DatabaseDescriptor.getCompactionThroughputMbPerSec() * 1024 * 1024 / 1000;
      return totalBytesPerMS / Math.max(1,CompactionManager.instance.getActiveCompactions());
    }
  }
);
}
