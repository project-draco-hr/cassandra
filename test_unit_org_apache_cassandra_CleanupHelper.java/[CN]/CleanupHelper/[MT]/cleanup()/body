{
  String[] directoryNames={DatabaseDescriptor.getLogFileLocation()};
  for (  String dirName : directoryNames) {
    File dir=new File(dirName);
    if (!dir.exists()) {
      throw new RuntimeException("No such directory: " + dir.getAbsolutePath());
    }
    for (    File f : dir.listFiles()) {
      FileUtils.deleteWithConfirm(f);
    }
    FileUtils.deleteWithConfirm(dir);
  }
  for (  String dirName : DatabaseDescriptor.getAllDataFileLocations()) {
    File dir=new File(dirName);
    if (!dir.exists()) {
      throw new RuntimeException("No such directory: " + dir.getAbsolutePath());
    }
    for (    File tableFile : dir.listFiles()) {
      if (tableFile.isDirectory()) {
        for (        File dataFile : tableFile.listFiles()) {
          FileUtils.deleteWithConfirm(dataFile);
        }
      }
      FileUtils.deleteWithConfirm(tableFile);
    }
    FileUtils.deleteWithConfirm(dir);
  }
}
