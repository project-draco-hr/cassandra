{
  createTable("CREATE TABLE %s.rowmarker (a int, PRIMARY KEY (a))");
  ColumnFamilyStore cfs=Keyspace.open(keyspace).getColumnFamilyStore("rowmarker");
  execute("INSERT INTO %s.rowmarker (a) VALUES (1) USING TIMESTAMP 9999");
  cfs.forceBlockingFlush();
  assertEquals(1,cfs.getSSTables().size());
  SSTableMetadata metadata=cfs.getSSTables().iterator().next().getSSTableMetadata();
  assertEquals(9999,metadata.minTimestamp);
  assertEquals(9999,metadata.maxTimestamp);
  assertEquals(Integer.MAX_VALUE,metadata.maxLocalDeletionTime);
  cfs.forceMajorCompaction();
  SSTableMetadata metadata2=cfs.getSSTables().iterator().next().getSSTableMetadata();
  assertEquals(metadata.maxLocalDeletionTime,metadata2.maxLocalDeletionTime);
  assertEquals(metadata.minTimestamp,metadata2.minTimestamp);
  assertEquals(metadata.maxTimestamp,metadata2.maxTimestamp);
}
