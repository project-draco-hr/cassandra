{
  SecondaryIndexManager indexManager=Keyspace.open(cfm.ksName).getColumnFamilyStore(cfm.cfId).indexManager;
  if (indexManager.hasIndexes()) {
    for (    Cell cell : cf) {
      SecondaryIndex failedIndex=indexManager.validate(key,cell);
      if (failedIndex != null) {
        throw invalidRequest(String.format("Can't index column value of size %d for index %s on %s.%s",cell.value().remaining(),failedIndex.getIndexName(),cfm.ksName,cfm.cfName));
      }
    }
  }
}
