{
  List<ByteBuffer> keys=buildKeyNames(cfDef,processedKeys,variables);
  ColumnNameBuilder builder=cfDef.getColumnNameBuilder();
  buildColumnNames(cfDef,processedKeys,builder,variables,true);
  boolean needsReading=false;
  for (  Map.Entry<CFDefinition.Name,Operation> entry : processedColumns.entries()) {
    CFDefinition.Name name=entry.getKey();
    Operation value=entry.getValue();
    if (!(name.type instanceof ListType))     continue;
    if (value.requiresRead()) {
      needsReading=true;
      break;
    }
  }
  Map<ByteBuffer,ColumnGroupMap> rows=needsReading ? readRows(keys,builder,(CompositeType)cfDef.cfm.comparator,local) : null;
  List<IMutation> rowMutations=new LinkedList<IMutation>();
  UpdateParameters params=new UpdateParameters(variables,getTimestamp(clientState),getTimeToLive());
  for (  ByteBuffer key : keys)   rowMutations.add(mutationForKey(cfDef,key,builder,params,rows == null ? null : rows.get(key)));
  return rowMutations;
}
