{
  Operation.Type type=valueOperation.getType();
switch (type) {
case COLUMN:
    if (valueDef != null && valueDef.type.isCollection()) {
      ((ColumnOperation)valueOperation).executePreparedCollection(cf,builder.copy(),(CollectionType)valueDef.type,params);
    }
 else {
      valueOperation.execute(cf,builder.copy(),valueDef == null ? null : valueDef.type,params);
    }
  break;
case COUNTER:
if (valueDef != null && valueDef.type.isCollection()) throw new InvalidRequestException("Cannot assign collection value to column with " + valueDef.type + " type.");
valueOperation.execute(cf,builder.copy(),valueDef == null ? null : valueDef.type,params);
break;
default :
if (!valueDef.type.isCollection()) throw new InvalidRequestException("Can't apply collection operation on column with " + valueDef.type + " type.");
valueOperation.execute(cf,builder.copy(),(CollectionType)valueDef.type,params,list);
break;
}
return valueOperation.getType() == Operation.Type.COUNTER;
}
