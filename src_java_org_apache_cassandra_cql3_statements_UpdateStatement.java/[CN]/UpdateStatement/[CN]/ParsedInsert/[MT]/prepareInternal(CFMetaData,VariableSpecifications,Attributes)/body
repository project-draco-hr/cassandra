{
  UpdateStatement stmt=new UpdateStatement(ModificationStatement.StatementType.INSERT,boundNames.size(),cfm,attrs);
  if (stmt.isCounter())   throw new InvalidRequestException("INSERT statements are not allowed on counter tables, use UPDATE instead");
  if (columnNames == null)   throw new InvalidRequestException("Column names for INSERT must be provided when using VALUES");
  if (columnNames.isEmpty())   throw new InvalidRequestException("No columns provided to INSERT");
  if (columnNames.size() != columnValues.size())   throw new InvalidRequestException("Unmatched column names/values");
  String ks=keyspace();
  for (int i=0; i < columnNames.size(); i++) {
    ColumnIdentifier id=columnNames.get(i).prepare(cfm);
    ColumnDefinition def=cfm.getColumnDefinition(id);
    if (def == null)     throw new InvalidRequestException(String.format("Unknown identifier %s",id));
    for (int j=0; j < i; j++) {
      ColumnIdentifier otherId=columnNames.get(j).prepare(cfm);
      if (id.equals(otherId))       throw new InvalidRequestException(String.format("Multiple definitions found for column %s",id));
    }
    Term.Raw value=columnValues.get(i);
    if (def.isPrimaryKeyColumn()) {
      Term t=value.prepare(ks,def);
      t.collectMarkerSpecification(boundNames);
      stmt.addKeyValue(def,t);
    }
 else {
      Operation operation=new Operation.SetValue(value).prepare(ks,def);
      operation.collectMarkerSpecification(boundNames);
      stmt.addOperation(operation);
    }
  }
  return stmt;
}
