{
  UpdateStatement stmt=new UpdateStatement(ModificationStatement.StatementType.INSERT,cfDef.cfm,attrs);
  if (stmt.isCounter())   throw new InvalidRequestException("INSERT statement are not allowed on counter tables, use UPDATE instead");
  if (columnNames.size() != columnValues.size())   throw new InvalidRequestException("Unmatched column names/values");
  if (columnNames.isEmpty())   throw new InvalidRequestException("No columns provided to INSERT");
  for (int i=0; i < columnNames.size(); i++) {
    ColumnIdentifier id=columnNames.get(i).prepare(cfDef.cfm);
    CFDefinition.Name name=cfDef.get(id);
    if (name == null)     throw new InvalidRequestException(String.format("Unknown identifier %s",id));
    for (int j=0; j < i; j++) {
      ColumnIdentifier otherId=columnNames.get(j).prepare(cfDef.cfm);
      if (id.equals(otherId))       throw new InvalidRequestException(String.format("Multiple definitions found for column %s",id));
    }
    Term.Raw value=columnValues.get(i);
switch (name.kind) {
case KEY_ALIAS:
case COLUMN_ALIAS:
      Term t=value.prepare(name);
    t.collectMarkerSpecification(boundNames);
  stmt.addKeyValue(name,t);
break;
case VALUE_ALIAS:
case COLUMN_METADATA:
case STATIC:
Operation operation=new Operation.SetValue(value).prepare(name);
operation.collectMarkerSpecification(boundNames);
stmt.addOperation(operation);
break;
}
}
return stmt;
}
