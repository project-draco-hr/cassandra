{
  UpdateStatement stmt=new UpdateStatement(ModificationStatement.StatementType.UPDATE,boundNames.size(),cfm,attrs);
  for (  Pair<ColumnIdentifier.Raw,Operation.RawUpdate> entry : updates) {
    ColumnDefinition def=cfm.getColumnDefinition(entry.left.prepare(cfm));
    if (def == null)     throw new InvalidRequestException(String.format("Unknown identifier %s",entry.left));
    Operation operation=entry.right.prepare(keyspace(),def);
    operation.collectMarkerSpecification(boundNames);
switch (def.kind) {
case PARTITION_KEY:
case CLUSTERING:
      throw new InvalidRequestException(String.format("PRIMARY KEY part %s found in SET part",entry.left));
default :
    stmt.addOperation(operation);
  break;
}
}
stmt.processWhereClause(whereClause,boundNames);
return stmt;
}
