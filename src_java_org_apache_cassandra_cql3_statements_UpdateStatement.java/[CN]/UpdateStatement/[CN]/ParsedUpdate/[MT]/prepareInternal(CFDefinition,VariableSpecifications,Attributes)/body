{
  UpdateStatement stmt=new UpdateStatement(ModificationStatement.StatementType.UPDATE,cfDef.cfm,attrs);
  for (  Pair<ColumnIdentifier.Raw,Operation.RawUpdate> entry : updates) {
    CFDefinition.Name name=cfDef.get(entry.left.prepare(cfDef.cfm));
    if (name == null)     throw new InvalidRequestException(String.format("Unknown identifier %s",entry.left));
    Operation operation=entry.right.prepare(name);
    operation.collectMarkerSpecification(boundNames);
switch (name.kind) {
case KEY_ALIAS:
case COLUMN_ALIAS:
      throw new InvalidRequestException(String.format("PRIMARY KEY part %s found in SET part",entry.left));
case VALUE_ALIAS:
case COLUMN_METADATA:
case STATIC:
    stmt.addOperation(operation);
  break;
}
}
stmt.processWhereClause(whereClause,boundNames);
return stmt;
}
