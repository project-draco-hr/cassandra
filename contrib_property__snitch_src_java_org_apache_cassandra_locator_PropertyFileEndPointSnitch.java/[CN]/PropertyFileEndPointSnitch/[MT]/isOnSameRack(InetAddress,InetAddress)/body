{
  if (runInBaseMode) {
    return super.isOnSameRack(host,host2);
  }
  if (!isInSameDataCenter(host,host2)) {
    return false;
  }
  return getRackForEndPoint(host).equals(getRackForEndPoint(host2));
}
