{
  try {
    String queryString=uncompress(query,compression);
    if (startSessionIfRequested()) {
      Tracing.instance().begin("execute_cql_query",ImmutableMap.of("query",queryString));
    }
 else {
      logger.debug("execute_cql_query");
    }
    ClientState cState=state();
    if (cState.getCQLVersion().major == 2)     return QueryProcessor.process(queryString,state());
 else     return org.apache.cassandra.cql3.QueryProcessor.process(queryString,cState).toThriftResult();
  }
 catch (  RequestExecutionException e) {
    ThriftConversion.rethrow(e);
    return null;
  }
catch (  RequestValidationException e) {
    throw ThriftConversion.toThrift(e);
  }
 finally {
    Tracing.instance().stopSession();
  }
}
