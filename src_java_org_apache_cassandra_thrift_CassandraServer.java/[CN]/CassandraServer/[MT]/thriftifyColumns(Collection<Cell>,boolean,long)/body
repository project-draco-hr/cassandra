{
  ArrayList<ColumnOrSuperColumn> thriftColumns=new ArrayList<ColumnOrSuperColumn>(cells.size());
  for (  Cell cell : cells) {
    if (cell.isMarkedForDelete(now))     continue;
    thriftColumns.add(thriftifyColumnWithName(cell,cell.name().toByteBuffer()));
  }
  if (reverseOrder)   Collections.reverse(thriftColumns);
  return thriftColumns;
}
