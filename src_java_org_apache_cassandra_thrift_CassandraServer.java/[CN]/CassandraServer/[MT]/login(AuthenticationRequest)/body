{
  AccessLevel level;
  if (keySpace.get() == null) {
    throw new AuthenticationException("You have not set a specific keyspace; please call set_keyspace first");
  }
  level=DatabaseDescriptor.getAuthenticator().login(keySpace.get(),auth_request);
  if (logger.isDebugEnabled())   logger.debug("login confirmed; new access level is " + level);
  loginDone.set(level);
  return level;
}
