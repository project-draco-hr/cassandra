{
  if (logger.isDebugEnabled())   logger.debug("prepare_cql_query");
  try {
    String queryString=uncompress(query,compression);
    ClientState cState=state();
    if (cState.getCQLVersion().major == 2)     return QueryProcessor.prepare(queryString,cState);
 else     return org.apache.cassandra.cql3.QueryProcessor.prepare(queryString,cState).toThriftPreparedResult();
  }
 catch (  RequestValidationException e) {
    throw ThriftConversion.toThrift(e);
  }
}
