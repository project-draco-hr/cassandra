{
  if (subcolumnsOnly) {
    ArrayList<ColumnOrSuperColumn> thriftSuperColumns=new ArrayList<ColumnOrSuperColumn>(cells.size());
    for (    Cell cell : cells) {
      if (cell.isMarkedForDelete(now))       continue;
      thriftSuperColumns.add(thriftifyColumnWithName(cell,SuperColumns.subName(cell.name())));
    }
    if (reverseOrder)     Collections.reverse(thriftSuperColumns);
    return thriftSuperColumns;
  }
 else {
    if (isCounterCF)     return thriftifyCounterSuperColumns(cells,reverseOrder,now);
 else     return thriftifySuperColumns(cells,reverseOrder,now);
  }
}
