{
  ArrayList<ColumnOrSuperColumn> thriftSuperColumns=new ArrayList<ColumnOrSuperColumn>(columns.size());
  CounterSuperColumn current=null;
  for (  org.apache.cassandra.db.Column column : columns) {
    if (column.isMarkedForDelete(now))     continue;
    ByteBuffer scName=SuperColumns.scName(column.name());
    if (current == null || !scName.equals(current.bufferForName())) {
      current=new CounterSuperColumn(scName,new ArrayList<CounterColumn>());
      thriftSuperColumns.add(new ColumnOrSuperColumn().setCounter_super_column(current));
    }
    current.getColumns().add(thriftifySubCounter(column).setName(SuperColumns.subName(column.name())));
  }
  if (reverseOrder)   Collections.reverse(thriftSuperColumns);
  return thriftSuperColumns;
}
