{
  if (keySpace.get() == null) {
    throw new InvalidRequestException("You have not assigned a keyspace; please use set_keyspace (and login if necessary)");
  }
  if (!(DatabaseDescriptor.getAuthenticator() instanceof AllowAllAuthenticator)) {
    if (loginDone.get() == null)     throw new InvalidRequestException("You have not logged into keyspace " + keySpace.get());
    if (loginDone.get().getValue() < level.getValue())     throw new InvalidRequestException("Your credentials are not sufficient to perform " + level + " operations");
  }
}
