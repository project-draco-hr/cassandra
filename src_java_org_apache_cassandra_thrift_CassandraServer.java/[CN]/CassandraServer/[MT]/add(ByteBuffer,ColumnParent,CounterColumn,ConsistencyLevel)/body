{
  logger.debug("add");
  state().hasColumnFamilyAccess(column_parent.column_family,Permission.WRITE);
  String keyspace=state().getKeyspace();
  CFMetaData metadata=ThriftValidation.validateColumnFamily(keyspace,column_parent.column_family,true);
  ThriftValidation.validateKey(metadata,key);
  ThriftValidation.validateCommutativeForWrite(metadata,consistency_level);
  ThriftValidation.validateColumnParent(metadata,column_parent);
  if (metadata.cfType == ColumnFamilyType.Super && column_parent.super_column == null) {
    throw new InvalidRequestException("missing mandatory super column name for super CF " + column_parent.column_family);
  }
  ThriftValidation.validateColumnNames(metadata,column_parent,Arrays.asList(column.name));
  RowMutation rm=new RowMutation(keyspace,key);
  try {
    rm.addCounter(new QueryPath(column_parent.column_family,column_parent.super_column,column.name),column.value);
  }
 catch (  MarshalException e) {
    throw new InvalidRequestException(e.getMessage());
  }
  doInsert(consistency_level,Arrays.asList(new CounterMutation(rm,consistency_level)));
}
