{
  ArrayList<ColumnOrSuperColumn> thriftColumns=new ArrayList<ColumnOrSuperColumn>(columns.size());
  for (  IColumn column : columns) {
    if (column.isMarkedForDelete()) {
      continue;
    }
    if (column instanceof org.apache.cassandra.db.CounterColumn) {
      CounterColumn thrift_column=new CounterColumn(column.name(),CounterContext.instance().total(column.value()));
      thriftColumns.add(new ColumnOrSuperColumn().setCounter_column(thrift_column));
    }
 else {
      Column thrift_column=new Column(column.name(),column.value(),column.timestamp());
      if (column instanceof ExpiringColumn) {
        thrift_column.setTtl(((ExpiringColumn)column).getTimeToLive());
      }
      thriftColumns.add(new ColumnOrSuperColumn().setColumn(thrift_column));
    }
  }
  if (reverseOrder)   Collections.reverse(thriftColumns);
  return thriftColumns;
}
