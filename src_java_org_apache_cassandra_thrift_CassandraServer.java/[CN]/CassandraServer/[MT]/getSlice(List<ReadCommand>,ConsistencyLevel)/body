{
  Map<byte[],ColumnFamily> columnFamilies=readColumnFamily(commands,consistency_level);
  Map<String,List<ColumnOrSuperColumn>> columnFamiliesMap=new HashMap<String,List<ColumnOrSuperColumn>>();
  for (  ReadCommand command : commands) {
    ColumnFamily cf=columnFamilies.get(command.key);
    boolean reverseOrder=command instanceof SliceFromReadCommand && ((SliceFromReadCommand)command).reversed;
    List<ColumnOrSuperColumn> thriftifiedColumns=thriftifyColumnFamily(cf,command.queryPath.superColumnName != null,reverseOrder);
    columnFamiliesMap.put(new String(command.key,UTF8),thriftifiedColumns);
  }
  return columnFamiliesMap;
}
