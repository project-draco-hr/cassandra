{
  org.apache.cassandra.db.ConsistencyLevel consistencyLevel=ThriftConversion.fromThrift(consistency_level);
  consistencyLevel.validateForWrite(state().getKeyspace());
  if (mutations.isEmpty())   return;
  schedule(DatabaseDescriptor.getWriteRpcTimeout());
  try {
    if (mutateAtomically)     StorageProxy.mutateAtomically((List<RowMutation>)mutations,consistencyLevel);
 else     StorageProxy.mutate(mutations,consistencyLevel);
  }
 catch (  RequestExecutionException e) {
    ThriftConversion.rethrow(e);
  }
 finally {
    release();
  }
}
