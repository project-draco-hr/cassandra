{
  if (subcolumnsOnly) {
    ArrayList<ColumnOrSuperColumn> thriftSuperColumns=new ArrayList<ColumnOrSuperColumn>(columns.size());
    for (    org.apache.cassandra.db.Column column : columns) {
      if (column.isMarkedForDelete(now))       continue;
      thriftSuperColumns.add(thriftifyColumnWithName(column,SuperColumns.subName(column.name())));
    }
    if (reverseOrder)     Collections.reverse(thriftSuperColumns);
    return thriftSuperColumns;
  }
 else {
    if (isCounterCF)     return thriftifyCounterSuperColumns(columns,reverseOrder,now);
 else     return thriftifySuperColumns(columns,reverseOrder,now);
  }
}
