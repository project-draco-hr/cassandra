{
  if (logger.isDebugEnabled())   logger.debug("scan");
  clientState.hasKeyspaceAccess(Permission.READ_VALUE);
  String keyspace=clientState.getKeyspace();
  ThriftValidation.validateColumnParent(keyspace,column_parent);
  ThriftValidation.validatePredicate(keyspace,column_parent,column_predicate);
  ThriftValidation.validateIndexClauses(keyspace,column_parent.column_family,index_clause);
  List<Row> rows;
  try {
    rows=StorageProxy.scan(keyspace,column_parent.column_family,index_clause,column_predicate,consistency_level);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  TimeoutException e) {
    throw new TimedOutException();
  }
  return thriftifyKeySlices(rows,column_parent,column_predicate);
}
