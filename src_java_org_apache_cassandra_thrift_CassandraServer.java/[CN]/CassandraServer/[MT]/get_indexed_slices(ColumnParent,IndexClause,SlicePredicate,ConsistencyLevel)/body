{
  logger.debug("scan");
  state().hasColumnFamilyAccess(column_parent.column_family,Permission.READ);
  String keyspace=state().getKeyspace();
  CFMetaData metadata=ThriftValidation.validateColumnFamily(keyspace,column_parent.column_family,false);
  ThriftValidation.validateColumnParent(metadata,column_parent);
  ThriftValidation.validatePredicate(metadata,column_parent,column_predicate);
  ThriftValidation.validateIndexClauses(metadata,index_clause);
  List<Row> rows;
  try {
    rows=StorageProxy.scan(keyspace,column_parent.column_family,index_clause,column_predicate,consistency_level);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  TimeoutException e) {
    logger.debug("... timed out");
    throw new TimedOutException();
  }
  return thriftifyKeySlices(rows,column_parent,column_predicate);
}
