{
  if (keyspace == null || !DatabaseDescriptor.getNonSystemTables().contains(keyspace))   throw new InvalidRequestException("There is no ring for the keyspace: " + keyspace);
  List<TokenRange> ranges=new ArrayList<TokenRange>();
  Token.TokenFactory tf=StorageService.getPartitioner().getTokenFactory();
  Map<Range,List<InetAddress>> address_map=StorageService.instance.getRangeToAddressMap(keyspace);
  for (  Map.Entry<Range,List<InetAddress>> entry : address_map.entrySet()) {
    Range range=entry.getKey();
    List<String> endpoints=new ArrayList<String>();
    List<String> rpc_endpoints=new ArrayList<String>();
    for (    InetAddress endpoint : entry.getValue()) {
      endpoints.add(endpoint.getHostAddress());
      rpc_endpoints.add(StorageService.instance.getRpcaddress(endpoint));
    }
    TokenRange tr=new TokenRange(tf.toString(range.left),tf.toString(range.right),endpoints);
    tr.rpc_endpoints=rpc_endpoints;
    ranges.add(tr);
  }
  return ranges;
}
