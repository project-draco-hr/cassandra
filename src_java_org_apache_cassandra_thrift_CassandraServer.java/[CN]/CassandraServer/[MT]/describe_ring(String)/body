{
  if (keyspace == null || !DatabaseDescriptor.getNonSystemTables().contains(keyspace))   throw new InvalidRequestException("There is no ring for the keyspace: " + keyspace);
  List<TokenRange> ranges=new ArrayList<TokenRange>();
  Token.TokenFactory tf=StorageService.getPartitioner().getTokenFactory();
  for (  Map.Entry<Range,List<String>> entry : StorageService.instance.getRangeToEndpointMap(keyspace).entrySet()) {
    Range range=entry.getKey();
    List<String> endpoints=entry.getValue();
    ranges.add(new TokenRange(tf.toString(range.left),tf.toString(range.right),endpoints));
  }
  return ranges;
}
