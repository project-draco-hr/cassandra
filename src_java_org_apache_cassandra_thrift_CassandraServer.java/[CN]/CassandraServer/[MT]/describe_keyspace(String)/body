{
  Map<String,Map<String,String>> columnFamiliesMap=new HashMap<String,Map<String,String>>();
  Map<String,CFMetaData> tableMetaData=DatabaseDescriptor.getTableMetaData(table);
  if (tableMetaData == null) {
    throw new NotFoundException();
  }
  for (  Map.Entry<String,CFMetaData> stringCFMetaDataEntry : tableMetaData.entrySet()) {
    CFMetaData columnFamilyMetaData=stringCFMetaDataEntry.getValue();
    Map<String,String> columnMap=new HashMap<String,String>();
    columnMap.put("Type",columnFamilyMetaData.columnType);
    columnMap.put("Desc",columnFamilyMetaData.comment == null ? columnFamilyMetaData.pretty() : columnFamilyMetaData.comment);
    columnMap.put("CompareWith",columnFamilyMetaData.comparator.getClass().getName());
    if (columnFamilyMetaData.columnType.equals("Super")) {
      columnMap.put("CompareSubcolumnsWith",columnFamilyMetaData.subcolumnComparator.getClass().getName());
    }
    columnFamiliesMap.put(columnFamilyMetaData.cfName,columnMap);
  }
  return columnFamiliesMap;
}
