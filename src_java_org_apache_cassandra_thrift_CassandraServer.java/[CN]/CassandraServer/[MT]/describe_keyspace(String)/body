{
  Map<String,Map<String,String>> columnFamiliesMap=new HashMap<String,Map<String,String>>();
  KSMetaData ksm=DatabaseDescriptor.getTableDefinition(table);
  if (ksm == null)   throw new NotFoundException();
  for (  Map.Entry<String,CFMetaData> stringCFMetaDataEntry : ksm.cfMetaData().entrySet()) {
    CFMetaData columnFamilyMetaData=stringCFMetaDataEntry.getValue();
    Map<String,String> columnMap=new HashMap<String,String>();
    columnMap.put("Type",columnFamilyMetaData.cfType.name());
    columnMap.put("Desc",columnFamilyMetaData.comment == null ? columnFamilyMetaData.pretty() : columnFamilyMetaData.comment);
    columnMap.put("CompareWith",columnFamilyMetaData.comparator.getClass().getName());
    if (columnFamilyMetaData.cfType == ColumnFamilyType.Super) {
      columnMap.put("CompareSubcolumnsWith",columnFamilyMetaData.subcolumnComparator.getClass().getName());
    }
    columnFamiliesMap.put(columnFamilyMetaData.cfName,columnMap);
  }
  return columnFamiliesMap;
}
