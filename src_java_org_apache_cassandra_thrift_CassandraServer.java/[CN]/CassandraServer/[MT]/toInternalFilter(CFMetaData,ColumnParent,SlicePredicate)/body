{
  IDiskAtomFilter filter;
  CellNameType columnType=metadata.isSuper() ? new SimpleDenseCellNameType(metadata.comparator.subtype(parent.isSetSuper_column() ? 1 : 0)) : metadata.comparator;
  if (predicate.column_names != null) {
    if (metadata.isSuper()) {
      SortedSet<CellName> s=new TreeSet<CellName>(columnType);
      for (      ByteBuffer bb : predicate.column_names)       s.add(columnType.cellFromByteBuffer(bb));
      filter=SuperColumns.fromSCNamesFilter(metadata.comparator,parent.bufferForSuper_column(),new NamesQueryFilter(s));
    }
 else {
      SortedSet<CellName> s=new TreeSet<CellName>(metadata.comparator);
      for (      ByteBuffer bb : predicate.column_names)       s.add(metadata.comparator.cellFromByteBuffer(bb));
      filter=new NamesQueryFilter(s);
    }
  }
 else {
    filter=toInternalFilter(metadata,parent,predicate.slice_range);
  }
  return filter;
}
