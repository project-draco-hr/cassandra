{
  IDiskAtomFilter filter;
  if (predicate.column_names != null) {
    if (metadata.isSuper()) {
      CompositeType type=(CompositeType)metadata.comparator;
      SortedSet s=new TreeSet<ByteBuffer>(parent.isSetSuper_column() ? type.types.get(1) : type.types.get(0));
      s.addAll(predicate.column_names);
      filter=SuperColumns.fromSCNamesFilter(type,parent.bufferForSuper_column(),new NamesQueryFilter(s));
    }
 else {
      SortedSet s=new TreeSet<ByteBuffer>(metadata.comparator);
      s.addAll(predicate.column_names);
      filter=new NamesQueryFilter(s);
    }
  }
 else {
    filter=toInternalFilter(metadata,parent,predicate.slice_range);
  }
  return filter;
}
