{
  if (!func.hasKeyspace()) {
    FunctionName nativeName=FunctionName.nativeFunction(func.name);
    if (Schema.instance.findFunction(nativeName,argTypes).isPresent())     return nativeName;
    return new FunctionName(functionName.keyspace,func.name);
  }
 else   if (!SystemKeyspace.NAME.equals(func.keyspace) && !functionName.keyspace.equals(func.keyspace))   throw new InvalidRequestException(String.format("Statement on keyspace %s cannot refer to a user function in keyspace %s; " + "user functions can only be used in the keyspace they are defined in",functionName.keyspace,func.keyspace));
  return func;
}
