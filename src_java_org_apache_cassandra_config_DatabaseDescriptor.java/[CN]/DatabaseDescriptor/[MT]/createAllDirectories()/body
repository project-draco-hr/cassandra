{
  try {
    if (dataFileDirectories_.length == 0) {
      throw new ConfigurationException("At least one DataFileDirectory must be specified");
    }
    for (    String dataFileDirectory : dataFileDirectories_)     FileUtils.createDirectory(dataFileDirectory);
    if (logFileDirectory_ == null) {
      throw new ConfigurationException("CommitLogDirectory must be specified");
    }
    FileUtils.createDirectory(logFileDirectory_);
  }
 catch (  ConfigurationException ex) {
    logger_.error("Fatal error: " + ex.getMessage());
    System.err.println("Bad configuration; unable to start server");
    System.exit(1);
  }
  for (  String dataFile : dataFileDirectories_) {
    FileUtils.createDirectory(dataFile + File.separator + Table.SYSTEM_TABLE);
    for (    String table : tables_) {
      String oneDir=dataFile + File.separator + table;
      FileUtils.createDirectory(oneDir);
      File streamingDir=new File(oneDir,STREAMING_SUBDIR);
      if (streamingDir.exists())       FileUtils.deleteDir(streamingDir);
    }
  }
}
