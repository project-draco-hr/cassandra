{
  Class<? extends AbstractType> typeClass;
  String compareWith=null;
  try {
    compareWith=XMLUtils.getAttributeValue(columnFamily,attr);
  }
 catch (  TransformerException e) {
    ConfigurationException ex=new ConfigurationException(e.getMessage());
    ex.initCause(e);
    throw ex;
  }
  if (compareWith == null) {
    typeClass=BytesType.class;
  }
 else {
    String className=compareWith.contains(".") ? compareWith : "org.apache.cassandra.db.marshal." + compareWith;
    try {
      typeClass=(Class<? extends AbstractType>)Class.forName(className);
    }
 catch (    ClassNotFoundException e) {
      throw new ConfigurationException("Unable to load class " + className + " for "+ attr+ " attribute");
    }
  }
  try {
    return typeClass.getConstructor().newInstance();
  }
 catch (  InstantiationException e) {
    ConfigurationException ex=new ConfigurationException(e.getMessage());
    ex.initCause(e);
    throw ex;
  }
catch (  IllegalAccessException e) {
    ConfigurationException ex=new ConfigurationException(e.getMessage());
    ex.initCause(e);
    throw ex;
  }
catch (  InvocationTargetException e) {
    ConfigurationException ex=new ConfigurationException(e.getMessage());
    ex.initCause(e);
    throw ex;
  }
catch (  NoSuchMethodException e) {
    ConfigurationException ex=new ConfigurationException(e.getMessage());
    ex.initCause(e);
    throw ex;
  }
}
