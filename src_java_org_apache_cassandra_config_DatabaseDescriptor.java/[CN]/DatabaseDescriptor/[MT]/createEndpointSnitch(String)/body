{
  IEndpointSnitch snitch;
  Class cls;
  try {
    cls=Class.forName(endpointSnitchClassName);
  }
 catch (  ClassNotFoundException e) {
    throw new ConfigurationException("Unable to load endpointsnitch class " + endpointSnitchClassName);
  }
  Constructor ctor;
  try {
    ctor=cls.getConstructor();
  }
 catch (  NoSuchMethodException e) {
    throw new ConfigurationException("No default constructor found in " + endpointSnitchClassName);
  }
  try {
    snitch=(IEndpointSnitch)ctor.newInstance();
  }
 catch (  InstantiationException e) {
    throw new ConfigurationException("endpointsnitch class " + endpointSnitchClassName + "is abstract");
  }
catch (  IllegalAccessException e) {
    throw new ConfigurationException("Access to " + endpointSnitchClassName + " constructor was rejected");
  }
catch (  InvocationTargetException e) {
    if (e.getCause() instanceof ConfigurationException)     throw (ConfigurationException)e.getCause();
    throw new ConfigurationException("Error instantiating " + endpointSnitchClassName + " "+ e.getMessage());
  }
  return snitch;
}
