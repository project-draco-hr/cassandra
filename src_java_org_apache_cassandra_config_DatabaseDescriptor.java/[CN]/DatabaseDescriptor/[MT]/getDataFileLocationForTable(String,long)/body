{
  long maxFreeDisk=0;
  int maxDiskIndex=0;
  String dataFileDirectory=null;
  String[] dataDirectoryForTable=getAllDataFileLocationsForTable(table);
  for (int i=0; i < dataDirectoryForTable.length; i++) {
    File f=new File(dataDirectoryForTable[i]);
    if (maxFreeDisk < f.getUsableSpace()) {
      maxFreeDisk=f.getUsableSpace();
      maxDiskIndex=i;
    }
  }
  logger.debug("expected data files size is {}; largest free partition has {} bytes free",expectedCompactedFileSize,maxFreeDisk);
  maxFreeDisk=(long)(0.9 * maxFreeDisk);
  if (expectedCompactedFileSize < maxFreeDisk) {
    dataFileDirectory=dataDirectoryForTable[maxDiskIndex];
    currentIndex=(maxDiskIndex + 1) % dataDirectoryForTable.length;
  }
 else {
    currentIndex=maxDiskIndex;
  }
  return dataFileDirectory;
}
