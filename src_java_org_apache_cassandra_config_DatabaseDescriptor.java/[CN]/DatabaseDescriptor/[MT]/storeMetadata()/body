{
  int cfId=0;
  Set<String> tables=tables_.keySet();
  for (  String table : tables) {
    Table.TableMetadata tmetadata=Table.TableMetadata.instance(table);
    if (tmetadata.isEmpty()) {
      tmetadata=Table.TableMetadata.instance(table);
      Map<String,CFMetaData> columnFamilies=tables_.get(table).cfMetaData;
      for (      String columnFamily : columnFamilies.keySet()) {
        tmetadata.add(columnFamily,cfId++,DatabaseDescriptor.getColumnType(table,columnFamily));
      }
    }
  }
}
