{
  try {
    memtable_.flush(cLogCtx_);
  }
 catch (  IOException e) {
    logger_.debug(LogUtil.throwableToString(e));
  }
  rwLock_.writeLock().lock();
  try {
    List<Memtable> memtables=history_.get(memtable_.getColumnFamily());
    memtables.remove(memtable_);
  }
  finally {
    rwLock_.writeLock().unlock();
  }
}
