{
  logger.info("Initializing key cache with capacity of {} MBs.",DatabaseDescriptor.getKeyCacheSizeInMB());
  long keyCacheInMemoryCapacity=DatabaseDescriptor.getKeyCacheSizeInMB() * 1024 * 1024;
  ICache<KeyCacheKey,RowIndexEntry> kc=ConcurrentLinkedHashCache.create(keyCacheInMemoryCapacity / AVERAGE_KEY_CACHE_ROW_SIZE);
  AutoSavingCache<KeyCacheKey,RowIndexEntry> keyCache=new AutoSavingCache<KeyCacheKey,RowIndexEntry>(kc,CacheType.KEY_CACHE);
  int keyCacheKeysToSave=DatabaseDescriptor.getKeyCacheKeysToSave();
  logger.info("Scheduling key cache save to each {} seconds (going to save {} keys).",keyCacheSavePeriod,keyCacheKeysToSave == Integer.MAX_VALUE ? "all" : keyCacheKeysToSave);
  keyCache.scheduleSaving(keyCacheSavePeriod,keyCacheKeysToSave);
  return keyCache;
}
