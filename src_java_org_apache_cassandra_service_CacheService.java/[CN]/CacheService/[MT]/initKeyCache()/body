{
  logger.info("Initializing key cache with capacity of {} MBs.",DatabaseDescriptor.getKeyCacheSizeInMB());
  long keyCacheInMemoryCapacity=DatabaseDescriptor.getKeyCacheSizeInMB() * 1024 * 1024;
  ICache<KeyCacheKey,RowIndexEntry> kc;
  kc=ConcurrentLinkedHashCache.create(keyCacheInMemoryCapacity);
  AutoSavingCache<KeyCacheKey,RowIndexEntry> keyCache=new AutoSavingCache<KeyCacheKey,RowIndexEntry>(kc,CacheType.KEY_CACHE,new KeyCacheSerializer());
  int keyCacheKeysToSave=DatabaseDescriptor.getKeyCacheKeysToSave();
  logger.info("Scheduling key cache save to each {} seconds (going to save {} keys).",DatabaseDescriptor.getKeyCacheSavePeriod(),keyCacheKeysToSave == Integer.MAX_VALUE ? "all" : keyCacheKeysToSave);
  keyCache.scheduleSaving(DatabaseDescriptor.getKeyCacheSavePeriod(),keyCacheKeysToSave);
  return keyCache;
}
