{
  while (true) {
    ByteBuffer bb=take();
    if (bb == CLOSE_SENTINEL) {
      disconnect();
      continue;
    }
    if (socket != null || connect())     writeConnected(bb);
 else     queue.clear();
  }
}
