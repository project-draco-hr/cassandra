{
  try {
    output.write(bb.array(),bb.position() + bb.arrayOffset(),bb.limit() + bb.arrayOffset());
    if (queue.peek() == null) {
      output.flush();
    }
  }
 catch (  IOException e) {
    logger.info("error writing to " + endpoint);
    disconnect();
  }
}
