{
  if (logger.isDebugEnabled())   logger.debug("attempting to connect to " + endpoint);
  long start=System.currentTimeMillis();
  while (System.currentTimeMillis() < start + DatabaseDescriptor.getRpcTimeout()) {
    try {
      if (DatabaseDescriptor.getEncryptionOptions().internode_encryption == EncryptionOptions.InternodeEncryption.all) {
        socket=SSLFactory.getSocket(DatabaseDescriptor.getEncryptionOptions(),endpoint,DatabaseDescriptor.getStoragePort(),FBUtilities.getLocalAddress(),0);
      }
 else {
        socket=new Socket(endpoint,DatabaseDescriptor.getStoragePort(),FBUtilities.getLocalAddress(),0);
      }
      socket.setKeepAlive(true);
      socket.setTcpNoDelay(true);
      output=new DataOutputStream(new BufferedOutputStream(socket.getOutputStream(),4096));
      return true;
    }
 catch (    IOException e) {
      socket=null;
      if (logger.isTraceEnabled())       logger.trace("unable to connect to " + endpoint,e);
      try {
        Thread.sleep(OPEN_RETRY_DELAY);
      }
 catch (      InterruptedException e1) {
        throw new AssertionError(e1);
      }
    }
  }
  return false;
}
