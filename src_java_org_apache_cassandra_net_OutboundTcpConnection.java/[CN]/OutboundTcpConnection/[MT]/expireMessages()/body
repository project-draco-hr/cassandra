{
  while (true) {
    QueuedMessage qm=backlog.peek();
    if (qm == null || qm.timestamp >= System.currentTimeMillis() - qm.message.getTimeout())     break;
    QueuedMessage qm2=backlog.poll();
    if (qm2 != qm) {
      if (qm2 != null)       active.add(qm2);
      break;
    }
    dropped.incrementAndGet();
  }
}
