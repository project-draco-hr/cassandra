{
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  SSTableReader sstable=sstable(cfs,0,128);
  TransactionLogs transactionLogs=new TransactionLogs(OperationType.COMPACTION,cfs.metadata);
  assertNotNull(transactionLogs);
  TransactionLogs.SSTableTidier tidier=transactionLogs.obsoleted(sstable);
  assertNotNull(tidier);
  tidier.abort();
  transactionLogs.abort();
  sstable.selfRef().release();
  assertFiles(transactionLogs.getDataFolder(),new HashSet<>(sstable.getAllFilePaths()));
  assertFiles(transactionLogs.getLogsFolder(),Collections.<String>emptySet());
  assertEquals(0,TransactionLogs.getLogFiles(cfs.metadata).size());
}
