{
  IFileReader dataReader=SequenceFile.bufferedReader(dataFile,bufferSize_);
  DataOutputBuffer bufOut=new DataOutputBuffer();
  DataInputBuffer bufIn=new DataInputBuffer();
  int blockCount=0;
  try {
    while (!dataReader.isEOF()) {
      bufOut.reset();
      dataReader.next(bufOut);
      bufIn.reset(bufOut.getData(),bufOut.getLength());
      String key=bufIn.readUTF();
      if (key.equals(SSTable.blockIndexKey_)) {
        ++blockCount;
      }
    }
  }
  finally {
    dataReader.close();
  }
  return blockCount;
}
