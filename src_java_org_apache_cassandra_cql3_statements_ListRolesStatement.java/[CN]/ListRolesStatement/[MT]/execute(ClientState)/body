{
  if (state.getUser().isSuper()) {
    if (grantee == null)     return resultMessage(DatabaseDescriptor.getRoleManager().getAllRoles());
 else     return resultMessage(DatabaseDescriptor.getRoleManager().getRoles(grantee,recursive));
  }
 else {
    if (grantee == null)     return resultMessage(DatabaseDescriptor.getRoleManager().getRoles(state.getUser().getName(),recursive));
    if (DatabaseDescriptor.getRoleManager().getRoles(state.getUser().getName(),true).contains(grantee))     return resultMessage(DatabaseDescriptor.getRoleManager().getRoles(grantee,recursive));
 else     throw new UnauthorizedException(String.format("You are not authorized to view roles granted to %s ",grantee));
  }
}
