{
  boolean bVal=true;
  int estimate=0;
  int size=epStateMap.size();
  dos.writeInt(size);
  for (  Entry<InetAddress,EndPointState> entry : epStateMap.entrySet()) {
    InetAddress ep=entry.getKey();
    if (Gossiper.MAX_GOSSIP_PACKET_SIZE - dos.size() < estimate) {
      logger_.info("@@@@ Breaking out to respect the MTU size in EPS. Estimate is " + estimate + " @@@@");
      bVal=false;
      break;
    }
    int pre=dos.size();
    CompactEndPointSerializationHelper.serialize(ep,dos);
    EndPointState.serializer().serialize(entry.getValue(),dos);
    int post=dos.size();
    estimate=post - pre;
  }
  return bVal;
}
