{
  if (newLength < 0)   throw new IllegalArgumentException();
  if (isDirty) {
    if (newLength < bufferOffset) {
      validBufferBytes=0;
    }
 else     if (newLength > (bufferOffset + validBufferBytes)) {
      flush();
    }
 else {
      validBufferBytes=(int)(newLength - bufferOffset);
      flush();
    }
  }
  super.setLength(newLength);
  validBufferBytes=0;
  current=newLength;
  reBuffer();
}
