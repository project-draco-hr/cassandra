{
  flush();
  buffer.clear();
  bufferOffset=current;
  if (bufferOffset > channel.size()) {
    buffer.rewind();
    bufferEnd=bufferOffset;
    hitEOF=true;
    return 0;
  }
  if (bufferOffset < minBufferOffset)   minBufferOffset=bufferOffset;
  channel.position(bufferOffset);
  long bytesRead=channel.read(buffer);
  hitEOF=(bytesRead < maxBufferSize);
  bufferEnd=bufferOffset + bytesRead;
  buffer.rewind();
  bytesSinceCacheFlush+=bytesRead;
  if (skipCache && bytesSinceCacheFlush >= MAX_BYTES_IN_PAGE_CACHE) {
    CLibrary.trySkipCache(this.fd,(int)minBufferOffset,0);
    bytesSinceCacheFlush=0;
    minBufferOffset=Long.MAX_VALUE;
  }
  return bytesRead;
}
