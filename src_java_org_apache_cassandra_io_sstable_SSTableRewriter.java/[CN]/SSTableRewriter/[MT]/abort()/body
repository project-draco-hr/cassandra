{
  switchWriter(null,true);
  moveStarts(null,Functions.forMap(originalStarts),true);
  for (  SSTableReader sstable : finished) {
    sstable.markObsolete();
    sstable.sharedRef().release();
  }
  for (  Finished finished : finishedEarly) {
    boolean opened=finished.reader != null;
    finished.writer.abort(!opened);
    if (opened) {
      discard.add(finished.reader);
      finished.reader.markObsolete();
    }
  }
  replaceWithFinishedReaders(Collections.<SSTableReader>emptyList());
}
