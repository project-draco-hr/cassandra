{
  if (writer == null)   return;
  moveStarts(null,Functions.forMap(originalStarts),true);
  List<SSTableReader> close=new ArrayList<>(finished);
  if (currentlyOpenedEarly != null)   close.add(currentlyOpenedEarly);
  for (  SSTableReader sstable : close)   sstable.markObsolete();
  if (!isOffline) {
    dataTracker.replaceReaders(close,Collections.<SSTableReader>emptyList(),false);
    dataTracker.unmarkCompacting(close);
  }
  writer.abort(currentlyOpenedEarly == null);
}
