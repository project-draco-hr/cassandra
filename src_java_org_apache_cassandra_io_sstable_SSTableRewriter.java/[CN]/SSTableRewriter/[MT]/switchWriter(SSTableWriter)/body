{
  if (writer == null || writer.getFilePointer() == 0) {
    if (writer != null)     writer.abort();
    writer=newWriter;
    return;
  }
  SSTableReader reader=null;
  if (preemptiveOpenInterval != Long.MAX_VALUE) {
    reader=writer.setMaxDataAge(maxAge).openFinalEarly();
    replaceEarlyOpenedFile(currentlyOpenedEarly,reader);
    moveStarts(reader,reader.last,false);
  }
  finishedWriters.add(new Finished(writer,reader));
  currentlyOpenedEarly=null;
  currentlyOpenedEarlyAt=0;
  writer=newWriter;
}
