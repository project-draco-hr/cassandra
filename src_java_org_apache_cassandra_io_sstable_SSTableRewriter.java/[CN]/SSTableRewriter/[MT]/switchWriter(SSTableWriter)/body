{
  if (writer == null) {
    writer=newWriter;
    return;
  }
  if (writer.getFilePointer() != 0) {
    if (preemptiveOpenInterval == Long.MAX_VALUE) {
      SSTableReader reader=writer.finish(SSTableWriter.FinishType.NORMAL,maxAge,-1);
      finishedReaders.add(reader);
    }
 else {
      SSTableReader reader=writer.finish(SSTableWriter.FinishType.EARLY,maxAge,-1);
      replaceEarlyOpenedFile(currentlyOpenedEarly,reader);
      moveStarts(reader,reader.last,false);
      finishedEarly.add(new Finished(writer,reader));
    }
  }
 else {
    writer.abort();
  }
  currentlyOpenedEarly=null;
  currentlyOpenedEarlyAt=0;
  writer=newWriter;
}
