{
  if (isOffline) {
    for (    SSTableReader reader : discard) {
      try {
        if (reader.getCurrentReplacement() == reader)         reader.markObsolete();
      }
 catch (      Throwable t) {
        accumulate=merge(accumulate,t);
      }
    }
    accumulate=Refs.release(Refs.selfRefs(discard),accumulate);
  }
 else {
    try {
      dataTracker.replaceEarlyOpenedFiles(discard,finished);
    }
 catch (    Throwable t) {
      accumulate=merge(accumulate,t);
    }
    try {
      dataTracker.unmarkCompacting(discard);
    }
 catch (    Throwable t) {
      accumulate=merge(accumulate,t);
    }
  }
  discard.clear();
  return accumulate;
}
