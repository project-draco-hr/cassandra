{
  if (isOffline) {
    for (    SSTableReader reader : discard) {
      if (dataTracker.getCurrentVersion(reader) == reader)       reader.markObsolete(dataTracker);
      reader.selfRef().release();
    }
  }
 else {
    dataTracker.replaceEarlyOpenedFiles(discard,finished);
    dataTracker.unmarkCompacting(discard);
  }
  discard.clear();
}
