{
  if (isOffline) {
    for (    SSTableReader reader : discard) {
      if (!reader.isReplaced())       reader.markObsolete(null);
      reader.selfRef().release();
    }
  }
 else {
    dataTracker.replaceEarlyOpenedFiles(discard,finished);
    dataTracker.unmarkCompacting(discard);
  }
  discard.clear();
}
