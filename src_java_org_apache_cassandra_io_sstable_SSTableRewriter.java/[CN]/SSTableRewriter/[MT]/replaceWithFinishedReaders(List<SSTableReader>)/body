{
  if (isOffline) {
    for (    SSTableReader reader : discard) {
      if (reader.getCurrentReplacement() == null)       reader.markObsolete();
      reader.sharedRef().release();
    }
  }
 else {
    dataTracker.replaceEarlyOpenedFiles(discard,finished);
    dataTracker.unmarkCompacting(discard);
  }
  discard.clear();
}
