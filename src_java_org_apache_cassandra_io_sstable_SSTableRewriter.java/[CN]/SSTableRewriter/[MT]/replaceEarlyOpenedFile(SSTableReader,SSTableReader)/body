{
  if (isOffline)   return;
  Set<SSTableReader> toReplaceSet;
  if (toReplace != null) {
    toReplace.setReplacedBy(replaceWith);
    toReplaceSet=Collections.singleton(toReplace);
  }
 else {
    dataTracker.markCompacting(Collections.singleton(replaceWith),true,isOffline);
    toReplaceSet=Collections.emptySet();
  }
  dataTracker.replaceEarlyOpenedFiles(toReplaceSet,Collections.singleton(replaceWith));
}
