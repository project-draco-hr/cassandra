{
  ClockRelationship cr=left.clock().compare(right.clock());
switch (cr) {
case EQUAL:
    if (left.isMarkedForDelete())     return left;
  if (right.isMarkedForDelete())   return right;
return FBUtilities.compareByteArrays(left.value(),right.value()) < 0 ? right : left;
case GREATER_THAN:
return left;
case LESS_THAN:
return right;
default :
throw new IllegalArgumentException("Timestamp clocks must either be equal, greater then or less than: " + cr);
}
}
