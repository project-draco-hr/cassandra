{
  InetAddress dest=request.dst;
  InetAddress preferred=SystemKeyspace.getPreferredIP(dest);
  logger.info(String.format("[streaming task #%s] Performing streaming repair of %d ranges with %s",desc.sessionId,request.ranges.size(),request.dst));
  boolean isIncremental=false;
  if (desc.parentSessionId != null) {
    ActiveRepairService.ParentRepairSession prs=ActiveRepairService.instance.getParentRepairSession(desc.parentSessionId);
    isIncremental=prs.isIncremental;
  }
  new StreamPlan("Repair",repairedAt,1,false,isIncremental).listeners(this).flushBeforeTransfer(true).requestRanges(dest,preferred,desc.keyspace,request.ranges,desc.columnFamily).transferRanges(dest,preferred,desc.keyspace,request.ranges,desc.columnFamily).execute();
}
