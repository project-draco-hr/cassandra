{
  if (logger.isDebugEnabled())   logger.debug("Indexing row {} ",cfs.metadata.getKeyValidator().getString(key.key));
  Collection<SecondaryIndex> indexes=cfs.indexManager.getIndexesByNames(idxNames);
  switchLock.readLock().lock();
  try {
    Iterator<ColumnFamily> pager=QueryPagers.pageRowLocally(cfs,key.key,DEFAULT_PAGE_SIZE);
    while (pager.hasNext()) {
      ColumnFamily cf=pager.next();
      ColumnFamily cf2=cf.cloneMeShallow();
      for (      Cell cell : cf) {
        if (cfs.indexManager.indexes(cell.name(),indexes))         cf2.addColumn(cell);
      }
      cfs.indexManager.indexRow(key.key,cf2);
    }
  }
  finally {
    switchLock.readLock().unlock();
  }
}
