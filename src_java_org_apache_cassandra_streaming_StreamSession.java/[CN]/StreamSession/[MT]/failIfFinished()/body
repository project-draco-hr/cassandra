{
  if (state() == State.COMPLETE || state() == State.FAILED)   throw new RuntimeException(String.format("Stream %s is finished with state %s",planId(),state().name()));
}
