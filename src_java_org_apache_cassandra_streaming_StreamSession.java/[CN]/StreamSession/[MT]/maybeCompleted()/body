{
  boolean completed=receivers.isEmpty() && transfers.isEmpty();
  if (completed) {
    if (state == State.WAIT_COMPLETE) {
      state(State.COMPLETE);
      handler.close();
      streamResult.handleSessionComplete(this);
    }
 else {
      handler.sendMessage(new CompleteMessage());
      state(State.WAIT_COMPLETE);
    }
  }
  return completed;
}
