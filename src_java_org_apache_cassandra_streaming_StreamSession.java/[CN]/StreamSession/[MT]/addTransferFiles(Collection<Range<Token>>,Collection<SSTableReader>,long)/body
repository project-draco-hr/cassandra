{
  List<SSTableStreamingSections> sstableDetails=new ArrayList<>(sstables.size());
  for (  SSTableReader sstable : sstables) {
    long repairedAt=overriddenRepairedAt;
    if (overriddenRepairedAt == ActiveRepairService.UNREPAIRED_SSTABLE)     repairedAt=sstable.getSSTableMetadata().repairedAt;
    sstableDetails.add(new SSTableStreamingSections(sstable,sstable.getPositionsForRanges(ranges),sstable.estimatedKeysForRanges(ranges),repairedAt));
  }
  addTransferFiles(sstableDetails);
}
