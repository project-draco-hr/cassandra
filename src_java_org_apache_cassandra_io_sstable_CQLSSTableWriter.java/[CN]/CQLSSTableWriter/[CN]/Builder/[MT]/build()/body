{
  if (directory == null)   throw new IllegalStateException("No ouptut directory specified, you should provide a directory with inDirectory()");
  if (schema == null)   throw new IllegalStateException("Missing schema, you should provide the schema for the SSTable to create with forTable()");
  if (insert == null)   throw new IllegalStateException("No insert statement specified, you should provide an insert statement through using()");
  AbstractSSTableSimpleWriter writer=sorted ? new SSTableSimpleWriter(directory,schema,partitioner) : new BufferedWriter(directory,schema,partitioner,bufferSizeInMB);
  return new CQLSSTableWriter(writer,insert,boundNames);
}
