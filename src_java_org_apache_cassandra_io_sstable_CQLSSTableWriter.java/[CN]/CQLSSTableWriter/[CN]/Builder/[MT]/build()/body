{
  if (directory == null)   throw new IllegalStateException("No ouptut directory specified, you should provide a directory with inDirectory()");
  if (schema == null)   throw new IllegalStateException("Missing schema, you should provide the schema for the SSTable to create with forTable()");
  if (insert == null)   throw new IllegalStateException("No insert statement specified, you should provide an insert statement through using()");
  AbstractSSTableSimpleWriter writer;
  if (sorted) {
    writer=new SSTableSimpleWriter(directory,schema,partitioner);
  }
 else {
    writer=new SSTableSimpleUnsortedWriter(directory,schema,partitioner,bufferSizeInMB);
  }
  return new CQLSSTableWriter(writer,insert,boundNames);
}
