{
  try {
synchronized (CQLSSTableWriter.class) {
      this.schema=getTableMetadata(schema);
      KeyspaceMetadata ksm=Schema.instance.getKSMetaData(this.schema.ksName);
      if (ksm == null) {
        createKeyspaceWithTable(this.schema);
      }
 else       if (Schema.instance.getCFMetaData(this.schema.ksName,this.schema.cfName) == null) {
        addTableToKeyspace(ksm,this.schema);
      }
      return this;
    }
  }
 catch (  RequestValidationException e) {
    throw new IllegalArgumentException(e.getMessage(),e);
  }
}
