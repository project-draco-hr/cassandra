{
  try {
synchronized (CQLSSTableWriter.class) {
      this.schema=getStatement(schema,CreateTableStatement.class,"CREATE TABLE").left.getCFMetaData().rebuild();
      KSMetaData ksm=Schema.instance.getKSMetaData(this.schema.ksName);
      if (ksm == null) {
        ksm=KSMetaData.newKeyspace(this.schema.ksName,AbstractReplicationStrategy.getClass("org.apache.cassandra.locator.SimpleStrategy"),ImmutableMap.of("replication_factor","1"),true,Collections.singleton(this.schema));
        Schema.instance.load(ksm);
      }
 else       if (Schema.instance.getCFMetaData(this.schema.ksName,this.schema.cfName) == null) {
        Schema.instance.load(this.schema);
        ksm=ksm.cloneWithTableAdded(this.schema);
        Schema.instance.setKeyspaceDefinition(ksm);
        Keyspace.open(ksm.name).initCf(this.schema.cfId,this.schema.cfName,false);
      }
      return this;
    }
  }
 catch (  RequestValidationException e) {
    throw new IllegalArgumentException(e.getMessage(),e);
  }
}
