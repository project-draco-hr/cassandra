{
  try {
    ClientState state=ClientState.forInternalCalls();
    ParsedStatement.Prepared prepared=QueryProcessor.getStatement(query,state);
    CQLStatement stmt=prepared.statement;
    stmt.validate(state);
    if (!stmt.getClass().equals(klass))     throw new IllegalArgumentException("Invalid query, must be a " + type + " statement");
    return Pair.create(klass.cast(stmt),prepared.boundNames);
  }
 catch (  RequestValidationException e) {
    throw new IllegalArgumentException(e.getMessage(),e);
  }
}
