{
  DecoratedKey key=Util.dk("row3");
  ColumnFamily cf;
  cf=cfStore.getColumnFamily(key,cellname("col1000"),Composites.EMPTY,false,3,System.currentTimeMillis());
  assertColumns(cf,"col1000","col1001","col1002");
  ByteBuffer col;
  col=cf.getColumn(cellname("col1000")).value();
  assertEquals(ByteBufferUtil.string(col),"v1000");
  col=cf.getColumn(cellname("col1001")).value();
  assertEquals(ByteBufferUtil.string(col),"v1001");
  col=cf.getColumn(cellname("col1002")).value();
  assertEquals(ByteBufferUtil.string(col),"v1002");
  cf=cfStore.getColumnFamily(key,cellname("col1195"),Composites.EMPTY,false,3,System.currentTimeMillis());
  assertColumns(cf,"col1195","col1196","col1197");
  col=cf.getColumn(cellname("col1195")).value();
  assertEquals(ByteBufferUtil.string(col),"v1195");
  col=cf.getColumn(cellname("col1196")).value();
  assertEquals(ByteBufferUtil.string(col),"v1196");
  col=cf.getColumn(cellname("col1197")).value();
  assertEquals(ByteBufferUtil.string(col),"v1197");
  cf=cfStore.getColumnFamily(key,cellname("col1996"),Composites.EMPTY,true,1000,System.currentTimeMillis());
  Cell[] cells=cf.getSortedColumns().toArray(new Cell[0]);
  for (int i=1000; i < 1996; i++) {
    String expectedName="col" + i;
    Cell cell=cells[i - 1000];
    assertEquals(ByteBufferUtil.string(cell.name().toByteBuffer()),expectedName);
    assertEquals(ByteBufferUtil.string(cell.value()),("v" + i));
  }
  cf=cfStore.getColumnFamily(key,cellname("col1990"),Composites.EMPTY,false,3,System.currentTimeMillis());
  assertColumns(cf,"col1990","col1991","col1992");
  col=cf.getColumn(cellname("col1990")).value();
  assertEquals(ByteBufferUtil.string(col),"v1990");
  col=cf.getColumn(cellname("col1991")).value();
  assertEquals(ByteBufferUtil.string(col),"v1991");
  col=cf.getColumn(cellname("col1992")).value();
  assertEquals(ByteBufferUtil.string(col),"v1992");
  cf=cfStore.getColumnFamily(key,Composites.EMPTY,Composites.EMPTY,true,3,System.currentTimeMillis());
  assertColumns(cf,"col1997","col1998","col1999");
  col=cf.getColumn(cellname("col1997")).value();
  assertEquals(ByteBufferUtil.string(col),"v1997");
  col=cf.getColumn(cellname("col1998")).value();
  assertEquals(ByteBufferUtil.string(col),"v1998");
  col=cf.getColumn(cellname("col1999")).value();
  assertEquals(ByteBufferUtil.string(col),"v1999");
  cf=cfStore.getColumnFamily(key,cellname("col9000"),Composites.EMPTY,true,3,System.currentTimeMillis());
  assertColumns(cf,"col1997","col1998","col1999");
  cf=cfStore.getColumnFamily(key,cellname("col9000"),Composites.EMPTY,false,3,System.currentTimeMillis());
  assertColumns(cf);
}
