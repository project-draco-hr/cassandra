{
  final Keyspace keyspace=Keyspace.open("Keyspace2");
  final ColumnFamilyStore cfStore=keyspace.getColumnFamilyStore("Standard3");
  ColumnFamily cf=TreeMapBackedSortedColumns.factory.create("Keyspace2","Standard3");
  cf.addColumn(column("col1","val1",1L));
  RowMutation rm=new RowMutation("Keyspace2",TEST_KEY.key,cf);
  rm.apply();
  Runnable verify=new WrappedRunnable(){
    public void runMayThrow() throws Exception {
      ColumnFamily cf;
      cf=cfStore.getColumnFamily(QueryFilter.getNamesFilter(TEST_KEY,"Standard3",new TreeSet<ByteBuffer>(),System.currentTimeMillis()));
      assertColumns(cf);
      cf=cfStore.getColumnFamily(QueryFilter.getSliceFilter(TEST_KEY,"Standard3",ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER,false,0,System.currentTimeMillis()));
      assertColumns(cf);
      cf=cfStore.getColumnFamily(QueryFilter.getNamesFilter(TEST_KEY,"Standard3",FBUtilities.singleton(ByteBufferUtil.bytes("col99"),cfStore.getComparator()),System.currentTimeMillis()));
      assertColumns(cf);
    }
  }
;
  reTest(keyspace.getColumnFamilyStore("Standard3"),verify);
}
