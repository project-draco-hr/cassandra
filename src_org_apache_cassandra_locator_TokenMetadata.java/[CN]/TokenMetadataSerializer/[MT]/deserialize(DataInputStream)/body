{
  TokenMetadata tkMetadata=null;
  int size=dis.readInt();
  if (size > 0) {
    Map<BigInteger,EndPoint> tokenToEndPointMap=new HashMap<BigInteger,EndPoint>();
    Map<EndPoint,BigInteger> endPointToTokenMap=new HashMap<EndPoint,BigInteger>();
    for (int i=0; i < size; ++i) {
      byte[] bytes=new byte[dis.readInt()];
      dis.readFully(bytes);
      BigInteger token=new BigInteger(bytes);
      EndPoint endpoint=CompactEndPointSerializationHelper.deserialize(dis);
      tokenToEndPointMap.put(token,endpoint);
      endPointToTokenMap.put(endpoint,token);
    }
    tkMetadata=new TokenMetadata(tokenToEndPointMap,endPointToTokenMap);
  }
  return tkMetadata;
}
