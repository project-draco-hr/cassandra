{
  validateKey(key);
  AbstractType<?> comparator=getComparator(keyspace);
  RowMutation rm=new RowMutation(keyspace,key);
  for (  Map.Entry<Term,Term> column : getColumns().entrySet()) {
    ByteBuffer colName=column.getKey().getByteBuffer(comparator);
    ByteBuffer colValue=column.getValue().getByteBuffer(getValueValidator(keyspace,colName));
    validateColumn(metadata,colName,colValue);
    rm.add(new QueryPath(columnFamily,null,colName),colValue,(timestamp == null) ? getTimestamp() : timestamp);
  }
  return rm;
}
