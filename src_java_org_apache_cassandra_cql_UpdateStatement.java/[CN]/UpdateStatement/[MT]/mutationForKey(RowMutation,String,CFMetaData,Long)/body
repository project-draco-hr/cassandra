{
  AbstractType<?> comparator=getComparator(keyspace);
  for (  Map.Entry<Term,Term> column : getColumns().entrySet()) {
    ByteBuffer colName=column.getKey().getByteBuffer(comparator);
    ByteBuffer colValue=column.getValue().getByteBuffer(getValueValidator(keyspace,colName));
    validateColumn(metadata,colName,colValue);
    mutation.add(new QueryPath(columnFamily,null,colName),colValue,(timestamp == null) ? getTimestamp() : timestamp,getTimeToLive());
  }
}
