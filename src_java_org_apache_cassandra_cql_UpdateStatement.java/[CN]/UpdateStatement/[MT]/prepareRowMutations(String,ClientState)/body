{
  List<String> cfamsSeen=new ArrayList<String>();
  CFMetaData metadata=validateColumnFamily(keyspace,columnFamily,false);
  if (!(cfamsSeen.contains(columnFamily))) {
    clientState.hasColumnFamilyAccess(columnFamily,Permission.WRITE);
    cfamsSeen.add(columnFamily);
  }
  ByteBuffer key=this.key.getByteBuffer(getKeyType(keyspace));
  validateKey(key);
  AbstractType<?> comparator=getComparator(keyspace);
  RowMutation rm=new RowMutation(keyspace,key);
  for (  Map.Entry<Term,Term> column : getColumns().entrySet()) {
    ByteBuffer colName=column.getKey().getByteBuffer(comparator);
    ByteBuffer colValue=column.getValue().getByteBuffer(getValueValidator(keyspace,colName));
    validateColumn(metadata,colName,colValue);
    rm.add(new QueryPath(columnFamily,null,colName),colValue,System.currentTimeMillis());
  }
  return Arrays.asList(rm);
}
