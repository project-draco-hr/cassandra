{
  old=findFunction();
  if (old == null) {
    if (ifExists)     return false;
 else     throw new InvalidRequestException(getMissingFunctionError());
  }
  KSMetaData ksm=Schema.instance.getKSMetaData(old.name().keyspace);
  Collection<UDAggregate> referrers=ksm.functions.aggregatesUsingFunction(old);
  if (!referrers.isEmpty())   throw new InvalidRequestException(String.format("Function '%s' still referenced by %s",old,referrers));
  MigrationManager.announceFunctionDrop((UDFunction)old,isLocalOnly);
  return true;
}
