{
  old=findFunction();
  if (old == null) {
    if (ifExists)     return false;
 else     throw new InvalidRequestException(getMissingFunctionError());
  }
  List<Function> references=Functions.getReferencesTo(old);
  if (!references.isEmpty())   throw new InvalidRequestException(String.format("Function '%s' still referenced by %s",old,references));
  MigrationManager.announceFunctionDrop((UDFunction)old,isLocalOnly);
  return true;
}
