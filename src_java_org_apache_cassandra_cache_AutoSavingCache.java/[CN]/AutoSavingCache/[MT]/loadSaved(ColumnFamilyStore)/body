{
  int count=0;
  long start=System.nanoTime();
  File path=getCachePath(cfs.keyspace.getName(),cfs.name,cfs.metadata.cfId,CURRENT_VERSION);
  if (!path.exists())   path=getCachePath(cfs.keyspace.getName(),cfs.name,null,CURRENT_VERSION);
  if (path.exists()) {
    DataInputStream in=null;
    try {
      logger.info(String.format("reading saved cache %s",path));
      in=new DataInputStream(new LengthAvailableInputStream(new BufferedInputStream(new FileInputStream(path)),path.length()));
      List<Future<Pair<K,V>>> futures=new ArrayList<Future<Pair<K,V>>>();
      while (in.available() > 0) {
        Future<Pair<K,V>> entry=cacheLoader.deserialize(in,cfs);
        if (entry == null)         continue;
        futures.add(entry);
        count++;
      }
      for (      Future<Pair<K,V>> future : futures) {
        Pair<K,V> entry=future.get();
        put(entry.left,entry.right);
      }
    }
 catch (    Exception e) {
      logger.debug(String.format("harmless error reading saved cache %s",path.getAbsolutePath()),e);
    }
 finally {
      FileUtils.closeQuietly(in);
    }
  }
  if (logger.isDebugEnabled())   logger.debug("completed reading ({} ms; {} keys) saved cache {}",TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - start),count,path);
  return count;
}
