{
  List<SSTableReader> repairedSSTables=new ArrayList<>();
  List<SSTableReader> unrepairedSSTables=new ArrayList<>();
  for (  SSTableReader sstable : sstables) {
    if (sstable.isRepaired())     repairedSSTables.add(sstable);
 else     unrepairedSSTables.add(sstable);
  }
  Set<ISSTableScanner> scanners=new HashSet<>(sstables.size());
  AbstractCompactionStrategy.ScannerList repairedScanners=repaired.getScanners(repairedSSTables,ranges);
  AbstractCompactionStrategy.ScannerList unrepairedScanners=unrepaired.getScanners(unrepairedSSTables,ranges);
  scanners.addAll(repairedScanners.scanners);
  scanners.addAll(unrepairedScanners.scanners);
  return new AbstractCompactionStrategy.ScannerList(new ArrayList<>(scanners));
}
