{
  return new IStreamCallback(){
    private final AtomicInteger outstanding=new AtomicInteger(isLocalTask ? 2 : 1);
    public void onSuccess(){
      if (outstanding.decrementAndGet() > 0)       return;
      tasks.remove(taskid);
      if (callback != null)       callback.run();
    }
    public void onFailure(){
    }
  }
;
}
