{
  InetAddress local=FBUtilities.getLocalAddress();
  UUID id=UUIDGen.makeType1UUIDFromHost(local);
  InetAddress src=ep2.equals(local) ? ep2 : ep1;
  InetAddress dst=ep2.equals(local) ? ep1 : ep2;
  StreamingRepairTask task=new StreamingRepairTask(id,local,src,dst,tableName,cfName,ranges,wrapCallback(callback,id,local.equals(src)));
  tasks.put(id,task);
  return task;
}
