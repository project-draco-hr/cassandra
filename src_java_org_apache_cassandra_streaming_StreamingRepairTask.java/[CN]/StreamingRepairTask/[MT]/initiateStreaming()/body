{
  ColumnFamilyStore cfstore=Table.open(tableName).getColumnFamilyStore(cfName);
  try {
    logger.info(String.format("[streaming task #%s] Performing streaming repair of %d ranges with %s",id,ranges.size(),dst));
    Collection<SSTableReader> sstables=cfstore.getSSTables();
    StreamOutSession outsession=StreamOutSession.create(tableName,dst,callback);
    StreamOut.transferSSTables(outsession,sstables,ranges,OperationType.AES);
    StreamIn.requestRanges(dst,tableName,ranges,callback,OperationType.AES);
  }
 catch (  Exception e) {
    throw new RuntimeException("Streaming repair failed",e);
  }
}
