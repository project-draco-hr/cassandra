{
  ColumnDefinition cfDef=indexDef.indexedColumn(baseMetadata);
  if (cfDef.type.isCollection() && cfDef.type.isMultiCell()) {
    CollectionType type=(CollectionType)cfDef.type;
    if (type.kind == CollectionType.Kind.LIST || (type.kind == CollectionType.Kind.MAP && indexDef.options.containsKey(SecondaryIndex.INDEX_VALUES_OPTION_NAME))) {
      CompositesIndexOnCollectionValue.addClusteringColumns(indexMetadata,baseMetadata,cfDef);
    }
 else {
      addGenericClusteringColumns(indexMetadata,baseMetadata,cfDef);
    }
  }
 else   if (cfDef.isClusteringColumn()) {
    CompositesIndexOnClusteringKey.addClusteringColumns(indexMetadata,baseMetadata,cfDef);
  }
 else {
    addGenericClusteringColumns(indexMetadata,baseMetadata,cfDef);
  }
}
