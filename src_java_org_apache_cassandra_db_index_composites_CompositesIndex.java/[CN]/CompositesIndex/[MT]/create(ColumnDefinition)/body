{
  if (cfDef.type.isCollection()) {
switch (((CollectionType)cfDef.type).kind) {
case LIST:
      return new CompositesIndexOnCollectionValue();
case SET:
    return new CompositesIndexOnCollectionKey();
case MAP:
  return cfDef.getIndexOptions().containsKey("index_keys") ? new CompositesIndexOnCollectionKey() : new CompositesIndexOnCollectionValue();
}
}
switch (cfDef.kind) {
case CLUSTERING_COLUMN:
return new CompositesIndexOnClusteringKey();
case REGULAR:
return new CompositesIndexOnRegular();
case PARTITION_KEY:
return new CompositesIndexOnPartitionKey();
}
throw new AssertionError();
}
