{
  if (cfDef.type.isCollection() && cfDef.type.isMultiCell()) {
switch (((CollectionType)cfDef.type).kind) {
case LIST:
      return CompositesIndexOnCollectionValue.buildIndexComparator(baseMetadata,cfDef);
case SET:
    return CompositesIndexOnCollectionKey.buildIndexComparator(baseMetadata,cfDef);
case MAP:
  if (cfDef.hasIndexOption(SecondaryIndex.INDEX_KEYS_OPTION_NAME))   return CompositesIndexOnCollectionKey.buildIndexComparator(baseMetadata,cfDef);
 else   if (cfDef.hasIndexOption(SecondaryIndex.INDEX_ENTRIES_OPTION_NAME))   return CompositesIndexOnCollectionKeyAndValue.buildIndexComparator(baseMetadata,cfDef);
 else   return CompositesIndexOnCollectionValue.buildIndexComparator(baseMetadata,cfDef);
}
}
switch (cfDef.kind) {
case CLUSTERING_COLUMN:
return CompositesIndexOnClusteringKey.buildIndexComparator(baseMetadata,cfDef);
case REGULAR:
return CompositesIndexOnRegular.buildIndexComparator(baseMetadata,cfDef);
case PARTITION_KEY:
return CompositesIndexOnPartitionKey.buildIndexComparator(baseMetadata,cfDef);
}
throw new AssertionError();
}
