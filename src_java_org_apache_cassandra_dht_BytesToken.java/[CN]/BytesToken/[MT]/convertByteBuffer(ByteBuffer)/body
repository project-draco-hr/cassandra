{
  token=token.duplicate();
  if (token.position() == 0 && token.arrayOffset() == 0 && token.limit() == token.capacity()) {
    return token.array();
  }
 else {
    byte[] buf=new byte[token.remaining()];
    token.get(buf);
    return buf;
  }
}
