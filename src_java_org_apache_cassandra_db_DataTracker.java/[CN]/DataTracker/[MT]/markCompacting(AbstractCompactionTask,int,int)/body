{
  Collection<SSTableReader> sstablesToMark=task.getSSTables();
  if (sstablesToMark == null || sstablesToMark.isEmpty())   return false;
  if (max < min || max < 1)   return false;
  View currentView, newView;
  Set<SSTableReader> remaining=new LinkedHashSet<SSTableReader>(sstablesToMark);
  do {
    currentView=view.get();
    remaining.removeAll(currentView.compacting);
    remaining.retainAll(currentView.sstables);
    if (remaining.size() < min || remaining.size() > max)     return false;
    newView=currentView.markCompacting(sstablesToMark);
  }
 while (!view.compareAndSet(currentView,newView));
  return true;
}
