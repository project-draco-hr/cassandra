{
  if (!components.contains(Component.PRIMARY_INDEX))   return;
  try (RandomAccessReader primaryIndex=RandomAccessReader.open(new File(descriptor.filenameFor(Component.PRIMARY_INDEX)))){
    long indexSize=primaryIndex.length();
    long histogramCount=sstableMetadata.estimatedRowSize.count();
    long estimatedKeys=histogramCount > 0 && !sstableMetadata.estimatedRowSize.isOverflowed() ? histogramCount : estimateRowsFromIndex(primaryIndex);
    if (recreateBloomFilter)     bf=FilterFactory.getFilter(estimatedKeys,metadata.getBloomFilterFpChance(),true,descriptor.version.hasOldBfHashOrder());
    try (IndexSummaryBuilder summaryBuilder=summaryLoaded ? null : new IndexSummaryBuilder(estimatedKeys,metadata.getMinIndexInterval(),samplingLevel)){
      long indexPosition;
      RowIndexEntry.IndexSerializer rowIndexSerializer=descriptor.getFormat().getIndexSerializer(metadata,descriptor.version,header);
      while ((indexPosition=primaryIndex.getFilePointer()) != indexSize) {
        ByteBuffer key=ByteBufferUtil.readWithShortLength(primaryIndex);
        RowIndexEntry indexEntry=rowIndexSerializer.deserialize(primaryIndex);
        DecoratedKey decoratedKey=partitioner.decorateKey(key);
        if (first == null)         first=decoratedKey;
        last=decoratedKey;
        if (recreateBloomFilter)         bf.add(decoratedKey);
        if (!summaryLoaded) {
          summaryBuilder.maybeAddEntry(decoratedKey,indexPosition);
          ibuilder.addPotentialBoundary(indexPosition);
          dbuilder.addPotentialBoundary(indexEntry.position);
        }
      }
      if (!summaryLoaded)       indexSummary=summaryBuilder.build(partitioner);
    }
   }
   first=getMinimalKey(first);
  last=getMinimalKey(last);
}
