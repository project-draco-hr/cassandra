{
  File summariesFile=new File(descriptor.filenameFor(Component.SUMMARY));
  if (!summariesFile.exists())   return false;
  DataInputStream iStream=null;
  try {
    iStream=new DataInputStream(new FileInputStream(summariesFile));
    indexSummary=IndexSummary.serializer.deserialize(iStream,partitioner,descriptor.version.hasSamplingLevel(),metadata.getMinIndexInterval(),metadata.getMaxIndexInterval());
    first=partitioner.decorateKey(ByteBufferUtil.readWithLength(iStream));
    last=partitioner.decorateKey(ByteBufferUtil.readWithLength(iStream));
    ibuilder.deserializeBounds(iStream);
    dbuilder.deserializeBounds(iStream);
    boolean checkForRepair=true;
    try {
      int v=iStream.readInt();
      checkForRepair=v != ACCURATE_BOUNDARIES_MAGIC_NUMBER;
    }
 catch (    Throwable t) {
    }
    if (checkForRepair && MmappedSegmentedFile.maybeRepair(metadata,descriptor,indexSummary,ibuilder,dbuilder))     saveSummary(ibuilder,dbuilder);
  }
 catch (  IOException e) {
    if (indexSummary != null)     indexSummary.close();
    logger.trace("Cannot deserialize SSTable Summary File {}: {}",summariesFile.getPath(),e.getMessage());
    FileUtils.closeQuietly(iStream);
    FileUtils.deleteWithConfirm(summariesFile);
    return false;
  }
 finally {
    FileUtils.closeQuietly(iStream);
  }
  return true;
}
