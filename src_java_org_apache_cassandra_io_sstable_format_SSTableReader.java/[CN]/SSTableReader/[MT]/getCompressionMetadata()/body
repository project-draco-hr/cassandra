{
  if (!compression)   throw new IllegalStateException(this + " is not compressed");
  CompressionMetadata cmd=((ICompressedFile)dfile).getMetadata();
  String cfName=metadata.isSecondaryIndex() ? metadata.getParentColumnFamilyName() : metadata.cfName;
  cmd.parameters.setLiveMetadata(Schema.instance.getCFMetaData(metadata.ksName,cfName));
  return cmd;
}
