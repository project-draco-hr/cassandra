{
  CFMetaData metadata;
  if (descriptor.cfname.contains(SECONDARY_INDEX_NAME_SEPARATOR)) {
    int i=descriptor.cfname.indexOf(SECONDARY_INDEX_NAME_SEPARATOR);
    String parentName=descriptor.cfname.substring(0,i);
    CFMetaData parent=Schema.instance.getCFMetaData(descriptor.ksname,parentName);
    ColumnDefinition def=parent.getColumnDefinitionForIndex(descriptor.cfname.substring(i + 1));
    metadata=SecondaryIndex.newIndexMetadata(parent,def);
  }
 else {
    metadata=Schema.instance.getCFMetaData(descriptor.ksname,descriptor.cfname);
  }
  return open(descriptor,metadata);
}
