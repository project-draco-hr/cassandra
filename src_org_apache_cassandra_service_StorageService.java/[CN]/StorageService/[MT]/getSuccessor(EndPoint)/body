{
  BigInteger token=tokenMetadata_.getToken(ep);
  Map<BigInteger,EndPoint> tokenToEndPointMap=tokenMetadata_.cloneTokenEndPointMap();
  List<BigInteger> tokens=new ArrayList<BigInteger>(tokenToEndPointMap.keySet());
  Collections.sort(tokens);
  int index=Collections.binarySearch(tokens,token);
  EndPoint successor=(index == (tokens.size() - 1)) ? tokenToEndPointMap.get(tokens.get(0)) : tokenToEndPointMap.get(tokens.get(++index));
  return successor;
}
