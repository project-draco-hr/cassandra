{
  try {
    zk_=new ZooKeeper(DatabaseDescriptor.getZkAddress(),DatabaseDescriptor.getZkSessionTimeout(),new Watcher(){
      public void process(      WatchedEvent we){
        String path="/Cassandra/" + DatabaseDescriptor.getClusterName() + "/Leader";
        String eventPath=we.getPath();
        logger_.debug("PROCESS EVENT : " + eventPath);
        if (eventPath != null && (eventPath.contains(path))) {
          logger_.debug("Signalling the leader instance ...");
          LeaderElector.instance().signal();
        }
      }
    }
);
    Stat stat=zk_.exists("/",false);
    if (stat != null) {
      stat=zk_.exists("/Cassandra",false);
      if (stat == null) {
        logger_.debug("Creating the Cassandra znode ...");
        zk_.create("/Cassandra",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      }
      String path="/Cassandra/" + DatabaseDescriptor.getClusterName();
      stat=zk_.exists(path,false);
      if (stat == null) {
        logger_.debug("Creating the cluster znode " + path);
        zk_.create(path,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      }
      stat=zk_.exists(path + "/Leader",false);
      if (stat == null) {
        logger_.debug("Creating the leader znode " + path);
        zk_.create(path + "/Leader",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      }
      stat=zk_.exists(path + "/Locks",false);
      if (stat == null) {
        logger_.debug("Creating the locks znode " + path);
        zk_.create(path + "/Locks",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      }
      stat=zk_.exists(path + "/Misc",false);
      if (stat == null) {
        logger_.debug("Creating the misc znode " + path);
        zk_.create(path + "/Misc",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      }
    }
  }
 catch (  KeeperException ke) {
    LogUtil.throwableToString(ke);
    reportToZookeeper();
  }
}
