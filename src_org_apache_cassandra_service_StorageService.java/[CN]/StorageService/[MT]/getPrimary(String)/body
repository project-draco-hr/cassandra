{
  EndPoint endpoint=StorageService.tcpAddr_;
  BigInteger token=hash(key);
  Map<BigInteger,EndPoint> tokenToEndPointMap=tokenMetadata_.cloneTokenEndPointMap();
  List<BigInteger> tokens=new ArrayList<BigInteger>(tokenToEndPointMap.keySet());
  if (tokens.size() > 0) {
    Collections.sort(tokens);
    int index=Collections.binarySearch(tokens,token);
    if (index >= 0) {
      endpoint=tokenToEndPointMap.get(tokens.get(index));
    }
 else {
      index=(index + 1) * (-1);
      if (index < tokens.size())       endpoint=tokenToEndPointMap.get(tokens.get(index));
 else       endpoint=tokenToEndPointMap.get(tokens.get(0));
    }
  }
  return endpoint;
}
