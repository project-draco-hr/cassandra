{
  logger.info("Performing streaming repair of " + differences.size() + " ranges to "+ remote+ " for "+ cf);
  ColumnFamilyStore cfstore=Table.open(cf.left).getColumnFamilyStore(cf.right);
  try {
    final List<Range> ranges=new ArrayList<Range>(differences);
    final Collection<SSTableReader> sstables=cfstore.getSSTables();
    Future f=StageManager.getStage(StageManager.STREAM_STAGE).submit(new WrappedRunnable(){
      protected void runMayThrow() throws Exception {
        StreamOut.transferSSTables(remote,cf.left,sstables,ranges);
        StreamOutManager.remove(remote);
      }
    }
);
    f.get();
  }
 catch (  Exception e) {
    throw new IOException("Streaming repair failed.",e);
  }
  logger.info("Finished streaming repair to " + remote + " for "+ cf);
}
