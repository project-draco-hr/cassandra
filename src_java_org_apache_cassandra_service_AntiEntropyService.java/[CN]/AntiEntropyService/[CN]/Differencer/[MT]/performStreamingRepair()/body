{
  logger.info("Performing streaming repair of " + differences.size() + " ranges to "+ remote+ " for "+ cf);
  ColumnFamilyStore cfstore=Table.open(cf.left).getColumnFamilyStore(cf.right);
  try {
    List<Range> ranges=new ArrayList<Range>(differences);
    List<SSTableReader> sstables=CompactionManager.instance.submitAnticompaction(cfstore,ranges,remote).get();
    StreamOut.transferSSTables(remote,sstables,cf.left);
  }
 catch (  Exception e) {
    throw new IOException("Streaming repair failed.",e);
  }
  logger.info("Finished streaming repair to " + remote + " for "+ cf);
}
