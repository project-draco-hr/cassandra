{
  if (r1.tree.partitioner() == null)   r1.tree.partitioner(StorageService.getPartitioner());
  if (r2.tree.partitioner() == null)   r2.tree.partitioner(StorageService.getPartitioner());
  differences.addAll(MerkleTree.difference(r1.tree,r2.tree));
  String format=String.format("[repair #%s] Endpoints %s and %s %%s for %s",getName(),r1.endpoint,r2.endpoint,cfname);
  if (differences.isEmpty()) {
    logger.info(String.format(format,"are consistent"));
    completed(this);
    return;
  }
  logger.info(String.format(format,"have " + differences.size() + " range(s) out of sync"));
  performStreamingRepair();
}
