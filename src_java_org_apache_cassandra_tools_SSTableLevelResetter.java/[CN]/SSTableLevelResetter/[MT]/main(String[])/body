{
  PrintStream out=System.out;
  if (args.length == 0) {
    out.println("This command should be run with Cassandra stopped!");
    out.println("Usage: sstablelevelreset <keyspace> <columnfamily>");
    System.exit(1);
  }
  if (!args[0].equals("--really-reset") || args.length != 3) {
    out.println("This command should be run with Cassandra stopped, otherwise you will get very strange behavior");
    out.println("Verify that Cassandra is not running and then execute the command like this:");
    out.println("Usage: sstablelevelreset --really-reset <keyspace> <columnfamily>");
    System.exit(1);
  }
  String keyspace=args[1];
  String columnfamily=args[2];
  Directories directories=Directories.create(keyspace,columnfamily);
  boolean foundSSTable=false;
  for (  Map.Entry<Descriptor,Set<Component>> sstable : directories.sstableLister().list().entrySet()) {
    if (sstable.getValue().contains(Component.STATS)) {
      foundSSTable=true;
      Descriptor descriptor=sstable.getKey();
      SSTableMetadata metadata=SSTableMetadata.serializer.deserialize(descriptor);
      out.println("Changing level from " + metadata.sstableLevel + " to 0 on "+ descriptor.filenameFor(Component.DATA));
      LeveledManifest.mutateLevel(metadata,descriptor,descriptor.filenameFor(Component.STATS),0);
    }
  }
  if (!foundSSTable) {
    out.println("Found no sstables, did you give the correct keyspace/columnfamily?");
  }
}
