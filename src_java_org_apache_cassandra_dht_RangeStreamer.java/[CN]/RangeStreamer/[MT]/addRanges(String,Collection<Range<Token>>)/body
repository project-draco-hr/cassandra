{
  Multimap<Range<Token>,InetAddress> rangesForKeyspace=useStrictSourcesForRanges(keyspaceName) ? getAllRangesWithStrictSourcesFor(keyspaceName,ranges) : getAllRangesWithSourcesFor(keyspaceName,ranges);
  if (logger.isTraceEnabled()) {
    for (    Map.Entry<Range<Token>,InetAddress> entry : rangesForKeyspace.entries())     logger.trace(String.format("%s: range %s exists on %s",description,entry.getKey(),entry.getValue()));
  }
  for (  Map.Entry<InetAddress,Collection<Range<Token>>> entry : getRangeFetchMap(rangesForKeyspace,sourceFilters,keyspaceName).asMap().entrySet()) {
    if (logger.isTraceEnabled()) {
      for (      Range<Token> r : entry.getValue())       logger.trace(String.format("%s: range %s from source %s for keyspace %s",description,r,entry.getKey(),keyspaceName));
    }
    toFetch.put(keyspaceName,entry);
  }
}
