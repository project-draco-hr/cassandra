{
  logger.debug("Segment {} is no longer active and will be deleted {}",segment,deleteFile ? "now" : "by the archive script");
  size.addAndGet(-DatabaseDescriptor.getCommitLogSegmentSize());
  segmentManagementTasks.add(new Runnable(){
    public void run(){
      segment.close();
      if (deleteFile)       segment.delete();
    }
  }
);
}
