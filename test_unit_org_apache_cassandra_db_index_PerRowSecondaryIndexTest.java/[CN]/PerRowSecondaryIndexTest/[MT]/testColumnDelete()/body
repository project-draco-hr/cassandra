{
  RowMutation rm;
  rm=new RowMutation("PerRowSecondaryIndex",ByteBufferUtil.bytes("k2"));
  rm.delete(new QueryPath("Indexed1",null,ByteBufferUtil.bytes("indexed")),1);
  rm.apply();
  ColumnFamily indexedRow=PerRowSecondaryIndexTest.TestIndex.LAST_INDEXED_ROW;
  assertNotNull(indexedRow);
  for (  IColumn column : indexedRow.getSortedColumns()) {
    assertTrue(column.isMarkedForDelete());
  }
  assertTrue(Arrays.equals("k2".getBytes(),PerRowSecondaryIndexTest.TestIndex.LAST_INDEXED_KEY.array()));
}
