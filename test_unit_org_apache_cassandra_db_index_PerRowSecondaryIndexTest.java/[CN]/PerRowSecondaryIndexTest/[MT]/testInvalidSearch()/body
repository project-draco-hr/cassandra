{
  Mutation rm;
  rm=new Mutation(KEYSPACE1,ByteBufferUtil.bytes("k4"));
  rm.add("Indexed1",Util.cellname("indexed"),ByteBufferUtil.bytes("foo"),1);
  rm.apply();
  UntypedResultSet result=QueryProcessor.executeInternal(String.format("SELECT * FROM \"%s\".\"Indexed1\" WHERE indexed = 'foo'",KEYSPACE1));
  assertEquals(1,result.size());
  try {
    QueryProcessor.executeInternal(String.format("SELECT * FROM \"%s\".\"Indexed1\" WHERE indexed = 'invalid'",KEYSPACE1));
    fail("Query should have been invalid!");
  }
 catch (  Exception e) {
    assertTrue(e instanceof InvalidRequestException || (e.getCause() != null && (e.getCause() instanceof InvalidRequestException)));
  }
}
