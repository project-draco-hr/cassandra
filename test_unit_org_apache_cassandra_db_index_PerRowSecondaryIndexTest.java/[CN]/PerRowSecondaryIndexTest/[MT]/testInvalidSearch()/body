{
  Mutation rm;
  rm=new Mutation("PerRowSecondaryIndex",ByteBufferUtil.bytes("k4"));
  rm.add("Indexed1",Util.cellname("indexed"),ByteBufferUtil.bytes("foo"),1);
  rm.apply();
  UntypedResultSet result=QueryProcessor.executeInternal("SELECT * FROM \"PerRowSecondaryIndex\".\"Indexed1\" WHERE indexed = 'foo'");
  assertEquals(1,result.size());
  try {
    QueryProcessor.executeInternal("SELECT * FROM \"PerRowSecondaryIndex\".\"Indexed1\" WHERE indexed = 'invalid'");
    fail("Query should have been invalid!");
  }
 catch (  Exception e) {
    assertTrue(e instanceof InvalidRequestException || (e.getCause() != null && (e.getCause() instanceof InvalidRequestException)));
  }
}
