{
  RowMutation rm;
  rm=new RowMutation("PerRowSecondaryIndex",ByteBufferUtil.bytes("k1"));
  rm.add("Indexed1",ByteBufferUtil.bytes("indexed"),ByteBufferUtil.bytes("foo"),1);
  rm.apply();
  ColumnFamily indexedRow=TestIndex.LAST_INDEXED_ROW;
  assertNotNull(indexedRow);
  assertEquals(ByteBufferUtil.bytes("foo"),indexedRow.getColumn(ByteBufferUtil.bytes("indexed")).value());
  rm=new RowMutation("PerRowSecondaryIndex",ByteBufferUtil.bytes("k1"));
  rm.add("Indexed1",ByteBufferUtil.bytes("indexed"),ByteBufferUtil.bytes("bar"),2);
  rm.apply();
  indexedRow=TestIndex.LAST_INDEXED_ROW;
  assertNotNull(indexedRow);
  assertEquals(ByteBufferUtil.bytes("bar"),indexedRow.getColumn(ByteBufferUtil.bytes("indexed")).value());
  assertTrue(Arrays.equals("k1".getBytes(),TestIndex.LAST_INDEXED_KEY.array()));
}
