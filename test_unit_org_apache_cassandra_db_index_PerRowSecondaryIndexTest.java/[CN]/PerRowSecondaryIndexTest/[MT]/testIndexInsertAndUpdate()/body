{
  RowMutation rm;
  rm=new RowMutation("PerRowSecondaryIndex",ByteBufferUtil.bytes("k1"));
  rm.add("Indexed1",Util.cellname("indexed"),ByteBufferUtil.bytes("foo"),1);
  rm.apply();
  ColumnFamily indexedRow=PerRowSecondaryIndexTest.TestIndex.LAST_INDEXED_ROW;
  assertNotNull(indexedRow);
  assertEquals(ByteBufferUtil.bytes("foo"),indexedRow.getColumn(Util.cellname("indexed")).value());
  rm=new RowMutation("PerRowSecondaryIndex",ByteBufferUtil.bytes("k1"));
  rm.add("Indexed1",Util.cellname("indexed"),ByteBufferUtil.bytes("bar"),2);
  rm.apply();
  indexedRow=PerRowSecondaryIndexTest.TestIndex.LAST_INDEXED_ROW;
  assertNotNull(indexedRow);
  assertEquals(ByteBufferUtil.bytes("bar"),indexedRow.getColumn(Util.cellname("indexed")).value());
  assertTrue(Arrays.equals("k1".getBytes(),PerRowSecondaryIndexTest.TestIndex.LAST_INDEXED_KEY.array()));
}
