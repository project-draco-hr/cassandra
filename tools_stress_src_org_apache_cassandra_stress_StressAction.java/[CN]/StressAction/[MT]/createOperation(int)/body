{
switch (client.getOperation()) {
case READ:
    return client.isCQL() ? new CqlReader(client,index) : new Reader(client,index);
case COUNTER_GET:
  return client.isCQL() ? new CqlCounterGetter(client,index) : new CounterGetter(client,index);
case INSERT:
return client.isCQL() ? new CqlInserter(client,index) : new Inserter(client,index);
case COUNTER_ADD:
return client.isCQL() ? new CqlCounterAdder(client,index) : new CounterAdder(client,index);
case RANGE_SLICE:
return client.isCQL() ? new CqlRangeSlicer(client,index) : new RangeSlicer(client,index);
case INDEXED_RANGE_SLICE:
return client.isCQL() ? new CqlIndexedRangeSlicer(client,index) : new IndexedRangeSlicer(client,index);
case MULTI_GET:
return client.isCQL() ? new CqlMultiGetter(client,index) : new MultiGetter(client,index);
}
throw new UnsupportedOperationException();
}
