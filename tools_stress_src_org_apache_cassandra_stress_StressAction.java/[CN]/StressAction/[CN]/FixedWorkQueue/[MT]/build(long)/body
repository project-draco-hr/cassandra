{
  if (operations > Integer.MAX_VALUE * (1L << 19))   throw new IllegalStateException("Cannot currently support more than approx 2^50 operations for one stress run. This is a LOT.");
  int batchSize=(int)(operations / (1 << 19));
  if (batchSize < 20)   batchSize=20;
  ArrayBlockingQueue<Work> work=new ArrayBlockingQueue<>((int)((operations / batchSize) + (operations % batchSize == 0 ? 0 : 1)));
  long offset=0;
  while (offset < operations) {
    work.add(new Work(offset,(int)Math.min(batchSize,operations - offset)));
    offset+=batchSize;
  }
  return new FixedWorkQueue(work);
}
