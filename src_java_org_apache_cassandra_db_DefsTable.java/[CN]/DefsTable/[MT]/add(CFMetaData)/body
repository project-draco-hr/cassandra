{
  return executor.submit(new WrappedRunnable(){
    protected void runMayThrow() throws Exception {
      KSMetaData ksm=DatabaseDescriptor.getTableDefinition(cfm.tableName);
      if (ksm == null)       throw new ConfigurationException("Keyspace does not already exist.");
 else       if (ksm.cfMetaData().containsKey(cfm.cfName))       throw new ConfigurationException("CF is already defined in that keyspace.");
      List<CFMetaData> newCfs=new ArrayList<CFMetaData>(ksm.cfMetaData().values());
      newCfs.add(cfm);
      ksm=new KSMetaData(ksm.name,ksm.strategyClass,ksm.replicationFactor,ksm.snitch,newCfs.toArray(new CFMetaData[newCfs.size()]));
      UUID newVersion=saveKeyspaceDefs(ksm,null);
      Table.open(ksm.name).addCf(cfm.cfName);
      DatabaseDescriptor.setTableDefinition(ksm,newVersion);
      CommitLog.instance().forceNewSegment();
    }
  }
);
}
