{
  IOException mostRecentProblem=null;
  Set<String> cfNames=DatabaseDescriptor.getTableDefinition(oldKs).cfMetaData().keySet();
  for (  String cfName : cfNames) {
    for (    File existing : getFiles(oldKs,cfName)) {
      try {
        File newParent=new File(existing.getParentFile().getParent(),newKs);
        newParent.mkdirs();
        FileUtils.renameWithConfirm(existing,new File(newParent,existing.getName()));
      }
 catch (      IOException ex) {
        mostRecentProblem=ex;
      }
    }
  }
  if (mostRecentProblem != null)   throw new IOException("One or more IOExceptions encountered while renaming files. Most recent problem is included.",mostRecentProblem);
}
