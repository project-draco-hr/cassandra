{
  return executor.submit(new WrappedRunnable(){
    protected void runMayThrow() throws Exception {
      if (DatabaseDescriptor.getTableDefinition(ksm.name) != null)       throw new ConfigurationException("Keyspace already exists.");
      UUID versionId=saveKeyspaceDefs(ksm,null);
      DatabaseDescriptor.setTableDefinition(ksm,versionId);
      Table.open(ksm.name);
      CommitLog.instance().forceNewSegment();
    }
  }
);
}
