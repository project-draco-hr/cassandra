{
  Map<DecoratedKey,ColumnFamily> oldKeyspaces=SystemTable.getSchema(SystemTable.SCHEMA_KEYSPACES_CF);
  Map<DecoratedKey,ColumnFamily> oldColumnFamilies=SystemTable.getSchema(SystemTable.SCHEMA_COLUMNFAMILIES_CF);
  for (  RowMutation mutation : mutations)   mutation.apply();
  SystemTable.migrateKeyAlias();
  if (!StorageService.instance.isClientMode())   flushSchemaCFs();
  Schema.instance.updateVersionAndAnnounce();
  Map<DecoratedKey,ColumnFamily> newKeyspaces=SystemTable.getSchema(SystemTable.SCHEMA_KEYSPACES_CF);
  Map<DecoratedKey,ColumnFamily> newColumnFamilies=SystemTable.getSchema(SystemTable.SCHEMA_COLUMNFAMILIES_CF);
  Set<String> keyspacesToDrop=mergeKeyspaces(oldKeyspaces,newKeyspaces);
  mergeColumnFamilies(oldColumnFamilies,newColumnFamilies);
  for (  String keyspaceToDrop : keyspacesToDrop)   dropKeyspace(keyspaceToDrop);
}
