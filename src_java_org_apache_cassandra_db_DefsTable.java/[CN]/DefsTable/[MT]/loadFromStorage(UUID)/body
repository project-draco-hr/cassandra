{
  DecoratedKey vkey=StorageService.getPartitioner().decorateKey(Migration.toBytes(version));
  Table defs=Table.open(Table.SYSTEM_TABLE);
  ColumnFamilyStore cfStore=defs.getColumnFamilyStore(Migration.SCHEMA_CF);
  QueryFilter filter=QueryFilter.getSliceFilter(vkey,new QueryPath(Migration.SCHEMA_CF),"".getBytes(),"".getBytes(),null,false,1024);
  ColumnFamily cf=cfStore.getColumnFamily(filter);
  Collection<KSMetaData> tables=new ArrayList<KSMetaData>();
  for (  IColumn col : cf.getSortedColumns()) {
    if (col instanceof DeletedColumn)     continue;
    KSMetaData ks=KSMetaData.deserialize(new ByteArrayInputStream(col.value()));
    tables.add(ks);
  }
  return tables;
}
