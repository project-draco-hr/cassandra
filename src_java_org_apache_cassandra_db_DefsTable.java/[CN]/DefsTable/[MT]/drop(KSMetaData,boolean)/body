{
  return executor.submit(new WrappedRunnable(){
    protected void runMayThrow() throws Exception {
      if (DatabaseDescriptor.getTableDefinition(ksm.name) != ksm)       throw new ConfigurationException("Either keyspace doesn't exist or the name of the one you supplied doesn't match with the one being used.");
      Table table=Table.clear(ksm.name);
      if (table == null)       throw new ConfigurationException("Table is not active. " + ksm.name);
      for (      CFMetaData cfm : ksm.cfMetaData().values()) {
        CFMetaData.purge(cfm);
        table.dropCf(cfm.cfName);
        SystemTable.markForRemoval(cfm);
      }
      UUID versionId=saveKeyspaceDefs(null,ksm);
      DatabaseDescriptor.clearTableDefinition(ksm,versionId);
      CommitLog.instance().forceNewSegment();
      cleanupDeadFiles(blockOnFileDeletion);
    }
  }
);
}
