{
  ColumnFamilyStore cfs=Table.open(Table.SYSTEM_KS).getColumnFamilyStore(columnFamily);
  boolean needsCleanup=false;
  Date now=new Date();
  List<Row> rows=SystemTable.serializedSchema(columnFamily);
  row_check_loop:   for (  Row row : rows) {
    if (Schema.invalidSchemaRow(row))     continue;
    for (    Column column : row.cf.columns) {
      Date columnDate=new Date(column.timestamp());
      if (columnDate.after(now)) {
        Date micros=new Date(column.timestamp() / 1000);
        Calendar calendar=Calendar.getInstance();
        calendar.setTime(micros);
        if ((micros.before(now) && calendar.get(Calendar.YEAR) == 1970) || micros.after(now)) {
          needsCleanup=true;
          break row_check_loop;
        }
      }
 else {
        needsCleanup=true;
        break row_check_loop;
      }
    }
  }
  if (!needsCleanup)   return;
  logger.info("Fixing timestamps of schema ColumnFamily " + columnFamily + "...");
  cfs.truncateBlocking();
  long microTimestamp=now.getTime() * 1000;
  for (  Row row : rows) {
    if (Schema.invalidSchemaRow(row))     continue;
    RowMutation mutation=new RowMutation(Table.SYSTEM_KS,row.key.key);
    for (    Column column : row.cf.columns) {
      if (column.isLive())       mutation.add(columnFamily,column.name(),column.value(),microTimestamp);
    }
    mutation.apply();
  }
  cfs.forceBlockingFlush();
}
