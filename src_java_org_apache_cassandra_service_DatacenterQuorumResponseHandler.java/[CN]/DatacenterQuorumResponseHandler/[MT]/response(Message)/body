{
  try {
    int b=-1;
    responses.add(message);
    if (localdc.equals(snitch.getDatacenter(message.getFrom()))) {
      b=localResponses.decrementAndGet();
    }
 else {
      b=localResponses.get();
    }
    if (b == 0 && responseResolver.isDataPresent(responses)) {
      condition.signal();
    }
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
}
