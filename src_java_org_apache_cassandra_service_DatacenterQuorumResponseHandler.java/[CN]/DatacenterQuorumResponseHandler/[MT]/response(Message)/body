{
  if (condition.isSignaled()) {
    return;
  }
  try {
    if (endpointsnitch.isInSameDataCenter(localEndpoint,message.getFrom())) {
      blockFor--;
    }
  }
 catch (  UnknownHostException e) {
    throw new RuntimeException(e);
  }
  responses.add(message);
  if (blockFor <= 0) {
    condition.signal();
  }
  if (logger.isDebugEnabled())   logger.debug("Processed Message: " + message.toString());
}
