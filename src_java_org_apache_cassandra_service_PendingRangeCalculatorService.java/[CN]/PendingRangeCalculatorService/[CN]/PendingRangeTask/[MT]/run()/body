{
  long start=System.currentTimeMillis();
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    calculatePendingRanges(Keyspace.open(keyspaceName).getReplicationStrategy(),keyspaceName);
  }
  PendingRangeCalculatorService.instance.finishUpdate();
  logger.debug("finished calculation for {} keyspaces in {}ms",Schema.instance.getNonSystemKeyspaces().size(),System.currentTimeMillis() - start);
}
