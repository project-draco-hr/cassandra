{
  for (  String seed : seeds_) {
    try {
      TSocket socket=new TSocket(seed,port_);
      TBinaryProtocol binaryProtocol=new TBinaryProtocol(new TFramedTransport(socket));
      Cassandra.Client client=new Cassandra.Client(binaryProtocol);
      socket.open();
      List<TokenRange> ring=client.describe_ring(keyspace);
      BiMap<Token,InetAddress> tokenEndpointMap=HashBiMap.create();
      for (      TokenRange range : ring) {
        Token<?> token=StorageService.getPartitioner().getTokenFactory().fromString(range.start_token);
        String host=range.endpoints.get(0);
        try {
          tokenEndpointMap.put(token,InetAddress.getByName(host));
        }
 catch (        UnknownHostException e) {
          throw new AssertionError(e);
        }
      }
      tokenMetadata=new TokenMetadata(tokenEndpointMap);
      break;
    }
 catch (    InvalidRequestException e) {
      throw new RuntimeException(e);
    }
catch (    TException e) {
      logger_.debug("Error contacting seed " + seed + " "+ e.getMessage());
    }
  }
}
