{
  if (rangeSet == null)   throw new RuntimeException("Must refresh endpoints before looking up a key.");
  Token<?> t=partitioner_.getToken(key);
  for (  Range range : rangeSet)   if (range.contains(t))   return rangeMap.get(range);
  throw new RuntimeException("Invalid token information returned by describe_ring: " + rangeMap);
}
