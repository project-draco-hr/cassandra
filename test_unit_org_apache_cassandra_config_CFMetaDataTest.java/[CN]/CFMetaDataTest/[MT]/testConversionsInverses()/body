{
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    for (    ColumnFamilyStore cfs : Keyspace.open(keyspaceName).getColumnFamilyStores()) {
      CFMetaData cfm=cfs.metadata;
      if (!cfm.isThriftCompatible())       continue;
      checkInverses(cfm);
      CFMetaData withCompression=CFMetaData.rename(cfm,cfm.cfName);
      withCompression.compressionParameters(new CompressionParameters(SnappyCompressor.instance,32768,new HashMap<String,String>()));
      checkInverses(withCompression);
    }
  }
}
