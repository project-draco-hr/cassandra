{
  Partition.RowIterator[] iterators=new Partition.RowIterator[partitions.size()];
  for (int i=0; i < iterators.length; i++)   iterators[i]=partitions.get(i).iterator(perVisit.next());
  List<BoundStatement> stmts=new ArrayList<>();
  partitionCount=partitions.size();
  boolean done;
  do {
    done=true;
    stmts.clear();
    for (    Partition.RowIterator iterator : iterators) {
      if (iterator.done())       continue;
      for (      Row row : iterator.batch(perBatch.next()))       stmts.add(bindRow(row));
      done&=iterator.done();
    }
    rowCount+=stmts.size();
    Statement stmt;
    if (stmts.size() == 1) {
      stmt=stmts.get(0);
    }
 else {
      BatchStatement batch=new BatchStatement(batchType);
      batch.setConsistencyLevel(JavaDriverClient.from(cl));
      batch.addAll(stmts);
      stmt=batch;
    }
    validate(client.getSession().execute(stmt));
  }
 while (!done);
  return true;
}
