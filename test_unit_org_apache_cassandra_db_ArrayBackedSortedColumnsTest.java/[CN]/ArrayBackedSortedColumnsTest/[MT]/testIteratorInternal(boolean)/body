{
  ISortedColumns map=ArrayBackedSortedColumns.factory().create(BytesType.instance,reversed);
  List<ByteBuffer> names=new ArrayList<ByteBuffer>();
  int[] values=new int[]{1,2,3,5,9};
  for (  int v : values)   names.add(ByteBufferUtil.bytes(v));
  for (int i=0; i < values.length; ++i)   map.addColumn(new Column(ByteBufferUtil.bytes(values[reversed ? values.length - 1 - i : i])),HeapAllocator.instance);
  assertSame(new int[]{3,2,1},map.reverseIterator(new ColumnSlice[]{new ColumnSlice(ByteBufferUtil.bytes(3),ByteBufferUtil.EMPTY_BYTE_BUFFER)}));
  assertSame(new int[]{3,2,1},map.reverseIterator(new ColumnSlice[]{new ColumnSlice(ByteBufferUtil.bytes(4),ByteBufferUtil.EMPTY_BYTE_BUFFER)}));
  assertSame(map.iterator(),map.iterator(ColumnSlice.ALL_COLUMNS_ARRAY));
}
