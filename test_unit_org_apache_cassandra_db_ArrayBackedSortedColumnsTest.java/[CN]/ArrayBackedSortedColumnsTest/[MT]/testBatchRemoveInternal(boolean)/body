{
  ColumnFamily map=ArrayBackedSortedColumns.factory.create(metadata(),reversed);
  int[] values=new int[]{1,2,3,5};
  for (int i=0; i < values.length; ++i)   map.addColumn(new Column(ByteBufferUtil.bytes(values[reversed ? values.length - 1 - i : i])),HeapAllocator.instance);
  BatchRemoveIterator<Column> batchIter=map.batchRemoveIterator();
  batchIter.next();
  batchIter.remove();
  batchIter.next();
  batchIter.remove();
  assertEquals("1st column before commit",1,map.iterator().next().name().getInt(0));
  batchIter.commit();
  assertEquals("1st column after commit",3,map.iterator().next().name().getInt(0));
}
