{
  CellNameType type=new SimpleDenseCellNameType(Int32Type.instance);
  ColumnFamily map=ArrayBackedSortedColumns.factory.create(metadata(),reversed);
  int[] values=new int[]{1,2,3,5,9};
  List<Column> sorted=new ArrayList<Column>();
  for (  int v : values)   sorted.add(new Column(type.makeCellName(v)));
  List<Column> reverseSorted=new ArrayList<Column>(sorted);
  Collections.reverse(reverseSorted);
  for (int i=0; i < values.length; ++i)   map.addColumn(new Column(type.makeCellName(values[reversed ? values.length - 1 - i : i])),HeapAllocator.instance);
  assertSame(sorted,map.getSortedColumns());
  assertSame(reverseSorted,map.getReverseSortedColumns());
}
