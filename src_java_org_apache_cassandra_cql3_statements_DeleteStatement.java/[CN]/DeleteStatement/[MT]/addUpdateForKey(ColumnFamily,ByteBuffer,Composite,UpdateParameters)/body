{
  List<Operation> deletions=getOperations();
  if (prefix.size() < cfm.clusteringColumns().size() && !deletions.isEmpty()) {
    for (    Operation deletion : deletions)     if (!deletion.column.isStatic())     throw new InvalidRequestException(String.format("Primary key column '%s' must be specified in order to delete column '%s'",getFirstEmptyKey().name,deletion.column.name));
  }
  if (deletions.isEmpty()) {
    if (prefix.isEmpty()) {
      cf.delete(new DeletionInfo(params.timestamp,params.localDeletionTime));
    }
 else     if (cfm.comparator.isDense() && prefix.size() == cfm.clusteringColumns().size()) {
      cf.addAtom(params.makeTombstone(cfm.comparator.create(prefix,null)));
    }
 else {
      cf.addAtom(params.makeRangeTombstone(prefix.slice()));
    }
  }
 else {
    for (    Operation op : deletions)     op.execute(key,cf,prefix,params);
  }
}
