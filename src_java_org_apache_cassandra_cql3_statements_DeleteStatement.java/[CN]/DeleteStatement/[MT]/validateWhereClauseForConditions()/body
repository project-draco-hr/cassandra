{
  Iterator<ColumnDefinition> iterator=Iterators.concat(cfm.partitionKeyColumns().iterator(),cfm.clusteringColumns().iterator());
  while (iterator.hasNext()) {
    ColumnDefinition def=iterator.next();
    Restriction restriction=processedKeys.get(def.name);
    if (restriction == null || !(restriction.isEQ() || restriction.isIN())) {
      throw new InvalidRequestException(String.format("DELETE statements must restrict all PRIMARY KEY columns with equality relations in order " + "to use IF conditions, but column '%s' is not restricted",def.name));
    }
  }
}
