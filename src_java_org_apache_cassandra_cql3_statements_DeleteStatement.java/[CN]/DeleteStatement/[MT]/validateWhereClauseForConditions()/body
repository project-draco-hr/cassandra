{
  Iterator<CFDefinition.Name> iterator=Iterators.concat(cfm.getCfDef().partitionKeys().iterator(),cfm.getCfDef().clusteringColumns().iterator());
  while (iterator.hasNext()) {
    CFDefinition.Name name=iterator.next();
    Restriction restriction=processedKeys.get(name.name);
    if (restriction == null || !(restriction.isEQ() || restriction.isIN())) {
      throw new InvalidRequestException(String.format("DELETE statements must restrict all PRIMARY KEY columns with equality relations in order " + "to use IF conditions, but column '%s' is not restricted",name.name));
    }
  }
}
