{
  CFMetaData metadata=ThriftValidation.validateColumnFamily(keyspace(),columnFamily());
  type=metadata.getDefaultValidator().isCommutative() ? Type.COUNTER : Type.LOGGED;
  cfDef=metadata.getCfDef();
  UpdateStatement.processKeys(cfDef,whereClause,processedKeys,boundNames);
  for (  Operation.RawDeletion deletion : deletions) {
    CFDefinition.Name name=cfDef.get(deletion.affectedColumn());
    if (name == null)     throw new InvalidRequestException(String.format("Unknown identifier %s",deletion.affectedColumn()));
    if (name.kind != CFDefinition.Name.Kind.COLUMN_METADATA && name.kind != CFDefinition.Name.Kind.VALUE_ALIAS)     throw new InvalidRequestException(String.format("Invalid identifier %s for deletion (should not be a PRIMARY KEY part)",name));
    Operation op=deletion.prepare(name);
    op.collectMarkerSpecification(boundNames);
    toRemove.add(op);
  }
  return new ParsedStatement.Prepared(this,Arrays.<ColumnSpecification>asList(boundNames));
}
