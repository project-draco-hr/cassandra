{
  int size=input.readInt();
  byte[] contentBytes=new byte[size];
  int remainder=size % CHUNK_SIZE;
  for (int offset=0; offset < size - remainder; offset+=CHUNK_SIZE)   input.readFully(contentBytes,offset,CHUNK_SIZE);
  input.readFully(contentBytes,size - remainder,remainder);
  if (version <= MessagingService.version_) {
    DataInputStream dis=new DataInputStream(new ByteArrayInputStream(contentBytes));
    String id=dis.readUTF();
    Message message=Message.serializer().deserialize(dis,version);
    MessagingService.instance().receive(message,id);
    return message;
  }
  logger.info("Received connection from newer protocol version. Ignorning message.");
  return null;
}
