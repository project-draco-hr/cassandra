{
  if (version < MessagingService.VERSION_12)   input.readInt();
  String id=input.readUTF();
  long timestamp=version >= MessagingService.VERSION_12 ? (System.currentTimeMillis() | 0x00000000FFFFFFFFL) & input.readInt() : System.currentTimeMillis();
  MessageIn message=MessageIn.read(input,version,id);
  if (message == null) {
    return null;
  }
  if (version <= MessagingService.current_version) {
    MessagingService.instance().receive(message,id,timestamp);
  }
 else {
    logger.debug("Received connection from newer protocol version {}. Ignoring message",version);
  }
  return message.from;
}
