{
  AbstractBounds<PartitionPosition> bounds=((PartitionRangeReadCommand)command).dataRange().keyRange();
  if (bounds instanceof Range || bounds instanceof Bounds) {
    return new Range<PartitionPosition>(lastReturnedKey,bounds.right);
  }
 else {
    return new ExcludingBounds<PartitionPosition>(lastReturnedKey,bounds.right);
  }
}
