{
  ExecutorService executor=Executors.newCachedThreadPool();
  try {
    List<Future<?>> mutationFutures=new ArrayList<Future<?>>();
    for (    Map.Entry<InetAddress,Map<byte[],Map<String,List<Mutation>>>> entry : mutationsByEndpoint.entrySet()) {
      mutationFutures.add(executor.submit(new EndpointCallable(conf,entry.getKey(),entry.getValue())));
    }
    for (    Future<?> mutationFuture : mutationFutures) {
      try {
        mutationFuture.get();
      }
 catch (      ExecutionException e) {
        throw new IOException("Could not perform endpoint mutations",e.getCause());
      }
catch (      InterruptedException e) {
        throw new AssertionError(e);
      }
    }
  }
  finally {
    executor.shutdownNow();
    mutationsByEndpoint.clear();
  }
}
