{
  KsDef curState=toThrift();
  RowMutation m=new RowMutation(Table.SYSTEM_TABLE,SystemTable.getSchemaKSKey(name));
  for (  KsDef._Fields field : KsDef._Fields.values()) {
    if (field.equals(KsDef._Fields.CF_DEFS))     continue;
    Object curValue=curState.getFieldValue(field);
    Object newValue=newState.getFieldValue(field);
    if (Objects.equal(curValue,newValue))     continue;
    m.add(new QueryPath(SystemTable.SCHEMA_KEYSPACES_CF,null,AsciiType.instance.fromString(field.getFieldName())),valueAsBytes(newValue),modificationTimestamp);
  }
  return m;
}
