{
  List<CfDef> cfDefs=new ArrayList<CfDef>();
  for (  CFMetaData cfm : cfMetaData().values())   cfDefs.add(cfm.toThrift());
  KsDef ksdef=new KsDef(name,strategyClass.getName(),cfDefs);
  ksdef.setStrategy_options(strategyOptions);
  if (strategyOptions != null && strategyOptions.containsKey("replication_factor"))   ksdef.setReplication_factor(Integer.parseInt(strategyOptions.get("replication_factor")));
  ksdef.setDurable_writes(durable_writes);
  return ksdef;
}
