{
  RowMutation mutation=new RowMutation(Table.SYSTEM_TABLE,SystemTable.getSchemaKSKey(ksDef.name));
  for (  KsDef._Fields field : KsDef._Fields.values()) {
    if (field.equals(KsDef._Fields.CF_DEFS))     continue;
    mutation.add(new QueryPath(SystemTable.SCHEMA_KEYSPACES_CF,null,AsciiType.instance.fromString(field.getFieldName())),valueAsBytes(ksDef.getFieldValue(field)),timestamp);
  }
  if (!ksDef.isSetCf_defs())   return mutation;
  for (  CfDef cf : ksDef.cf_defs) {
    try {
      CFMetaData.toSchema(mutation,cf,timestamp);
    }
 catch (    ConfigurationException e) {
      throw new IOException(e);
    }
  }
  return mutation;
}
