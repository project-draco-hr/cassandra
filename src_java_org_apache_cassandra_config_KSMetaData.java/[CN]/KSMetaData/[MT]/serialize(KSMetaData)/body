{
  ByteArrayOutputStream bout=new ByteArrayOutputStream();
  DataOutputStream dout=new DataOutputStream(bout);
  dout.writeUTF(ksm.name);
  dout.writeBoolean(ksm.strategyClass != null);
  if (ksm.strategyClass != null)   dout.writeUTF(ksm.strategyClass.getName());
  dout.writeInt(ksm.replicationFactor);
  dout.writeBoolean(ksm.snitch != null);
  if (ksm.snitch != null)   dout.writeUTF(ksm.snitch.getClass().getName());
  dout.writeInt(ksm.cfMetaData.size());
  for (  CFMetaData cfm : ksm.cfMetaData.values())   dout.write(CFMetaData.serialize(cfm));
  dout.close();
  return bout.toByteArray();
}
