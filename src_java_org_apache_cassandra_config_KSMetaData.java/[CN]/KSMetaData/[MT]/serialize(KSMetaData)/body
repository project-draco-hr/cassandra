{
  ByteArrayOutputStream bout=new ByteArrayOutputStream();
  DataOutputStream dout=new DataOutputStream(bout);
  dout.writeUTF(ksm.name);
  dout.writeBoolean(ksm.repStratClass != null);
  if (ksm.repStratClass != null)   dout.writeUTF(ksm.repStratClass.getName());
  dout.writeInt(ksm.replicationFactor);
  dout.writeBoolean(ksm.epSnitch != null);
  if (ksm.epSnitch != null)   dout.writeUTF(ksm.epSnitch.getClass().getName());
  dout.writeInt(ksm.cfMetaData.size());
  for (  CFMetaData cfm : ksm.cfMetaData.values())   dout.write(CFMetaData.serialize(cfm));
  dout.close();
  return bout.toByteArray();
}
