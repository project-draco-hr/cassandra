{
  if (!CFMetaData.isNameValid(name))   throw new ConfigurationException(String.format("Invalid keyspace name: shouldn't be empty nor more than %s characters long (got \"%s\")",Schema.NAME_LENGTH,name));
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  IEndpointSnitch eps=DatabaseDescriptor.getEndpointSnitch();
  AbstractReplicationStrategy.createReplicationStrategy(name,strategyClass,tmd,eps,strategyOptions);
  for (  CFMetaData cfm : cfMetaData.values())   cfm.validate();
  return this;
}
