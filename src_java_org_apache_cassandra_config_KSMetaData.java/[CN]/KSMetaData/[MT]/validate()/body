{
  if (!CFMetaData.isNameValid(name))   throw new ConfigurationException(String.format("Keyspace name must not be empty, more than %s characters long, or contain non-alphanumeric-underscore characters (got \"%s\")",Schema.NAME_LENGTH,name));
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  IEndpointSnitch eps=DatabaseDescriptor.getEndpointSnitch();
  AbstractReplicationStrategy.createReplicationStrategy(name,strategyClass,tmd,eps,strategyOptions);
  for (  CFMetaData cfm : cfMetaData.values())   cfm.validate();
  return this;
}
