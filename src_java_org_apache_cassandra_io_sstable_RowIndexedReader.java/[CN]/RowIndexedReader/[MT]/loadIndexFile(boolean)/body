{
  indexSummary=new IndexSummary();
  BufferedRandomAccessFile input=new BufferedRandomAccessFile(indexFilename(),"r");
  if (recreatebloom) {
    bf=BloomFilter.getFilter((int)(input.length() / 32),15);
  }
  try {
    long indexSize=input.length();
    while (true) {
      long indexPosition=input.getFilePointer();
      if (indexPosition == indexSize) {
        break;
      }
      DecoratedKey decoratedKey=partitioner.convertFromDiskFormat(FBUtilities.readShortByteArray(input));
      if (recreatebloom) {
        bf.add(decoratedKey.key);
      }
      long dataPosition=input.readLong();
      long nextIndexPosition=input.getFilePointer();
      long nextDataPosition;
      if (input.isEOF()) {
        nextDataPosition=length();
      }
 else {
        FBUtilities.readShortByteArray(input);
        nextDataPosition=input.readLong();
        input.seek(nextIndexPosition);
      }
      indexSummary.maybeAddEntry(decoratedKey,dataPosition,nextDataPosition - dataPosition,indexPosition,nextIndexPosition);
    }
    indexSummary.complete();
  }
  finally {
    input.close();
  }
}
