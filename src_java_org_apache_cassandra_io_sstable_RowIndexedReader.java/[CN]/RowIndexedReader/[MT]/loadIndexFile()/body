{
  indexSummary=new IndexSummary();
  BufferedRandomAccessFile input=new BufferedRandomAccessFile(indexFilename(),"r");
  try {
    long indexSize=input.length();
    while (true) {
      long indexPosition=input.getFilePointer();
      if (indexPosition == indexSize) {
        break;
      }
      DecoratedKey decoratedKey=partitioner.convertFromDiskFormat(input.readUTF());
      long dataPosition=input.readLong();
      long nextIndexPosition=input.getFilePointer();
      long nextDataPosition;
      if (input.isEOF()) {
        nextDataPosition=length();
      }
 else {
        input.readUTF();
        nextDataPosition=input.readLong();
        input.seek(nextIndexPosition);
      }
      indexSummary.maybeAddEntry(decoratedKey,dataPosition,nextDataPosition - dataPosition,indexPosition,nextIndexPosition);
    }
    indexSummary.complete();
  }
  finally {
    input.close();
  }
}
