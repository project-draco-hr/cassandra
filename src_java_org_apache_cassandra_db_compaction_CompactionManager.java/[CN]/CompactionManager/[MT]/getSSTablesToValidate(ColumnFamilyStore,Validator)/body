{
  Refs<SSTableReader> sstables;
  ActiveRepairService.ParentRepairSession prs=ActiveRepairService.instance.getParentRepairSession(validator.desc.parentSessionId);
  if (prs == null)   return null;
  Set<SSTableReader> sstablesToValidate=new HashSet<>();
  try (ColumnFamilyStore.RefViewFragment sstableCandidates=cfs.selectAndReference(prs.isIncremental ? ColumnFamilyStore.UNREPAIRED_SSTABLES : ColumnFamilyStore.CANONICAL_SSTABLES)){
    for (    SSTableReader sstable : sstableCandidates.sstables) {
      if (new Bounds<>(sstable.first.getToken(),sstable.last.getToken()).intersects(Collections.singletonList(validator.desc.range))) {
        sstablesToValidate.add(sstable);
      }
    }
    Set<SSTableReader> currentlyRepairing=ActiveRepairService.instance.currentlyRepairing(cfs.metadata.cfId,validator.desc.parentSessionId);
    if (!Sets.intersection(currentlyRepairing,sstablesToValidate).isEmpty()) {
      logger.error("Cannot start multiple repair sessions over the same sstables");
      throw new RuntimeException("Cannot start multiple repair sessions over the same sstables");
    }
    sstables=Refs.tryRef(sstablesToValidate);
    if (sstables == null) {
      logger.error("Could not reference sstables");
      throw new RuntimeException("Could not reference sstables");
    }
  }
   prs.addSSTables(cfs.metadata.cfId,sstablesToValidate);
  return sstables;
}
