{
  Scrubber scrubber=new Scrubber(cfs,sstable,skipCorrupted);
  CompactionInfo.Holder scrubInfo=scrubber.getScrubInfo();
  metrics.beginCompaction(scrubInfo);
  try {
    scrubber.scrub();
  }
  finally {
    scrubber.close();
    metrics.finishCompaction(scrubInfo);
  }
  if (scrubber.getNewInOrderSSTable() != null)   cfs.addSSTable(scrubber.getNewInOrderSSTable());
  if (scrubber.getNewSSTable() == null)   cfs.markObsolete(Collections.singletonList(sstable),OperationType.SCRUB);
 else   cfs.replaceCompactedSSTables(Collections.singletonList(sstable),Collections.singletonList(scrubber.getNewSSTable()),OperationType.SCRUB);
}
