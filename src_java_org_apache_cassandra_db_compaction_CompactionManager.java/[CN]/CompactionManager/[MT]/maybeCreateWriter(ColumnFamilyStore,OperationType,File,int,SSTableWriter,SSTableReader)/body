{
  if (writer == null) {
    FileUtils.createDirectory(compactionFileLocation);
    writer=new SSTableWriter(cfs.getTempSSTablePath(compactionFileLocation),expectedBloomFilterSize,cfs.metadata,cfs.partitioner,SSTableMetadata.createCollector(Collections.singleton(sstable),sstable.getSSTableLevel()));
  }
  return writer;
}
