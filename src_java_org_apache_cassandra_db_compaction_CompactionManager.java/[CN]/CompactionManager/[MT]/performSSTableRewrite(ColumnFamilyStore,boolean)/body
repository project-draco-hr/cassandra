{
  performAllSSTableOperation(cfStore,new AllSSTablesOperation(){
    public void perform(    ColumnFamilyStore cfs,    Iterable<SSTableReader> sstables){
      for (      final SSTableReader sstable : sstables) {
        if (excludeCurrentVersion && sstable.descriptor.version.equals(Descriptor.Version.CURRENT))         continue;
        AbstractCompactionTask task=cfs.getCompactionStrategy().getCompactionTask(Collections.singleton(sstable),NO_GC,Long.MAX_VALUE);
        task.setUserDefined(true);
        task.setCompactionType(OperationType.UPGRADE_SSTABLES);
        task.execute(metrics);
      }
    }
  }
);
}
