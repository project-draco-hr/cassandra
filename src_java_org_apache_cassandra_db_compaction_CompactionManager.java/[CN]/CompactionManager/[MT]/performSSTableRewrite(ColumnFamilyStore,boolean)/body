{
  performAllSSTableOperation(cfStore,new AllSSTablesOperation(){
    public void perform(    ColumnFamilyStore cfs,    Collection<SSTableReader> sstables){
      for (      final SSTableReader sstable : sstables) {
        if (excludeCurrentVersion && sstable.descriptor.version.equals(Descriptor.Version.CURRENT))         continue;
        CompactionTask task=new CompactionTask(cfs,Collections.singletonList(sstable),NO_GC);
        task.setUserDefined(true);
        task.setCompactionType(OperationType.UPGRADE_SSTABLES);
        task.execute(metrics);
      }
    }
  }
);
}
