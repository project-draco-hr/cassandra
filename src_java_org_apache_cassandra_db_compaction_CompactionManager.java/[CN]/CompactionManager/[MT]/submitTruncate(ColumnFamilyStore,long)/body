{
  Runnable runnable=new WrappedRunnable(){
    public void runMayThrow() throws InterruptedException, IOException {
      compactionLock.writeLock().lock();
      try {
        main.discardSSTables(truncatedAt);
        for (        SecondaryIndex index : main.indexManager.getIndexes())         index.truncate(truncatedAt);
      }
  finally {
        compactionLock.writeLock().unlock();
      }
    }
  }
;
  return executor.submit(runnable);
}
