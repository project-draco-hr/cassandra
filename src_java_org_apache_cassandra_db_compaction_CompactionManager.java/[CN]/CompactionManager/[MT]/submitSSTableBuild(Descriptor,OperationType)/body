{
  final Rebuilder builder=SSTableWriter.createBuilder(desc,type);
  Callable<SSTableReader> callable=new Callable<SSTableReader>(){
    public SSTableReader call() throws IOException {
      compactionLock.readLock().lock();
      try {
        executor.beginCompaction(builder);
        try {
          return builder.build();
        }
  finally {
          executor.finishCompaction(builder);
        }
      }
  finally {
        compactionLock.readLock().unlock();
      }
    }
  }
;
  return executor.submit(callable);
}
