{
  Callable<Integer> callable=new Callable<Integer>(){
    public Integer call() throws IOException {
      compactionLock.readLock().lock();
      try {
        if (cfs.isInvalid())         return 0;
        AbstractCompactionStrategy strategy=cfs.getCompactionStrategy();
        for (        AbstractCompactionTask task : strategy.getBackgroundTasks(getDefaultGcBefore(cfs))) {
          if (!task.markSSTablesForCompaction())           continue;
          try {
            task.execute(executor);
          }
  finally {
            task.unmarkSSTables();
          }
        }
      }
  finally {
        compactionLock.readLock().unlock();
      }
      return 0;
    }
  }
;
  return executor.submit(callable);
}
