{
  Runnable runnable=new WrappedRunnable(){
    protected void runMayThrow() throws IOException {
      compactionLock.readLock().lock();
      try {
        AbstractCompactionStrategy strategy=cfs.getCompactionStrategy();
        AbstractCompactionTask task=strategy.getNextBackgroundTask(getDefaultGcBefore(cfs));
        if (task == null || !task.markSSTablesForCompaction())         return;
        try {
          task.execute(executor);
        }
  finally {
          task.unmarkSSTables();
        }
        submitBackground(cfs);
      }
  finally {
        compactionLock.readLock().unlock();
      }
    }
  }
;
  return executor.submit(runnable);
}
