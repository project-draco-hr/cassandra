{
  Runnable runnable=new WrappedRunnable(){
    protected void runMayThrow() throws IOException {
      Collection<SSTableReader> sstables=new ArrayList<SSTableReader>(dataFiles.size());
      for (      Descriptor desc : dataFiles) {
        SSTableReader sstable=lookupSSTable(cfs,desc);
        if (sstable == null) {
          logger.info("Will not compact {}: it is not an active sstable",desc);
        }
 else {
          sstables.add(sstable);
        }
      }
      if (sstables.isEmpty()) {
        logger.info("No files to compact for user defined compaction");
      }
 else {
        AbstractCompactionTask task=cfs.getCompactionStrategy().getUserDefinedTask(sstables,gcBefore);
        if (task != null)         task.execute(metrics);
      }
    }
  }
;
  if (executor.isShutdown()) {
    logger.info("Compaction executor has shut down, not submitting task");
    return Futures.immediateCancelledFuture();
  }
  return executor.submit(runnable);
}
