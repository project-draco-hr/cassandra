{
  final Collection<AbstractCompactionTask> tasks=cfStore.getCompactionStrategy().getMaximalTask(gcBefore);
  if (tasks == null)   return Collections.emptyList();
  List<Future<?>> futures=new ArrayList<>();
  int nonEmptyTasks=0;
  for (  final AbstractCompactionTask task : tasks) {
    if (task.sstables.size() > 0)     nonEmptyTasks++;
    Runnable runnable=new WrappedRunnable(){
      protected void runMayThrow() throws IOException {
        task.execute(metrics);
      }
    }
;
    if (executor.isShutdown()) {
      logger.info("Compaction executor has shut down, not submitting task");
      return Collections.emptyList();
    }
    futures.add(executor.submit(runnable));
  }
  if (nonEmptyTasks > 1)   logger.info("Cannot perform a full major compaction as repaired and unrepaired sstables cannot be compacted together. These two set of sstables will be compacted separately.");
  return futures;
}
