{
  final Collection<AbstractCompactionTask> tasks=cfStore.getCompactionStrategy().getMaximalTask(gcBefore);
  if (tasks == null)   return Collections.emptyList();
  List<Future<?>> futures=new ArrayList<>();
  for (  final AbstractCompactionTask task : tasks) {
    Runnable runnable=new WrappedRunnable(){
      protected void runMayThrow() throws IOException {
        task.execute(metrics);
      }
    }
;
    futures.add(executor.submit(runnable));
  }
  return futures;
}
