{
  Runnable runnable=new WrappedRunnable(){
    protected void runMayThrow() throws IOException {
      compactionLock.writeLock().lock();
      try {
        AbstractCompactionTask task=cfStore.getCompactionStrategy().getMaximalTask(gcBefore);
        if (task == null)         return;
        try {
          compactionLock.readLock().lock();
          compactionLock.writeLock().unlock();
          try {
            task.execute(metrics);
          }
  finally {
            compactionLock.readLock().unlock();
          }
        }
  finally {
          task.unmarkSSTables();
        }
      }
  finally {
        if (compactionLock.writeLock().isHeldByCurrentThread())         compactionLock.writeLock().unlock();
      }
    }
  }
;
  return executor.submit(runnable);
}
