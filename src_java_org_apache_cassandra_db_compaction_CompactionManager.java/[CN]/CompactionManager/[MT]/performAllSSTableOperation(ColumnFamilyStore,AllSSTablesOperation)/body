{
  final Iterable<SSTableReader> sstables=cfs.markAllCompacting();
  if (sstables == null)   return;
  Callable<Object> runnable=new Callable<Object>(){
    public Object call() throws IOException {
      try {
        operation.perform(cfs,sstables);
      }
  finally {
        cfs.getDataTracker().unmarkCompacting(sstables);
      }
      return this;
    }
  }
;
  executor.submit(runnable).get();
}
