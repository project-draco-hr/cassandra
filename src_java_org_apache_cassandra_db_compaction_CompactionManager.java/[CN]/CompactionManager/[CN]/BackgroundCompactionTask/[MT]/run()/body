{
  try {
    logger.debug("Checking {}.{}",cfs.table.getName(),cfs.name);
    if (!cfs.isValid()) {
      logger.debug("Aborting compaction for dropped CF");
      return;
    }
    AbstractCompactionStrategy strategy=cfs.getCompactionStrategy();
    AbstractCompactionTask task=strategy.getNextBackgroundTask(getDefaultGcBefore(cfs));
    if (task == null) {
      logger.debug("No tasks available");
      return;
    }
    task.execute(metrics);
  }
  finally {
    compactingCF.remove(cfs);
  }
  submitBackground(cfs);
}
