{
  try {
    logger.debug("Checking {}.{}",cfs.keyspace.getName(),cfs.name);
    if (!cfs.isValid()) {
      logger.debug("Aborting compaction for dropped CF");
      return;
    }
    CompactionStrategyManager strategy=cfs.getCompactionStrategyManager();
    AbstractCompactionTask task=strategy.getNextBackgroundTask(getDefaultGcBefore(cfs));
    if (task == null) {
      logger.debug("No tasks available");
      return;
    }
    task.execute(metrics);
  }
  finally {
    compactingCF.remove(cfs);
  }
  submitBackground(cfs);
}
